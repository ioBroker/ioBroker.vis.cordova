<!DOCTYPE html>
<html manifest="cache.manifest" xmlns="http://www.w3.org/1999/html">
<head>
    <!-- vis Version 1.1.3 -->

    <meta charset="utf-8">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, maximum-scale=2, minimum-scale=0.5, user-scalable=yes" />
    <meta name="mobile-web-app-capable" content="yes">

    <!-- cordova settings -->
    <meta http-equiv="Content-Security-Policy"
          content="default-src 'self' * 'unsafe-eval' 'unsafe-inline'; style-src 'self' 'unsafe-inline' *; img-src 'self' 'unsafe-inline' * data:; media-src 'self' 'unsafe-inline' *; connect-src 'self' 'unsafe-eval' 'unsafe-inline' * ws: wss:; script-src 'self' 'unsafe-eval' 'unsafe-inline' *">
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">

    <link href="img/favicon.png" rel="shortcut icon" type="image/x-icon" />
    <link href="img/favicon.png" rel="apple-touch-icon" />

    <title>vis</title>

    <link rel="stylesheet" type="text/css" href="lib/css/jquery.multiselect-1.13.css" />

    <link rel="stylesheet" type="text/css" href="css/backgrounds.css" />
    <link rel="stylesheet" type="text/css" href="css/vis.css" />
    <link rel="stylesheet" type="text/css" href="file:///data/data/net.iobroker.vis/files/vis-common-user.css" />
    <link rel="stylesheet" type="text/css" href="css/app.css" />
    <link rel="stylesheet" type="text/css" href="css/styles.css" />

    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="lib/js/jquery-1.11.2.min.js"></script>
    <script type="text/javascript" src="lib/js/jquery-ui-1.11.4.full.min.js"></script>
    <script type="text/javascript" src="lib/js/socket.io.js"></script>
    <script type="text/javascript" src="lib/js/translate.js"></script>
    <script type="text/javascript" src="js/app.js"></script>

    <script type="text/javascript" src="lib/js/can.custom.min.js"></script>
    <script type="text/javascript" src="lib/js/jquery.ui.touch-punch.min.js"></script>
    <script type="text/javascript" src="lib/js/jquery.multiselect-1.13.min.js"></script>
    <script type="text/javascript" src="lib/js/quo.standalone.js"></script>
    <script type="text/javascript" src="lib/js/loStorage.js"></script>
    <script type="text/javascript" src="lib/js/moment-with-locales.min.js"></script>

    
    <script type="text/javascript" src="js/config.js"></script> <!-- this file must be before vis.js -->
    <script type="text/javascript" src="js/conn.js"></script>
    <script type="text/javascript" src="js/visUtils.js"></script>
    <script type="text/javascript" src="js/vis.js"></script>
</head>
<body>
<!-- ---------------------------------------  DO NOT EDIT INSIDE THIS LINE - BEGIN ------------------------------------------- -->
<!-- --------------bars.html--- START -->
<!--
    ioBroker.vis bars Widget-Set

    version: "0.1.4"

    Copyright 2013-2016 bluefox<dogafox@gmail.com>
-->
<link rel="stylesheet" type="text/css" href="widgets/bars/css/bars.css" />
<link rel="stylesheet" type="text/css" href="widgets/bars/css/sidebar.css" />
<link rel="stylesheet" type="text/css" href="widgets/bars/css/barButtons.css" />
<script type="text/javascript" src="widgets/bars/js/bars.js"></script>
<script type="text/javascript" src="widgets/bars/js/jquery.sidebar.js"></script>

<script id="tplBarFilter" 
		type="text/ejs"
		class="vis-tpl"
		data-vis-type="filter"
		data-vis-set="bars"
		data-vis-name="Filter bar"
		data-vis-prev='<img src="widgets/bars/img/Prev_bars_filter.png"></img>'
		data-vis-attrs="bCount[1]/number,1,100,1;bTheme[sidebar-red]/style,,sidebar-,background-color;bPosition[floatHorizontal]/select,floatHorizontal,floatVertical,dockTop,dockBottom,dockLeft,dockRight;bOnlyOneSelected/checkbox;bValue/filters;alwaysOpened/checkbox;"
		data-vis-attrs0="group.button_options;bSpace[5]/slider,0,100,1;bRadius[5]/slider,0,100,1;bOffset[0]/slider,0,100,1;bTextAlign[center]/select,center,left,right;bImageAlign[center]/select,center,left,right;bLayout[fixed]/select,auto,fixed;imagePaddingLeft[10]/slider,0,100,1;imagePaddingTop[2]/slider,0,100,1;"
		data-vis-attrs1="group.style;bStyleNormal/style,barButtons,-button,background;bStyleActive/style,barButtons,-button,background;"
		data-vis-attrs2="group.effects;bShowEffect[show]/effect;bShowEffectMs[100]/number;bHideEffect[show]/effect;bHideEffectMs[100]/number;"
		data-vis-attrs3="group.buttons/byindex;buttonsImage(1-bCount)/image;buttonsText(1-bCount);buttonsOption(1-bCount)/filters;"
		data-vis-init="initOptions">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 200px; height: 130px;overflow:visible" id="<%= this.data.attr('wid') %>"
	    data-vis-hide-helper=<%== (this.data.attr('position')=='dockTop' || this.data.attr('position')=='dockBottom' || this.data.attr('position')=='dockRight' || this.data.attr('position')=='dockRight') ? 'true' : 'false' %>
	    data-vis-resizable='<%== (this.data.attr('position')=='dockTop' || this.data.attr('position')=='dockBottom' || this.data.attr('position')=='dockRight' || this.data.attr('position')=='dockRight') ? '{"disabled":true}': '' %>'
	    data-vis-draggable='<%== (this.data.attr('position')=='dockTop' || this.data.attr('position')=='dockBottom' || this.data.attr('position')=='dockRight' || this.data.attr('position')=='dockRight') ? '{"disabled":true}': '' %>'
	    >
        <div class="vis-widget-body" style="overflow: visible"></div>
        <% vis.binds.bars.init(this.data.wid, this.data, this.view, "tplBarFilter"); %>
    </div>
</script>

<script id="tplBarNavigator" 
		type="text/ejs"
		class="vis-tpl"
		data-vis-type="navigation"
		data-vis-set="bars"
		data-vis-prev='<img src="widgets/bars/img/Prev_bars_view.png"></img>'
		data-vis-name="Views bar"
		data-vis-attrs="bCount[1]/number,1,100,1;bTheme[sidebar-blue]/style,,sidebar-,background-color;bPosition[floatHorizontal]/select,floatHorizontal,floatVertical,dockTop,dockBottom,dockLeft,dockRight;alwaysOpened/checkbox;"
		data-vis-attrs0="group.button_options;bSpace[5]/slider,0,100,1;bRadius[5]/slider,0,100,1;bOffset[0]/slider,0,100,1;bTextAlign[center]/select,center,left,right;bImageAlign[center]/select,center,left,right;bLayout[fixed]/select,auto,fixed;imagePaddingLeft[10]/slider,0,100,1;imagePaddingTop[2]/slider,0,100,1;"
		data-vis-attrs1="group.style;bStyleNormal/style,barButtons,-button,background;bStyleActive/style,barButtons,-button,background;"
		data-vis-attrs2="group.effects;bShowEffect[show]/effect;bShowEffectMs[100]/number;bHideEffect[show]/effect;bHideEffectMs[100]/number;"
		data-vis-attrs3="group.buttons/byindex;buttonsImage(1-bCount)/image;buttonsText(1-bCount);buttonsOption(1-bCount)/views;"
		data-vis-init="initOptions">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 200px; height: 130px;overflow:visible" id="<%= this.data.attr('wid') %>"
	    data-vis-hide-helper=<%== (this.data.attr('position')=='dockTop' || this.data.attr('position')=='dockBottom' || this.data.attr('position')=='dockRight' || this.data.attr('position')=='dockRight') ? 'true' : 'false' %>
	    data-vis-resizable='<%== (this.data.attr('position')=='dockTop' || this.data.attr('position')=='dockBottom' || this.data.attr('position')=='dockRight' || this.data.attr('position')=='dockRight') ? '{"disabled":true}': '' %>'
	    data-vis-draggable='<%== (this.data.attr('position')=='dockTop' || this.data.attr('position')=='dockBottom' || this.data.attr('position')=='dockRight' || this.data.attr('position')=='dockRight') ? '{"disabled":true}': '' %>'
	    >
        <div class="vis-widget-body" style="overflow: visible"></div>
        <% vis.binds.bars.init(this.data.wid, this.data, this.view, "tplBarNavigator"); %>
    </div>
</script>

<!-- --------------bars.html--- END -->
<!-- --------------basic.html--- START -->
<link rel="stylesheet" type="text/css" href="widgets/basic/css/table.css" />
<script type="text/javascript" src="widgets/basic/js/table.js"></script>

<script type="text/javascript">
    'use strict';

    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {
            // Bars
            "src":              {"en": "Source",                    "de": "Quelle",                 "ru": "Адрес"},
            "refreshInterval":  {"en": "Refresh interval(ms)",      "de": "Updatezeit(ms)",         "ru": "Интервал обновления(ms)"},
            "is_comma":         {"en": "Divider comma",             "de": "Komme als Trennung",     "ru": "Запятая-разделитель"},
            "is_tdp":           {"en": "Use thousands separator",  "de": "Tausender Trennzeichen",  "ru": "Use thousands separator"},
            "digits":           {"en": "Digits after comma",        "de": "Zeichen nach Komma",     "ru": "Знаков после запятой"},
            "oid":              {"en": "Object ID",                 "de": "Object ID",              "ru": "ID Объекта"},
            "html_prepend":     {"en": "Prepend value",             "de": "Voranstellen HTML",      "ru": "Префикс значения"},
            "html_append":      {"en": "Append to value",           "de": "HTML anhängen",          "ru": "Суффикс значения"},
            "html_append_singular": {
                "en": "Append to value (Singular)",
                "de": "HTML anhängen (Singulär)",
                "ru": "Суффикс значения(един.ч.)"
            },
            "html_append_plural": {
                "en": "Append to value (Plural)",
                "de": "HTML anhängen(Plüral)",
                "ru": "Суффикс значения(множ.ч.)"
            },
            "html_prepend_tooltip":    {
                "en": "Write HTML code here that will be placed before,\x0Ae.g. <b> ",
                "de": "HTML Kod, der wird vom dem Wert platziert,\x0Az.B. <b>",
                "ru": "HTML код будет помещён перед значением,\x0Aнапример <b>"
            },
            "html_append_tooltip":     {
                "en": "Write HTML code here that will be placed before,\x0Ae.g. </b>",
                "de": "HTML Kod, der wird vom dem Wert platziert,\x0Az.B. </b>",
                "ru": "HTML код будет помещён после значения,\x0Aнапример </b>"
            },
            "stretch":          {"en": "Stretch",                   "de": "Strecken",               "ru": "Растянуть"},
            "factor":           {"en": "Multiplex factor",          "de": "Multiplikation",         "ru": "Множитеть"},
            "class_true":       {"en": "Class if quality 'true'",   "de": "Klasse bei Qualität 'true'", "ru": "Класс, если качество 'true'"},
            "class_false":      {"en": "Class if quality 'false'",  "de": "Klasse bei Qualität 'false'", "ru": "Класс, если качество 'false'"},
            "test_html":        {"en": "Text for test",             "de": "Testtext",               "ru": "Тестовый текст"},
            "test_html_tooltip": {
                "en": "You can specify the test text if value is now empty to visualise settings.\x0AIt is valid only during edit.",
                "de": "Man kann noch Testtext setzen um die Einstellungen visuell zu sehen.\x0ADas ist nur während Edit gültig.",
                "ru": "Можно задать тестовый текст, что бы видеть настройки визуально.\x0AОн действителен только во время редактирования."
            },
            "html":             {"en": "HTML",                      "de": "HTML",                   "ru": "HTML"},
            "oid-quality":      {"en": "Quality ID",                "de": "Qualität ID",            "ru": "ID-Качество"},
            "oid-quality_tooltip":     {
                "en": "You can set additionally Quality ID to indicate if the value valid or not.",
                "de": "Man kann noch zusätzlich Qualität ID setzetn um zu zeigen ob das Wert aktuell ist.",
                "ru": "Можно дополнительно установить ID-Качества, что бы показать актуальное значение или нет."},
            "title":            {"en": "Title",                     "de": "Titel",                  "ru": "Заголовок"},
            "title_font":       {"en": "Title font name",           "de": "Titelschriftname",       "ru": "Шрифт заголовка"},
            "title_color":      {"en": "Title color",               "de": "Titelfarbe",             "ru": "Цвет заголовка"},
            "title_back":       {"en": "Title backg. color",        "de": "Titelhintergrund",       "ru": "Цвет фона текста"},
            "title_top":        {"en": "Title top padding",         "de": "Titel-Oben-Abstand",     "ru": "Отступ заголовка сверху"},
            "title_left":       {"en": "Title left padding",        "de": "Titel-Links-Abstand",    "ru": "Отступ заголовка слева"},
            "header_height":    {"en": "Header height",             "de": "Kopfhöhe",               "ru": "Высота заголовока"},
            "header_color":     {"en": "Header color",              "de": "Kopffarbe",              "ru": "Цвет фона заголовка"},
            "refreshOnWakeUp":  {"en": "Refresh on wake up",        "de": "Update bei Aufwachen",   "ru": "Обновлять при выходе из сна"},
            "refreshOnViewChange": {"en": "Refresh on view change", "de": "Update bei Viewwechsel", "ru": "Обновлять при смене страницы"},
            "refreshWithNoQuery": {"en": "Do not add anything to URL", "de": "Addiere nichst zu URL", "ru": "Ничего не добавлять к URL"},
            "src_":             {"en": "URL, by value=",            "de": "URL falls Wert=",        "ru": "Адрес при значении "},
            "nav_view":         {"en": "View to navigate",          "de": "View zum Navigieren",    "ru": "Перейти на страницу"},
            "group_effects":    {"en": "Show/Hide Effects",         "de": "Anzeige Effekte",        "ru": "Эффекты появления/исчезновения"},
            "group_extended":   {"en": "Extended settings",         "de": "Erweiterte Eistellungen", "ru": "Расширенные настройки"},
            "body-background":  {"en": "Background color by changing", "de": "Hintegrund by Wechsel", "ru": "Фон при смене страниц"},
            "sync":             {"en": "Hide and show together:",   "de": "Anzeigen und verbergen gleichzeitig", "ru": "Появления и исчезновение вместе"},
            // Effects
            "show":             {"en": "show",                      "de": "show",                   "ru": "show"},
            "blind":            {"en": "blind",                     "de": "blind",                  "ru": "blind"},
            "bounce":           {"en": "bounce",                    "de": "bounce",                 "ru": "bounce"},
            "clip":             {"en": "clip",                      "de": "clip",                   "ru": "clip"},
            "drop":             {"en": "drop",                      "de": "drop",                   "ru": "drop"},
            "explode":          {"en": "explode",                   "de": "explode",                "ru": "explode"},
            "fade":             {"en": "fade",                      "de": "fade",                   "ru": "fade"},
            "fold":             {"en": "fold",                      "de": "fold",                   "ru": "fold"},
            "highlight":        {"en": "highlight",                 "de": "highlight",              "ru": "highlight"},
            "puff":             {"en": "puff",                      "de": "puff",                   "ru": "puff"},
            "pulsate":          {"en": "pulsate",                   "de": "pulsate",                "ru": "pulsate"},
            "scale":            {"en": "scale",                     "de": "scale",                  "ru": "scale"},
            "shake":            {"en": "shake",                     "de": "shake",                  "ru": "shake"},
            "size":             {"en": "size",                      "de": "size",                   "ru": "size"},
            "slide":            {"en": "slide",                     "de": "slide",                  "ru": "slide"},
            "is_milliseconds":  {"en": "Milliseconds",              "de": "Millisekunden",          "ru": "Миллисекунды"},
            "is_milliseconds_tooltip": {
                "en": "Is object is milliseconds from 1970.01.01 00:00:00. Normally no.",
                "de": "Ob das Wert die Milleskunden seit 1970.01.01 00:00:00 ist. Normalerweise nicht.",
                "ru": "Является ли значение объекта миллисекундами с 1970.01.01 00:00:00. Обычно нет."
            },
            "format_date":      {"en": "Dateformat",                "de": "Datumformat",            "ru": "Формат даты"},
            "format_date_tooltip": {
                "en": "Dateformat",
                "de": "Datumformat",
                "ru": "Формат даты"
            },
            "show_interval":    {"en": "As interval",               "de": "Als Intervall",          "ru": "Как интервал"},
            "hide_effect":      {"en": "Hide effect",               "de": "Verbergeneffekt",        "ru": "Эффект скрытия"},
            "hide_duration":    {"en": "Hide duration(ms)",         "de": "Verbergendauer",         "ru": "Длительность скрытия(мс)"},
            "hide_options":     {"en": "Hide options",              "de": "Verbergenoptionen",      "ru": "Опции скрытия"},
            "show_effect":      {"en": "Show effect",               "de": "Anzeigeeffekt",          "ru": "Эффект появления"},
            "show_duration":    {"en": "Show duration(ms)",         "de": "Anzeigedauer",           "ru": "Длительность появления(мс)"},
            "show_options":     {"en": "Show options",              "de": "Anzeigeoptionen",        "ru": "Опции появления"},
            "left":             {"en": "left",                      "de": "links",                  "ru": "лево"},
            "right":            {"en": "right",                     "de": "rechts",                 "ru": "право"},
            "top":              {"en": "top",                       "de": "oben",                   "ru": "верх"},
            "bottom":           {"en": "bottom",                    "de": "unten",                  "ru": "низ"},

            "contains_view":    {"en": "Contains view",             "de": "Viewname",               "ru": "Имя страницы"},
            "persistent":       {"en": "Persistent",                "de": "Bleibend",               "ru": "Постоянно"},
            "persistent_tooltip": {
                "en": "If persistent the view will not be destroyed when inactive, just hide.\nElsewise the view will be destroyed, if inactive.",
                "de": "Falls 'Bleibend', dann wird die View nicht zerstört, sondern nur versteckt wenn inaktive. Sonst wird die View immer wieder kreiert und zerstört.",
                "ru": "Если выбранно 'Постоянно', то страница не будет уничтожаться, если она не активна. В противном случае страница будет создаваться и разрушаться."},
            "notIfInvisible":       {"en": "Only if visible",                "de": "Nur falls sichtbar",               "ru": "Только если видимо"},
            "notIfInvisible_tooltip": {
                "en": "View will be used only if this widget is visible",
                "de": "Die View wird nur benutzt, wenn dieses Widget sichtbar ist",
                "ru": "Страница будет использоваться только в том случае, если виден этот виджет"
            },
            "valuelist":        {"en": "Values list",               "de": "Wertenliste",            "ru": "Список значений"},
            "valuelist_tooltip": {
                "en": "Divide values with semicolon, like 'ok;warning;alram'. Every text accordingly for value 0,1,2 and so on\nTo have ';' in text use §§ instead.",
                "de": "Die Werte mit Semikolon trennen, wie 'ok;Warnung;Alarm'. Jeder Text ist entsprechend für das Wert 0,1,2 usw.\nUm ';' im Text zu haben, schrein '§§'.",
                "ru": "Разделять значения точкой запятой, например 'ok;Внимание;Тревога'. Каждый текст соответственно для значения 0,1,2 итд.\nДля написания ';' в тексте используй '§§'."
            },
            "html_false":       {"en": "HTML by 'false'",           "de": "HTML bei 'false'",       "ru": "HTML если 0"},
            "html_true":        {"en": "HTML by 'true'",            "de": "HTML bei 'true'",        "ru": "HTML если 1"},
            "text_false":       {"en": "Text by 'false'",           "de": "Text bei 'false'",       "ru": "Текст если 0"},
            "text_true":        {"en": "Text by 'true'",            "de": "Text bei 'true'",        "ru": "Текст если 1"},
            "svg_false":        {"en": "SVG by 'false'",            "de": "SVG bei 'false'",        "ru": "SVG если 0"},
            "svg_true":         {"en": "SVG by 'true'",             "de": "SVG bei 'true'",         "ru": "SVG если 1"},
            "svg_opacity":      {"en": "Opacity",                   "de": "Durchsichtigkeit",       "ru": "Прозрачность"},
            "html_closed":      {"en": "HTML by 'closed'",          "de": "HTML bei 'zu'",          "ru": "HTML если закрыто"},
            "html_open":        {"en": "HTML by 'open'",            "de": "HTML bei 'auf'",         "ru": "HTML если открыто"},
            "html_tilt":        {"en": "HTML by 'tilted'",          "de": "HTML bei 'gekippt'",     "ru": "HTML если наклоненно"},
            "html_tilt_tooltip": {
                "en": "0 - Closed, 1 - tilt, 2 - open",
                "de": "0- Zu, 1 - gekippt, 2 - auf",
                "ru": "0 - закрыто, 1 - откинуто, 2 - открыто"
            },
            "color":            {"en": "Color",                     "de": "Farbe",                  "ru": "Цвет"},
            "shadow":           {"en": "Opacity",                   "de": "Durchsichtigkeit",       "ru": "Тень"},
            "shadow_tooltip":   {
                "en": "CSS Shadow, like '10px 10px 5px #888888'",
                "de": "CSS Shatten, wie '10px 10px 5px #888888'",
                "ru": "CSS Тень, как '10px 10px 5px #888888'"
            },
            "reverse":          {"en": "Revers value",              "de": "Wert umkehren",          "ru": "Перевернуть значение"},
            "border":           {"en": "Border",                    "de": "Rand",                   "ru": "Окантовка"},
            "border_tooltip":   {
                "en": "CSS border, like 'green 5px solid'",
                "de": "CSS Rand, wie 'green 5px solid'",
                "ru": "CSS бордюр, как 'green 5px solid'"
            },
            "test_text":        {"en": "Test text",                 "de": "Testtext",               "ru": "Тестовый текст"},
            "max_width":        {"en": "Max. width",                "de": "Maximale Breite",        "ru": "Максимальная ширина"},
            "style":            {"en": "Style for ",                "de": "Stil für ",              "ru": "Стиль для "},
            "style_tooltip":    {
                "en": "Write here css style, like: 'color:red;background:white'",
                "de": "Hier muss CSS Stil stehen, wie 'color:red;background:white'",
                "ru": "CSS Стиль, например: 'color:red;background:white'"},
            "count":            {"en": "Values number to",          "de": "Wertsanzahl bis",        "ru": "Количество значений до"},
            "test_list":        {"en": "Test value",                "de": "Testwert",               "ru": "Тестовое значение"},
            "urlValue":         {"en": "Call URL on click",         "de": "Rufe URL bei click",     "ru": "Вызвать URL при нажатии"},
            "group_ccontrol":   {"en": "Advanced control",          "de": "Extrasteuerung",         "ru": "Продвинутое управление"},
            "urlFalse":         {"en": "URL on false",              "de": "URL bei false",          "ru": "URL при false"},
            "urlTrue":          {"en": "URL on true",               "de": "URL bei true",           "ru": "URL при true"},
            "oidFalse":         {"en": "Object ID on false",        "de": "Objekt ID bei false",    "ru": "ID объекта при false"},
            "oidTrue":          {"en": "Object ID on true",         "de": "Objekt ID bei true",     "ru": "ID объекта при true"},
            "oidTrueValue":     {"en": "Value for OÍD on true",     "de": "Wert für ID bei false",  "ru": "Значение для ID при false"},
            "oidFalseValue":    {"en": "Value for OÍD on false",    "de": "Wert für ID bei true",   "ru": "Значение для ID при true"},
            "square":           {"en": "square",                    "de": "square",                 "ru": "квадрат"},
            "pentagone":        {"en": "pentagone",                 "de": "pentagone",              "ru": "Пятиуголник"},
            "hexagone":         {"en": "hexagone",                  "de": "hexagone",               "ru": "Шестиугольник"},
            "octagone":         {"en": "octagone",                  "de": "octagone",               "ru": "Восьмиугольник"},
            "circle":           {"en": "circle",                    "de": "Kreis",                  "ru": "Круг"},
            "svgType":          {"en": "Type",                      "de": "Typ",                    "ru": "Тип"},
            "strokeColor":      {"en": "Stroke color",              "de": "Liniefarbe",             "ru": "Цвет линии"},
            "fill":             {"en": "Fill color",                "de": "Füllfarbe",              "ru": "Цвет заливки"},
            "strokeWidth":      {"en": "Stroke width",              "de": "Liniebreite",            "ru": "Ширина линии"},
            "rotate":           {"en": "Rotate",                    "de": "Drehen",                 "ru": "Повернуть на"},
            "no_control":       {"en": "Read only",                 "de": "Nur Anzeige",            "ru": "Только показывать"},
            "numeric":          {"en": "Number",                    "de": "Nummer",                 "ru": "Число"},
            "autoSet":          {"en": "Auto set",                  "de": "Auto-setzen",            "ru": "Авто запись"},
            "autoSet_tooltip":  {
                "en": "Without 'Auto set' you must press ENTER,\x0ato write the value.",
                "de": "Ohne 'Auto-setzen' man muss danach ENTER drucken,\x0A um das Wert zu schreiben.",
                "ru": "Без 'Авто записи' нужно нажать ENTER,\x0Aчто бы записать значение."
            },
            "group_views":      {"en": "Views",                     "de": "Views",                  "ru": "Страницы"},
            "group_frames":     {"en": "iFrames",                   "de": "iFrames",                "ru": "iFrames"},
            "horizontal":       {"en": "horizontal",                "de": "horizontal",             "ru": "горизонтально"},
            "vertical":         {"en": "vertical",                  "de": "senkrecht",              "ru": "вертикально"},
            "orientation":      {"en": "Orientation",               "de": "Ausrichtung ",           "ru": "Направление"},
            "noSandbox":        {"en": "No sandbox",                "de": "Kein Sandkasten",        "ru": "Не запускать в песочнице"},
            "scrollX":          {"en": "Scroll X",                  "de": "Scroll X",               "ru": "Scroll X"},
            "scrollY":          {"en": "Scroll Y",                  "de": "Scroll Y",               "ru": "Scroll Y"},
            "seamless":         {"en": "Seamless",                  "de": "Kein Rahmen",            "ru": "Без рамки"},
            "filters":          {"en": "Filters",                   "de": "Filter",                 "ru": "Фильтры"},
            "filters_Tooltip":  {
                "en": "Divided by semicolon,\x0Ae.g: light;control",
                "de": "Geteilt mir Semikolon\x0Az.B.: Licht;Steuerung",
                "ru": "Разделять точкой запятой\x0Aнапример: Свет;Управление"
            },
            "Select ID":        {"en": "Select ID",                 "de": "ID auswählen",           "ru": "Выбрать ID"},
            "redirect_url":     {"en": "Redirect URL",              "de": "Weiterleiten nach Logout", "ru": "Перейти на URL после выхода"},
            "in_app_close":     {"en": "Close mobile APP",          "de": "Mobiles APP schliessen", "ru": "Закрыть мобильное приложение"},
            "en-US":            {"en": "english",                   "de": "Englisch",               "ru": "английский"},
            "ru-RU":            {"en": "russian",                   "de": "Russisch",               "ru": "русский"},
            "continuous":       {"en": "Continuous",                "de": "Immer zuhören",          "ru": "Непрерывно"},
            "keywords":         {"en": "Keywords",                  "de": "Schlüsselworte",         "ru": "Ключевые слова"},
            "noImage":          {"en": "No image",                  "de": "Kein Bild",              "ru": "Без картинки"},
            "imageInactive":    {"en": "Inactive",                  "de": "Inaktiv",                "ru": "Не активно"},
            "imageActive":      {"en": "Active",                    "de": "Aktiv",                  "ru": "Активно"},
            "imageStarted":     {"en": "Started",                   "de": "Gestartet",              "ru": "Запущено"},
            "imageDetected":    {"en": "Detected",                  "de": "Gefunden",               "ru": "Обнаружено"},
            "imageSent":        {"en": "Sent",                      "de": "Gesedet",                "ru": "Отослано"},
            "imageHeightPx":    {"en": "Height (px)",               "de": "Höhe (px)",              "ru": "Высота (px)"},
            "imageWidthPx":     {"en": "Width (px)",                "de": "Breite (px)",            "ru": "Ширина (px)"},
            "noText":           {"en": "No help text",              "de": "Keine Hilfetext",        "ru": "Без текста помощи"},
            "noResults":        {"en": "No results",                "de": "Keine Ergebnise",        "ru": "Без результатов"},
            "keyWordColor":     {"en": "Key word color",            "de": "Schlüsselworte-Farbe",   "ru": "Цвет ключевых слов"},
            "keyWordColor_tooltip": {
                "en": "Text color, if key word found",
                "de": "Textfarbe, wenn im Text Schlüsselwort gefunden ist.",
                "ru": "Цвет текста, когда обнаружено ключевое слово"
            },
            "textSentColor":    {"en": "Text sent color",           "de": "Gesendet-Farbe",         "ru": "Цвет отосланного текста"},
            "textSentColor_tooltip": {
                "en": "Text color, when text sent to processing it",
                "de": "Textfarbe, wenn Text ist für Abarbeitung gesendet.",
                "ru": "Цвет текста, когда текст отослан на обработку"
            },
            "speechMode":       {"en": "Speech mode",               "de": "Sprachmodus",            "ru": "Режим речи"},
            "single":           {"en": "single",                    "de": "Ein mal",                "ru": "Одиночный"},
            "startstop":        {"en": "start/stop",                "de": "Start/Stop",             "ru": "Старт/стоп"},
            "line":             {"en": "line",                      "de": "Linie",                  "ru": "линия"},
            "triangle":         {"en": "triangle",                  "de": "Dreieck",                "ru": "треугольник"},
            "star":             {"en": "star",                      "de": "Stern",                  "ru": "звезда"},
            "arrow":            {"en": "arrow",                     "de": "Pfeil",                  "ru": "стрела"},
            "scaleWidth":       {"en": "Scale width",               "de": "breiten Skala",          "ru": "Масштаб по ширине"},
            "scaleHeight":      {"en": "Scale height",              "de": "höhen Skala",            "ru": "Масштаб по высоте"}
        });
    }

    $.extend(true, systemDictionary, {
        "Edit note":    {"en": "Edit note",     "de": "Meldung eingeben",   "ru": "Сообщение"},
        "Clear":        {"en": "Clear",         "de": "Löschen",            "ru": "Очистить"},
        "Ok":           {"en": "Ok",            "de": "Ok",                 "ru": "Ok"},
        "Cancel":       {"en": "Cancel",        "de": "Abbrechen",          "ru": "Отмена"},
        "all":          {"en": "all",           "de": "Alle",               "ru": "Все"},
        "just&nbsp;now":  {"en": "just&nbsp;now", "de": "gerade&nbsp;jetzt", "ru": "только&nbsp;что"},
        "for&nbsp;%s&nbsp;min.":  {"en": "for&nbsp;%s&nbsp;min.", "de": "vor&nbsp;%s&nbsp;Min.", "ru": "%s&nbsp;мин. назад"},
        "for&nbsp;%s&nbsp;hr.&nbsp;and&nbsp;%s&nbsp;min.": {
            "en": "for&nbsp;%s&nbsp;hr.&nbsp;and&nbsp;%s&nbsp;min.",
            "de": "vor&nbsp;%s&nbsp;St.&nbsp;und&nbsp;%s&nbsp;Min.",
            "ru": "%s&nbsp;часов&nbsp;и&nbsp;%s&nbsp;мин. назад"
        },
        "yesterday":              {"en": "yesterday", "de": "gestern", "ru": "вчера"},
        "for&nbsp;%s&nbsp;hours": {"en": "for&nbsp;%s&nbsp;hours", "de": "vor&nbsp;%s&nbsp;Stunden", "ru": "%s&nbsp;часов назад"},
        "click to create":        {"en": "click to create", "de": "klicken um zu erzeugen", "ru": "нажать что бы создать"},
        "This option works only in APP": {
            "en": "This option works only in APP",
            "de": "Funktioniert nur im APP",
            "ru": "Работает только в мобильном приложении"
        },
        "info_start": {
            "en": "Click on the microphone icon and begin speaking.",
            "de": "Klicken Sie das Mikrophon an und sagen Sie etwas.",
            "ru": "Нажмите на микрофон и начинайте говорить."
        },
        "info_speak_now": {
            "en": "Speak now.",
            "de": "Sage etwas.",
            "ru": "Говорите."
        },
        "info_no_speech": {
            "en": "No speech was detected. You may need to adjust your <a href=\"//support.google.com/chrome/bin/answer.py?hl=en&amp;answer=1407892\">microphone settings</a>.",
            "de": "No speech was detected. You may need to adjust your <a href=\"//support.google.com/chrome/bin/answer.py?hl=en&amp;answer=1407892\">microphone settings</a>.",
            "ru": "Речи не обнаружено. Может надо настроить микрофон <a href=\"//support.google.com/chrome/bin/answer.py?hl=en&amp;answer=1407892\">Настройки микрофона</a>."
        },
        "info_no_microphone": {
            "en": "No microphone was found. Ensure that a microphone is installed and that <a href=\"//support.google.com/chrome/bin/answer.py?hl=en&amp;answer=1407892\"> microphone settings</a> are configured correctly.",
            "de": "No microphone was found. Ensure that a microphone is installed and that <a href=\"//support.google.com/chrome/bin/answer.py?hl=en&amp;answer=1407892\"> microphone settings</a> are configured correctly.",
            "ru": "No microphone was found. Ensure that a microphone is installed and that <a href=\"//support.google.com/chrome/bin/answer.py?hl=en&amp;answer=1407892\"> microphone settings</a> are configured correctly."
        },
        "info_allow": {
            "en": "Click the \"Allow\" button above to enable your microphone.",
            "de": "Click the \"Allow\" button above to enable your microphone.",
            "ru": "Нажмите на кнопку \"разрешить\" сверху, что бы активировать микрофон."
        },
        "info_denied": {
            "en": "Permission to use microphone was denied.",
            "de": "Permission to use microphone was denied.",
            "ru": "Доступ к микрофону был запрещён."
        },
        "info_blocked": {
            "en": "Permission to use microphone is blocked. To change, go to chrome://settings/contentExceptions#media-stream",
            "de": "Permission to use microphone is blocked. To change, go to chrome://settings/contentExceptions#media-stream",
            "ru": "Доступ к микрофону блокирован. Что бы изменить настройки идите <a href=\"chrome://settings/contentExceptions#media-stream\">сюда</a>"
        },
        "info_upgrade": {
            "en": "Web Speech API is not supported by this browser. Upgrade to<a href=\"//www.google.com/chrome\">Chrome</a> version 25 or later.",
            "de": "Web Speech API is not supported by this browser. Upgrade to<a href=\"//www.google.com/chrome\">Chrome</a> version 25 or later.",
            "ru": "Web Speech API не поддерживается этим браузером. Обновите до <a href=\"//www.google.com/chrome\">Chrome</a> версии 25 или новее."
        }
    });

    vis.binds.stateful = {
        view: function (el, viewArr, persistent, notIfInvisible) {
            var $this = $(el);
            var oid   = $this.attr('data-oid');
            var timer = null;

            function draw(val) {
                timer = null;
                var view = viewArr[val];
                if (!persistent) {
                    $this.parent().find('div.vis-view').remove();
                } else {
                    $this.parent().find('div.vis-view').hide().appendTo($('#vis_container'));
                }
                if (vis.views[view]) {
                    vis.renderView(view, view, true, function (_view) {
                        var $view = $('#visview_' + _view);
                        $view.show().data('persistent', persistent);
                        if (!$this.find('#visview_' + _view).length) {
                            $view.appendTo($this);
                        }
                    });
                }
                vis.destroyUnusedViews();
            }

            function onChange(e, newVal) {
                if (newVal === 'true'  || newVal === true)  newVal = 1;
                if (newVal === 'false' || newVal === false) newVal = 0;
                if (notIfInvisible && !$this.is(':visible')) {
                    return;
                }

                if (timer) {
                    clearTimeout(timer)
                }
                timer = setTimeout(function () {
                    draw(newVal);
                }, 50);
            }

            if (oid) {
                vis.states.bind(oid + '.val', onChange);

                // remember all ids, that bound
                $this.parent().parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);
            }
        },
        iframe: function (el, srcArr, refreshInterval) {
            var $this = $(el).parent().find('iframe');
            var oid   = $this.attr('data-oid');
            refreshInterval = parseInt(refreshInterval, 10) || 0;

            function onChange (e, newVal) {
                if (newVal === 'true'  || newVal === true)  newVal = 1;
                if (newVal === 'false' || newVal === false) newVal = 0;
                $this.attr('src', srcArr[newVal]);
            }

            if (oid) {
                vis.states.bind(oid + '.val', onChange);

                // remember all ids, that bound
                $this.parent().parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);

                if (vis.states[oid + '.val'] !== undefined) {
                    var val = vis.states[oid + '.val'];
                    if (val === 'true'  || val === true)  val = 1;
                    if (val === 'false' || val === false) val = 0;
                    $this.attr('src', srcArr[val]);
                }

                if (refreshInterval > 0) {
                    setInterval(function () {
                        var val = vis.states[oid + '.val'] || 0;
                        if (val === 'true'  || val === true)  val = 1;
                        if (val === 'false' || val === false) val = 0;
                        var src = srcArr[val];
                        $this.attr('src', src + (src.match(/\?/) ? '&' : '?') + '_vis_refts=' + ((new Date()).getTime()));
                    }, refreshInterval);
                }
            }
        },
        image: function (el, srcArr, refreshInterval) {
            var $this = $(el).parent().find('img');
            var oid = $this.attr('data-oid');
            refreshInterval = parseInt(refreshInterval, 10) || 0;

            function onChange (e, newVal) {
                if (newVal === 'true'  || newVal === true)  newVal = 1;
                if (newVal === 'false' || newVal === false) newVal = 0;
                $this.attr('src', srcArr[newVal]);
            }

            if (oid) {
                vis.states.bind(oid + '.val', onChange);

                // remember all ids, that bound
                $this.parent().parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);

                if (vis.states[oid + '.val'] !== undefined) {
                    var val = vis.states[oid + '.val'];
                    if (val === 'true'  || val === true)  val = 1;
                    if (val === 'false' || val === false) val = 0;
                    $this.attr('src', srcArr[val]);
                }

                if (refreshInterval > 0) {
                    setInterval(function () {
                        var val = vis.states[oid + '.val'] || 0;
                        if (val === 'true'  || val === true)  val = 1;
                        if (val === 'false' || val === false) val = 0;

                        var src = srcArr[val];
                        if (src) $this.attr('src', src + ((src.indexOf('?') !== -1) ? '&' : '?') + '_vis_refts=' + ((new Date()).getTime()));
                    }, refreshInterval);
                }
            }

        },
        value: function (values, oid) {
            if (oid !== 'nothing_selected' && vis.states.attr(oid + '.val') !== undefined) {
                var val = vis.states.attr(oid + '.val');
                if (val === 'true'  || val === true)  val = 1;
                if (val === 'false' || val === false) val = 0;
                return values[val];
            } else {
                return values[0];
            }
        }
    };
    vis.binds.container = function (el, view) {
        var $this = $(el);
        if (vis.views[view]) {
            vis.renderView(view, view, true, function (_view) {
                $('#visview_' + _view).appendTo($this).show();
            });
        }
    };
    vis.binds.basic = {
        isFullScreen: false,
        filterDropdown: function (el, filters, hideEffect, hideDuration, showEffect, showDuration) {
            var $this = $(el);
            if (filters) {
                filters = filters.split(';');
                for (var i = 0; i < filters.length; i++) {
                    $this.find('select').append('<option value="' + filters[i] + '">' + filters[i] + '</option>');
                }
            }

            if (vis.viewsActiveFilter[vis.activeView]) {
                $this.find('select option[value="' + vis.viewsActiveFilter[vis.activeView] + '"]').attr('selected', true);
            }

            $this.find('select').change(function () {
                vis.changeFilter(null, $this.find('select option:selected').val(), hideEffect, hideDuration, showEffect, showDuration);
            });
        },
        state: function (el, oid) {
            var $this = $(el);
            oid = oid ? oid : $this.attr('data-oid');
            var val = $this.attr('data-val');

            if (oid) {
                $this.attr('data-ctrl-oid', oid);
            }

            if (val === 'true')  val = true;
            if (val === 'false') val = false;

            if (!vis.editMode) {
                var moved = false;
                $this.on('click touchend', function (e) {
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    if (moved) return;

                    var oid = $(this).attr('data-ctrl-oid');

                    if ($(this).attr('url-value')) {
                        vis.conn.httpGet($(this).attr('url-value'));
                    }

                    if (oid) {
                        var val = $(this).attr('data-val');
                        if (val === undefined || val === null) val = false;
                        if (val === 'true')  val = true;
                        if (val === 'false') val = false;
                        if (parseFloat(val).toString() == val) val = parseFloat(val);

                        if (oid) vis.setValue(oid, val);
                    }
                }).on('touchmove', function () {
                    moved = true;
                }).on('touchstart', function () {
                    moved = false;
                });
            }
        },
        pressed: null,
        pressedNext: null,
        increment: function (el, minmax, delay, interval) {

            function fInterval($that) {
                vis.binds.basic.pressedNext = true;
                vis.binds.basic.pressed = null;
                var oid = $that.attr('data-oid');
                if (!vis.editMode) {
                    var step = parseFloat($that.attr('data-vis-step'));
                    var tmp  = parseFloat(vis.states[oid + '.val']) + step;
                    if (step < 0) {
                        if (tmp >= minmax) {
                            vis.setValue($that.attr('data-oid'), tmp);
                            vis.binds.basic.pressed = _setTimeout(fInterval, interval, $that);
                        }
                    } else {
                        if (tmp <= minmax) {
                            vis.setValue($that.attr('data-oid'), tmp);
                            vis.binds.basic.pressed = _setTimeout(fInterval, interval, $that);
                        }
                    }
                }
            }

            function intervalStart(e) {
                vis.binds.basic.pressedNext = false;
                var $this = $(this);
                var oid = $this.attr('data-oid');

                if (vis.binds.basic.pressed) {
                    clearInterval(vis.binds.basic.pressed);
                    vis.binds.basic.pressed = null;
                }

                vis.binds.basic.pressed = setTimeout(fInterval, delay, $this);
            }

            if (!vis.editMode) {
                var moved = false;
                $(el).on('click touchend', function (e) {
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    if (moved) return;

                    if (vis.binds.basic.pressed) {
                        clearInterval(vis.binds.basic.pressed);
                        vis.binds.basic.pressed = null;
                    }

                    if (vis.binds.basic.pressedNext) {
                        vis.binds.basic.pressedNext = false;
                        return;
                    }
                    var $this = $(this);
                    var oid = $this.attr('data-oid');
                    var step = parseFloat($this.attr('data-vis-step'));
                    var tmp  = parseFloat(vis.states[oid + '.val']) + step;
                    if (step < 0) {
                        if (minmax === undefined || tmp >= minmax) {
                            vis.setValue($this.attr('data-oid'), tmp);
                        }
                    } else {
                        if (minmax === undefined || tmp <= minmax) {
                            vis.setValue($this.attr('data-oid'), tmp);
                        }
                    }
                }).on('touchmove', function () {
                    moved = true;
                }).on('touchstart', function () {
                    moved = false;
                });
            }

            if (interval) {
                $(el).on('mousedown', intervalStart)
                    .on('touchstart', intervalStart)
                    .on('touchend', function () {
                        if (vis.binds.basic.pressed) {
                            clearInterval(vis.binds.basic.pressed);
                            vis.binds.basic.pressed = null;
                        }
                    })
                    .on('mouseup', function () {
                        if (vis.binds.basic.pressed) {
                            clearInterval(vis.binds.basic.pressed);
                            vis.binds.basic.pressed = null;
                        }
                    }).data('destroy', function (id, $widget) {
                    $widget && $widget.off('mousedown').off('touchstart').off('touchend').off('mouseup');
                });
            }
        },
        navigation: function (el, options) {
            if (!vis.editMode && options.nav_view) {
                var $this = $(el);
                var moved = false;
                $this.on('click touchend', function (e) {
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    if (moved) return;

                    if (options.background) $('body').css({background: options.background});

                    vis.changeView(options.nav_view, options.nav_view, options.hideOptions, options.showOptions, options.sync);
                    //e.preventDefault();
                    //return false;
                }).on('touchmove', function () {
                    moved = true;
                }).on('touchstart', function () {
                    moved = false;
                });
            }
        },
        hideOnFalse: function (el) {
            var $this = $(el);
            var oid   = $this.attr('data-oid');

            function onChange (e, newVal) {
                if (newVal === null || newVal === false || newVal === 0 || newVal === 'false' || !parseInt(newVal, 10)) {
                    if (!vis.editMode) {
                        $this.hide();
                    }
                } else {
                    $this.show();
                }
            }

            if (oid) {
                vis.states.bind(oid + '.val', onChange);

                // remember all ids, that bound
                $this.data('bound', [oid + '.val'])
                // remember bind handler
                    .data('bindHandler', onChange);

                if (!vis.editMode) {
                    var newVal = vis.states.attr(oid + '.val');
                    if (newVal === null || newVal === false || newVal === 0 || newVal === 'false' || parseInt(newVal, 10) === 0) {
                        $this.hide();
                    }
                }
            }

        },
        /*hideOnTrue: function (el) {
            var $this = $(el);
            var oid = $this.attr('data-oid');
            vis.states.bind(oid + '.val', function (e, newVal, oldVal) {
                if (newVal === true || parseFloat(newVal) > 0) {
                    if (!vis.editMode) {
                        $this.hide();
                    }
                } else {
                    $this.show();
                }
            });
            if (!vis.editMode) {
                if (parseFloat(vis.states.attr(oid + '.val')) !== 0 && vis.states.attr(oid + '.val') !== false) {
                    $this.hide();
                }
            }
        },
        showOnValue: function (el, val) {
            var $this = $(el);
            var oid = $this.attr('data-oid');
            vis.states.bind(oid + '.val', function (e, newVal, oldVal) {
                if (newVal != val) {
                    if (!vis.editMode) {
                        $this.hide();
                    }
                } else {
                    $this.show();
                }
            });
            if (!vis.editMode) {
                if (vis.states.attr(oid + '.val') != val) {
                    $this.hide();
                }
            }
        },*/
        _onChange: function (el, oid, wid) {
            var $this = $(el);
            // If still working
            //console.log(oid + ' ' + vis.states.attr(oid + '.val') + ' (' + vis.states.attr(oid + '.ack') + ') - ' + wid + ' ' + vis.states.attr(wid + '.val') + ' (' + vis.states.attr(wid + '.ack') + ')');

            if (wid && (vis.states.attr(wid + '.val') === true)) return;

            var val = vis.states.attr(oid + '.val');

            if (val === 'false') {
                val = false;
            } else if (val === 'true') {
                val = true;
            } else if (typeof val === 'string') {
                var f = parseFloat(val);
                if (f == val) {
                    val = f;
                } else if (val !== '') {
                    val = true;
                } else {
                    val = false;
                }
            }

            if ($this.data('data-numeric')) {
                $this.prop('checked', (val > (($this.data('data-max') - $this.data('data-min')) / 2)));
            } else {
                $this.prop('checked', val);
            }
        },
        checkbox: function (el, numeric, min, max) {
            var $this = $(el);
            var oid   = $this.data('oid'); // Object ID
            var wid   = $this.data('oid-working'); // Work ID

            function onChange() {
                vis.binds.basic._onChange(el, oid, wid);
            }
            if (oid) {
                var bound = [];
                vis.states.bind(oid + '.val', onChange);
                bound.push(oid + '.val');
                if (wid) {
                    vis.states.bind(wid + '.val', onChange);
                    bound.push(wid + '.val');
                }

                // remember all ids, that bound
                $this.closest('.vis-widget')
                    .data('bound', bound)
                    // remember bind handler
                    .data('bindHandler', onChange);
            }

            if (numeric) {
                if (min !== undefined && min !== null && min !== '') {
                    min = parseFloat(min);
                } else {
                    min = 0;
                }

                if (max !== undefined && max !== null && max !== '') {
                    max = parseFloat(max);
                } else {
                    max = 1;
                }
            } else {
                min = false;
                max = true;
            }

            $this.data('min',     min);
            $this.data('max',     max);
            $this.data('numeric', numeric);

            vis.binds.basic._onChange(el, oid, wid);

            if (!vis.editMode) {
                $this.change(function () {
                    var $this_ = $(this);
                    if ($this_.prop('checked')) {
                        vis.setValue($this_.data('oid'), $this_.data('max'));
                    } else {
                        vis.setValue($this_.data('oid'), $this_.data('min'));
                    }
                });
            }
        },
        input: function (el, data) {
            var $this = $(el);
            var oid   = $this.data('oid'); // Object ID
            var wid   = $this.data('oid-working'); // Work ID

            function onChange(e, val) {
                $this.val(val);
            }

            if (oid) {
                var bound = [oid + '.val'];
                vis.states.bind(oid + '.val', onChange);
                if (wid) {
                    bound.push(wid + '.val');
                    vis.states.bind(wid + '.val', onChange);
                }
                // remember all ids, that bound
                $this.closest('.vis-widget')
                    .data('bound', bound)
                    // remember bind handler
                    .data('bindHandler', onChange);
            }

            if (data.numeric) {
                $this.attr('type', 'number');
                if (data.min !== undefined && data.min !== null && data.min !== '') {
                    data.min = parseFloat(data.min);
                } else {
                    data.min = null;
                }

                if (data.max !== undefined && data.max !== null && data.max !== '') {
                    data.max = parseFloat(data.max);
                } else {
                    data.max = null;
                }
            }

            $this.val(vis.states[oid + '.val'] === undefined ? '' : vis.states[oid + '.val']);

            setTimeout(function () {
                $this.css('text-align', $this.parent().parent().css('text-align'));
                $this.css('color', $this.parent().parent().css('color'));
                $this.css('background', $this.parent().parent().css('background'));
                $this.css('border', '0');
                $this.css('text-font', $this.parent().parent().css('text-font'));
            }, 0);

            if (!vis.editMode) {
                $this.change(function () {
                    var $this_ = $(this);
                    if (data.numeric) {
                        var value = parseFloat($this_.val());
                        if (data.min !== null && value < data.min) {
                            value = data.min;
                            $this_.val(value);
                        } else if (data.max !== null && value > data.max) {
                            value = data.max;
                            $this_.val(value);
                        }
                        vis.setValue($this_.data('oid'), value);
                    } else {
                        vis.setValue($this_.data('oid'), $this_.val());
                    }
                });
                if (data.autoSet) {
                    $this.keyup(function(e) {
                        var timer = $this.data('timer');
                        if (timer) clearTimeout(timer);
                        $this.data('timer', setTimeout(function () {
                            $this.trigger('change');
                        }), 1000);
                    });
                }
            }
        },
        select: function (el, invert) {
            var $this = $(el).prev();
            var oid   = $this.attr('data-oid');
            var val   = vis.states[oid + '.val'];

            if (val === 'false') {
                val = false;
            } else if (val === 'true') {
                val = true;
            } else if (typeof val === 'string') {
                var f = parseFloat(val);
                if (f == val) {
                    val = f;
                } else if (val !== '') {
                    val = true;
                } else {
                    val = false;
                }
            }

            if (invert) val = !val;

            $this.val(val ? 1 : 0);

            if (!vis.editMode) {
                if (oid !== 'nothing_selected') {
                    $this.change(function () {
                        var val = $this.find('option:selected').val();
                        if (invert) val = !val;
                        vis.setValue(oid, val);
                    });
                }
            }
            if (oid !== 'nothing_selected') {

            }
            function onChange(e, newVal, oldVal) {
                if (newVal === 'false') {
                    newVal = false;
                } else if (newVal === 'true') {
                    newVal = true;
                } else if (typeof newVal === 'string') {
                    var f = parseFloat(newVal);
                    if (f == newVal) {
                        newVal = f;
                    } else if (newVal !== '') {
                        newVal = true;
                    } else {
                        newVal = false;
                    }
                }
                if (oldVal === 'false') {
                    oldVal = false;
                } else if (oldVal === 'true') {
                    oldVal = true;
                } else if (typeof oldVal === 'string') {
                    var f = parseFloat(oldVal);
                    if (f == oldVal) {
                        oldVal = f;
                    } else if (oldVal !== '') {
                        oldVal = true;
                    } else {
                        oldVal = false;
                    }
                }

                if (newVal == oldVal) return;

                if (newVal === 'false' || newVal === false || parseFloat(newVal) === 0) {
                    if ($this.find('option[value="1"]').prop('selected')) {
                        $this.find('option[value="1"]').prop('selected', false);
                        $this.find('option[value="0"]').prop('selected', true);
                        $this.trigger('change');
                    }
                } else {
                    if ($this.find('option[value="0"]').prop('selected')) {
                        $this.find('option[value="0"]').prop('selected', false);
                        $this.find('option[value="1"]').prop('selected', true);
                        $this.trigger('change');
                    }
                }
            }

            if (oid) {
                vis.states.bind(oid + '.val', onChange);
                // remember all ids, that bound
                $this.closest('.vis-widget')
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);
            }
        },
        pushbutton: function(el, oid) {
            if (!vis.editMode) {
                var $this = $(el);
                oid = oid || $this.data('oid');

                $this.on('mousedown touchstart', function (e) {
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    vis.setValue(oid, true);
                });
                $this.on('mouseup touchend touchcancel', function (e) {
                    // Protect against two events
                    if (vis.detectBounce(this, true)) return;

                    vis.setValue(oid, false);
                });
            }
        },
        toggle: function (el, oid) {
            var $this = $(el);
            oid = oid || $this.data('oid');
            var min = $this.data('min');
            var max = $this.data('max');

            var urlTrue     = $this.data('url-true');
            var urlFalse    = $this.data('url-false');
            var oidTrue     = $this.data('oid-true');
            var oidFalse    = $this.data('oid-false');
            var oidTrueVal  = $this.data('oid-true-value');
            var oidFalseVal = $this.data('oid-false-value');
            var readOnly    = $this.data('read-only');

            if (min === '') min = undefined;
            if (max === '') max = undefined;

            if ((oid || oidTrue || urlTrue) && !vis.editMode && !readOnly) {
                var moved = false;
                $this.on('click touchend', function () {
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    if (moved) return;

                    var val;

                    if (oidTrue || urlTrue) {
                        if (!oidFalse && oidTrue) oidFalse = oidTrue;
                        if (!urlFalse && urlTrue) urlFalse = urlTrue;

                        if (!oid || oid === 'nothing_selected') {
                            val = !$(this).data('state');
                            // remember state
                            $(this).data('state', val);
                        } else {
                            val = vis.states[oid + '.val'];
                            if (max !== undefined) {
                                if (max === 'true')  max = true;
                                if (max === 'false') max = false;
                                if (val === 'true')  val = true;
                                if (val === 'false') val = false;
                                val = (val == max);
                            } else {
                                val = (val === 1 || val === '1' || val === true || val === 'true');
                            }
                            val = !val; // invert
                        }
                        if (min === undefined || min === 'false' || min === null) min = false;
                        if (max === undefined || max === 'true'  || max === null) max = true;

                        if (oidTrue) {
                            if (val) {
                                if (oidTrueVal === undefined || oidTrueVal === null) oidTrueVal = max;
                                if (oidTrueVal === 'false') oidTrueVal = false;
                                if (oidTrueVal === 'true')  oidTrueVal = true;
                                var f = parseFloat(oidTrueVal);
                                if (f.toString() == oidTrueVal) oidTrueVal = f;
                                vis.setValue(oidTrue,  oidTrueVal);
                            } else {
                                if (oidFalseVal === undefined || oidFalseVal === null) oidFalseVal = min;
                                if (oidFalseVal === 'false') oidFalseVal = false;
                                if (oidFalseVal === 'true')  oidFalseVal = true;
                                var f = parseFloat(oidFalseVal);
                                if (f.toString() == oidFalseVal) oidFalseVal = f;
                                vis.setValue(oidFalse, oidFalseVal);
                            }
                        }

                        if (urlTrue) {
                            if (val) {
                                vis.conn.httpGet(urlTrue)
                            } else {
                                vis.conn.httpGet(urlFalse);
                            }
                        }

                        // show new state
                        if (!oid || oid === 'nothing_selected') {
                            var img = $(this).data('img-class');
                            if (val) {
                                if ($(this).data('as-button')) $(this).addClass('ui-state-active');
                                val = $(this).data('img-true');
                            } else {
                                val = $(this).data('img-false');
                                if ($(this).data('as-button')) $(this).removeClass('ui-state-active');
                            }
                            $(this).find('.' + img).attr('src', val);
                        }
                    } else {
                        var val = vis.states[oid + '.val'];
                        if ((min === undefined && (val === null || val === '' || val === undefined || val === false || val === 'false')) ||
                            (min !== undefined && min == val)) {
                            vis.setValue(oid, max !== undefined ? max : true);
                        } else
                        if ((max === undefined && (val === true || val === 'true')) ||
                            (max !== undefined && val == max))
                        {
                            vis.setValue(oid, min !== undefined ? min : false);
                        } else {
                            val = parseFloat(val);
                            if (min !== undefined && max !== undefined) {
                                if (val >= (max - min) / 2) {
                                    val = min;
                                } else {
                                    val = max;
                                }
                            } else {
                                if (val >= 0.5) {
                                    val = 0;
                                } else {
                                    val = 1;
                                }
                            }
                            vis.setValue(oid, val);
                        }
                    }
                }).on('touchmove', function () {
                    moved = true;
                }).on('touchstart', function () {
                    moved = false;
                }).data('destroy', function (id, $widget) {
                    $widget.off('click touchend').off('touchmove').off('touchstart');
                });
            }
        },
        iframeRefresh: function (el, src, refreshInterval, refreshOnWakeUp, refreshOnViewChange, refreshWithNoQuery) {
            var widgetView;
            if (src && typeof src === 'object') {
                widgetView = refreshInterval;
                refreshInterval     = src.refreshInterval;
                refreshOnWakeUp     = src.refreshOnWakeUp;
                refreshOnViewChange = src.refreshOnViewChange;
                refreshWithNoQuery  = src.refreshWithNoQuery;
                src                 = src.src;
            } else if (refreshInterval && typeof refreshInterval === 'object') {
                widgetView = refreshOnWakeUp;
                refreshInterval     = refreshInterval.refreshInterval;
                refreshOnWakeUp     = refreshInterval.refreshOnWakeUp;
                refreshOnViewChange = refreshInterval.refreshOnViewChange;
                refreshWithNoQuery  = refreshInterval.refreshWithNoQuery;
            }
            refreshOnViewChange = refreshOnViewChange === true || refreshOnViewChange === 'true';
            refreshOnWakeUp     = refreshOnWakeUp     === true || refreshOnWakeUp     === 'true';
            refreshWithNoQuery  = refreshWithNoQuery  === true || refreshWithNoQuery  === 'true';

            if (!vis.editMode && src) {
                var $this = $(el).parent().find('iframe');
                refreshInterval = parseInt(refreshInterval, 10) || 0;

                if (refreshOnViewChange) {
                    widgetView = widgetView || vis.activeView;
                    vis.navChangeCallbacks.push(function (view) {
                        if (view === widgetView) {
                            $this.attr('src', src + (refreshWithNoQuery ? '' : ((src.indexOf('?') !== -1) ? '&' : '?') + '_refts=' + ((new Date()).getTime())));
                        }
                    });
                }
                if (refreshInterval > 0) {
                    setInterval(function () {
                        if ($this.is(':visible')) {
                            var p = $this.parents(':hidden');
                            if (!p.length || p[0].tagName === 'BODY' || p[0].id === 'materialdesign-vuetify-container') {
                                $this.attr('src', src + (refreshWithNoQuery ? '' : ((src.indexOf('?') !== -1) ? '&' : '?') + '_refts=' + ((new Date()).getTime())));
                            }
                        }
                    }, refreshInterval);
                }
                if (refreshOnWakeUp) {
                    vis.onWakeUp(function () {
                        // TODO this does not work. :(
                        $this.attr('src', src + (refreshWithNoQuery ? '' : ((src.indexOf('?') !== -1) ? '&' : '?') + '_refts=' + ((new Date()).getTime())));
                    });
                }
            }
        },
        htmlRefresh: function (el, html, refreshInterval) {
            refreshInterval = parseInt(refreshInterval, 10) || 0;
            if (html && !vis.editMode && refreshInterval > 0) {
                var $this = $(el);
                setInterval(function () {
                    if ($this.is(':visible')) {
                        var p = $this.parents(':hidden');
                        if (!p.length || p[0].tagName === 'BODY' || p[0].id === 'materialdesign-vuetify-container') {
                            $this.html(html);
                        }
                    }
                }, refreshInterval);
            }
        },
        imgRefresh: function (el, src, refreshInterval, refreshOnWakeUp, refreshOnViewChange, refreshWithNoQuery) {
            var widgetView;
            if (src && typeof src === 'object') {
                widgetView = refreshInterval;
                refreshInterval     = src.refreshInterval;
                refreshOnWakeUp     = src.refreshOnWakeUp;
                refreshOnViewChange = src.refreshOnViewChange;
                refreshWithNoQuery  = src.refreshWithNoQuery;
                src                 = src.src;
            } else if (refreshInterval && typeof refreshInterval === 'object') {
                widgetView = refreshOnWakeUp;
                refreshInterval     = refreshInterval.refreshInterval;
                refreshOnWakeUp     = refreshInterval.refreshOnWakeUp;
                refreshOnViewChange = refreshInterval.refreshOnViewChange;
                refreshWithNoQuery  = refreshInterval.refreshWithNoQuery;
            }
            refreshOnViewChange = refreshOnViewChange === true || refreshOnViewChange === 'true';
            refreshOnWakeUp     = refreshOnWakeUp     === true || refreshOnWakeUp     === 'true';
            refreshWithNoQuery  = refreshWithNoQuery  === true || refreshWithNoQuery  === 'true';

            if (!vis.editMode && src) {
                var $this = $(el).parent().find('img');
                refreshInterval = parseInt(refreshInterval, 10) || 0;

                if (refreshOnViewChange) {
                    widgetView = widgetView || vis.activeView;
                    vis.navChangeCallbacks.push(function (view) {
                        if (view === widgetView) {
                            $this.attr('src', src + (refreshWithNoQuery ? '' : ((src.indexOf('?') !== -1) ? '&' : '?') + '_refts=' + ((new Date()).getTime())));
                        }
                    });
                }
                if (refreshInterval > 0) {
                    setInterval(function () {
                        if ($this.is(':visible')) {
                            var p = $this.parents(':hidden');
                            if (!p.length || p[0].tagName === 'BODY' || p[0].id === 'materialdesign-vuetify-container') {
                                $this[0].src = src + (refreshWithNoQuery ? '' : ((src.indexOf('?') !== -1) ? '&' : '?') + '_refts=' + ((new Date()).getTime()));
                            }
                        }
                    }, refreshInterval);
                }
                if (refreshOnWakeUp) {
                    //console.log("refreshOnWakeUp!");
                    vis.onWakeUp(function () {
                        // TODO this does not work. :(
                        //console.log("wakeup refresh!");
                        $this[0].src = src + (refreshWithNoQuery ? '' : ((src.indexOf('?') !== -1) ? '&' : '?') + '_refts=' + ((new Date()).getTime()));
                        //console.log($this.attr('src'));
                    });
                }
            }
        },
        showSvg: function (myClass, view, wid, oid, opacity, svg_false, svg_true, style, no_control) {
            var $wid = $('#' + wid);

            var id = $wid.attr('id');
            if (id && id.match(/_removed$/)) return;

            if (!$wid.length) {
                return setTimeout(function () {
                    vis.binds.basic.showSvg(myClass, view, wid, oid, opacity, svg_false, svg_true, style, no_control);
                }, 100);
            }

            $wid.find('svg').remove();
            var str = vis.states.attr(oid + '.val');
            if (typeof str === 'string') str = str.toLowerCase();
            var val = parseFloat(str);
            var sText = '<svg version="1.1" style="width:100%;height:100%" xmlns="http://www.w3.org/2000/svg" data-oid="' + oid + '">';
            if (vis.editMode) {
                if (opacity === undefined || opacity === null || opacity === '') opacity = 1;

                if (parseFloat(opacity) < 0.2) opacity = 0.2;
            }
            if (val === 0 || str === 'false' || str === '0' || str === 'off' || str === false || str === null || str === undefined) {
                // try to analyse
                sText += svg_false;
            } else {
                sText += svg_true;
            }
            sText += '</svg>';
            $wid.find('.vis-widget-body').append(sText);

            if (style) $wid.css(style);

            var moved = false;

            function onSvgClick() {
                // Protect against two events
                if (vis.detectBounce(this)) return;

                if (moved) return;

                var val = vis.states[oid + '.val'];
                if (val === null || val === '' || val === undefined || val === false || val === "false") {
                    vis.setValue(oid, true);
                } else if (val === true || val === "true") {
                    vis.setValue(oid, false);
                } else {
                    val = parseFloat(val);
                    if (val >= 0.5) {
                        val = 1;
                    } else {
                        val = 0;
                    }
                    vis.setValue(oid, 1 - val);
                }
            }

            function onChange (e, newVal) {
                if (newVal === 'true'  || newVal === true)  newVal = 1;
                if (newVal === 'false' || newVal === false || newVal === '0') newVal = 0;
                var $svg = $('#' + wid).find('svg');

                $svg.html(newVal ? svg_true : svg_false);

                if (!vis.editMode && !no_control) {
                    $svg.children().unbind('click touchend touchmove touchstart').on('click touchend', onSvgClick)
                        .on('touchmove', function () {
                            moved = true;
                        }).on('touchstart', function () {
                        moved = false;
                    });
                } else if (vis.editMode){
                    $svg.children().unbind('click touchstart').on('click touchstart', function () {
                        vis.inspectWidgets([wid]);
                    });
                }
            }

            if (oid) {
                vis.states.bind(oid + '.val', onChange);
                // remember all ids, that bound
                $wid.data('bound', [oid + '.val'])
                // remember bind handler
                    .data('bindHandler', onChange);
            }
            var $svg = $wid.find('svg');
            if (!vis.editMode && !no_control) {
                $svg.children().off('click touchend').on('click touchend', onSvgClick).off('touchmove').on('touchmove', function () {
                    moved = true;
                }).on('touchstart', function () {
                    moved = false;
                });
            } else if (vis.editMode){
                $svg.children().off('click touchstart').on('click touchstart', function () {
                    vis.inspectWidgets([wid]);
                });
            }
            $wid.data('destroy', function (id, $widget) {
                $widget.find('svg').children().off('click touchend').off('touchmove').off('click touchstart');
            });
        },
        editNote: function (wid, max_width, min_width, min_height, oid) {
            if (vis.editMode) return;

            max_width  = max_width  ? parseInt(max_width,  10) : 400;
            min_width  = min_width  ? parseInt(min_width,  10) : 40;
            min_height = min_height ? parseInt(min_height, 10) : 15;

            var $this = $('#div_' + wid);
            $('body').append('<div id="dlg_' + wid + '" title="' + _('Edit note') + '">' +
                '<textarea style="resize: none; width:95%; height:92%" id="text_' + wid + '">' + $this.text().trim() + '</textarea></div>');

            var buttons = {};
            buttons[_('Clear')] = function () {
                $('#text_' + $(this).attr('data-wid')).val("");
            };

            buttons[_('Ok')] = function () {
                var dlg  = $(this);
                var oid  = dlg.attr('data-oid');
                var wid  = dlg.attr('data-wid');
                var text = $('#text_' + wid).val();
                text = text.replace('\n', '<br>\n');

                if (!oid) $('#div_' + wid).html(text);
                /*if (!text) {
                 $('#' + wid).css({width: min_width, height: min_height});
                 }
                 else {
                 $('#' + wid).css({width: max_width, height: 'auto'});
                 }*/

                if (oid) vis.setValue(oid, text);

                dlg.dialog('close');
                dlg.remove();
            };

            buttons[_('Cancel')] = function () {
                $(this).dialog('close');
                $(this).remove();
            };

            $('#dlg_' + wid).attr('data-oid', oid).attr('data-wid', wid).dialog({
                width:   500,
                height:  300,
                modal:   true,
                buttons: buttons
            });
        },
        formatFloat: function (data, val) {
            if (vis.editMode && data.attr('test_html') !== undefined && data.attr('test_html') !== '') {
                val = parseFloat(data.attr('test_html'));
            } else if(val === undefined || val === null){
                val = parseFloat(vis.states.attr(data.oid + '.val'));
            }else {
                val = parseFloat(val);
            }
            if (data.factor !== undefined && data.factor !== '') val = val * parseFloat(data.factor);
            if (data.digits !== undefined && data.digits !== '') val = val.toFixed(parseFloat(data.digits, 10));

            if (data.attr('is_tdp')) {
                val = this.formatValue(val, data.digits ? parseInt(data.digits) : 2, data.attr('is_comma') ? ".," : ",.");
            } else if (data.attr('is_comma')) {
                val = '' + val;
                val = val.replace('.', ',');
            }

            return val;
        },
        extractWidth: function (css, multiplier) {
            // extract from "2px solid #aabbcc" => 2px
            var m = css.match(/([0-9])+(px|em)?/);
            if (m) {
                if (m[1] && m[2]) {
                    return parseInt(m[1], 10) * (multiplier || 1) + m[2];
                } else {
                    return parseInt(m[1], 10) * (multiplier || 1);
                }
            }
        },
        getCalc: function (data, val) {
            var min = (data.min || data.min === 0) ? parseFloat(data.min) : 0;
            var max = (data.max || data.max === 0) ? parseFloat(data.max) : 100;
            val = parseFloat(vis.states.attr(data.oid + '.val')) || 0;
            val = (val - min) / (max - min);
            return (data.border) ? ('calc(' + Math.round(val * 100) + '% - ' + vis.binds.basic.extractWidth(data.border, 2) + ')') : (Math.round(val * 100) + '%');
        },

        formatValue: function formatValue(value, decimals, _format) {
            if (typeof decimals !== 'number') {
                decimals = 2;
                _format = decimals;
            }
            var format = (_format === undefined) ? '.,' : _format;
            if (typeof value !== 'number') value = parseFloat(value);
            return isNaN(value) ? '' : value.toFixed(decimals || 0).replace(format[0], format[1]).replace(/\B(?=(\d{3})+(?!\d))/g, format[0]);
        },

        formatIntervalHelper: function (value, type) {
            var singular;
            var plural;
            var special24;
            if (vis.language === 'de') {
                if (type === 'seconds') {
                    singular = 'Sekunde';
                    plural   = 'Sekunden';
                } else if (type === 'minutes') {
                    singular = 'Minute';
                    plural   = 'Minuten';
                } else if (type === 'hours') {
                    singular = 'Stunde';
                    plural   = 'Stunden';
                } else if (type === 'days') {
                    singular = 'Tag';
                    plural   = 'Tagen';
                }
            } else
            if (vis.language === 'ru') {
                if (type === 'seconds') {
                    singular  = 'секунду';
                    plural    = 'секунд';
                    special24 = 'секунды';
                } else if (type === 'minutes') {
                    singular  = 'минуту';
                    plural    = 'минут';
                    special24 = 'минуты';
                } else if (type === 'hours') {
                    singular  = 'час';
                    plural    = 'часов';
                    special24 = 'часа';
                } else if (type === 'days') {
                    singular  = 'день';
                    plural    = 'дней';
                    special24 = 'дня';
                }
            } else {
                if (type === 'seconds') {
                    singular = 'second';
                    plural   = 'seconds';
                } else if (type === 'minutes') {
                    singular = 'minute';
                    plural   = 'minutes';
                } else if (type === 'hours') {
                    singular = 'hour';
                    plural   = 'hours';
                } else if (type === 'days') {
                    singular = 'day';
                    plural   = 'days';
                }
            }

            if (value === 1) {
                if (vis.language === 'de') {
                    if (type === 'days') {
                        return 'einem ' + singular;
                    } else {
                        return 'einer ' + singular;
                    }
                } else if (vis.language === 'ru') {
                    if (type === 'days' || type === 'hours') {
                        return 'один ' + singular;
                    } else {
                        return 'одну ' + singular;
                    }
                } else {
                    return 'one ' + singular;
                }
            } else {
                if (vis.language === 'de') {
                    return value + ' ' + plural;
                } else if (vis.language === 'ru') {
                    var d = value % 10;
                    if (d === 1 && value !== 11) {
                        return value + ' ' + singular;
                    } else
                    if (d >= 2 && d <= 4 && (value > 20 || value < 10)) {
                        return value + ' ' + special24;
                    } else {
                        return value + ' ' + plural;
                    }
                } else {
                    return value + ' ' + plural;
                }
            }
        },
        formatInterval: function (timestamp, isMomentJs) {
            if (isMomentJs && typeof moment !== 'undefined') {
                return moment(new Date(timestamp)).fromNow();
            }
            var diff = new Date().getTime() - timestamp;
            diff = Math.round(diff / 1000);
            var text;
            if (diff <= 60) {
                if (vis.language === 'de') {
                    text = 'vor ' + vis.binds.basic.formatIntervalHelper(diff, 'seconds');
                } else if (vis.language === 'ru') {
                    text = vis.binds.basic.formatIntervalHelper(diff, 'seconds') + ' назад';
                } else {
                    text = vis.binds.basic.formatIntervalHelper(diff, 'seconds') + ' ago';
                }
            } else if (diff < 3600) {
                var m = Math.floor(diff / 60);
                var s = diff - m * 60;
                text = '';
                if (vis.language === 'de') {
                    text = 'vor ' + vis.binds.basic.formatIntervalHelper(m, 'minutes');
                } else if (vis.language === 'ru') {
                    text = vis.binds.basic.formatIntervalHelper(m, 'minutes');
                } else {
                    text = vis.binds.basic.formatIntervalHelper(m, 'minutes');
                }

                if (m < 5) {
                    // add seconds
                    if (vis.language === 'de') {
                        text += ' und ' + vis.binds.basic.formatIntervalHelper(s, 'seconds');
                    } else if (vis.language === 'ru') {
                        text += ' и ' + vis.binds.basic.formatIntervalHelper(s, 'seconds');
                    } else {
                        text += ' and ' + vis.binds.basic.formatIntervalHelper(s, 'seconds');
                    }
                }

                if (vis.language === 'de') {
                    // nothing
                } else if (vis.language === 'ru') {
                    text += ' назад';
                } else {
                    text += ' ago';
                }
            } else if (diff < 3600 * 24) {
                var h = Math.floor(diff / 3600);
                var m = Math.floor((diff - h * 3600) / 60);
                text = '';
                if (vis.language === 'de') {
                    text = 'vor ' + vis.binds.basic.formatIntervalHelper(h, 'hours');
                } else if (vis.language === 'ru') {
                    text = vis.binds.basic.formatIntervalHelper(h, 'hours');
                } else {
                    text = vis.binds.basic.formatIntervalHelper(h, 'hours');
                }

                if (h < 10) {
                    // add seconds
                    if (vis.language === 'de') {
                        text += ' und ' + vis.binds.basic.formatIntervalHelper(m, 'minutes');
                    } else if (vis.language === 'ru') {
                        text += ' и ' + vis.binds.basic.formatIntervalHelper(m, 'minutes');
                    } else {
                        text += ' and ' + vis.binds.basic.formatIntervalHelper(m, 'minutes');
                    }
                }

                if (vis.language === 'de') {
                    // nothing
                } else if (vis.language === 'ru') {
                    text += ' назад';
                } else {
                    text += ' ago';
                }
            } else {
                var d = Math.floor(diff / (3600 * 24));
                var h = Math.floor((diff - d * (3600 * 24)) / 3600);
                text = '';
                if (vis.language === 'de') {
                    text = 'vor ' + vis.binds.basic.formatIntervalHelper(d, 'days');
                } else if (vis.language === 'ru') {
                    text = vis.binds.basic.formatIntervalHelper(d, 'days');
                } else {
                    text = vis.binds.basic.formatIntervalHelper(d, 'days');
                }

                if (d < 3) {
                    // add seconds
                    if (vis.language === 'de') {
                        text += ' und ' + vis.binds.basic.formatIntervalHelper(h, 'hours');
                    } else if (vis.language === 'ru') {
                        text += ' и ' + vis.binds.basic.formatIntervalHelper(h, 'hours');
                    } else {
                        text += ' and ' + vis.binds.basic.formatIntervalHelper(h, 'hours');
                    }
                }

                if (vis.language === 'de') {
                    // nothing
                } else if (vis.language === 'ru') {
                    text += ' назад';
                } else {
                    text += ' ago';
                }
            }
            return text;
        },
        startUpdateInterval: function () {
            if (vis.binds.basic.updateInterval) return;
            vis.binds.basic.updateInterval = setInterval(function () {
                $('.time-interval').each(function () {
                    $(this).html(vis.binds.basic.formatInterval($(this).data('time'), $(this).data('moment')))
                });
            }, 15000);
        },
        formatDate: function (dateObj, format, interval, isMomentJs) {
            if (typeof format === 'boolean') {
                interval = format;
                format = 'auto';
            }

            if (format === 'auto') format = (vis.dateFormat || 'DD.MM.YYYY') + ' hh:mm:ss';

            format = format || vis.dateFormat || 'DD.MM.YYYY';

            if (!dateObj) return '';
            var text = typeof dateObj;
            if (text === 'string') {
		dateObj = new Date(dateObj);
            }
            if (text !== 'object') {
                var i = parseInt(dateObj, 10);
                if (i == dateObj) {
                    i = dateObj;
                    // if greater than 2000.01.01 00:00:00
                    if (i > 946681200000) {
                        dateObj = new Date(dateObj);
                    } else {
                        dateObj = new Date(dateObj * 1000);
                    }
                } else {
                    dateObj = new Date(dateObj);
                }
            }
            if (interval) {
                vis.binds.basic.startUpdateInterval();
                return '<span class="time-interval" data-time="' + dateObj.getTime() + '" data-moment="' + (isMomentJs || false) + '">' + vis.binds.basic.formatInterval(dateObj.getTime(), isMomentJs) + '</span>';
            }

            var v;

            // Year
            if (format.indexOf('YYYY') !== -1 || format.indexOf('JJJJ') !== -1 || format.indexOf('ГГГГ') !== -1) {
                v = dateObj.getFullYear();
                format = format.replace('YYYY', v);
                format = format.replace('JJJJ', v);
                format = format.replace('ГГГГ', v);
            } else if (format.indexOf('YY') !== -1 || format.indexOf('JJ') !== -1 || format.indexOf('ГГ') !== -1) {
                v = dateObj.getFullYear() % 100;
                format = format.replace('YY', v);
                format = format.replace('JJ', v);
                format = format.replace('ГГ', v);
            }
            // Month
            if (format.indexOf('MM') !== -1 || format.indexOf('ММ') !== -1) {
                v =  dateObj.getMonth() + 1;
                if (v < 10) v = '0' + v;
                format = format.replace('MM', v);
                format = format.replace('ММ', v);
            } else if (format.indexOf('M') !== -1 || format.indexOf('М') !== -1) {
                v =  dateObj.getMonth() + 1;
                format = format.replace('M', v);
                format = format.replace('М', v);
            }

            // Day
            if (format.indexOf('DD') !== -1 || format.indexOf('TT') !== -1 || format.indexOf('ДД') !== -1) {
                v =  dateObj.getDate();
                if (v < 10) v = '0' + v;
                format = format.replace('DD', v);
                format = format.replace('TT', v);
                format = format.replace('ДД', v);
            } else if (format.indexOf('D') !== -1 || format.indexOf('TT') !== -1 || format.indexOf('Д') !== -1) {
                v =  dateObj.getDate();
                format = format.replace('D', v);
                format = format.replace('T', v);
                format = format.replace('Д', v);
            }

            // hours
            if (format.indexOf('hh') !== -1 || format.indexOf('SS') !== -1 || format.indexOf('чч') !== -1) {
                v =  dateObj.getHours();
                if (v < 10) v = '0' + v;
                format = format.replace('hh', v);
                format = format.replace('SS', v);
                format = format.replace('чч', v);
            } else if (format.indexOf('h') !== -1 || format.indexOf('S') !== -1 || format.indexOf('ч') !== -1) {
                v =  dateObj.getHours();
                format = format.replace('h', v);
                format = format.replace('S', v);
                format = format.replace('ч', v);
            }

            // minutes
            if (format.indexOf('mm') !== -1 || format.indexOf('мм') !== -1) {
                v =  dateObj.getMinutes();
                if (v < 10) v = '0' + v;
                format = format.replace('mm', v);
                format = format.replace('мм', v);
            } else if (format.indexOf('m') !== -1 ||  format.indexOf('м') !== -1) {
                v =  dateObj.getMinutes();
                format = format.replace('m', v);
                format = format.replace('v', v);
            }

            // milliseconds
            if (format.indexOf('sss') !== -1 || format.indexOf('ссс') !== -1) {
                v =  dateObj.getMilliseconds();
                if (v < 10) {
                    v = '00' + v;
                } else if (v < 100) {
                    v = '0' + v;
                }
                format = format.replace('sss', v);
                format = format.replace('ссс', v);
            }

            // seconds
            if (format.indexOf('ss') !== -1 || format.indexOf('сс') !== -1) {
                v =  dateObj.getSeconds();
                if (v < 10) v = '0' + v;
                format = format.replace('ss', v);
                format = format.replace('cc', v);
            } else if (format.indexOf('s') !== -1 || format.indexOf('с') !== -1) {
                v =  dateObj.getHours();
                format = format.replace('s', v);
                format = format.replace('с', v);
            }

            return format;
        },
        detectScreen: function (wid) {
            if (vis.navChangeCallbacks.indexOf(vis.binds.basic.detectScreen) === -1) {
                vis.navChangeCallbacks.push(vis.binds.basic.detectScreen);
            }

            function onResize () {
                if (vis.editMode) {
                    $('.vis-resolution-width').html(vis.views[vis.activeView].settings.sizex  || $(window).width());
                    $('.vis-resolution-height').html(vis.views[vis.activeView].settings.sizey || $(window).height());
                    $('.vis-resolution-default-view').html(vis.findNearestResolution(vis.views[vis.activeView].settings.sizex || $(window).width(), vis.views[vis.activeView].settings.sizey || $(window).height()));
                } else {
                    $('.vis-resolution-width').html($(window).width());
                    $('.vis-resolution-height').html($(window).height());
                    $('.vis-resolution-default-view').html(vis.findNearestResolution());
                }
            }

            setTimeout(function () {
                $(window).bind('resize', onResize);
                if (vis.editMode) {
                    $('.vis-resolution-width').html(vis.views[vis.activeView].settings.sizex  || $(window).width());
                    $('.vis-resolution-height').html(vis.views[vis.activeView].settings.sizey || $(window).height());
                    $('.vis-resolution-default-view').html(vis.findNearestResolution(vis.views[vis.activeView].settings.sizex || $(window).width(), vis.views[vis.activeView].settings.sizey || $(window).height()));
                } else {
                    $('.vis-resolution-width').html($(window).width());
                    $('.vis-resolution-height').html($(window).height());
                    $('.vis-resolution-default-view').html(vis.findNearestResolution());
                }
            }, 100);

            if (vis.editMode) {
                $('#' + wid).data('destroy', function () {
                    $(window).unbind('resize', onResize);
                });
            }
        },
        createScreenText: function () {
            setTimeout(function () {
                $('.basic-click-create-instance').unbind('click').click(function () {
                    if (!vis.instance) {
                        vis.generateInstance();
                        if (vis.instance) {
                            $(this).html(vis.instance).removeClass('basic-click-create-instance').css({
                                'font-weight': 'inherit',
                                cursor: 'inherit'
                            });
                        } else {
                            window.alert('Cannot generate!');
                        }
                    }
                });
            }, 500);
            return '<span class="basic-click-create-instance" style="font-weight: bold; cursor: pointer">' + _('click to create') + '</span>';
        },
        isFalse: function (val, min, max) {
            if (min !== undefined && min !== null && min !== '') {
                if (val === 'true') {
                    val = true;
                }
                if (val === 'false') {
                    val = false;
                }
                if (max !== undefined && max !== null && max !== '') {
                    if (max === 'false') {
                        max = false;
                    }
                    if (max === 'true') {
                        max = true;
                    }
                    return val != max;
                } else {
                    if (min === 'false') {
                        min = false;
                    }
                    if (min === 'true') {
                        min = true;
                    }
                    return val == min;
                }
            }
            if (val === undefined || val === null || val === false || val === 'false' || val === 'FALSE' || val === 'False' || val === 'OFF' || val === 'Off' || val === 'off' || val === '') return true;
            if (val === '0' || val === 0) return true;
            var f = parseFloat(val);
            if (f.toString() !== 'NaN') return !f;
            return false;
        },
        circlePoints: function (radius, num, step) {
            var isArray = false;
            if (step === true) {
                isArray = true;
                step = 0;
            }
            step = step || 360 / num;
            var points = [];
            var text = '';
            for (var i = 0; i < num; i++) {
                var point = {x:Math.sin(Math.PI / 180 * (i * step - 180)) * radius, y:Math.cos(Math.PI / 180 * (i * step - 180)) * radius};
                points.push(point);
                text += point.x + ', ' + point.y + ' ';
            }
            if (isArray) return points;
            return text;
        },
        createValueGesture: function (widgetID, view, data, style) {
            var $div = $('#' + widgetID);
            // if nothing found => wait
            if (!$div.length) {
                return setTimeout(function () {
                    vis.binds.basic.createValueGesture(widgetID, view, data, style);
                }, 100);
            }
            var $content = $('#' + widgetID + ' .vis-widget-body');
            function refresh(val, x, y) {
                var text;
                if (val === null){
                    $div.hide();
                    return;
                }
                text = data.html_prepend || '';
                text += vis.binds.basic.formatFloat(data,val);
                text += parseFloat(vis.binds.basic.formatFloat(data,val)) === 1 ? data.html_append_singular || '' : data.html_append_plural || '';
                $content.html(text);
                $div.css({left: parseInt(x)  -$div.width() / 2 + 'px', top: parseInt(y) - $div.height() / 2 + 'px'}).show();
            }
            if (vis.editMode){
                refresh(data.test_html || 0, $div.position().left + $div.width() / 2, $div.position().top + $div.height() / 2);
            } else {
                refresh(null, 0, 0);
            }

            // subscribe top value updates
            $div.on('gestureUpdate', function(event, evData){
                refresh(evData.val, evData.x, evData.y);
            });
        },
        speech2text: function (wid, view, data, style) {
            var $div = $('#' + wid);
            // if nothing found => wait
            if (!$div.length) {
                return setTimeout(function () {
                    vis.binds.basic.speech2text(wid, view, data, style);
                }, 100);
            }

            if (typeof webkitSpeechRecognition === 'undefined') {
                console.error('Browser does not support speech 2 text');
                $div.find('.mic-info-text').html(_('info_upgrade'));
                return;
            }

            var _data ={
                continuous:     data.speechMode === 'continuous' || data.speechMode === 'startstop',
                speechMode:     data.speechMode,
                oid:            data.oid,
                language:       data.language,
                finalTranscript: '',
                lastText:       '',
                recognition:    null,
                ignoreOnEnd:    false,
                timer:          null,
                words:          data.keywords ? data.keywords.toLowerCase().split(/[\s,;]+/g) : null,
                textSentColor:  data.textSentColor,
                keyWordColor:   data.keyWordColor,
                imageInactive:  data.imageInactive,
                imageActive:    data.imageActive    || data.imageInactive,
                imageStarted:   data.imageStarted   || data.imageInactive,
                imageDetected:  data.imageDetected  || data.imageInactive,
                imageSent:      data.imageSent      || data.imageInactive,
                $text:          $div.find('.mic-info-text'),
                $result:        $div.find('.mic-results'),
                $image:         $div.find('.mic-image')
            };
            data = null;

            function findKeyWord(text) {
                var found = false;
                if (_data.words) {
                    found = false;
                    var wwords = text.toLowerCase().split(' ');
                    for (var w = 0; w < _data.words.length; w++) {
                        var pos = wwords.indexOf(_data.words[w]);
                        if (pos !== -1) {
                            var offset = 0;
                            for (var p = 0; p < pos; p++) {
                                offset += wwords[p].length + 1;
                            }
                            text = text.substring(0, offset) + '<b>' + text.substring(offset, offset + wwords[pos].length) + '</b>' + text.substring(offset + wwords[pos].length);
                            found = true;
                            break;
                        }
                    }
                } else {
                    return true;
                }
                return found ? text : false;
            }

            function startRecognition() {
                if (_data.recognition) {
                    if (_data.speechMode === 'startstop') {
                        _data.recognition.onend = null;
                        _data.recognition.stop();
                        _data.recognition = null;
                        _data.$text.html(_('info_start')).show();
                        _data.$image.attr('src', _data.imageInactive);
                        _data.$result.hide();
                    }
                    return;
                }

                _data.recognition                 = new webkitSpeechRecognition();
                _data.recognition.continuous      = _data.continuous;
                _data.recognition.interimResults  = true;
                _data.recognition.maxAlternatives = 1;
                var startTimestamp = new Date();


                _data.recognition.onstart = function() {
                    _data.$text.html(_('info_speak_now')).show();
                    _data.$image.attr('src', _data.imageActive);
                    _data.$result.hide();
                };

                _data.recognition.onerror  = function(event) {
                    _data.$result.hide();
                    _data.$text.show();
                    _data.$image.attr('src', _data.imageInactive);
                    if (event.error === 'no-speech') {
                        _data.$text.html(_('info_no_speech'));
                        //_data.ignoreOnEnd = true;
                    }
                    if (event.error === 'audio-capture') {
                        _data.$text.html(_('info_no_microphone'));
                        _data.ignoreOnEnd = true;
                    }
                    if (event.error === 'not-allowed') {
                        if (event.timeStamp - startTimestamp < 100) {
                            _data.$text.html(_('info_blocked'));
                        } else {
                            _data.$text.html(_('info_denied'));
                        }
                        _data.ignoreOnEnd = true;
                    }
                };

                _data.recognition.onend    = function() {
                    // console.log('onend');
                    _data.recognition.stop();
                    _data.recognition = null;
                    if (!_data.ignoreOnEnd) {
                        setTimeout(function () {
                            _data.$image.attr('src', _data.imageInactive);
                            if (_data.continuous) {
                                _data.$result.hide();
                                _data.$text.html(_('info_speak_now')).show();
                                startRecognition();
                            } else {
                                _data.$result.hide();
                                _data.$text.html(_('info_start')).show();
                            }
                        }, 1000);
                    }
                };

                _data.recognition.onresult = function(event) {
                    var interimTranscript = '';

                    if (typeof event.results === 'undefined') {
                        _data.recognition.onend = null;
                        _data.recognition.stop();
                        return;
                    }

                    for (var i = event.resultIndex; i < event.results.length; ++i) {
                        if (event.results[i].isFinal) {
                            _data.finalTranscript += event.results[i][0].transcript;
                        } else {
                            interimTranscript += event.results[i][0].transcript;
                        }
                    }

                    if (_data.$image.attr('src') === _data.imageActive) _data.$image.attr('src', _data.imageStarted);

                    //final_transcript = capitalize(final_transcript);
                    _data.$text.hide();
                    var text = _data.finalTranscript || interimTranscript;
                    var found = findKeyWord(text);

                    if (!_data.originalColor) _data.originalColor = _data.$result.css('color');

                    if (found) {
                        text = found;
                        if (_data.$image.attr('src') === _data.imageStarted) _data.$image.attr('src', _data.imageDetected);
                        _data.$result.addClass('mic-keyword-found');
                        if (_data.keyWordColor) _data.$result.css({color: _data.keyWordColor});
                    }

                    _data.$result.html(text).show();

                    if (_data.finalTranscript) {
                        if (_data.timer) clearTimeout(_data.timer);

                        if (found) {
                            _data.$image.attr('src', _data.imageSent);
                            if (_data.textSentColor) _data.$result.css({color: _data.textSentColor});
                            _data.$result.addClass('mic-text-sent');
                            vis.setValue(_data.oid, _data.finalTranscript);
                        }

                        _data.finalTranscript = '';
                        _data.lastText = '';

                        setTimeout(function () {
                            _data.$image.attr('src', _data.imageActive);
                            _data.$result.css({color: _data.originalColor});
                            _data.$result.hide().removeClass('mic-keyword-found mic-text-sent');
                            _data.$text.html(_('info_speak_now')).show();
                        }, 1000);
                    } else {
                        _data.lastText = interimTranscript;

                        if (_data.timer) clearTimeout(_data.timer);
                        _data.timer = setTimeout(function () {
                            _data.timer = null;
                            _data.recognition.onend = null;
                            _data.recognition.stop();
                            _data.recognition = null;

                            var found = findKeyWord(_data.lastText);
                            if (found) {
                                _data.$image.attr('src', _data.imageSent);
                                if (_data.textSentColor) _data.$result.css({color: _data.textSentColor});
                                _data.$result.addClass('mic-text-sent');
                                vis.setValue(_data.oid, _data.finalTranscript);
                            }

                            _data.finalTranscript = '';
                            _data.lastText = '';

                            setTimeout(function () {
                                _data.$image.attr('src', _data.imageActive);
                                _data.$result.css({color: _data.originalColor});
                                _data.$result.hide().removeClass('mic-keyword-found mic-text-sent');
                                _data.$text.html(_('info_speak_now')).show();
                                startRecognition();
                            }, 1000);
                        }, 3000);
                    }
                };

                _data.recognition.lang     = _data.language;

                _data.recognition.start();
            }

            if (_data.speechMode === 'continuous') {
                if (!vis.editMode) {
                    startRecognition();
                } else {
                    $div.find('.mic-info-text').html(_('info_start'));
                }
            } else {
                $div.find('.mic-info-text').html(_('info_start'));
                if (!vis.editMode) {
                    $div.click(function () {
                        startRecognition();
                    });
                }
            }
        },
        getTimeInterval: function (oldTime, hoursToShow) {
            var result = '';

            var newTime = new Date ();

            if (!oldTime) return '';
            if (typeof oldTime === 'string') {
                oldTime = new Date(oldTime);
            } else {// 2000.01.01 00:00:00 = 946681200000
                if (typeof oldTime === 'number') oldTime = oldTime > 946681200000 ? new Date(oldTime) : new Date(oldTime * 1000);
            }

            var seconds = (newTime.getTime() - oldTime.getTime()) / 1000;

            if (hoursToShow && (seconds / 3600) > hoursToShow) return '';

            if (seconds < 60) {
                result = _('just&nbsp;now');
            } else
            if (seconds <= 3600)
                result = _('for&nbsp;%s&nbsp;min.', Math.floor (seconds / 60));
            else
            if (seconds <= 3600 * 24)
                result = _('for&nbsp;%s&nbsp;hr.&nbsp;and&nbsp;%s&nbsp;min.', Math.floor (seconds / 3600), (Math.floor (seconds / 60) % 60));
            else
            if (seconds > 3600 * 24 && seconds <= 3600 * 48)
                result = _('yesterday');
            else
            if (seconds > 3600*48) {
                result = _('for&nbsp;%s&nbsp;hours', Math.floor (seconds / 3600));
            }

            return result;
        },
        logout: function (el, data) {
            if (vis.editMode) return;
            var $el = $(el);
            $el.data('redirect', data.redirect_url);
            $el.data('app', data.in_app_close);

            $el.click(function () {
                if ($(this).data('app')) {
                    if (typeof logout === 'function') {
                        logout();
                    } else {
                        vis.showMessage(_('This option works only in APP'));
                    }
                } else if ($(this).data('redirect')) {
                    var redirect = $(this).data('redirect');
                    vis.conn.logout(function() {
                        window.location = redirect;
                    });
                } else {
                    vis.conn.logout(function(){
                        window.location.reload();
                    });
                }
            });
        },
        toggleFullScreen: function (wid, view, data, style) {
            var $div = $('#' + wid);

            var id = $div.attr('id');
            if (id && id.match(/_removed$/)) return;

            // if nothing found => wait
            if (!$div.length) {
                setTimeout(function () {
                    vis.binds.basic.toggleFullScreen(wid, view, data, style);
                }, 100);
                return;
            }

            var svgOn  = '<svg viewBox="0 0 24 24" style="display: inline-block; color: rgba(0, 0, 0, 0.87); fill: currentcolor; height: 24px; width: 24px; user-select: none; transition: all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"></path></svg>';
            var svgOff = '<svg viewBox="0 0 24 24" style="display: inline-block; color: rgba(0, 0, 0, 0.87); fill: currentcolor; height: 24px; width: 24px; user-select: none; transition: all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;"><path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"></path></svg>';

            if (!vis.editMode) {
                $div.unbind('click').click(function () {
                    if (vis.binds.basic.isFullScreen) {
                        vis.binds.basic.isFullScreen = false;
                        if (document.exitFullscreen) {
                            document.exitFullscreen();
                        } else if (document.mozCancelFullScreen) {
                            document.mozCancelFullScreen();
                        } else if (document.webkitExitFullscreen) {
                            document.webkitExitFullscreen();
                        }
                        $('#' + wid).find('.vis-fullscreen-icon').html(svgOn);
                    } else {
                        vis.binds.basic.isFullScreen = true;
                        var element = $('#vis_container')[0];
                        if (element.requestFullscreen) {
                            element.requestFullscreen();
                        } else if (element.mozRequestFullScreen) {
                            element.mozRequestFullScreen();
                        } else if (element.webkitRequestFullscreen) {
                            element.webkitRequestFullscreen();
                        } else if (element.msRequestFullscreen) {
                            element.msRequestFullscreen();
                        }
                        $('#' + wid).find('.vis-fullscreen-icon').html(svgOff);
                    }
                });
            }

            $div.find('.vis-fullscreen-icon').html(svgOn);
        }
    };

    $(document).mouseup(function () {
        if (vis.binds.basic.pressed) {
            clearInterval(vis.binds.basic.pressed);
            vis.binds.basic.pressed = null;
        }
    });

    if (vis.editMode) {
        vis.binds.basic.onOrientation = function (widgetID, view, newId, attr, isCss) {
            var data  = vis.views[view].widgets[widgetID].data;
            var style = vis.views[view].widgets[widgetID].style;
            var h = parseInt(style.height, 10);
            var w = parseInt(style.width, 10);

            if (data[attr] === 'vertical') {
                if (h < w) {
                    var t = style.height;
                    style.height = style.width;
                    style.width = t;
                    setTimeout(function () {
                        vis.showWidgetHelper(widgetID, true);
                    }, 0);
                    return ['width', 'height'];
                }
            } else {
                if (w < h) {
                    var t = style.height;
                    style.height = style.width;
                    style.width = t;
                    setTimeout(function () {
                        vis.showWidgetHelper(widgetID, true);
                    }, 0);
                    return ['width', 'height'];
                }
            }
        };
        vis.binds.basic.onAttrChanged = function (widgetID, view, newId, attr, isCss) {
            if (vis.binds.basic.groupTimer) clearTimeout(vis.binds.basic.groupTimer);
            vis.binds.basic.groupTimer = setTimeout(function () {
                vis.inspectWidgets(vis.activeViewDiv, vis.activeView, this.activeWidgets);
            }, 2000);
        };
    }
</script>

<!-- Basic Widgets -->


<script id="tplHtml"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="static"
        data-vis-prev='<img src="widgets/basic/img/Prev_HTML.png"></img>'
        data-vis-prev1='<div id="prev_tplFrame" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock" style="width: 80px; height: 80px; border: 3px solid rgb(73, 185, 255); border-radius: 20px;"><div style="top: 30px; color: rgb(73, 185, 255); font-size: 20px; text-align: center; padding-top: 32px;">HTML</div></div>'
        data-vis-name="HTML"
        data-vis-attrs="html/text;refreshInterval[0]/slider,0,180000,100">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 200px; height: 130px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.basic.htmlRefresh(el, this.data.attr('html'), data.attr("refreshInterval")) %>>
            <%== this.data.attr('html') %>
        </div>
    </div>
</script>

<script id="tplShapes"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="static"
        data-vis-name="Svg shape"
        data-vis-prev='<div id="prev_tplShapes" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev " style="width: 90px; height: 90px; left: 502px; top: 174px; position: absolute;"> <div class="vis-widget-prev-body"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 100 100" style="display: block;width: 100%;height: 100%;fill: rgb(255, 255, 255);stroke: rgb(60, 152, 211); stroke-width: 4px;"> <circle cx="50" cy="50" r="47"></circle></svg></div> </div></div>'
        data-vis-attrs="svgType[circle]/select,line,triangle,square,pentagone,hexagone,octagone,circle,star,arrow;strokeColor[#009cb3]/color;fill[#00b3ac]/color;strokeWidth[5]/slider,0,100,1;rotate/slider,0,360,1;scaleWidth[1]/slider,0,1,0.1;scaleHeight[1]/slider,0,1,0.1">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 100px; height: 100px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewbox="-50 -50 100 100" style="display: block;width:100%; height:100%;fill:<%== this.data.attr('fill') %>;stroke:<%== this.data.attr('strokeColor')%>;stroke-width: <%== this.data.attr('strokeWidth') %>">
                <%
                var svg = '';
                var rotate      = parseFloat(this.data.attr('rotate')) || 0;
                var scaleWidth  = parseFloat(this.data.attr('scaleWidth')) || 1;
                var scaleHeight = parseFloat(this.data.attr('scaleHeight')) || 1;
                var strokeWidth = parseInt(this.data.attr('strokeWidth'), 10) || 0;

                if (this.data.svgType === 'triangle') {
                    svg = '<polygon transform="rotate(' + rotate + ')  scale(' + scaleWidth + ', ' + scaleHeight + ') " ' +
                        'points="' + vis.binds.basic.circlePoints(50 - strokeWidth, 3) + '"/>';
                } else if (this.data.svgType === 'line') {
                    svg = '<line  vector-effect="non-scaling-stroke"  transform="rotate(' + rotate + ')" x1="-50" y1="0" x2="50" y2="0"/>';
                } else if (this.data.svgType === 'circle') {
                    svg = '<circle transform="scale(' + scaleWidth + ', ' + scaleHeight + ') rotate(' + rotate + ')" cx="0" cy="0" r="' + (50 - parseInt(strokeWidth, 10) / 2) + '" />';
                } else if (this.data.svgType === 'pentagone') {
                    svg = '<polygon transform="rotate(' + rotate + ')  scale(' + scaleWidth + ', ' + scaleHeight + ') " ' +
                        'points="' + vis.binds.basic.circlePoints(50 - strokeWidth, 5) + '"/>';
                } else if (this.data.svgType === 'square') {
                    svg = '<polygon transform="rotate(' + rotate + ')  scale(' + scaleWidth + ', ' + scaleHeight + ') " ' +
                        'points="' + vis.binds.basic.circlePoints(50 - strokeWidth, 4) + '"/>';
                } else if (this.data.svgType === 'hexagone') {
                    svg = '<polygon transform="rotate(' + rotate + ')  scale(' + scaleWidth + ', ' + scaleHeight + ') " ' +
                        'points="' + vis.binds.basic.circlePoints(50 - strokeWidth, 6) + '"/>';
                } else if (this.data.svgType === 'octagone') {
                    svg = '<polygon transform="rotate(' + rotate + ')  scale(' + scaleWidth + ', ' + scaleHeight + ') " ' +
                        'points="' + vis.binds.basic.circlePoints(50 - strokeWidth, 8) + '"/>';
                } else if (this.data.svgType === 'star') {
                    svg = '<polygon transform="rotate(' + rotate + ')  scale(' + scaleWidth + ', ' + scaleHeight + ') " ' +
                        'points="' + vis.binds.basic.circlePoints(50 - strokeWidth, 5, 144) + '"/>';
                } else if (this.data.svgType === 'arrow') {
                    var points = vis.binds.basic.circlePoints(50 - strokeWidth * 4, 3, true);
                    var text = '';
                    for (var p = 0; p < points.length; p++) {
                        text += points.x + ',' + points.y;
                        if (points.length === p - 2) {
                            text += '0,0';
                        }
                    }
                    svg = '<polygon transform="rotate(' + rotate + ') translate(0,10)  scale(' + scaleWidth + ', ' + scaleHeight + ') " ' +
                        'points="0, -50 -43.3, 25 0,0 43.3, 25"/>';
                }
                %>
                <%== svg %>
                </g>
            </svg>
        </div>
    </div>
</script>

<script id="tplIFrame"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="static"
        data-vis-prev='<img src="widgets/basic/img/Prev_iFrame.png"></img>'
        data-vis-name="iFrame"
        data-vis-attrs="src;refreshInterval[0]/slider,0,180000,100;noSandbox/checkbox;refreshOnWakeUp/checkbox;refreshOnViewChange/checkbox;refreshWithNoQuery/checkbox;scrollX/checkbox;scrollY/checkbox;seamless[true]/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top: 0px; left: 0px; width: 600px; height: 320px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <% if (vis.editMode) { %>
            <div class="editmode-helper" />
            <% } %>
            <iframe src="<%= this.data.attr('src') %>" <%= this.data.attr('noSandbox') ? '' : 'sandbox="allow-modals allow-forms allow-pointer-lock allow-popups allow-same-origin allow-scripts"' %> style="position: absolute; border: 0; padding: 0; margin: 0; width: 100%; height: 100%;<%= this.data.attr('scrollX') == true ? 'overflow-x: scroll;' : 'overflow-x: hidden;' %><%= this.data.attr('scrollY') == true ? 'overflow-y: scroll;' : 'overflow-y: hidden;' %>" <%= this.data.attr('seamless') == true ? 'seamless' : '' %>></iframe>
            <div <%= (el) -> vis.binds.basic.iframeRefresh(el, data, this.view) %>></div>
        </div>
    </div>
</script>

<script id="tplImage"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="static"
        data-vis-prev='<img src="widgets/basic/img/Prev_Image.png"></img>'
        data-vis-name="Image"
        data-vis-attrs="src/image;stretch/checkbox;refreshInterval[0]/slider,0,180000,100;"
        data-vis-attrs0="refreshOnWakeUp/checkbox;refreshOnViewChange/checkbox;refreshWithNoQuery/checkbox;allowUserInteractions/checkbox;">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 200px; height: 130px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <% if (vis.editMode) { %>
                <div class="editmode-helper" />
            <% } %>
            <img class="<%= this.data.attr('stretch') ? 'vis-image' : '' %> <%= this.data.attr('allowUserInteractions') ? '' : 'vis-no-user-select vis-no-pointer-events' %>" style="top:0; left: 0; position: absolute; width: 100%; <%= this.data.attr('stretch') ? 'height: 100%;' : '' %>" <%= this.data.attr('src') ? 'src="' + this.data.attr('src') + '"' : '' %> />
            <div <%= (el) -> vis.binds.basic.imgRefresh(el, data, this.view) %> />
        </div>
    </div>
</script>

<script id="tplLink"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/basic/img/Prev_tplLink.png"></img>'
        data-vis-set="basic"
        data-vis-type="static"
        data-vis-name="link"
        data-vis-attrs="html;href;target/auto,,_blank,_self,_parent,_top;alt">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 200px; height: 130px; " id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <a href="<%== this.data.attr('href') %>" target="<%== this.data.attr("target") %>" alt="<%== this.data.attr("alt") %>" style="text-decoration:none;width:100%;height:100%"><div style="width:100%;height:100%"><%== this.data.attr("html") %></div></a>
        </div>
    </div>
</script>

<script id="tplFrame"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplFrame" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock" style="width: 80px; height: 80px; border: 3px dashed rgb(60, 152, 211); border-radius: 20px;"><div style="top: 30px; color: rgb(60, 152, 211); font-size: 16px; text-align: center; padding-top: 31px;">BORDER</div></div>'
        data-vis-set="basic"
        data-vis-type="static"
        data-vis-name="Border"
        data-vis-attrs="title['Title'];title_font;title_color[black]/color;title_back/color;title_top[-10]/slider,-20,20,1;title_left[15]/slider,-20,30,1;header_height[0]/slider,0,100,1;header_color[black]/color">
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible;width:50px;height:50px;border:1px solid #888" id="<%= this.data.attr('wid') %>" >
        <% if (this.data.attr('header_height')) { %>
	    <div style="width:100%;height:<%= this.data.attr('header_height') %>px;background-color:<%= this.data.attr('header_color') %>">
		<% } %>
        <div style="position: absolute;top:<%= this.data.attr('title_top') %>px;left:<%= this.data.attr('title_left') %>px;color:<%== this.data.attr('title_color') %>;background:<%== this.data.attr('title_back') %>;font:<%== this.data.attr('title_font') %>"><%== this.data.attr('title') %></div>
        <% if (this.data.attr('header_height')) { %>
        </div>
		<% } %>
    </div>
</script>

<script id="tplStatefulIFrame8"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_StatefulIFrame8.png"></img>'
        data-vis-type="stateful"
        data-vis-name="iFrame 8"
        data-vis-attrs="oid;refreshInterval[0]/slider,0,180000,100;count[1]/number;group.frames;src_(0-count);noSandbox/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0px; left: 0px; width: 600px; height: 320px;" id="<%= this.data.attr('wid') %>">
        <% if (vis.editMode) { %>
            <div class="editmode-helper"/>
        <% } %>
        <div class="vis-widget-body">
            <% if (vis.editMode) { %>
                <div class="editmode-helper"/>
            <% } %>
            <%
                var srcArr = [];
                var i = 0;
                while(data.attr('src_' + i) !== undefined) {
                    srcArr.push(data.attr('src_' + i));
                    i++;
                }
            %>
            <iframe class="vis-widget-element" <%= this.data.attr('noSandbox') ? '' : 'sandbox="allow-modals allow-forms allow-pointer-lock allow-popups allow-same-origin allow-scripts"' %> data-oid="<%= this.data.attr('oid') %>" src="<%== vis.binds.stateful.value(srcArr, data.attr('oid')) %>" style="position: absolute; border: 0; padding: 0; margin: 0; width: 100%; height: 100%;"></iframe>
            <div <%= (el) -> vis.binds.stateful.iframe(el, srcArr, data.attr('refreshInterval')) %> />
        </div>
    </div>
</script>

<!-- basic Container -->
<script id="tplContainerView"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_ContainerView.png"></img>'
        data-vis-type="container"
        data-vis-name="view in widget"
        data-vis-attrs="contains_view/views">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:400px; height: 270px;" id="<%= this.data.attr('wid') %>">
        <% if (vis.editMode) { %>
            <div class="editmode-helper"></div>
        <% } %>
        <div data-vis-contains="<%= this.data.attr('contains_view') %>" class="vis-widget-body vis-view-container">
        </div>
    </div>
</script>

<!-- Stateful Widgets -->
<script id="tplStatefulContainerView8"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_StatefulContainerView8.png"></img>'
        data-vis-type="stateful,container"
        data-vis-name="view in widget 8"
        data-vis-attrs="oid;persistent/checkbox;notIfInvisible/checkbox;count[1]/number;group.views;contains_view_(0-count)/views">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:400px; height: 270px;" id="<%= this.data.attr('wid') %>">
        <% if (vis.editMode) { %>
            <div class="editmode-helper" />
        <% } %>
        <%
            var viewArr = [];
            var i = 0;
            while (data.attr('contains_view_' + i) !== undefined) {
                viewArr.push(data.attr('contains_view_' + i));
                i++;
            }
        %>
        <div class="vis-widget-body">
            <div class="vis-view-container" data-oid="<%= data.attr('oid') %>" data-vis-contains="<%= vis.binds.stateful.value(viewArr, data.attr('oid')) %>" <%= (el) -> vis.binds.stateful.view(el, viewArr, data.attr('persistent'), data.attr('notIfInvisible')) %> />
        </div>
    </div>
</script>

<!-- TODO
<script type="text/ejs" id="tplStatefulIFrame8Persistent" class="vis-tpl" data-vis-set="basic" data-vis-name="stateful - iFrame 8 (persistent)" data-vis-attrs="oid;refreshInterval;src_(0-1)">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0px; left: 0px; width: 600px; height: 320px;" id="<%= this.data.attr('wid') %>">
            <% if (vis.editMode) { %>
                <div class="editmode-helper" />
            <% } %>
          <div class="vis-widget-body">
            <% if (vis.editMode) { %>
                <div class="editmode-helper" />
            <% } %>
            <iframe class="vis-widget-element" src="<%= this.data.attr('src_0') %>" style="position: absolute; border:0; padding:0; margin:0; width: 100%; height:100%;"></iframe>
            <iframe class="vis-widget-element" src="<%= this.data.attr('src_1') %>" style="position: absolute; border:0; padding:0; margin:0; width: 100%; height:100%;"></iframe>
            <iframe class="vis-widget-element" src="<%= this.data.attr('src_2') %>" style="position: absolute; border:0; padding:0; margin:0; width: 100%; height:100%;"></iframe>
            <iframe class="vis-widget-element" src="<%= this.data.attr('src_3') %>" style="position: absolute; border:0; padding:0; margin:0; width: 100%; height:100%;"></iframe>
            <iframe class="vis-widget-element" src="<%= this.data.attr('src_4') %>" style="position: absolute; border:0; padding:0; margin:0; width: 100%; height:100%;"></iframe>
            <iframe class="vis-widget-element" src="<%= this.data.attr('src_5') %>" style="position: absolute; border:0; padding:0; margin:0; width: 100%; height:100%;"></iframe>
            <iframe class="vis-widget-element" src="<%= this.data.attr('src_6') %>" style="position: absolute; border:0; padding:0; margin:0; width: 100%; height:100%;"></iframe>
            <iframe class="vis-widget-element" src="<%= this.data.attr('src_7') %>" style="position: absolute; border:0; padding:0; margin:0; width: 100%; height:100%;"></iframe>
            <div <%= (el) -> vis.binds.stateful.iframe(el, [data.attr("src_0"), data.attr("src_1"), data.attr("src_2"), data.attr("src_3"), data.attr("src_4"), data.attr("src_5"), data.attr("src_6"), data.attr("src_7"]), data.attr("refreshInterval")) %> />
        </div>
    </div>
</script>
-->

<script id="tplStatefulImage8"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_StatefulImage.png"></img>'
        data-vis-type="stateful"
        data-vis-name="Image 8"
        data-vis-attrs="oid;refreshInterval[0]/slider,0,180000,100;count[1]/number;group.images;src_(0-count)/image">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 200px; height: 130px;" id="<%= this.data.attr('wid') %>">
        <% if (vis.editMode) { %>
            <div class="editmode-helper" />
        <% } %>
        <div class="vis-widget-body">
            <% if (vis.editMode) { %>
                <div class="editmode-helper" />
            <% } %>
            <%
                var srcArr = [];
                var i = 0;
                while(data.attr("src_" + i) !== undefined) {
                    srcArr.push(this.data.attr("src_" + i));
                    i++;
                }
            %>
            <img class="vis-widget-element" data-oid="<%= this.data.attr('oid') %>" style="position:absolute; width:100%;" src="<%== vis.binds.stateful.value(srcArr, this.data.attr('oid')) %>" />
            <div <%= (el) -> vis.binds.stateful.image(el, srcArr, data.attr('refreshInterval')) %> />
        </div>
    </div>
</script>

<script id="tplHtmlNav"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="static,navigation"
        data-vis-prev='<img src="widgets/basic/img/Prev_HTMLnavigation.png"></img>'
        data-vis-name="HTML navigation"
        data-vis-attrs="html;nav_view;sync/checkbox;body-background/color;group.effects;hide_effect/effect;hide_duration/slider,0,10000,100;hide_options/effect-options;show_effect/effect;show_duration/slider,0,10000,100;show_options/effect-options">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 200px; height: 130px; " id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.basic.navigation(el, {nav_view: data.attr('nav_view'), hideOptions: {effect: data.attr('hide_effect'), options: (data.attr('hide_options') ? data.attr('hide_options') : {}),duration:data.attr('hide_duration')}, showOptions: {effect:data.attr('show_effect'), options: (data.attr('show_options') ? data.attr('show_options') : {}), duration: data.attr('show_duration')}, sync: data.attr('sync'), background: data.attr('body-background')}) %>>
        <div class="vis-widget-body">
            <%== this.data.attr('html') %>
        </div>
    </div>
</script>

<script id="tplFilterDropdown"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/basic/img/Prev_FilterDropdown.png"></img>'
        data-vis-set="basic"
        data-vis-type="filter"
        data-vis-name="filter - dropdown"
        data-vis-attrs="filters;group.effects;hide_effect/effect;hide_duration/slider,0,10000,100;show_effect/effect;show_duration/slider,0,10000,100">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0px; left:0px; width: 200px; height: 40px;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.basic.filterDropdown(el, data.attr('filters'), data.attr('hide_effect'), data.attr('hide_duration'), data.attr('show_effect'), data.attr('show_duration')) %>>
        <div class="vis-widget-body">
            <select id="" name="">
                <option value=""><%= _('all') %></option>
            </select>
        </div>
    </div>
</script>

<script id="tplValueFloat"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueFloat.png"></img>'
        data-vis-name="Number"
        data-vis-attrs="oid;html_prepend;html_append_singular;html_append_plural;group.extended;digits;is_comma[true]/checkbox;is_tdp/checkbox;factor[1];oid-quality;class_true;class_false;test_html">
    <div class="vis-widget <%== (vis.states.attr(this.data['oid-quality'] + '.val') === 'true' ||  vis.states.attr(this.data['oid-quality'] + '.val') === true) ? this.data.attr('class_true') : this.data.attr('class_false') %> <%== this.data.attr('class') %>" style="top: 0; left: 0; width: 60px; height: 18px" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== this.data.attr('html_prepend') %><%= vis.binds.basic.formatFloat(this.data) %><%== (parseFloat(vis.binds.basic.formatFloat(this.data)) === 1 ? this.data.attr('html_append_singular') : this.data.attr('html_append_plural')) %>
            </div>
        </div>
    </div>
</script>

<script id="tplValueString"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val"
        data-vis-name="String"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueString.png"></img>'
        data-vis-attrs="oid;html_prepend;html_append;test_html">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0px; left: 0px; width: 50px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') ? ((this.data.attr('oid').indexOf('"') !== -1) ? '' : this.data.attr('oid')) : this.data.attr('oid') %>">
                <%== this.data.attr("html_prepend") %><%= (vis.editMode && this.data.attr('test_html')) ? this.data.attr('test_html') : this.data.attr('oid') ? ((this.data.attr('oid').indexOf('"') !== -1) ? this.data.oid.substring(1, this.data.oid.length - 1) : (vis.states.attr(this.data.oid + '.val'))) : (vis.states.attr(this.data.oid + '.val')) %><%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>

<script id="tplValueStringRaw"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueStringRaw.png"></img>'
        data-vis-name="String (unescaped)"
        data-vis-attrs="oid;html_prepend;html_append;test_html">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0px; left: 0px; width: 50px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== this.data.attr('html_prepend') %><%== (vis.editMode && this.data.attr('test_html')) ? this.data.attr('test_html') : (typeof app !== 'undefined' ? app.replaceFilePathSrc(vis.states.attr(this.data.oid + '.val')) : vis.states.attr(this.data.oid + '.val')) %><%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>

<script id="tplValueStringImg"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueStringImg.png"></img>'
        data-vis-type="val"
        data-vis-name="String img src"
        data-vis-attrs="oid;html_prepend;html_append;refreshInterval[0]/slider,0,180000,100">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0px; left:0px; width:60px; height: 40px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== this.data.attr('html_prepend') %>
                <img src="<%= (typeof app !== 'undefined' ? app.replaceFilePathImg(vis.states.attr(this.data.oid + '.val')) : vis.states.attr(this.data.oid + '.val')) || '' %>" width="100%" />
                 <div <%= (el) -> vis.binds.basic.imgRefresh(el, vis.states.attr(data.oid + '.val' ), data, this.view) %> />
                <%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>

<script id="tplTimeValue"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val,timestamp"
        data-vis-name="TimesValue"
        data-vis-prev='<img src="widgets/basic/img/Prev_TimeValue.png"></img>'
        data-vis-attrs="oid;show_interval/checkbox;format_date/auto,YYYY.MM.DD hh:mm:ss,DD.MM.YYYY hh:mm:ss,YYYY.MM.DD,DD.MM.YYYY,YYYY/MM/DD hh:mm:ss,YYYY/MM/DD,hh:mm:ss;html_prepend;html_append;test_html">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top: 0px; left: 0px; width: 50px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== this.data.attr('html_prepend') %><%== (vis.editMode && this.data.attr('test_html')) ? this.data.attr('test_html') : vis.binds.basic.formatDate(vis.states.attr(this.data.oid + '.val'), this.data.attr('format_date'), this.data.attr('show_interval')) %><%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>

<script id="tplValueTimestampValue"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val,timestamp"
        data-vis-name="Timestamp Value"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueTimestamp.png"></img>'
        data-vis-attrs="oid;show_interval/checkbox;format_date/auto,YYYY.MM.DD hh:mm:ss,DD.MM.YYYY hh:mm:ss,YYYY.MM.DD,DD.MM.YYYY,YYYY/MM/DD hh:mm:ss,YYYY/MM/DD,hh:mm:ss;html_prepend;html_append;test_html">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top: 0px; left: 0px; width: 50px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== this.data.attr('html_prepend') %><%== (vis.editMode && this.data.attr('test_html')) ? this.data.attr('test_html') : vis.binds.basic.formatDate(vis.states.attr(this.data.oid + '.val'), this.data.attr('format_date'), this.data.attr('show_interval')) %><%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>

<script id="tplValueTimestamp"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val,timestamp"
        data-vis-name="Timestamp"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueTimestamp.png"></img>'
        data-vis-attrs="oid;show_interval/checkbox;format_date/auto,YYYY.MM.DD hh:mm:ss,DD.MM.YYYY hh:mm:ss,YYYY.MM.DD,DD.MM.YYYY,YYYY/MM/DD hh:mm:ss,YYYY/MM/DD,hh:mm:ss;html_prepend;html_append;test_html">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top: 0px; left: 0px; width: 50px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== this.data.attr('html_prepend') %><%== (vis.editMode && this.data.attr('test_html')) ? this.data.attr('test_html') : vis.binds.basic.formatDate(vis.states.attr(this.data.oid + '.ts'), this.data.attr('format_date'), this.data.attr('show_interval')) %><%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>

<script id="tplValueLastchange"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val,timestamp"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueLastchange.png"></img>'
        data-vis-name="Last change Timestamp"
        data-vis-attrs="oid;show_interval/checkbox;format_date/auto,YYYY.MM.DD hh:mm:ss,DD.MM.YYYY hh:mm:ss,YYYY.MM.DD,DD.MM.YYYY,YYYY/MM/DD hh:mm:ss,YYYY/MM/DD,hh:mm:ss;html_prepend;html_append;test_html">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0px; left: 0px; width: 50px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== this.data.attr('html_prepend') %><%== (vis.editMode && this.data.attr('test_html')) ? this.data.attr('test_html') : vis.binds.basic.formatDate(vis.states.attr(this.data.oid + '.lc'), this.data.attr('format_date'), this.data.attr('show_interval')) %><%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>

<script id="tplValueList"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueList.png"></img>'
        data-vis-type="val"
        data-vis-name="ValueList Text"
        data-vis-attrs="oid;html_prepend;html_append;valuelist/text;test_list/nselect,,0,1,2,3,4,5,6,7,8,9,10,11,12">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0px;left:0px;width:60px;height:20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== this.data.attr('html_prepend') %><%= (function (that){var list = (that.data.valuelist ? that.data.valuelist.split(';') : []); var val = list[(vis.editMode && (that.data.attr('test_list') || that.data.attr('test_list') == '0')) ? parseInt(that.data.attr('test_list')) : parseInt(vis.states.attr(that.data.oid + '.val'), 10)]; if (val) val = val.replace('§§', ';'); return val;})(this) %><%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>

<script id="tplValueListHtml"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueListHtml.png"></img>'
        data-vis-type="val"
        data-vis-name="ValueList HTML"
        data-vis-attrs="oid;html_prepend;html_append;valuelist/text;test_list/nselect,,0,1,2,3,4,5,6,7,8,9,10,11,12">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0px;left:0px;width:60px;height:20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== this.data.attr('html_prepend') %><%== (function (that){var list = (that.data.valuelist ? that.data.valuelist.split(';') : []); var val = list[(vis.editMode && (that.data.attr('test_list') || that.data.attr('test_list') == '0')) ? parseInt(that.data.attr('test_list')) : parseInt(vis.states.attr(that.data.oid + '.val'), 10)]; if (val) val = val.replace('§§', ';'); return val;})(this) %><%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>

<script id="tplValueListHtml8"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueListHtml8.png"></img>'
        data-vis-type="val"
        data-vis-name="ValueList HTML Style"
        data-vis-attrs="oid;html_prepend;html_append;count[2]/number,0,10,1;value(0-count);style(0-count);test_list/nselect,,0,1,2,3,4,5,6,7,8,9,10,11,12">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 100px; height: 30px;" id="<%= this.data.attr('wid') %>">
        <%
            var slist = [];
            var i = 0;
            while (data['style' + i] !== undefined) {
                slist[i] = data['style' + i]; i++;
            }
        %>
        <div class="vis-widget-body" style="<%== slist[(vis.editMode && (this.data.attr('test_list') || this.data.attr('test_list') == '0')) ? parseInt(this.data.attr('test_list')) : (parseInt((vis.states.attr(this.data.oid + '.val') == true ? 1 : (vis.states.attr(this.data.oid + '.val') == false ? 0 : vis.states.attr(this.data.oid + '.val'))), 10))] %>">
            <div data-oid="<%= this.data.attr('oid') %>">
               <%== this.data.attr('html_prepend') %><%
                   var list = [];
                   var j = 0;
                   while (data['value' + j] !== undefined) {
                        list[j] = data['value' + j];
                        if (list[j]) list[j] = list[j].replace('§§', ';');
                        j++;
                   }
                   %><%== list[(vis.editMode && (this.data.attr('test_list') || this.data.attr('test_list') == '0')) ? parseInt(this.data.attr('test_list')) : (parseInt((vis.states.attr(this.data.oid + '.val') == true ? 1 : (vis.states.attr(this.data.oid + '.val') == false ? 0 : vis.states.attr(this.data.oid + '.val'))), 10))] %><%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>

<script id="tplValueBool"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueBool.png"></img>'
        data-vis-type="val"
        data-vis-name="Bool HTML"
        data-vis-attrs="oid;html_prepend;html_append;html_false;html_true">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:76px; height:76px;" id="<%= this.data.attr('wid') %>"  data-oid="<%= this.data.attr('oid') %>" >
        <div class="vis-widget-body">
            <%== this.data.attr('html_prepend') %>
            <% if (vis.binds.basic.isFalse(vis.states.attr(this.data.oid + '.val'), this.data.attr('min'), this.data.attr('max'))) { %>
                <%== this.data.attr("html_false") %>
            <% } else { %>
                <%== this.data.attr('html_true') %>
            <% } %>
            <%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplAckBool"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_AckBool.png"></img>'
        data-vis-type="val"
        data-vis-name="AckFlag HTML"
        data-vis-attrs="oid;html_prepend;html_append;html_false;html_true">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:76px; height:76px;" id="<%= this.data.attr('wid') %>"  data-oid="<%= this.data.attr('oid') %>" >
        <div class="vis-widget-body">
            <%== this.data.attr('html_prepend') %>
            <%
            var str = vis.states.attr(this.data.oid + ".ack");
            var val = parseFloat(str);
            var state;
            if (str === false || str === "false" || val == 0) {
            %>
            <%== this.data.attr('html_false') %>
            <% } else { %>
            <%== this.data.attr('html_true') %>
            <% } %>
            <%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplValueBoolCheckbox"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueBoolCheckbox.png"></img>'
        data-vis-set="basic"
        data-vis-type="ctrl"
        data-vis-name="Bool Checkbox"
        data-vis-attrs="oid;html_prepend;html_append">
    <div class="vis-widget <%== this.data.attr('class') %>" style="" id="<%= this.data.attr('wid') %>" >
        <div class="vis-widget-body">
			<%== this.data.attr('html_prepend') %>
			<input type="checkbox" name="<%= this.data.attr('wid') %>_checkbox" id="<%= this.data.attr('wid') %>_checkbox" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.checkbox(el) %>/>
			<%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplValueInput"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueInput.png"></img>'
        data-vis-type="ctrl"
        data-vis-update-style="true"
        data-vis-name="Input val"
        data-vis-attrs="oid;html_prepend;html_append;numeric/checkbox;min;max;autoSet/checkbox;readOnly/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" style="background: white; color: black; border: 2px inset" id="<%= this.data.attr('wid') %>" >
        <div class="vis-widget-body">
			<%== this.data.attr('html_prepend') %>
			<input type="text" <%= (this.data.attr('readOnly') === true || this.data.attr('readOnly') === 'true') ? 'readonly' : '' %> data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.input(el, this.data) %> style="width: calc(100% - 5px);"/>
			<%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplValueBoolSelect"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueBoolSelect.png"></img>'
        data-vis-type="ctrl"
        data-vis-name="Bool Select"
        data-vis-attrs="oid;html_prepend;html_append;text_true;text_false">
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:false" id="<%= this.data.attr('wid') %>" >
        <div class="vis-widget-body"  style="overflow:false">
			<%== this.data.attr('html_prepend') %>
			<select id="<%= this.data.attr('wid') %>_select" data-oid="<%= this.data.attr('oid') %>">
				<option value="0" selected='selected'><%= this.data.attr('text_false') %></option>
				<option value="1"><%= this.data.attr('text_true') %></option>
			</select>
			<div <%= (el) -> vis.binds.basic.select(el) %>></div>
			<%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplValueBoolCtrl"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueBoolCtrl.png"></img>'
        data-vis-type="ctrl"
        data-vis-name="Bool HTML"
        data-vis-attrs="oid;min;max;html_prepend;html_append;html_false;html_true;"
        data-vis-attrs1="group.ccontrol;urlTrue;urlFalse;oidTrue/id;oidFalse/id;">
    <div
        class="vis-widget <%== this.data.attr('class') %>"
        style="width:76px; height:76px;"
        id="<%= this.data.attr('wid') %>"
        data-oid="<%= this.data.attr('oid') %>"
        data-min="<%= this.data.attr('min') %>"
        data-max="<%= this.data.attr('max') %>"
        data-as-button="<%= this.data.attr('asButton') %>"
        data-url-true="<%=  this.data.attr('urlTrue') %>"
        data-url-false="<%= this.data.attr('urlFalse') %>"
        data-oid-true="<%=  this.data.attr('oidTrue') %>"
        data-oid-false="<%= this.data.attr('oidFalse') %>"
        <%= (el) -> vis.binds.basic.toggle(el) %>>
        <div class="vis-widget-body">
			<%== this.data.attr('html_prepend') %>
			<% if (vis.binds.basic.isFalse(vis.states.attr(this.data.oid + '.val'), this.data.attr('min'), this.data.attr('max'))) { %>
			    <%== this.data.attr('html_false') %>
			<% } else { %>
			    <%== this.data.attr('html_true') %>
			<% } %>
			<%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplValueBoolCtrlSvg"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueBoolCtrlSvg.png"></img>'
        data-vis-type="ctrl,state"
        data-vis-name="Bool SVG"
        data-vis-attrs="oid;no_control/checkbox;"
        data-vis-attrs0="svg_false[<polygon points='100,10 40,198 190,78 10,78 160,198' style='fill:lime§ stroke:purple§ stroke-width:5§ fill-rule:nonzero' transform='scale(0.4)'/>]/text;"
        data-vis-attrs1="svg_true[<polygon points='100,10 40,198 190,78 10,78 160,198' style='fill:yellow§ stroke:red§ stroke-width:5§ fill-rule:nonzero' transform='scale(0.4)'/>]/text;"
        data-vis-attrs2="svg_opacity/slider,0,1,0.05">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:76px; height:76px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>">
        <div class="vis-widget-body">
            <% vis.binds.basic.showSvg(this.data.attr('class'), this.view, this.data.attr('wid'), this.data.attr('oid'), this.data.attr('svg_opacity'), this.data.attr('svg_false'), this.data.attr('svg_true'), null, this.data.attr('no_control')) %>
        </div>
    </div>
</script>

<script id="tplBasicState"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/basic/img/Prev_BasicState.png"></img>'
        data-vis-set="basic"
        data-vis-type="ctrl"
        data-vis-name="HTML State"
        data-vis-attrs="oid;html;value;urlValue">
    <div
        class="vis-widget <%== this.data.attr('class') %>"
        style="width:76px; height:76px;"
        id="<%= this.data.attr('wid') %>"
        data-oid="<%= this.data.attr('oid') %>"
        data-url-value="<%= this.data.attr('urlValue') %>"
        data-val="<%= this.data.attr('value') %>"
        <%= (el) -> vis.binds.basic.state(el) %>
        >
        <div class="vis-widget-body">
			<%== this.data.attr("html") %>
        </div>
    </div>
</script>

<script id="tplRedNumber"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val"
        data-vis-name="Red Number"
        data-vis-prev='<img src="widgets/basic/img/Prev_RedNumber.png"></img>'
        data-vis-attrs="oid;type[circle]/select,circle,pin;html_prepend;html_append_singular;html_append_plural">
    <% if (this.data.attr('type') === 'pin') { %>
        <div class="vis-widget <%== this.data.attr('class') %>" style="width: 33px; height: 61px; padding-left: 4px" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.hideOnFalse(el) %>>
            <div class="vis-widget-body" >
                <img src="widgets/basic/img/pin_red5.svg" style="width: 100%; height: 100%">
                <div style="position:absolute; top: 22%; width: 95%; text-align: center">
                    <%== this.data.attr('html_prepend') %><%= parseInt(vis.states.attr(this.data.oid + '.val'), 10) %><%== (parseInt(vis.states.attr(this.data.oid + '.val'), 10) === 1 ? this.data.attr("html_append_singular") : this.data.attr("html_append_plural")) %>
                </div>
            </div>
        </div>
    <% } else { %>
        <div class="vis-widget <%== this.data.attr('class') %>" style="padding: 3px; width: auto; min-width: 21px; height: 21px; border-radius:16px; border: 3px solid white; background-color: rgb(214, 69, 69); color:white; font:normal normal normal 20px/normal Helvetica; text-align: center;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.hideOnFalse(el) %>>
            <div class="vis-widget-body" >
                <%== this.data.attr('html_prepend') %><%= parseInt(vis.states.attr(this.data.oid + '.val'), 10) %><%== (parseInt(vis.states.attr(this.data.oid + '.val'), 10) === 1 ? this.data.attr("html_append_singular") : this.data.attr("html_append_plural")) %>
            </div>
        </div>
    <% } %>
</script>

<script id="tplBulbOnOffCtrl"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/basic/img/Prev_BulbOnOffCtrl.png"></img>'
        data-vis-set="basic"
        data-vis-type="ctrl"
        data-vis-name="Bulb on/off"
        data-vis-attrs="oid;min;max;icon_off[img~bulb_off.png]/image;icon_on[img~bulb_on.png]/image;readOnly/checkbox;"
        data-vis-attrs0="group.ccontrol;urlTrue;urlFalse;oidTrue/id;oidFalse/id;oidTrueValue;oidFalseValue;"
>
    <div
        data-oid="<%= this.data.attr('oid') %>"
        class="vis-widget <%== this.data.attr('class') %>"
        id="<%= this.data.attr('wid') %>"
        style="width: 44px; height: 59px"
        data-read-only="<%=  this.data.attr('readOnly') %>"
        data-min="<%= this.data.attr('min') %>"
        data-max="<%= this.data.attr('max') %>"
        data-url-true="<%=  this.data.attr('urlTrue') %>"
        data-url-false="<%= this.data.attr('urlFalse') %>"
        data-oid-true="<%=  this.data.attr('oidTrue') %>"
        data-oid-false="<%= this.data.attr('oidFalse') %>"
        data-oid-true-value="<%=  this.data.attr('oidTrueValue') %>"
        data-oid-false-value="<%= this.data.attr('oidFalseValue') %>"
        <%= (el) -> vis.binds.basic.toggle(el) %>
        >
        <div class="vis-widget-body">
            <% if (vis.binds.basic.isFalse(vis.states.attr(this.data.oid + '.val'), this.data.attr('min'), this.data.attr('max'))) { %>
                <img src="<%== this.data.attr('icon_off') ? this.data.attr('icon_off') : 'img/bulb_off.png' %>" width="100%"/>
            <% } else { %>
                <img src="<%== this.data.attr('icon_on') ? this.data.attr('icon_on') : 'img/icon_on.png' %>" width="100%"/>
            <% } %>
        </div>
    </div>
</script>

<script id="tplValueFloatBar"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val,bar"
        data-vis-name="Bar"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueFloatBar.png"></img>'
        data-vis-attrs="oid;min[0];max[100];orientation[horizontal]/select,horizontal,vertical/onOrientation;color[blue]/color;border;shadow;reverse/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 240px; height: 20px; border: 1px solid #888" id="<%= this.data.attr('wid') %>">
        <div data-oid="<%= this.data.attr('oid') %>" class="vis-widget-body"
        style="<%= (this.data.attr('orientation') === 'vertical') ? ('height: ' + vis.binds.basic.getCalc(this.data) + ';' + ((this.data.border) ? ' width:  calc(100% - ' + vis.binds.basic.extractWidth(this.data.border, 2) + ');' : '') + (this.data.reverse === 'true' || this.data.reverse === true ? 'left: 0px; position: absolute; bottom: 0%;' : '')) : (((this.data.border) ? " height: calc(100% - " + vis.binds.basic.extractWidth(this.data.border, 2) + ');' : '') + 'width: ' + vis.binds.basic.getCalc(this.data) + ';' + (this.data.reverse === 'true' || this.data.reverse === true ? 'float: right; ' : '')) %>background-color:<%= this.data.color %>; border: <%= this.data.border %>; box-shadow: <%= this.data.shadow %>"></div>
    </div>
</script>

<script id="tplNote"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val"
        data-vis-name="Note"
        data-vis-prev='<img src="widgets/basic/img/Prev_Note.png"></img>'
        data-vis-attrs="oid;max_width[300];html_prepend;html_append;test_text">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:50px; height:50px; border:1px solid #888; background: rgba(255,255,105,0.8)" id="<%= this.data.attr('wid') %>" onclick="vis.binds.basic.editNote('<%= this.data.attr('wid') %>', '<%= this.data.attr('max_width') %>', '<%= this.data.attr('min_width') %>', '<%= this.data.attr('min_height') %>', '<%= this.data.attr('oid') %>')">
		<div data-oid="<%= this.data.attr('oid') %>" id="div_<%= this.data.attr('wid') %>" style="padding: 10px">
			<%== this.data.attr('html_prepend') %><%= (this.data.test_text && vis.editMode) ? this.data.test_text : (vis.states.attr(this.data.oid + '.val') == null ? "" : vis.states.attr(this.data.oid + '.val')) %><%== this.data.attr('html_append') %>
		</div>
    </div>
</script>

<script id="tplTableBody"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="json,table"
        data-vis-name="Table"
        data-vis-prev='<img src="widgets/basic/img/Prev_TableBody.png"></img>'
        data-vis-attrs="table_oid/id;"
        data-vis-attrs0="static_value[[{^Title^: ^first^, ^Value^: 1, ^_Description^: ^Value1^}, {^Title^: ^second^, ^Value^: 2, ^_Description^: ^Value2^}]]/text;"
        data-vis-attrs1="event_oid/id;new_on_top/checkbox;ack_oid/id;selected_oid/id;hide_header/checkbox;show_scroll/checkbox;detailed_wid/widget;max_rows/number;"
        data-vis-attrs2="colCount/number;group.header/byindex;colName(1-colCount);colWidth(1-colCount);colAttr(1-colCount);"
        data-vis-attrs-not-used="btn_print;view_for_print/views"
>
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width: 300px; height: 150px; background: #d3d3d3">
       <% vis.binds.table.showTable(this.view, this.data.attr('wid'), this.data); %>
    </div>
</script>

<script id="tplHtmlLogout"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="tools"
        data-vis-prev='<img src="widgets/basic/img/Prev_HtmlLogout.png"></img>'
        data-vis-name="HTML logout"
        data-vis-attrs="html[<button style=^cursor: pointer^>Logout</button>]/text;redirect_url;in_app_close/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 70px; height: 30px; cursor: pointer" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.basic.logout(el, this.data) %> >
        <div class="vis-widget-body">
            <%== this.data.attr('html') %>
        </div>
    </div>
</script>

<!--script id="tplDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="table"
        data-vis-name="Dialog"
        data-vis-attrs="show/checkbox;trigger_id/id;button(1-3);title;text;image/image;width[400]/slider,50,1000,10;height[200]/slider,50,1000,10;modal/checkbox;_no_style[true]/hidden;_no_move[true]/hidden;_no_resize[true]/hidden;margin_left[0]/slider,0,200,1;margin_top[0]/slider,0,200,1"
        >
    <%
        var options =  {
            trigger_id:  this.data.attr('trigger_id'),
            buttons:     [this.data.attr('button1'), this.data.attr('button2'), this.data.attr('button3')],
            image:       this.data.attr('image'),
            title:       this.data.attr('title'),
            text:        this.data.attr('text'),
            width:       this.data.attr('width'),
            height:      this.data.attr('height'),
            show:        this.data.attr('show'),
            modal:       this.data.attr('modal'),
            margin_left: this.data.attr('margin_left'),
            margin_top:  this.data.attr('margin_top')
        };
        vis.binds.table.showDialog(this.view, this.data.attr('wid'), options);
    %>
</script-->

<script id="tplValueGesture"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val,tools"
        data-vis-prev='<img src="widgets/basic/img/Prev_ValueGesture.png"></img>'
        data-vis-name="Gesture indicator"
        data-vis-no-gestures="true"
        data-vis-attrs="html_prepend;html_append_singular;html_append_plural;group.extended;digits[0];is_comma[true]/checkbox;is_tdp/checkbox;factor[1];test_html">
    <div class="vis-widget <%== this.data.attr('class') %>" style="height: 21px; border: 1px solid #c7c7c7; border-radius: 5px; text-align: center; padding-top: 6px; box-shadow: 2px 2px 5px 1px gray; padding-left: 2px; padding-right: 2px; background: lightgray;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <% vis.binds.basic.createValueGesture(this.data.wid, this.view, this.data, this.style); %>
        </div>
    </div>
</script>

<script id="tplSpeech2Text"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-type="val"
        data-vis-prev='<img src="widgets/basic/img/Prev_Speech2Text.png"></img>'
        data-vis-name="Speech to text"
        data-vis-no-gestures="true"
        data-vis-attrs="oid;speechMode[single]/select,single,startstop,continuous;language/select,,en-US,de,ru-RU;keywords;"
        data-vis-attrs0="group.image;noImage/checkbox;imageInactive[widgets~basic~img~micInactive.svg]/image;imageActive[widgets~basic~img~micActive.svg]/image;imageStarted[widgets~basic~img~micStarted.svg]/image;imageDetected[widgets~basic~img~micDetected.svg]/image;imageSent[widgets~basic~img~micSent.svg]/image;imageHeightPx[70]/slider,0,200,1;imageWidthPx[70]/slider,0,200,1;"
        data-vis-attrs1="group.text;noText/checkbox;noResults/checkbox;keyWordColor[#FFB051]/color;textSentColor[#7E88D3]/color;">
    <div class="vis-widget <%== this.data.attr('class') %>" style="height: 77px; width: 500px" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <table style="height: 100%; width: 100%"><tr>
                <td style="<%= this.data.attr('noImage') ? 'display: none' : '' %>"><img class="mic-image" style="height: <%= this.data.attr('imageHeightPx') %>px; width: <%= this.data.attr('imageWidthPx') %>px" src="<%= this.data.attr('imageInactive') %>" /></td>
                <td class="mic-text" style="width: 100%">
                    <div class="mic-info-text" style="<%= this.data.attr('noText')    ? 'display: none' : '' %>"></div>
                    <div class="mic-results"   style="<%= this.data.attr('noResults') ? 'display: none' : '' %>"></div>
                </td>
            </tr></table>
        </div>
    </div>
    <% vis.binds.basic.speech2text(this.data.wid, this.view, this.data, this.style); %>
</script>

<script id="tplFullScreen"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/basic/img/Prev_FullScreen.png"></img>'
        data-vis-set="basic"
        data-vis-type="tools"
        data-vis-name="Full Screen"
        data-vis-attrs="">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:43px; height:43px; background: #AAAAAA; cursor: pointer; opacity: 0.9" id="<%= this.data.attr('wid') %>">
		<div class='vis-fullscreen-icon' style="padding: 10px"></div>
		<%= vis.binds.basic.toggleFullScreen(this.data.wid, this.view, this.data, this.style); %>
    </div>
</script>

<script id="tplScreenResolution"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/basic/img/Prev_ScreenResolution.png"></img>'
        data-vis-set="basic"
        data-vis-type="tools"
        data-vis-name="Screen Resolution"
        data-vis-attrs="">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:170px; height:75px; border: 1px solid #888; font-size: 12px; opacity: 0.8" id="<%= this.data.attr('wid') %>">
		<div id="div_<%= this.data.attr('wid') %>" style="padding: 10px">
			Default view: <span class='vis-resolution-default-view'></span><br>
			Width: <span class='vis-resolution-width'></span><br>
			Height: <span class='vis-resolution-height'></span><br>
			Instance: <span><%== vis.instance ? vis.instance : vis.binds.basic.createScreenText() %></span>
		</div>
		<%= vis.binds.basic.detectScreen(this.data.attr('wid')) %>
    </div>
</script>


<script id="_tplGroup"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="basic"
        data-vis-attrs="group.objects;attrCount[1]/slider,0,20,1;attrName(1-attrCount)//onAttrChanged;attrType(1-attrCount)/select,,id,checkbox,image,color,views,html,widget,history/onAttrChanged;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow: visible" id="<%= this.data.attr('wid') %>"></div>
</script>

<!-- --------------basic.html--- END -->
<!-- --------------bring.html--- START -->
<!--
    ioBroker.vis Bring! Widget

    version: "0.0.1"

    Copyright 2019 Moritz Heusinger moritz.heusinger@gmail.com
-->

<link rel="stylesheet" type="text/css" href="widgets/bring/css/stylesheet.css">
<script type="text/javascript" src="widgets/bring/js/textFit.min.js"></script>
<!-- the full description of format in data-vis-attrs can be found here:
    https://github.com/ioBroker/ioBroker.vis/blob/master/www/js/visEditInspect.js#L39

    ----------------------------------------------------------
    Mandatory XML attributes:
        id="tplTemplateWIDGETNAME"
        type="text/ejs"
        class="vis-tpl"

        "type" and "class" are always the same. "id" is unique and must start with "tplSETNAME" and ends with widget name. Use camel-case for it.

    ----------------------------------------------------------
    data-vis-attrs - divided with semicolon the list of attributes, like attr1/id;attr2/color
        Full format of one attribute is: attr_name(start-end)[default_value]/type,idFilter/onChangeFunc
            attr_name - the name of the attribute, e.g. "myID"
            start-end - creates automatically attributes from attr_namestart to attr_nameend, like "myID(1-3)" creates myID1, myID2, myID3
            default_value - by creation of widget this attribute will be filled with this value, e.g. "myID[#001122]/color"
            type - some predefined types have edit helpers, else it will be shown as text field

                Type format:
                      id - Object ID Dialog
                      checkbox
                      image - image
                      number,min,max,step - non-float number. min,max,step are optional
                      color - color picker
                      views - Name of the view
                      effect - jquery UI show/hide effects
                      eff_opt - additional option to effect slide (up, down, left, right)
                      fontName - Font name
                      slider,min,max,step - Default step is ((max - min) / 100)
                      select,value1,value2,... - dropdown select
                      nselect,value1,value2,... - same as select, but without translation of items
                      style,fileFilter,nameFilter,attrFilter
                      custom,functionName,options,... - custom editor - functionName is starting from vis.binds.[widgetset.funct]. E.g. custom/timeAndWeather.editWeather,short
                      group.name - define new or old group. All following attributes belongs to new group till new group.xyz
                      group.name/byindex - like group, but all following attributes will be grouped by ID. Like group.windows/byindex;slide(1-4)/id;slide_type(1-4)/select,open,closed  Following groups will be created Windows1(slide1,slide_type1), Windows2(slide2,slide_type2), Windows3(slide3,slide_type3), Windows4(slide4,slide_type4)
                      text - dialog box with html editor
                      html - dialog box with html editor

                If type is "id", you can define filer for "Select ID Dialog", like "myID/id,level.temperature".
                Additionally you can define callback(onChangeFunc), which will be called if this attribute was changed by user for different purposes: validate entry, fill other attributes, ...

        You can define additional data-vis-attrs line: data-vis-attrs0, data-vis-attrs1. Anyway data-vis-attrs must be there. You may not skip numbers.
        E.g. in "data-vis-attrs="A;" data-vis-attrs1="B" attribute B will be not parsed.

    --------------------------------------------------------
    data-vis-type
        Help information for user. Used for search.
        You can define more than one type divided by comma.
        There are following common types, but you can use your own specific types:
            ctrl   - widget that can write some Object IDs
            val    - widget that shows some information from Object IDs
            static - widget do not read information from Object IDs or URL
            button - button widget
            dimmer - dimmer widget
            weather - weather widget
            ...

    --------------------------------------------------------
    data-vis-set
        Name of the widget set. Must be equal to the name of this HTML file

    --------------------------------------------------------
    data-vis-prev
        Html code used as preview of this widget. If widget is complex you can just use image as preview:
        data-vis-prev='<img src="widgets/hqwidgets/img/prev/Prev_tplTemplateShowInstance.png"></img>'
        Of course the image must exist.

    --------------------------------------------------------
    data-vis-name
        Readable name of widget shown in vis editor.

    --------------------------------------------------------
    data-vis-beta="true"
        Shows "BETA" symbol in vis editor by preview

    --------------------------------------------------------
    data-vis-update-style="true"
        Call redraw of widget if some of the CSS styles in editor for this widget was changed
-->

<script type="text/javascript">
    'use strict';
    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {
            "oid-list": {
                "en": "List ID",
                "de": "Listen ID",
                "ru": "ID списка",
                "pt": "ID da lista",
                "nl": "Lijst ID",
                "fr": "ID de liste",
                "it": "Elenco ID",
                "es": "ID de lista",
                "pl": "ID listy",
                "zh-cn": "清单ID"
            },
            "text-for-adding": {
                "en": "Placeholder for adding",
                "de": "Platzhalter zum Hinzufügen",
                "ru": "Заполнитель для добавления",
                "pt": "Placeholder para adicionar",
                "nl": "Tijdelijke aanduiding voor toevoegen",
                "fr": "Espace réservé pour l'ajout",
                "it": "Segnaposto per l'aggiunta",
                "es": "Marcador de posición para añadir",
                "pl": "Symbol zastępczy do dodania",
                "zh-cn": "占位符用于添加"
            },
            "max-width-item": {
                "en": "Width and Height per Item in px",
                "de": "Breite und Höhe pro Artikel in px",
                "ru": "Ширина и высота на элемент в пикселях",
                "pt": "Largura e altura por item em px",
                "nl": "Breedte en hoogte per item in px",
                "fr": "Largeur et hauteur par élément en px",
                "it": "Larghezza e Altezza per Articolo in px",
                "es": "Ancho y alto por articulo en px",
                "pl": "Szerokość i wysokość na element w px",
                "zh-cn": "px中每个项目的宽度和高度"
            }
        });
    }

    var addedLastFiveSeconds = {};
    var removedLastFiveSeconds = {};
    var bringDict = {};
    var bringInvertedDict = {};
    var bringRemoveId = {};
    var bringSaveId = {};
    var bringRecentListId = {};
    var bringListId = {};
    var bringOnChange = {};
    var bringCheckItemsTimer = {};
    var bringCheckRecentTimer = {};

    // Binding to communicate with ejs script
    vis.binds['bring'] = {
        onclick: function (el) {
            var $el = $(el);

            if ($el.data('item')) {
                var item = $el.data('item').replace(/_/g, ' ');
                var wid = $el.attr('id').split('-')[0];

                vis.conn.setState(bringRemoveId[wid], item, false);

                removedLastFiveSeconds[wid][item] = true;
                setTimeout(function () {
                    removedLastFiveSeconds[wid][item] = false;
                }, 5000);

                $el.remove();

                // now we add this item to recent content
                $el.addClass('bring-recent-item').removeClass('bring-item');
                var prevData = $el.data('item');

                // remove item data from cache and corresponding attribute
                $el.removeAttr('data-item');
                $el.removeData('item');
                var prevId = $el.attr('id').substring(wid.length + 1);
                $el.attr('id', wid + '-recent_' + prevId);
                $el.attr('data-recentitem', prevData);
                $('#' + wid + '-recentlist').prepend($el);
            } else {
                var recentItem = $el.data('recentitem').replace(/_/g, ' ');
                var desc = $el.data('desc').toString();
                var wid = $el.attr('id').split('-')[0];
                $el.remove();
                saveItem(recentItem, desc, wid);
            } // endElse
        }
    };

    /*
    *   Add new item to list
    **/
    function saveItem(item, desc, wid) {
        var $save = $('#' + wid + '-save');
        var maxWidth = vis.widgets[wid].data['max-width-item'];

        item = item ? item : $save.val();
        var itemWoDescription = $save.val().length && bringInvertedDict[wid][item.split(',')[0]] ? bringInvertedDict[wid][item.split(',')[0]] : item.split(',')[0];
        $save.val('');

        // return on empty form
        if (item === '') return;

        // get current list
        vis.conn.getStates(bringListId[wid], function (err, states) {
            var currentList = JSON.parse(states[bringListId[wid]].val);
            var itemWoDescriptionReplaced = itemWoDescription.replace(/ /g, '_');
            desc = desc ? desc : (item.split(',').length > 1) ? item.substring(item.indexOf(',') + 1).trim() : '';
            var existence = document.getElementById(wid + '-' + itemWoDescriptionReplaced);
            var currentDesc = existence ? existence.getAttribute('data-desc') : null;

            // Translate to list language
            var nameFromDict = bringDict[wid][itemWoDescription] ? bringDict[wid][itemWoDescription] : itemWoDescription;

            // set state in backend - do this before existence check because description may have changed
            vis.conn.setState(bringSaveId[wid], itemWoDescription + (desc ? ',' + desc : ''), false);

            // if item is already on list --> return
            for (var i = 0; i < currentList.length; i++) {
                if (((currentList[i].name === itemWoDescription && currentList[i].specification === desc) && !removedLastFiveSeconds[wid][itemWoDescription])
                    || (existence !== null && (desc === currentDesc))) return;
            } // endFor

            var alternative = nameFromDict.substring(0, 1).toLowerCase();
            if (/^(ä|ö|ü)/g.test(alternative)) {
                alternative = alternative.replace(/ä/g, 'ae').replace(/ö/g, 'oe').replace(/ü/g, 'ue');
            } // endIf

            addedLastFiveSeconds[wid][item] = true;
            setTimeout(function () {
                addedLastFiveSeconds[wid][item] = false;
            }, 5000);

            // if item is there but description changed, remove item
            if (currentDesc !== null && (desc !== currentDesc)) existence && existence.parentNode && existence.parentNode.removeChild(existence);

            // if item exists in recent items --> remove it because it is now on active items list
            $('#' + wid + '-recent_' + itemWoDescription.replace(/ /g, '_')).remove();

            // add item instant to widget
            var html = '<div class="bring-item" data-desc="' + desc + '" id=' + wid + '-' + itemWoDescriptionReplaced +
                ' onclick="vis.binds[\'bring\'].onclick(this)" ' +
                'style="max-width: ' + maxWidth + 'px; min-width: ' + maxWidth + 'px; ' +
                'max-height: ' + maxWidth + 'px; min-height: ' + maxWidth + 'px;"' +
                ' data-item="' + itemWoDescription.replace(/ /g, '_') + '"> ' +
                '<img src="https://web.getbring.com/assets/images/items/' + itemWoDescriptionReplaced.toLowerCase()
                    .replace(/ä/g, 'ae').replace(/ö/g, 'oe').replace(/ü/g, 'ue') + '.png" ' +
                'onerror="this.src=\'https://web.getbring.com/assets/images/items/' + alternative + '.png\'" ' +
                'alt=' + itemWoDescription + ' class="item-image" id="' + wid + '-img-' + itemWoDescriptionReplaced + '"' +
                'style="height: calc(0.43 * ' + maxWidth + 'px); padding-top: calc(0.172 * ' + maxWidth + 'px)">' +
                '<div class="item-name" style="height: calc(0.2013 * ' + maxWidth + 'px);' +
                'margin-top: calc(-0.0431 * ' + maxWidth + 'px;">' +
                nameFromDict +
                '</div>' +
                '<div class="item-desc" style="height: calc(0.2155 * ' + maxWidth + 'px);' +
                'margin-top:calc(-0.0431 * ' + maxWidth + 'px);">' +
                desc +
                '</div></div>';

            $('#' + wid + '-shoppinglist').append(html);

            item = document.getElementById(wid + '-' + itemWoDescriptionReplaced);
            try {
                // resize item name
                var resizeText = item.getElementsByClassName('item-name')[0];
                textFit(resizeText, {maxFontSize: 0.112 * maxWidth, detectMultiLine: false});

                // resize item desc
                var resizeItemDesc = item.getElementsByClassName('item-desc')[0];
                textFit(resizeItemDesc, {maxFontSize: 0.0948 * maxWidth, detectMultiLine: false});
            } catch (e) {
                console.warn(new Date().toLocaleTimeString() + ' Bring[' + wid + ']: Cannot resize text for item ' + wid + '-' + itemWoDescriptionReplaced + ': ' + e);
            } // endCatch
        });
    } // endSaveItem

    /*
    *   Update current items
    **/
    function checkItems(wid) {
        console.log(new Date().toLocaleTimeString() + ' Bring[' + wid + ']: Checking Items');
        var newItems = [];
        var spec = [];
        var knownList = [];
        var knownSpec = [];
        var maxWidth = vis.widgets[wid].data['max-width-item'];

        // get current list
        var newList = JSON.parse(vis.states[bringListId[wid] + '.val']);

        $('.bring-item').each(function () {
            if (this.id.startsWith(wid)) {
                var stillOnList = false;
                var itemIdFixed = this.id.replace(/_/g, ' ').substring(wid.length + 1);
                knownList.push(itemIdFixed);
                knownSpec.push($(this).data('desc').toString());

                for (var i = 0; i < newList.length; i++) {
                    if (newList[i].name === itemIdFixed) {
                        stillOnList = true;
                        break;
                    } // endIf
                } // endFor

                // if item is not on list anymore and is not newly added --> remove
                if (!stillOnList && !(addedLastFiveSeconds[wid][this.id.replace(/_/g, ' ')])) {
                    $(this).remove();
                    removedLastFiveSeconds[wid][this.id] = true;
                    setTimeout(function () {
                        removedLastFiveSeconds[wid][this.id] = false;
                    }, 5000);
                } // endIf
            } // endIf
        });

        for (var j = 0; j < newList.length; j++) {
            var itemName = newList[j].name;
            var specification = newList[j].specification;
            var index = knownList.indexOf(itemName);
            if (index < 0) {
                // new Item found
                newItems.push(itemName);
                spec.push(specification);
            } else if (knownSpec[index] !== specification) {
                // if specification has changed, rm old item and add with new description
                newItems.push(itemName);
                spec.push(specification);
                $('#' + wid + '-' + itemName.replace(/ /g, '_')).remove();
            }
        } // endFor

        var alternative;
        for (var k = 0; k < newItems.length; k++) {
            // if item was rm recently backend doesn't know yet so do not add it again
            if (removedLastFiveSeconds[wid][newItems[k]]) continue;
            var nameFromDict = bringDict[wid][newItems[k]] ? bringDict[wid][newItems[k]] : newItems[k];
            alternative = nameFromDict.substring(0, 1).toLowerCase();
            if (/^(ä|ö|ü)/g.test(alternative)) {
                alternative = alternative.replace(/ä/g, 'ae').replace(/ö/g, 'oe').replace(/ü/g, 'ue');
            } // endIf

            var newItemReplaced = newItems[k].replace(/ /g, '_');

            var html = '<div class="bring-item" data-desc="' + spec[k] + '" id=' + wid + '-' + newItemReplaced +
                ' onclick="vis.binds[\'bring\'].onclick(this)" ' +
                'style="max-width: ' + maxWidth + 'px; min-width: ' + maxWidth + 'px; ' +
                'max-height: ' + maxWidth + 'px; min-height: ' + maxWidth + 'px;"' +
                ' data-item="' + newItems[k].replace(/ /g, '_') + '"> ' +
                '<img src="https://web.getbring.com/assets/images/items/' + newItemReplaced.toLowerCase()
                    .replace(/ä/g, 'ae').replace(/ö/g, 'oe').replace(/ü/g, 'ue') + '.png" ' +
                'onerror="this.src=\'https://web.getbring.com/assets/images/items/' + alternative + '.png\'" ' +
                'alt=' + newItems[k] + ' class="item-image" id="' + wid + '-img-' + newItemReplaced + '"' +
                'style="height: calc(0.43 * ' + maxWidth + 'px); padding-top: calc(0.172 * ' + maxWidth + 'px)">' +
                '<div class="item-name" style="height: calc(0.2013 * ' + maxWidth + 'px);' +
                'margin-top: calc(-0.0431 * ' + maxWidth + 'px;">' +
                nameFromDict + '</div>' +
                '<div class="item-desc" style="height: calc(0.2155 * ' + maxWidth + 'px);' +
                'margin-top:calc(-0.0431 * ' + maxWidth + 'px);">' +
                spec[k] + '</div></div>';

            $('#' + wid + '-shoppinglist').append(html);

            var item = document.getElementById(wid + '-' + newItemReplaced);
            try {
                // resize item name
                var resizeText = item.getElementsByClassName('item-name')[0];
                textFit(resizeText, {maxFontSize: 0.112 * maxWidth, detectMultiLine: false});
                // resize item desc
                var resizeItemDesc = item.getElementsByClassName('item-desc')[0];
                textFit(resizeItemDesc, {maxFontSize: 0.0948 * maxWidth, detectMultiLine: false});
            } catch (e) {
                console.warn(new Date().toLocaleTimeString() + ' Bring[' + wid + ']: Cannot resize text for item ' + wid + '-' + newItemReplaced + ': ' + e);
            } // endCatch
        } // endFor
    } // endCheckItems

    /*
    *   Update the recent items
    **/
    function checkRecentItems(wid) {
        console.log(new Date().toLocaleTimeString() + ' Bring[' + wid + ']: Checking Recent Items');
        var newItems = [];
        var spec = [];
        var knownList = [];
        var knownSpec = [];
        var maxWidth = vis.widgets[wid].data['max-width-item'];

        // get recentList
        var newList = JSON.parse(vis.states[bringRecentListId[wid] + '.val']);

        $('.bring-recent-item').each(function (index) {
            if (this.id.startsWith(wid)) {
                var stillOnList = false;
                var itemIdFixed = this.id.substring(14).replace(/_/g, ' ');
                knownList.push(itemIdFixed);
                knownSpec.push($(this).data('desc').toString());

                for (var i = 0; i < newList.length; i++) {
                    if (newList[i].name === itemIdFixed) {
                        stillOnList = true;
                        break;
                    } // endIf
                } // endFor

                // if item is not on list anymore --> remove
                if (!stillOnList) {
                    $(this).remove();
                } // endIf
            } // endIf
        });

        for (var j = 0; j < newList.length; j++) {
            var itemName = newList[j].name;
            var specification = newList[j].specification;
            var index = knownList.indexOf(itemName);
            if (index < 0) {
                // new Item found
                newItems.push(itemName);
                spec.push(specification);
            } else if (knownSpec[index] !== specification) {
                // if specification has changed, rm old item and add with new description
                newItems.push(itemName);
                spec.push(specification);
                $('#' + wid + '-recent_' + itemName.replace(/ /g, '_')).remove();
            }
        } // endFor

        var alternative;
        for (var k = 0; k < newItems.length; k++) {
            // if item was rm recently backend doesn't know yet so do not add it again
            var newItemReplaced = newItems[k].replace(/ /g, '_');
            var nameFromDict = bringDict[wid][newItems[k]] ? bringDict[wid][newItems[k]] : newItems[k];
            alternative = nameFromDict.substring(0, 1).toLowerCase();

            if (/^(ä|ö|ü)/g.test(alternative)) {
                alternative = alternative.replace(/ä/g, 'ae').replace(/ö/g, 'oe').replace(/ü/g, 'ue');
            }

            var html = '<div class="bring-recent-item" data-desc="' + spec[k] + '" id="' + wid + '-recent_' + newItemReplaced + '"' +
                ' onclick="vis.binds[\'bring\'].onclick(this)" ' +
                'style="max-width: ' + maxWidth + 'px; min-width: ' + maxWidth + 'px; ' +
                'max-height: ' + maxWidth + 'px; min-height: ' + maxWidth + 'px;"' +
                ' data-recentitem="' + newItemReplaced + '"> ' +
                '<img src="https://web.getbring.com/assets/images/items/' + newItemReplaced.toLowerCase()
                    .replace(/ä/g, 'ae').replace(/ö/g, 'oe').replace(/ü/g, 'ue') + '.png" ' +
                'onerror="this.src=\'https://web.getbring.com/assets/images/items/' + alternative + '.png\'" ' +
                'alt=' + newItems[k] + ' class="item-image" id="' + wid + '-img-' + newItemReplaced + '"' +
                'style="height: calc(0.43 * ' + maxWidth + 'px); padding-top: calc(0.172 * ' + maxWidth + 'px)">' +
                '<div class="item-name" style="height: calc(0.2013 * ' + maxWidth + 'px);' +
                'margin-top: calc(-0.0431 * ' + maxWidth + 'px;">' +
                nameFromDict + '</div>' +
                '<div class="item-desc" style="height: calc(0.2155 * ' + maxWidth + 'px);' +
                'margin-top:calc(-0.0431 * ' + maxWidth + 'px);">' +
                spec[k] + '</div></div>';

            $('#' + wid + '-recentlist').append(html);

            var item = document.getElementById(wid + '-recent_' + newItemReplaced);
            try {
                // resize item name
                var resizeText = item.getElementsByClassName('item-name')[0];
                textFit(resizeText, {maxFontSize: 0.112 * maxWidth, detectMultiLine: false});
                // resize item desc
                var resizeItemDesc = item.getElementsByClassName('item-desc')[0];
                textFit(resizeItemDesc, {maxFontSize: 0.0948 * maxWidth, detectMultiLine: false});
            } catch (e) {
                console.warn(new Date().toLocaleTimeString() + ' Bring[' + wid + ']: Cannot resize text for item ' + wid + '-' + newItemReplaced + ': ' + e);
            } // endCatch
        } // endFor
    } // endCheckRecentItems

    /*
    *   Render page and do init
    **/
    function renderPage(wid) {
        var listNamespace = vis.widgets[wid].data['oid-list'];

        console.log(new Date().toLocaleTimeString() + ' Bring[' + wid + ']: Render Widget');

        // Register event handlers for widget
        $('#' + wid + '-save').keypress(function (event) {
            if (event.which !== 13) return;
            saveItem(null, null, wid);
        });

        $('#' + wid+ '-addButton').click(function () {
            saveItem(null, null, wid);
        });

        // create lastFiveSecond states for wid
        removedLastFiveSeconds[wid] = [];
        addedLastFiveSeconds[wid] = [];

        console.log(new Date().toLocaleTimeString() + ' Bring[' + wid + ']: Registered Event Handlers');

        // create individual onChange func that knows the wid
        bringOnChange[wid] = function (obj) {
            // if content changed call check items, else checkRecentItems
            if (obj.type.split('.')[3] === 'content') {
                if (bringCheckItemsTimer[wid]) clearTimeout(bringCheckItemsTimer[wid]);
                bringCheckItemsTimer[wid] = setTimeout(function () {checkItems(wid)}, 5000);
            } else {
                if (bringCheckRecentTimer[wid]) clearTimeout(bringCheckRecentTimer[wid]);
                bringCheckRecentTimer[wid] = setTimeout(function () {checkRecentItems(wid)}, 5000);
            } // endElse
        };

        // create state ids
        bringRemoveId[wid] = listNamespace + '.moveToRecentContent';
        bringSaveId[wid] = listNamespace + '.saveItem';
        bringRecentListId[wid] = listNamespace + '.recentContent';
        bringListId[wid] = listNamespace + '.content';

        // Get translations
        vis.conn.getStates(listNamespace + '.translation', function (err, states) {
            if (err) console.error(new Date().toLocaleTimeString() + ' Bring[' + wid + ']: Cannot get translations: ' + err);
            try {
                bringDict[wid] = !err ? JSON.parse(states[listNamespace + '.translation'].val) : {};
                bringInvertedDict[wid] = !err ? swap(bringDict[wid]) : {};
            } catch (e) {
                console.error(new Date().toLocaleTimeString() + ' Bring[' + wid + ']: Cannot parse translations: ' + e);
                bringDict[wid] = {};
                bringInvertedDict[wid] = {};
            } // endCatch

            var dps = [bringListId[wid], bringRecentListId[wid]];

            // Update states and subscribe to changes
            vis.conn.getStates(dps, function (error, states) {
                vis.updateStates(states);
                vis.conn.subscribe(dps);

                // ad onChange listener
                for (var i = 0; i < dps.length; i++) {
                    dps[i] = dps[i] + '.val';
                    vis.states.bind(dps[i], bringOnChange[wid]);
                } // endFor

                // give vis ability to destroy on change
                var $div = $('#' + wid);
                $div.data('bound', dps);
                $div.data('bindHandler', bringOnChange[wid]);

                checkItems(wid);
                checkRecentItems(wid);
            });
        });
    } // endRenderPage

    /*
    *   Swap key value of JSON
    **/
    function swap(json){
        var ret = {};
        for(var key in json){
            ret[json[key]] = key;
        }
        return ret;
    } // endSwap
</script>

<script id="tplBringShoppingList"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/bring/img/shopping-list.png"></img>'
        data-vis-attrs="oid-list/id,list.json;text-for-adding/text;max-width-item[116]/number"
        data-vis-set="bring"
        data-vis-type="ctrl"
        data-vis-update-style="true"
        data-vis-name="bring-shopping-list">
        <div class="vis-widget <%== this.data.attr('class') %>" style="width:230px; height:210px; min-width:145px;" id="<%= this.data.attr('wid'); %>" >
        <div style="height: 45px; margin-bottom: 10px; padding-right: 10px;">
            <input type="text" placeholder="<%= this.data['text-for-adding'] %>" id="<%= this.data.attr('wid') %>-save" class="addArticleText" name="addArticle">
            <input type="image" src="widgets/bring/img/add.svg" id="<%= this.data.attr('wid') %>-addButton" class="addButton"/>
        </div>
        <div class="template-class vis-widget-body <%== this.data.attr('class') %>">
              <div id="<%= this.data.attr('wid') %>-shoppinglist" style="min-width: 100%; padding: 2px;">
              </div>
              <div style="clear: both;"></div>
              <hr style="margin-top: 5px; margin-bottom:5px;width:70%;text-align:center;">
              <div id="<%= this.data.attr('wid') %>-recentlist" style="min-width: 100%; padding: 2px; max-height: auto; overflow: hidden;">
              </div>
        </div>
    </div>
    <% setTimeout(renderPage, 50, this.data.attr('wid')); %>
</script>

<!-- --------------bring.html--- END -->
<!-- --------------canvas-gauges.html--- START -->
<!--
    ioBroker.vis-canvas-gauges

    version: "0.1.5"

    Copyright 2016 bluefox<dogafox@gmail.com>

-->
<script type="text/javascript" src="widgets/canvas-gauges/js/gauge.min.js"></script>

<script language="javascript">
    'use strict';
    // Add words for bars
    if (vis.editMode) {
        $.extend(systemDictionary, {
            "linear":           {"en": "linear",            "de": "linear", "ru": "linear"},
            "quad":             {"en": "quad",              "de": "quad", "ru": "quad"},
            "quint":            {"en": "quint",             "de": "quint", "ru": "quint"},
            "cycle":            {"en": "cycle",             "de": "cycle", "ru": "cycle"},
            "elastic":          {"en": "elastic",           "de": "elastic", "ru": "elastic"},
            "dequad":           {"en": "dequad",            "de": "dequad", "ru": "dequad"},
            "dequint":          {"en": "dequint",           "de": "dequint", "ru": "dequint"},
            "decycle":          {"en": "decycle",           "de": "decycle", "ru": "decycle"},
            "debounce":         {"en": "debounce",          "de": "debounce", "ru": "debounce"},
            "delastic":         {"en": "delastic",          "de": "delastic", "ru": "delastic"},
            "arrow":            {"en": "arrow",             "de": "arrow", "ru": "arrow"},
            "minValue":         {"en": "min",               "de": "min", "ru": "minValue"},
            "maxValue":         {"en": "max",               "de": "max", "ru": "maxValue"},
            "valueOffset":      {"en": "Value offset",      "de": "Wertoffset", "ru": "valueOffset"},
            "hCount":           {"en": "Highlights number", "de": "Anzahl von Sektoren", "ru": "Кол-во секторов"},
            "group_highlights": {"en": "Highlights",        "de": "Sektoren",       "ru": "Сектора"},
            "highlightsFrom":   {"en": "From",              "de": "Von",            "ru": "highlightsFrom"},
            "highlightsTo":     {"en": "To",                "de": "Bis",            "ru": "highlightsTo"},
            "highlightsColor":  {"en": "Color",             "de": "Farbe",          "ru": "highlightsColor"},
            "majorTicks":       {"en": "Major ticks",       "de": "majorTicks",     "ru": "majorTicks"},
            "minorTicks":       {"en": "Minor ticks",       "de": "minorTicks",     "ru": "minorTicks"},
            "strokeTicks":      {"en": "Stroke ticks",      "de": "strokeTicks",        "ru": "strokeTicks"},
            "majorTicksInt":    {"en": "Before comma ",     "de": "majorTicksInt",      "ru": "majorTicksInt"},
            "majorTicksDec":    {"en": "After comma",       "de": "majorTicksDec",      "ru": "majorTicksDec"},
            "group_animation":  {"en": "Animation",         "de": "group_animation",    "ru": "group_animation"},
            "animation":        {"en": "Enabled",           "de": "animation",          "ru": "animation"},
            "animationDuration": {"en": "Duration",         "de": "animationDuration", "ru": "animationDuration"},
            "animationRule":    {"en": "Rule",              "de": "animationRule", "ru": "animationRule"},
            "animatedValue":    {"en": "Value",             "de": "animatedValue", "ru": "animatedValue"},
            "animateOnInit":    {"en": "Animate on start",  "de": "animateOnInit", "ru": "animateOnInit"},
            "group_colorsGauge": {"en": "Colors",           "de": "Farben", "ru": "group_colorsGauge"},
            "colorPlate":       {"en": "Plate",             "de": "Plate", "ru": "colorPlate"},
            "colorPlateEnd":    {"en": "Plate end",         "de": "PlateEnd", "ru": "colorPlateEnd"},
            "colorMajorTicks":  {"en": "Major ticks",       "de": "MajorTicks", "ru": "colorMajorTicks"},
            "colorMinorTicks":  {"en": "Minor ticks",       "de": "MinorTicks", "ru": "colorMinorTicks"},
            "colorTitle":       {"en": "Title",             "de": "Title", "ru": "colorTitle"},
            "colorUnits":       {"en": "Units",             "de": "Units", "ru": "colorUnits"},
            "colorNumbers":     {"en": "Numbers",           "de": "Numbers", "ru": "colorNumbers"},
            "colorNeedle":      {"en": "Needle",            "de": "Needle", "ru": "colorNeedle"},
            "colorNeedleEnd":   {"en": "NeedleEnd",         "de": "NeedleEnd", "ru": "colorNeedleEnd"},
            "colorValueText":   {"en": "ValueText",         "de": "ValueText", "ru": "colorValueText"},
            "colorValueTextShadow":     {"en": "Value text shadow",     "de": "ValueTextShadow", "ru": "colorValueTextShadow"},
            "colorBorderShadow":        {"en": "Border shadow",         "de": "BorderShadow", "ru": "colorBorderShadow"},
            "colorBorderOuter":         {"en": "Border outer",          "de": "BorderOuter", "ru": "colorBorderOuter"},
            "colorBorderOuterEnd":      {"en": "Border outer end",      "de": "BorderOuterEnd", "ru": "colorBorderOuterEnd"},
            "colorBorderMiddle":        {"en": "Border middle",         "de": "BorderMiddle", "ru": "colorBorderMiddle"},
            "colorBorderMiddleEnd":     {"en": "Border middle end",     "de": "BorderMiddleEnd", "ru": "colorBorderMiddleEnd"},
            "colorBorderInner":         {"en": "Border inner",          "de": "BorderInner", "ru": "colorBorderInner"},
            "colorBorderInnerEnd":      {"en": "Border inner end",      "de": "BorderInnerEnd", "ru": "colorBorderInnerEnd"},
            "colorValueBoxRect":        {"en": "Value box rect",        "de": "ValueBoxRect", "ru": "colorValueBoxRect"},
            "colorValueBoxRectEnd":     {"en": "Value box rect end",    "de": "ValueBoxRectEnd", "ru": "colorValueBoxRectEnd"},
            "colorValueBoxBackground":  {"en": "Value box background",  "de": "ValueBoxBackground", "ru": "colorValueBoxBackground"},
            "colorValueBoxShadow":      {"en": "Value box shadow",      "de": "ValueBoxShadow", "ru": "colorValueBoxShadow"},
            "colorNeedleShadowUp":      {"en": "Needle shadow up",      "de": "NeedleShadowUp", "ru": "colorNeedleShadowUp"},
            "colorNeedleShadowDown":    {"en": "Needle shadow down",    "de": "NeedleShadowDown", "ru": "colorNeedleShadowDown"},
            "needle":           {"en": "Needle",            "de": "needle", "ru": "needle"},
            "needleShadow":     {"en": "NeedleShadow",      "de": "needleShadow", "ru": "needleShadow"},
            "needleType":       {"en": "NeedleType",        "de": "needleType", "ru": "needleType"},
            "needleStart":      {"en": "NeedleStart",       "de": "needleStart", "ru": "needleStart"},
            "needleEnd":        {"en": "NeedleEnd",         "de": "needleEnd", "ru": "needleEnd"},
            "needleWidth":      {"en": "NeedleWidth",       "de": "needleWidth", "ru": "needleWidth"},
            "group_borders":    {"en": "Borders",           "de": "Rahmen", "ru": "group_borders"},
            "borders":          {"en": "Enabled",           "de": "Aktiviert", "ru": "borders"},
            "borderOuterWidth": {"en": "Outer width",       "de": "borderOuterWidth", "ru": "borderOuterWidth"},
            "borderMiddleWidth": {"en": "Middle width",     "de": "borderMiddleWidth", "ru": "borderMiddleWidth"},
            "borderInnerWidth": {"en": "Inner width",       "de": "borderInnerWidth", "ru": "borderInnerWidth"},
            "borderShadowWidth": {"en": "Shadow width",     "de": "borderShadowWidth", "ru": "borderShadowWidth"},
            "group_valueBox":   {"en": "Value Box",         "de": "Wert-Box", "ru": "group_valueBox"},
            "valueBox":         {"en": "Enabled",           "de": "Aktiviert", "ru": "valueBox"},
            "valueBoxStroke":   {"en": "Box stroke",        "de": "valueBoxStroke", "ru": "valueBoxStroke"},
            "valueText":        {"en": "Text",              "de": "valueText", "ru": "valueText"},
            "valueTextShadow":  {"en": "Text shadow",       "de": "valueTextShadow", "ru": "valueTextShadow"},
            "valueBoxBorderRadius": {"en": "Box border radius", "de": "valueBoxBorderRadius", "ru": "valueBoxBorderRadius"},
            "valueInt":         {"en": "Before comma",      "de": "Vor Komma", "ru": "valueInt"},
            "valueDec":         {"en": "After comma",       "de": "Nach Komma", "ru": "valueDec"},
            "group_fonts":      {"en": "Fonts",             "de": "Schriften", "ru": "group_fonts"},
            "fontNumbers":      {"en": "Numbers",           "de": "Numbers", "ru": "fontNumbers"},
            "fontTitle":        {"en": "Title",             "de": "Title", "ru": "fontTitle"},
            "fontUnits":        {"en": "Units",             "de": "Units", "ru": "fontUnits"},
            "fontValue":        {"en": "Value",             "de": "Value", "ru": "fontValue"},
            "fontNumbersSize":  {"en": "Numbers size",      "de": "Numbers Size", "ru": "fontNumbersSize"},
            "fontTitleSize":    {"en": "Title size",        "de": "Title Size", "ru": "fontTitleSize"},
            "fontUnitsSize":    {"en": "Units size",        "de": "Units Size", "ru": "fontUnitsSize"},
            "fontValueSize":    {"en": "Value size",        "de": "Value Size", "ru": "fontValueSize"},
            "fontNumbersStyle": {"en": "Numbers style",     "de": "Numbers Style", "ru": "fontNumbersStyle"},
            "fontTitleStyle":   {"en": "Title style",       "de": "Title Style", "ru": "fontTitleStyle"},
            "fontUnitsStyle":   {"en": "Units style",       "de": "Units Style", "ru": "fontUnitsStyle"},
            "fontValueStyle":   {"en": "Value style",       "de": "Value Style", "ru": "fontValueStyle"},
            "fontNumbersWeight": {"en": "Numbers weight",   "de": "Numbers Weight", "ru": "fontNumbersWeight"},
            "fontTitleWeight":  {"en": "Title weight",      "de": "Title Weight", "ru": "fontTitleWeight"},
            "fontUnitsWeight":  {"en": "Units weight",      "de": "Units Weight", "ru": "fontUnitsWeight"},
            "fontValueWeight":  {"en": "Value weight",      "de": "Value Weight", "ru": "fontValueWeight"},
            "group_gaugeBar":   {"en": "Gauge bar",         "de": "Gauge Bar", "ru": "group_gaugeBar"},
            "barBeginCircle":   {"en": "Begin circle",      "de": "BeginCircle", "ru": "barBeginCircle"},
            "barWidth":         {"en": "Width",             "de": "Width", "ru": "barWidth"},
            "barLength":        {"en": "Length",            "de": "Length", "ru": "barLength"},
            "barStrokeWidth":   {"en": "Stroke width",      "de": "StrokeWidth", "ru": "barStrokeWidth"},
            "barProgress":      {"en": "Progress",          "de": "Progress", "ru": "barProgress"},
            "group_colorsBar":  {"en": "Bar colors",        "de": "Bar-Farbe", "ru": "group_colorsBar"},
            "colorBarStroke":   {"en": "Bar stroke",        "de": "BarStroke", "ru": "colorBarStroke"},
            "colorBar":         {"en": "Bar",               "de": "Bar", "ru": "colorBar"},
            "colorBarEnd":      {"en": "BarEnd",            "de": "BarEnd", "ru": "colorBarEnd"},
            "colorBarProgress": {"en": "BarProgress",       "de": "BarProgress", "ru": "colorBarProgress"},
            "colorBarProgressEnd": {"en": "BarProgressEnd", "de": "BarProgressEnd", "ru": "colorBarProgressEnd"},
            "group_positions":  {"en": "Positions",         "de": "Position", "ru": "group_positions"},
            "tickSide":         {"en": "Tick's side",       "de": "tick Side", "ru": "tickSide"},
            "needleSide":       {"en": "Needle's side",     "de": "needle Side", "ru": "needleSide"},
            "numberSide":       {"en": "Number's side",     "de": "number Side", "ru": "numberSide"},
            "group_ticksBar":   {"en": "Bar ticks",         "de": "Ticks Bar", "ru": "group_ticksBar"},
            "ticksWidth":       {"en": "Width",             "de": "ticksWidth", "ru": "ticksWidth"},
            "ticksWidthMinor":  {"en": "Width minor",       "de": "ticksWidthMinor", "ru": "ticksWidthMinor"},
            "ticksPadding":     {"en": "Padding",           "de": "ticksPadding", "ru": "ticksPadding"},
            "plate":            {"en": "plate",             "de": "plate", "ru": "plate"},
            "animationTarget":  {"en": "Animation target",  "de": "Animationsziel", "ru": "animationTarget"},
            "group_gaugeRadial": {"en": "Gauge radial",     "de": "Radial", "ru": "group_gaugeRadial"},
            "ticksAngle":       {"en": "Ticks's angle",     "de": "ticksAngle", "ru": "ticksAngle"},
            "startAngle":       {"en": "Start Angle",       "de": "startAngle", "ru": "startAngle"},
            "group_colorsRadial":       {"en": "Colors for radial",         "de": "Farbe (radiall)", "ru": "group_colorsRadial"},
            "colorNeedleCircleOuter":   {"en": "Needle circle outer",       "de": "NeedleCircleOuter", "ru": "colorNeedleCircleOuter"},
            "colorNeedleCircleOuterEnd": {"en": "Needle circle outer end",  "de": "NeedleCircleOuterEnd", "ru": "colorNeedleCircleOuterEnd"},
            "colorNeedleCircleInner":   {"en": "Needle circle inner",       "de": "NeedleCircleInner", "ru": "colorNeedleCircleInner"},
            "colorNeedleCircleInnerEnd": {"en": "Needle circle inner end",  "de": "NeedleCircleInnerEnd", "ru": "colorNeedleCircleInnerEnd"},
            "group_needleRadial":       {"en": "Needle for radial",         "de": "Zeiger (radial)", "ru": "group_needleRadial"},
            "needleCircleSize":         {"en": "Circle size",               "de": "Circle Size", "ru": "needleCircleSize"},
            "needleCircleInner":        {"en": "Circle inner",              "de": "Circle Inner", "ru": "needleCircleInner"},
            "needleCircleOuter":        {"en": "Circle outer",              "de": "Circle Outer", "ru": "needleCircleOuter"}
        });
    }

    //jQuery.extend(true, vis.binds, {
    vis.binds['canvas-gauges'] = {
        version: "0.1.5",
        showVersion: function () {
            if (vis.binds['canvas-gauges'].version) {
                console.log('Version vis-canvas-gauges: ' + vis.binds['canvas-gauges'].version);
                vis.binds['canvas-gauges'].version = null;
            }
        },
        gaugeDestroy: function (wid, $wid) {
            if ($wid && $wid.length) {
                var bound = $wid.data('bound');
                if (bound) {
                    var bindHandler = $wid.data('bindHandler');
                    for (var b = 0; b < bound.length; b++) {
                        vis.states.unbind(bound[b], bindHandler);
                    }
                }
                var gauge = $wid.data('gauge');
                if (gauge) {
                    gauge.destroy();
                    $wid.data('gauge', null);
                }
            }
        },

        gauge: function (view, data, type) {
            var wid = data.attr('wid');
            var $wid = $('#' + wid).css('overflow', 'visible');
            if (!$wid.length) {
                setTimeout(function () {
                    vis.binds['canvas-gauges'].gauge(view, data, type);
                }, 100);
                return;
            }
            if (!$wid.is(':visible')) {
                setTimeout(function () {
                    vis.binds['canvas-gauges'].gauge(view, data, type);
                }, 1000);
                return;
            }

            $wid.css('overflow', 'visible');

            var w = $wid.width();
            var h = $wid.height();
            var gauge = $wid.data('gauge');

            var options = {
                width:          w,
                height:         h,
                title:          data.attr('title') || '',
                minValue:       parseFloat(data.attr('minValue')) || 0,
                maxValue:       parseFloat(data.attr('maxValue')),
                units:          data.attr('units') || '',
                factor:         parseFloat(data.attr('factor')) || 1,
                offset:         parseFloat(data.attr('valueOffset')) || 0,

                minorTicks:     parseInt(data.attr('minorTicks'), 10) || 1,
                strokeTicks:    data.attr('strokeTicks') === 'true' || data.attr('strokeTicks') === true,
                majorTicksInt:  parseInt(data.attr('majorTicksInt'), 10) || 4,
                majorTicksDec:  parseInt(data.attr('majorTicksDec'), 10) || 2,

                animation:      data.attr('animation') === 'true' || data.attr('animation') === true,
                animationDuration:  parseInt(data.attr('animationDuration')) || 500,
                animationRule:  data.attr('animationRule') || 'linear',
                animatedValue:  data.attr('animatedValue') === 'true' || data.attr('animatedValue') === true,
                animateOnInit:  data.attr('animateOnInit') === 'true' || data.attr('animateOnInit') === true
            };

            if (isNaN(options.maxValue)) options.maxValue = 100;

            if (data.attr('colorPlate'))             options.colorPlate             = data.attr('colorPlate');
            if (data.attr('colorPlateEnd'))          options.colorPlateEnd          = data.attr('colorPlateEnd');
            if (data.attr('colorMajorTicks'))        options.colorMajorTicks        = data.attr('colorMajorTicks');
            if (data.attr('colorMinorTicks'))        options.colorMinorTicks        = data.attr('colorMinorTicks');
            if (data.attr('colorTitle'))             options.colorTitle             = data.attr('colorTitle');
            if (data.attr('colorUnits'))             options.colorUnits             = data.attr('colorUnits');
            if (data.attr('colorNumbers'))           options.colorNumbers           = data.attr('colorNumbers');
            if (data.attr('colorNeedle'))            options.colorNeedle            = data.attr('colorNeedle');
            if (data.attr('colorNeedleEnd'))         options.colorNeedleEnd         = data.attr('colorNeedleEnd');
            if (data.attr('colorValueText'))         options.colorValueText         = data.attr('colorValueText');
            if (data.attr('colorValueTextShadow'))   options.colorValueTextShadow   = data.attr('colorValueTextShadow');
            if (data.attr('colorBorderShadow'))      options.colorBorderShadow      = data.attr('colorBorderShadow');
            if (data.attr('colorBorderOuter'))       options.colorBorderOuter       = data.attr('colorBorderOuter');
            if (data.attr('colorBorderOuterEnd'))    options.colorBorderOuterEnd    = data.attr('colorBorderOuterEnd');
            if (data.attr('colorBorderMiddle'))      options.colorBorderMiddle      = data.attr('colorBorderMiddle');
            if (data.attr('colorBorderMiddleEnd'))   options.colorBorderMiddleEnd   = data.attr('colorBorderMiddleEnd');
            if (data.attr('colorBorderInner'))       options.colorBorderInner       = data.attr('colorBorderInner');
            if (data.attr('colorBorderInnerEnd'))    options.colorBorderInnerEnd    = data.attr('colorBorderInnerEnd');
            if (data.attr('colorValueBoxRect'))      options.colorValueBoxRect      = data.attr('colorValueBoxRect');
            if (data.attr('colorValueBoxRectEnd'))   options.colorValueBoxRectEnd   = data.attr('colorValueBoxRectEnd');
            if (data.attr('colorValueBoxBackground'))options.colorValueBoxBackground = data.attr('colorValueBoxBackground');
            if (data.attr('colorValueBoxShadow'))    options.colorValueBoxShadow    = data.attr('colorValueBoxShadow');
            if (data.attr('colorNeedleShadowUp'))    options.colorNeedleShadowUp    = data.attr('colorNeedleShadowUp');
            if (data.attr('colorNeedleShadowDown'))  options.colorNeedleShadowDown  = data.attr('colorNeedleShadowDown');

            if (data.attr('needle')       !== undefined && data.attr('needle')       !== '')  options.needle       = data.attr('needle') === 'true' || data.attr('needle') === true;
            if (data.attr('needleShadow') !== undefined && data.attr('needleShadow') !== '')  options.needleShadow = data.attr('needleShadow') === 'true' || data.attr('needleShadow') === true;
            if (data.attr('needleType')   !== undefined && data.attr('needleType')   !== '')  options.needleType   = data.attr('needleType');
            if (data.attr('needleStart')  !== undefined && data.attr('needleStart')  !== '')  options.needleStart  = parseFloat(data.attr('needleStart'));
            if (data.attr('needleEnd')    !== undefined && data.attr('needleEnd')    !== '')  options.needleEnd    = parseFloat(data.attr('needleEnd'));
            if (data.attr('needleWidth')  !== undefined && data.attr('needleWidth')  !== '')  options.needleWidth  = parseFloat(data.attr('needleWidth'));

            if (data.attr('borders')           !== undefined && data.attr('borders')           !== '')  options.borders = data.attr('borders') === 'true' || data.attr('borders') === true;
            if (data.attr('borderOuterWidth')  !== undefined && data.attr('borderOuterWidth')  !== '')  options.borderOuterWidth  = parseFloat(data.attr('borderOuterWidth'));
            if (data.attr('borderMiddleWidth') !== undefined && data.attr('borderMiddleWidth') !== '')  options.borderMiddleWidth = parseFloat(data.attr('borderMiddleWidth'));
            if (data.attr('borderInnerWidth')  !== undefined && data.attr('borderInnerWidth')  !== '')  options.borderInnerWidth  = parseFloat(data.attr('borderInnerWidth'));
            if (data.attr('borderShadowWidth') !== undefined && data.attr('borderShadowWidth') !== '')  options.borderShadowWidth = parseFloat(data.attr('borderShadowWidth'));

            if (data.attr('valueBox')              !== undefined && data.attr('valueBox') !== '')       options.valueBox = data.attr('valueBox') === 'true' || data.attr('valueBox') === true;
            if (data.attr('valueText')             !== undefined && data.attr('valueText') !== '')      options.valueText = data.attr('valueText');
            if (data.attr('valueBoxStroke')        !== undefined && data.attr('valueBoxStroke') !== '') options.valueBoxStroke  = parseFloat(data.attr('valueBoxStroke'));
            if (data.attr('valueTextShadow')       !== undefined)                                       options.valueTextShadow = data.attr('valueTextShadow');
            if (data.attr('valueBoxBorderRadius')  !== undefined && data.attr('valueBoxBorderRadius') !== '')  options.valueBoxBorderRadius  = parseFloat(data.attr('valueBoxBorderRadius'));
            if (data.attr('valueInt')              !== undefined && data.attr('valueInt') !== '')       options.valueInt = parseInt(data.attr('valueInt'), 10);
            if (data.attr('valueDec')              !== undefined && data.attr('valueDec') !== '')       options.valueDec = parseInt(data.attr('valueDec'), 10);

            if (data.attr('fontNumbers') !== undefined && data.attr('fontNumbers') !== '')  options.fontNumbers = data.attr('fontNumbers');
            if (data.attr('fontTitle')   !== undefined && data.attr('fontTitle')   !== '')  options.fontTitle   = data.attr('fontTitle');
            if (data.attr('fontUnits')   !== undefined && data.attr('fontUnits')   !== '')  options.fontUnits   = data.attr('fontUnits');
            if (data.attr('fontValue')   !== undefined && data.attr('fontValue')   !== '')  options.fontValue   = data.attr('fontValue');
            if (data.attr('fontNumbersSize') !== undefined && data.attr('fontNumbersSize') !== '')  options.fontNumbersSize = parseInt(data.attr('fontNumbersSize'), 10);
            if (data.attr('fontTitleSize')   !== undefined && data.attr('fontTitleSize')   !== '')  options.fontTitleSize   = parseInt(data.attr('fontTitleSize'), 10);
            if (data.attr('fontUnitsSize')   !== undefined && data.attr('fontUnitsSize')   !== '')  options.fontUnitsSize   = parseInt(data.attr('fontUnitsSize'), 10);
            if (data.attr('fontValueSize')   !== undefined && data.attr('fontValueSize')   !== '')  options.fontValueSize   = parseInt(data.attr('fontValueSize'), 10);

            if (data.attr('fontNumbersStyle') !== undefined && data.attr('fontNumbersStyle')    !== '')  options.fontNumbersStyle = data.attr('fontNumbersStyle');
            if (data.attr('fontTitleStyle') !== undefined && data.attr('fontTitleStyle')        !== '')  options.fontTitleStyle = data.attr('fontTitleStyle');
            if (data.attr('fontUnitsStyle') !== undefined && data.attr('fontUnitsStyle')        !== '')  options.fontUnitsStyle = data.attr('fontUnitsStyle');
            if (data.attr('fontValueStyle') !== undefined && data.attr('fontValueStyle')        !== '')  options.fontValueStyle = data.attr('fontValueStyle');
            if (data.attr('fontNumbersWeight') !== undefined && data.attr('fontNumbersWeight')  !== '')  options.fontNumbersWeight = data.attr('fontNumbersWeight');
            if (data.attr('fontTitleWeight') !== undefined && data.attr('fontTitleWeight')      !== '')  options.fontTitleWeight = data.attr('fontTitleWeight');
            if (data.attr('fontUnitsWeight') !== undefined && data.attr('fontUnitsWeight')      !== '')  options.fontUnitsWeight = data.attr('fontUnitsWeight');
            if (data.attr('fontValueWeight') !== undefined && data.attr('fontValueWeight')      !== '')  options.fontNumbers = data.attr('fontValueWeight');

            var hCount = parseInt(data.attr('hCount'), 10) || 0;

            if (hCount) {
                options.highlights = [];
                for (var u = 1; u <= hCount; u++) {
                    if (data.attr('highlightsFrom' + u) === undefined || data.attr('highlightsFrom' + u) === '') continue;

                    if (type === 'radial') {
                        options.highlights.push({
                            from:   (parseFloat(data.attr('highlightsFrom' + u)) || 0),
                            to:     parseFloat(data.attr('highlightsTo' + u)),
                            color:  data.attr('highlightsColor' + u)
                        });
                    } else {
                        options.highlights.push({
                            from:   (parseFloat(data.attr('highlightsFrom' + u)) || 0) - options.minValue,
                            to:     parseFloat(data.attr('highlightsTo' + u)) - options.minValue,
                            color:  data.attr('highlightsColor' + u)
                        });

                    }
                }
            } else {
                options.highlights = false;
            }

            // convert majorTicks
            var majorTicks = data.attr('majorTicks');

            if (typeof majorTicks === 'string' && majorTicks.indexOf(',') !== -1) {
                majorTicks = majorTicks.split(',');
                for (var m = majorTicks.length - 1; m >= 0; m--) {
                    majorTicks[m] = majorTicks[m].trim();
                }
            } else {
                majorTicks = parseFloat(majorTicks);
                if (majorTicks) {
                    var start = options.minValue;
                    var step = (options.maxValue - options.minValue) / (majorTicks - 1);
                    majorTicks = [];
                    while(start <= options.maxValue) {
                        majorTicks.push(start);
                        start += step;
                    }
                } else {
                    majorTicks = undefined;
                }
            }

            if (!majorTicks) {
                majorTicks = [];
                var start = options.minValue;
                var step = (options.maxValue - options.minValue) / 5;
                while(start <= options.maxValue) {
                    majorTicks.push(start);
                    start += step;
                }
            }

            options.majorTicks = majorTicks;

            if (type === 'radial') {
                vis.binds['canvas-gauges'].radialGauge(view, data, options, $wid);
            } else {
                vis.binds['canvas-gauges'].linearGauge(view, data, options, $wid);
            }

            if (gauge) {
                gauge.update(options);
            } else {
                options.value = options.minValue || 0;
                $wid.html('<canvas class="vis-canvas-gauges"></canvas>');
                options.renderTo = $wid.find('.vis-canvas-gauges')[0];
                if (type === 'radial') {
                    gauge = new RadialGauge(options);
                } else {
                    gauge = new LinearGauge(options);
                }
                $wid.data('gauge', gauge);
                gauge.draw();

                if (vis.editMode && vis.activeWidgets.indexOf(wid) !== -1) {
                    $wid.resizable('destroy');
                    vis.resizable($wid);
                }
            }

            var oid = data.attr('oid');

            if ((oid || oid === 0) && oid !== 'nothing_selected') {
                var val = vis.states.attr(oid + '.val');
                if (val === undefined || val === null) {
                    val = parseFloat(val);
                } else {
                    var updateGauge = function (e, newVal /* , oldVal*/) {
                        gauge.value = parseFloat(newVal) * gauge.options.factor + gauge.options.offset;
                    };

                    // remember all ids, that bound
                    $wid.data('bound', [oid + '.val']);

                    // remember bind handler
                    $wid.data('bindHandler', updateGauge);

                    vis.states.bind(oid + '.val', updateGauge);
                }
                gauge.value = val * gauge.options.factor + gauge.options.offset;
            }

            // register destroy handler
            $wid.data('destroy', vis.binds['canvas-gauges'].gaugeDestroy);
        },

        linearGauge: function (view, data, options, $wid) {
            options.borderRadius = parseFloat($wid.css('border-radius'));
            if (data.attr('barBeginCircle') !== undefined && data.attr('barBeginCircle')    !== '')  options.barBeginCircle = parseFloat(data.attr('barBeginCircle'));
            if (data.attr('barWidth')       !== undefined && data.attr('barWidth')          !== '')  options.barWidth       = parseFloat(data.attr('barWidth'));
            if (data.attr('barLength')      !== undefined && data.attr('barLength')         !== '')  options.barLength      = parseFloat(data.attr('barLength'));
            if (data.attr('barStrokeWidth') !== undefined && data.attr('barStrokeWidth')    !== '')  options.barStrokeWidth = parseFloat(data.attr('barStrokeWidth'));
            if (data.attr('barProgress')    !== undefined && data.attr('barProgress')       !== '')  options.barProgress    = data.attr('barProgress') === 'true' || data.attr('barProgress') === true;

            if (data.attr('colorBarStroke')     !== undefined && data.attr('colorBarStroke')    !== '')  options.colorBarStroke     = data.attr('colorBarStroke');
            if (data.attr('colorBar')           !== undefined && data.attr('colorBar')          !== '')  options.colorBar           = data.attr('colorBar');
            if (data.attr('colorBarEnd')        !== undefined && data.attr('colorBarEnd')       !== '')  options.colorBarEnd        = data.attr('colorBarEnd');
            if (data.attr('colorBarProgress')   !== undefined && data.attr('colorBarProgress')  !== '')  options.colorBarProgress   = data.attr('colorBarProgress');
            if (data.attr('colorBarProgressEnd') !== undefined && data.attr('colorBarProgressEnd') !== '')  options.colorBarProgressEnd = data.attr('colorBarProgressEnd');

            if (data.attr('tickSide')       !== undefined && data.attr('tickSide')      !== '')  options.tickSide       = data.attr('tickSide');
            if (data.attr('needleSide')     !== undefined && data.attr('needleSide')    !== '')  options.needleSide     = data.attr('needleSide');
            if (data.attr('numberSide')     !== undefined && data.attr('numberSide')    !== '')  options.numberSide     = data.attr('numberSide');

            if (data.attr('ticksWidth')      !== undefined && data.attr('ticksWidth')      !== '')  options.ticksWidth      = parseFloat(data.attr('ticksWidth'));
            if (data.attr('ticksWidthMinor') !== undefined && data.attr('ticksWidthMinor') !== '')  options.ticksWidthMinor = parseFloat(data.attr('ticksWidthMinor'));
            if (data.attr('ticksPadding')    !== undefined && data.attr('ticksPadding')    !== '')  options.barBeginCircle  = parseFloat(data.attr('ticksPadding'));
        },
        radialGauge: function (view, data, options, $wid) {
            if (data.attr('ticksAngle') !== undefined && data.attr('ticksAngle')    !== '')  options.ticksAngle = parseFloat(data.attr('ticksAngle'));
            if (data.attr('startAngle')       !== undefined && data.attr('startAngle')          !== '')  options.startAngle       = parseFloat(data.attr('startAngle'));

            if (data.attr('colorNeedleCircleOuter')     !== undefined && data.attr('colorNeedleCircleOuter')    !== '')  options.colorNeedleCircleOuter     = data.attr('colorNeedleCircleOuter');
            if (data.attr('colorNeedleCircleOuterEnd')           !== undefined && data.attr('colorNeedleCircleOuterEnd')          !== '')  options.colorNeedleCircleOuterEnd           = data.attr('colorNeedleCircleOuterEnd');
            if (data.attr('colorNeedleCircleInner')        !== undefined && data.attr('colorNeedleCircleInner')       !== '')  options.colorNeedleCircleInner        = data.attr('colorNeedleCircleInner');
            if (data.attr('colorNeedleCircleInnerEnd')   !== undefined && data.attr('colorNeedleCircleInnerEnd')  !== '')  options.colorNeedleCircleInnerEnd   = data.attr('colorNeedleCircleInnerEnd');

            if (data.attr('needleCircleSize')       !== undefined && data.attr('needleCircleSize')      !== '')  options.needleCircleSize       = parseFloat(data.attr('needleCircleSize'));
            if (data.attr('needleCircleInner')    !== undefined && data.attr('needleCircleInner')       !== '')  options.needleCircleInner    = data.attr('needleCircleInner') === 'true' || data.attr('needleCircleInner') === true;
            if (data.attr('needleCircleOuter')    !== undefined && data.attr('needleCircleOuter')       !== '')  options.needleCircleOuter    = data.attr('needleCircleOuter') === 'true' || data.attr('needleCircleOuter') === true;

            if (data.attr('animationTarget')     !== undefined && data.attr('animationTarget')    !== '')  options.animationTarget     = data.attr('animationTarget');
        }
    };

    if (vis.editMode) {
        vis.binds['canvas-gauges'].changedId = function (widgetID, view, newId/*, fields*/) {
            var obj = vis.objects[newId];
            var changed = [];
            var wData = vis.views[view].widgets[widgetID].data;
            var wwData = vis.widgets[widgetID].data;

            if (obj && obj.common && obj.type === 'state') {
                if (obj.common.min !== undefined && (wData.minValue === undefined || wData.minValue === '')) {
                    wData.minValue = obj.common.min;
                    wwData.minValue = obj.common.min;
                    changed.push('minValue');
                }
                if (obj.common.max !== undefined && (wData.maxValue === undefined || wData.maxValue === '')) {
                    wData.maxValue = obj.common.max;
                    wwData.maxValue = obj.common.max;
                    changed.push('maxValue');
                }
                if (obj.common.unit !== undefined && (wData.units === undefined || wData.units === '')) {
                    wData.units = obj.common.unit;
                    wwData.units = obj.common.unit;
                    changed.push('units');
                }
                if (obj.common.name && (wData.title === undefined || wData.title === '')) {
                    wData.title = obj.common.name;
                    wwData.title = obj.common.name;
                    changed.push('title');
                }
            }

            return changed.length ? changed : null;
        };
    }

    vis.binds['canvas-gauges'].showVersion();
</script>

<!--script id="tplCGlinearGauge"
        type="text/ejs"
        class="vis-tpl"
        data-vis-type="temperature,number"
        data-vis-set="canvas-gauges"
        data-vis-name="Linear"
        data-vis-update-style="true"
        data-vis-prev='<img src="widgets/canvas-gauges/img/prev/Prev_cgLinear.png"></img>'
        data-vis-attrs="oid/id/changedId;minValue;maxValue;units;title;factor[1];valueOffset[0];hCount[1]/slider,0,20,1;"
        data-vis-attrs0="group.highlights/byindex;highlightsFrom(1-hCount);highlightsTo(1-hCount);highlightsColor(1-hCount)/color;"
        data-vis-attrs1="group.ticks;majorTicks/slider,0,20,1;minorTicks/slider,0,20,1;strokeTicks/checkbox;majorTicksInt/slider,0,10,1;majorTicksDec/slider,0,10,1;"
        data-vis-attrs2="group.animation;animation[true]/checkbox;animationDuration/slider,0,2000,50;animationRule/select,linear,quad,quint,cycle,bounce,elastic,dequad,dequint,decycle,debounce,delastic;animatedValue/checkbox;animateOnInit/checkbox;"
        data-vis-attrs3="group.colorsGauge;colorPlate/color;colorPlateEnd/color;colorMajorTicks/color;colorMinorTicks/color;colorTitle/color;colorUnits/color;colorNumbers/color;colorNeedle/color;colorNeedleEnd/color;colorValueText/color;colorValueTextShadow/color;colorBorderShadow/color;colorBorderOuter/color;colorBorderOuterEnd/color;colorBorderMiddle/color;colorBorderMiddleEnd/color;colorBorderInner/color;colorBorderInnerEnd/color;colorValueBoxRect/color;colorValueBoxRectEnd/color;colorValueBoxBackground/color;colorValueBoxShadow/color;colorNeedleShadowUp/color;colorNeedleShadowDown/color;"
        data-vis-attrs4="group.needle;needle/checkbox;needleShadow/checkbox;needleType/select,arrow,line;needleStart/slider,0,20,1;needleEnd/slider,0,20,1;needleWidth/slider,0,20,1;"
        data-vis-attrs5="group.borders;borders[true]/checkbox;borderOuterWidth/slider,0,20,1;borderMiddleWidth/slider,0,20,1;borderInnerWidth/slider,0,20,1;borderShadowWidth/slider,0,20,1;;"
        data-vis-attrs6="group.valueBox;valueBox[false]/checkbox;valueBoxStroke/slider,0,20,1;valueText;valueTextShadow/checkbox;valueBoxBorderRadius/slider,0,20,1;valueInt/slider,0,20,1;valueDec/slider,0,20,1;"
        data-vis-attrs7="group.fonts;fontNumbers/fontname;fontTitle/fontname;fontUnits/fontname;fontValue/fontname;"
        data-vis-attrs8="fontNumbersSize/slider,0,100,1;fontTitleSize/slider,0,100,1;fontUnitsSize/slider,0,100,1;fontValueSize/slider,0,100,1;"
        data-vis-attrs9="fontNumbersStyle/nselect,normal,italic,oblique;fontTitleStyle/nselect,normal,italic,oblique;fontUnitsStyle/nselect,normal,italic,oblique;fontValueStyle/nselect,normal,italic,oblique;"
        data-vis-attrs10="fontNumbersWeight/auto,normal,bold,bolder,lighter;fontTitleWeight/auto,normal,bold,bolder,lighter;fontUnitsWeight/auto,normal,bold,bolder,lighter;fontValueWeight/auto,normal,bold,bolder,lighter;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow: visible; width: 150px; height: 250px; border-radius: 10px" id="<%= this.data.attr('wid') %>"></div>
    <% vis.binds['canvas-gauges'].gauge(this.view, this.data, 'linear'); %>
</script-->
<script id="tplCGlinearGauge"
        type="text/ejs"
        class="vis-tpl"
        data-vis-type="temperature,number"
        data-vis-set="canvas-gauges"
        data-vis-name="Linear"
        data-vis-update-style="true"
        data-vis-prev='<img src="widgets/canvas-gauges/img/prev/Prev_cgLinear.png"></img>'
        data-vis-attrs="oid/id/changedId;minValue;maxValue;units;title;factor[1];valueOffset[0];hCount[1]/slider,0,20,1;"
        data-vis-attrs0="group.highlights/byindex;highlightsFrom(1-hCount);highlightsTo(1-hCount);highlightsColor(1-hCount)/color;"
        data-vis-attrs1="group.ticks;majorTicks/slider,0,20,1;minorTicks[5]/slider,0,20,1;strokeTicks/checkbox;majorTicksInt/slider,0,10,1;majorTicksDec/slider,0,10,1;"
        data-vis-attrs2="group.animation;animation[true]/checkbox;animationDuration/slider,0,2000,50;animationRule/select,linear,quad,quint,cycle,bounce,elastic,dequad,dequint,decycle,debounce,delastic;animatedValue/checkbox;animateOnInit/checkbox;"
        data-vis-attrs3="group.colorsGauge;colorPlate/color;colorPlateEnd/color;colorMajorTicks/color;colorMinorTicks/color;colorTitle/color;colorUnits/color;colorNumbers/color;colorNeedle/color;colorNeedleEnd/color;colorValueText/color;colorValueTextShadow/color;colorBorderShadow/color;colorBorderOuter/color;colorBorderOuterEnd/color;colorBorderMiddle/color;colorBorderMiddleEnd/color;colorBorderInner/color;colorBorderInnerEnd/color;colorValueBoxRect/color;colorValueBoxRectEnd/color;colorValueBoxBackground/color;colorValueBoxShadow/color;colorNeedleShadowUp/color;colorNeedleShadowDown/color;"
        data-vis-attrs4="group.needle;needle/checkbox;needleShadow/checkbox;needleType/select,arrow,line;needleStart/slider,0,100,1;needleEnd/slider,0,100,1;needleWidth/slider,0,50,1;"
        data-vis-attrs5="group.borders;borders[true]/checkbox;borderOuterWidth/slider,0,20,1;borderMiddleWidth/slider,0,20,1;borderInnerWidth/slider,0,20,1;borderShadowWidth/slider,0,20,1;"
        data-vis-attrs6="group.valueBox;valueBox[false]/checkbox;valueBoxStroke/slider,0,20,1;valueText;valueTextShadow/checkbox;valueBoxBorderRadius/slider,0,20,1;valueInt/slider,0,20,1;valueDec/slider,0,20,1;"
        data-vis-attrs7="group.fonts;fontNumbers/fontname;fontTitle/fontname;fontUnits/fontname;fontValue/fontname;"
        data-vis-attrs8="fontNumbersSize/slider,0,100,1;fontTitleSize/slider,0,100,1;fontUnitsSize/slider,0,100,1;fontValueSize/slider,0,100,1;"
        data-vis-attrs9="fontNumbersStyle/nselect,normal,italic,oblique;fontTitleStyle/nselect,normal,italic,oblique;fontUnitsStyle/nselect,normal,italic,oblique;fontValueStyle/nselect,normal,italic,oblique;"
        data-vis-attrs10="fontNumbersWeight/auto,normal,bold,bolder,lighter;fontTitleWeight/auto,normal,bold,bolder,lighter;fontUnitsWeight/auto,normal,bold,bolder,lighter;fontValueWeight/auto,normal,bold,bolder,lighter;"
        data-vis-attrs11="group.gaugeBar;barBeginCircle/slider,0,360,1;barWidth/slider,0,50,1;barLength/slider,0,100,1;barStrokeWidth/slider,0,50,0;barProgress[true]/checkbox;"
        data-vis-attrs12="group.colorsBar;colorBarStroke/color;colorBar/color;colorBarEnd/color;colorBarProgress/color;colorBarProgressEnd/color;"
        data-vis-attrs13="group.positions;tickSide/select,both,left,right;needleSide/select,both,left,right;numberSide/select,both,left,right;"
        data-vis-attrs14="group.ticksBar;ticksWidth/slider,0,50,1;ticksWidthMinor/slider,0,50,1;ticksPadding/slider,0,50,1;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow: visible; width: 150px; height: 250px; border-radius: 10px" id="<%= this.data.attr('wid') %>"></div>
    <% vis.binds['canvas-gauges'].gauge(this.view, this.data, 'linear'); %>
</script>

<script id="tplCGradialGauge"
        type="text/ejs"
        class="vis-tpl"
        data-vis-type="number"
        data-vis-set="canvas-gauges"
        data-vis-name="Radial"
        data-vis-update-style="true"
        data-vis-prev='<img src="widgets/canvas-gauges/img/prev/Prev_cgRadial.png"></img>'
        data-vis-attrs="oid/id/changedId;minValue;maxValue;units;title;factor[1];valueOffset[0];hCount[1]/slider,0,20,1;"
        data-vis-attrs0="group.highlights/byindex;highlightsFrom(1-hCount);highlightsTo(1-hCount);highlightsColor(1-hCount)/color;"
        data-vis-attrs1="group.ticks;majorTicks/slider,0,20,1;minorTicks[4]/slider,0,20,1;strokeTicks/checkbox;majorTicksInt/slider,0,10,1;majorTicksDec/slider,0,10,1;"
        data-vis-attrs2="group.animation;animation[true]/checkbox;animationDuration/slider,0,2000,50;animationRule/select,linear,quad,quint,cycle,bounce,elastic,dequad,dequint,decycle,debounce,delastic;animatedValue/checkbox;animateOnInit/checkbox;animationTarget/select,needle,plate;"
        data-vis-attrs3="group.colorsGauge;colorPlate/color;colorPlateEnd/color;colorMajorTicks/color;colorMinorTicks/color;colorTitle/color;colorUnits/color;colorNumbers/color;colorNeedle/color;colorNeedleEnd/color;colorValueText/color;colorValueTextShadow/color;colorBorderShadow/color;colorBorderOuter/color;colorBorderOuterEnd/color;colorBorderMiddle/color;colorBorderMiddleEnd/color;colorBorderInner/color;colorBorderInnerEnd/color;colorValueBoxRect/color;colorValueBoxRectEnd/color;colorValueBoxBackground/color;colorValueBoxShadow/color;colorNeedleShadowUp/color;colorNeedleShadowDown/color;"
        data-vis-attrs4="group.needle;needle[true]/checkbox;needleShadow[true]/checkbox;needleType[select]/select,arrow,line;needleStart/slider,0,100,1;needleEnd/slider,0,100,1;needleWidth/slider,0,50,1;"
        data-vis-attrs5="group.borders;borders[true]/checkbox;borderOuterWidth[2]/slider,0,20,1;borderMiddleWidth[2]/slider,0,20,1;borderInnerWidth[2]/slider,0,20,1;borderShadowWidth[2]/slider,0,20,1;"
        data-vis-attrs6="group.valueBox;valueBox[false]/checkbox;valueBoxStroke/slider,0,20,1;valueText;valueTextShadow/checkbox;valueBoxBorderRadius/slider,0,20,1;valueInt/slider,0,20,1;valueDec/slider,0,20,1;"
        data-vis-attrs7="group.fonts;fontNumbers/fontname;fontTitle/fontname;fontUnits/fontname;fontValue/fontname;"
        data-vis-attrs8="fontNumbersSize/slider,0,100,1;fontTitleSize/slider,0,100,1;fontUnitsSize/slider,0,100,1;fontValueSize/slider,0,100,1;"
        data-vis-attrs9="fontNumbersStyle/nselect,normal,italic,oblique;fontTitleStyle/nselect,normal,italic,oblique;fontUnitsStyle/nselect,normal,italic,oblique;fontValueStyle/nselect,normal,italic,oblique;"
        data-vis-attrs10="fontNumbersWeight/auto,normal,bold,bolder,lighter;fontTitleWeight/auto,normal,bold,bolder,lighter;fontUnitsWeight/auto,normal,bold,bolder,lighter;fontValueWeight/auto,normal,bold,bolder,lighter;"
        data-vis-attrs11="group.gaugeRadial;ticksAngle[270]/slider,0,360,1;startAngle[45]/slider,0,360,1;"
        data-vis-attrs12="group.colorsRadial;colorNeedleCircleOuter/color;colorNeedleCircleOuterEnd/color;colorNeedleCircleInner/color;colorNeedleCircleInnerEnd/color;"
        data-vis-attrs13="group.needleRadial;needleCircleSize/slider,0,200,1;needleCircleInner/checkbox;needleCircleInner/checkbox;needleCircleOuter/checkbox;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow: visible; width: 200px; height: 200px;" id="<%= this.data.attr('wid') %>"></div>
    <% vis.binds['canvas-gauges'].gauge(this.view, this.data, 'radial'); %>
</script>

<script id="tplCGCompas"
        type="text/ejs"
        class="vis-tpl"
        data-vis-type="number"
        data-vis-set="canvas-gauges"
        data-vis-name="Compas"
        data-vis-update-style="true"
        data-vis-prev='<img src="widgets/canvas-gauges/img/prev/Prev_cgCompas.png"></img>'
        data-vis-attrs="oid/id/changedId;minValue[0];maxValue[360];units;title;factor[1];valueOffset[0];hCount[1]/slider,0,20,1;"
        data-vis-attrs0="group.highlights/byindex;highlightsFrom(1-hCount);highlightsTo(1-hCount);highlightsColor(1-hCount)/color;"
        data-vis-attrs1="group.ticks;majorTicks[N,NE,E,SE,S,SW,W,NW,N];minorTicks[22]/slider,0,20,1;strokeTicks[false]/checkbox;majorTicksInt/slider,0,10,1;majorTicksDec/slider,0,10,1;"
        data-vis-attrs2="group.animation;animation[true]/checkbox;animationDuration[1000]/slider,0,2000,50;animationRule/select,linear,quad,quint,cycle,bounce,elastic,dequad,dequint,decycle,debounce,delastic;animatedValue/checkbox;animateOnInit/checkbox;animationTarget/select,needle,plate;"
        data-vis-attrs3="group.colorsGauge;colorPlate[#222]/color;colorPlateEnd/color;colorMajorTicks[#f5f5f5]/color;colorMinorTicks[#ddd]/color;colorTitle/color;colorUnits/color;colorNumbers[#ccc]/color;colorNeedle[rgba(240,128,128,1)]/color;colorNeedleEnd[rgba(255,160,122,.9)]/color;colorValueText/color;colorValueTextShadow/color;colorBorderShadow/color;colorBorderOuter[#ccc]/color;colorBorderOuterEnd[#ccc]/color;colorBorderMiddle/color;colorBorderMiddleEnd/color;colorBorderInner/color;colorBorderInnerEnd/color;colorValueBoxRect/color;colorValueBoxRectEnd/color;colorValueBoxBackground/color;colorValueBoxShadow/color;colorNeedleShadowUp/color;colorNeedleShadowDown[#222]/color;"
        data-vis-attrs4="group.needle;needle/checkbox;needleShadow/checkbox;needleType[line]/select,arrow,line;needleStart[75]/slider,0,100,1;needleEnd[99]/slider,0,100,1;needleWidth[3]/slider,0,50,1;"
        data-vis-attrs5="group.borders;borders[true]/checkbox;borderOuterWidth[10]/slider,0,20,1;borderMiddleWidth[0]/slider,0,20,1;borderInnerWidth[0]/slider,0,20,1;borderShadowWidth[0]/slider,0,20,1;"
        data-vis-attrs6="group.valueBox;valueBox[false]/checkbox;valueBoxStroke/slider,0,20,1;valueText;valueTextShadow[false]/checkbox;valueBoxBorderRadius/slider,0,20,1;valueInt/slider,0,20,1;valueDec/slider,0,20,1;"
        data-vis-attrs7="group.fonts;fontNumbers/fontname;fontTitle/fontname;fontUnits/fontname;fontValue/fontname;"
        data-vis-attrs8="fontNumbersSize/slider,0,100,1;fontTitleSize/slider,0,100,1;fontUnitsSize/slider,0,100,1;fontValueSize/slider,0,100,1;"
        data-vis-attrs9="fontNumbersStyle/nselect,normal,italic,oblique;fontTitleStyle/nselect,normal,italic,oblique;fontUnitsStyle/nselect,normal,italic,oblique;fontValueStyle/nselect,normal,italic,oblique;"
        data-vis-attrs10="fontNumbersWeight/auto,normal,bold,bolder,lighter;fontTitleWeight/auto,normal,bold,bolder,lighter;fontUnitsWeight/auto,normal,bold,bolder,lighter;fontValueWeight/auto,normal,bold,bolder,lighter;"
        data-vis-attrs11="group.gaugeRadial;ticksAngle[360]/slider,0,360,1;startAngle[180]/slider,0,360,1;"
        data-vis-attrs12="group.colorsRadial;colorNeedleCircleOuter[#ccc]/color;colorNeedleCircleOuterEnd/color;colorNeedleCircleInner/color;colorNeedleCircleInnerEnd/color;"
        data-vis-attrs13="group.needleRadial;needleCircleSize[15]/slider,0,200,1;needleCircleInner/checkbox;needleCircleInner/checkbox;needleCircleOuter[false]/checkbox;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow: visible; width: 200px; height: 200px;" id="<%= this.data.attr('wid') %>"></div>
    <% vis.binds['canvas-gauges'].gauge(this.view, this.data, 'radial'); %>
</script>

<script id="tplCGflatGauge"
        type="text/ejs"
        class="vis-tpl"
        data-vis-type="temperature,number"
        data-vis-set="canvas-gauges"
        data-vis-name="Flat"
        data-vis-update-style="true"
        data-vis-prev='<img src="widgets/canvas-gauges/img/prev/Prev_cgFlat.png"></img>'
        data-vis-attrs="oid/id/changedId;minValue;maxValue;units;title;factor[1];valueOffset[0];hCount[1]/slider,0,20,1;"
        data-vis-attrs0="group.highlights/byindex;highlightsFrom(1-hCount);highlightsTo(1-hCount);highlightsColor(1-hCount)/color;"
        data-vis-attrs1="group.ticks;majorTicks/slider,0,20,1;minorTicks[10]/slider,0,20,1;strokeTicks[true]/checkbox;majorTicksInt/slider,0,10,1;majorTicksDec/slider,0,10,1;"
        data-vis-attrs2="group.animation;animation[true]/checkbox;animationDuration/slider,0,2000,50;animationRule/select,linear,quad,quint,cycle,bounce,elastic,dequad,dequint,decycle,debounce,delastic;animatedValue/checkbox;animateOnInit/checkbox;"
        data-vis-attrs3="group.colorsGauge;colorPlate[#fff]/color;colorPlateEnd/color;colorMajorTicks/color;colorMinorTicks/color;colorTitle/color;colorUnits/color;colorNumbers/color;colorNeedle[red]/color;colorNeedleEnd[rgba(255,0,0,0.7)]/color;colorValueText/color;colorValueTextShadow/color;colorBorderShadow/color;colorBorderOuter/color;colorBorderOuterEnd/color;colorBorderMiddle/color;colorBorderMiddleEnd/color;colorBorderInner/color;colorBorderInnerEnd/color;colorValueBoxRect/color;colorValueBoxRectEnd/color;colorValueBoxBackground/color;colorValueBoxShadow/color;colorNeedleShadowUp/color;colorNeedleShadowDown/color;"
        data-vis-attrs4="group.needle;needle/checkbox;needleShadow/checkbox;needleType[line]/select,arrow,line;needleStart/slider,0,100,1;needleEnd/slider,0,100,1;needleWidth[3]/slider,0,50,1;"
        data-vis-attrs5="group.borders;borders[false]/checkbox;borderOuterWidth[0]/slider,0,20,1;borderMiddleWidth[0]/slider,0,20,1;borderInnerWidth[0]/slider,0,20,1;borderShadowWidth[0]/slider,0,20,1;;"
        data-vis-attrs6="group.valueBox;valueBox[false]/checkbox;valueBoxStroke/slider,0,20,1;valueText;valueTextShadow/checkbox;valueBoxBorderRadius/slider,0,20,1;valueInt/slider,0,20,1;valueDec/slider,0,20,1;"
        data-vis-attrs7="group.fonts;fontNumbers/fontname;fontTitle/fontname;fontUnits/fontname;fontValue/fontname;"
        data-vis-attrs8="fontNumbersSize/slider,0,100,1;fontTitleSize/slider,0,100,1;fontUnitsSize/slider,0,100,1;fontValueSize/slider,0,100,1;"
        data-vis-attrs9="fontNumbersStyle/nselect,normal,italic,oblique;fontTitleStyle/nselect,normal,italic,oblique;fontUnitsStyle/nselect,normal,italic,oblique;fontValueStyle/nselect,normal,italic,oblique;"
        data-vis-attrs10="fontNumbersWeight/auto,normal,bold,bolder,lighter;fontTitleWeight/auto,normal,bold,bolder,lighter;fontUnitsWeight/auto,normal,bold,bolder,lighter;fontValueWeight/auto,normal,bold,bolder,lighter;"
        data-vis-attrs11="group.gaugeBar;barBeginCircle[0]/slider,0,360,1;barWidth[5]/slider,0,50,1;barLength/slider,0,100,1;barStrokeWidth/slider,0,50,0;barProgress[true]/checkbox;"
        data-vis-attrs12="group.colorsBar;colorBarStroke/color;colorBar/color;colorBarEnd/color;colorBarProgress[#db9994]/color;colorBarProgressEnd/color;"
        data-vis-attrs13="group.positions;tickSide[left]/select,both,left,right;needleSide[left]/select,both,left,right;numberSide[left]/select,both,left,right;"
        data-vis-attrs14="group.ticksBar;ticksWidth[50]/slider,0,50,1;ticksWidthMinor[15]/slider,0,50,1;ticksPadding/slider,0,50,1;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow: visible; width: 360px; height: 100px;" id="<%= this.data.attr('wid') %>"></div>
    <% vis.binds['canvas-gauges'].gauge(this.view, this.data, 'linear'); %>
</script>
<!-- --------------canvas-gauges.html--- END -->
<!-- --------------chromecast.html--- START -->
<!--
    ioBroker.chromecast Widget-Set

    version: "2.0.0"

    Copyright 10.2015-2018 Vegetto<iobroker@angelnu.com>
-->
<!-- here you can include so many css as you want -->
<link rel="stylesheet" href="widgets/chromecast/css/style.css" />
<!-- here you can include so many js-files as you want -->
<script type="text/javascript" src="widgets/chromecast/js/chromecast.js"></script>

<!-- the full description of format in data-vis-attrs can be found here: 
    https://github.com/ioBroker/ioBroker.vis/blob/master/www/js/visEditInspect.js#L39 
	
    ----------------------------------------------------------	
	Mandatory XML attributes:
		id="tplChromecastWIDGETNAME"
        type="text/ejs"
        class="vis-tpl"
		
		"type" and "class" are always the same. "id" is unique and must start with "tplSETNAME" and ends with widget name. Use camel-case for it.
		
    ----------------------------------------------------------	
	data-vis-attrs - divided with semicolon the list of attributes, like attr1/id;attr2/color
		Full format of one attribute is: attr_name(start-end)[default_value]/type,idFilter/onChangeFunc
			attr_name - the name of the attribute, e.g. "myID"
			start-end - creates automatically attributes from attr_namestart to attr_nameend, like "myID(1-3)" creates myID1, myID2, myID3
			default_value - by creation of widget this attribute will be filled with this value, e.g. "myID[#001122]/color"
			type - some predefined types have edit helpers, else it will be shown as text field
		
				Type format: 
					  id - Object ID Dialog
					  checkbox
					  image - image
					  number,min,max,step - non-float number. min,max,step are optional
					  color - color picker
					  views - Name of the view
					  effect - jquery UI show/hide effects
					  eff_opt - additional option to effect slide (up, down, left, right)
					  fontName - Font name
					  slider,min,max,step - Default step is ((max - min) / 100)
					  select,value1,value2,... - dropdown select
					  nselect,value1,value2,... - same as select, but without translation of items
					  style,fileFilter,nameFilter,attrFilter
					  custom,functionName,options,... - custom editor - functionName is starting from vis.binds.[widgetset.funct]. E.g. custom/timeAndWeather.editWeather,short
					  group.name - define new or old group. All following attributes belongs to new group till new group.xyz
					  group.name/byindex - like group, but all following attributes will be grouped by ID. Like group.windows/byindex;slide(1-4)/id;slide_type(1-4)/select,open,closed  Following groups will be created Windows1(slide1,slide_type1), Windows2(slide2,slide_type2), Windows3(slide3,slide_type3), Windows4(slide4,slide_type4)
					  text - dialog box with text editor
					  html - dialog box with html editor
				
				If type is "id", you can define filter for "Select ID Dialog", like "myID/id,level.temperature".
				Additionally you can define callback(onChangeFunc), which will be called if this attribute was changed by user for different purposes: validate entry, fill other attributes, ...
				
		You can define additional data-vis-attrs line: data-vis-attrs0, data-vis-attrs1. Anyway data-vis-attrs must be there. You may not skip numbers. 
		E.g. in "data-vis-attrs="A;" data-vis-attrs1="B" attribute B will be not parsed.
				
	--------------------------------------------------------
	data-vis-type
		Help information for user. Used for search. 
		You can define more than one type divided by comma.
		There are following common types, but you can use your own specific types:
			ctrl   - widget that can write some Object IDs
			val    - widget that shows some information from Object IDs
			static - widget do not read information from Object IDs or URL
			button - button widget
			dimmer - dimmer widget
			weather - weather widget
			...
			
	--------------------------------------------------------
	data-vis-set
		Name of the widget set. Must be equal to the name of this HTML file

	--------------------------------------------------------
	data-vis-prev
		Html code used as preview of this widget. If widget is complex you can just use image as preview: 
		data-vis-prev='<img src="widgets/hqwidgets/img/prev/Prev_tplChromecastShowInstance.png"></img>'
		Of course the image must exist.

	--------------------------------------------------------
	data-vis-name
		Readable name of widget shown in vis editor. 

	--------------------------------------------------------
	data-vis-beta="true"
		Shows "BETA" symbol in vis editor by preview
		
	--------------------------------------------------------
	data-vis-update-style="true"
		Call redraw of widget if some of the CSS styles in editor for this widget was changed


	You can read about Magic tags here: http://canjs.com/guides/EJS.html
	Following magic are exist:
        <% %> - execute javascript
        <%== %> - place unescaped result to HTML document
        <%== %> - place escaped result to HTML document

    You can do "if" conditions and "for" cycles.

-->

<script id="tplChromecastDevice"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplChromecastDevice" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev " style="overflow: visible; width: 340px; height: 210px; left: 17px; top: 13px; position: absolute;" > <select class="chromecastDeviceSelector"><option value="1" class="chromecastDeviceSelectorValue">audio-all</option><option value="2" class="chromecastDeviceSelectorValue">audio-bedroom</option><option value="3" class="chromecastDeviceSelectorValue">audio-guestroom</option><option value="4" class="chromecastDeviceSelectorValue">audio-kids</option><option value="5" class="chromecastDeviceSelectorValue">audio-kitchen</option><option value="6" class="chromecastDeviceSelectorValue">audio-livingroom</option><option value="7" class="chromecastDeviceSelectorValue">audio-playroom</option><option value="8" class="chromecastDeviceSelectorValue">audio-workroom</option><option value="9" class="chromecastDeviceSelectorValue">video-kitchen</option></select><div class="chromecastDevice_1 chromecastDevice_div" style="display: none;"><p><input class="chromecastConnected" type="checkbox">Connected</p><p><input class="chromecastVolume" type="range" min="0" max="100">Volume</p><p><input class="chromecastMuted" type="checkbox">Muted</p><p><input class="chromecastPlaying" type="checkbox">Playing</p><p><input class="chromecastPaused" type="checkbox">Paused</p><p>url2play: </p><form><input class="chromecastUrl2play" type="url"></form><p></p><p><span class="chromecastDisplayName"></span></p><p><span class="chromecastPlayerDescription"></span></p><p>Status: <span class="chromecastPlayerState">STOP</span></p><p>Playing URL: <span class="chromecastPlayerURL">Unknown</span></p><p>Title: <span class="chromecastMetadataTitle">Unknown</span></p></div><div class="chromecastDevice_2 chromecastDevice_div" style="display: none;"><p><input class="chromecastConnected" type="checkbox">Connected</p><p><input class="chromecastVolume" type="range" min="0" max="100">Volume</p><p><input class="chromecastMuted" type="checkbox">Muted</p><p><input class="chromecastPlaying" type="checkbox">Playing</p><p><input class="chromecastPaused" type="checkbox">Paused</p><p>url2play: </p><form><input class="chromecastUrl2play" type="url"></form><p></p><p><span class="chromecastDisplayName">Default Media Receiver</span></p><p><span class="chromecastPlayerDescription">Now Casting: Anime - Decisive Battle</span></p><p>Status: <span class="chromecastPlayerState">STOP</span></p><p>Playing URL: <span class="chromecastPlayerURL">Unknown</span></p><p>Title: <span class="chromecastMetadataTitle">Unknown</span></p></div><div class="chromecastDevice_3 chromecastDevice_div" style="display: none;"><p><input class="chromecastConnected" type="checkbox">Connected</p><p><input class="chromecastVolume" type="range" min="0" max="100">Volume</p><p><input class="chromecastMuted" type="checkbox">Muted</p><p><input class="chromecastPlaying" type="checkbox">Playing</p><p><input class="chromecastPaused" type="checkbox">Paused</p><p>url2play: </p><form><input class="chromecastUrl2play" type="url"></form><p></p><p><span class="chromecastDisplayName">TuneIn Pro</span></p><p><span class="chromecastPlayerDescription">Ready to play</span></p><p>Status: <span class="chromecastPlayerState">STOP</span></p><p>Playing URL: <span class="chromecastPlayerURL">Unknown</span></p><p>Title: <span class="chromecastMetadataTitle">Unknown</span></p></div><div class="chromecastDevice_4 chromecastDevice_div" style="display: none;"><p><input class="chromecastConnected" type="checkbox">Connected</p><p><input class="chromecastVolume" type="range" min="0" max="100">Volume</p><p><input class="chromecastMuted" type="checkbox">Muted</p><p><input class="chromecastPlaying" type="checkbox">Playing</p><p><input class="chromecastPaused" type="checkbox">Paused</p><p>url2play: </p><form><input class="chromecastUrl2play" type="url"></form><p></p><p><span class="chromecastDisplayName">Default Media Receiver</span></p><p><span class="chromecastPlayerDescription">Now Casting: http://edge.live.mp3.mdn.newmedia.nacamar.net/ps-dieneue_rock/livestream_hi.mp3</span></p><p>Status: <span class="chromecastPlayerState">STOP</span></p><p>Playing URL: <span class="chromecastPlayerURL">Unknown</span></p><p>Title: <span class="chromecastMetadataTitle">THE ALL-AMERICAN REJECTS - GIVES YOU HELL</span></p></div><div class="chromecastDevice_5 chromecastDevice_div" style="display: none;"><p><input class="chromecastConnected" type="checkbox">Connected</p><p><input class="chromecastVolume" type="range" min="0" max="100">Volume</p><p><input class="chromecastMuted" type="checkbox">Muted</p><p><input class="chromecastPlaying" type="checkbox">Playing</p><p><input class="chromecastPaused" type="checkbox">Paused</p><p>url2play: </p><form><input class="chromecastUrl2play" type="url"></form><p></p><p><span class="chromecastDisplayName">TuneIn Pro</span></p><p><span class="chromecastPlayerDescription">Ready to play</span></p><p>Status: <span class="chromecastPlayerState">STOP</span></p><p>Playing URL: <span class="chromecastPlayerURL">Unknown</span></p><p>Title: <span class="chromecastMetadataTitle">Unknown</span></p></div><div class="chromecastDevice_6 chromecastDevice_div" style="display: block;"><p><input class="chromecastConnected" type="checkbox">Connected</p><p><input class="chromecastVolume" type="range" min="0" max="100">Volume</p><p><input class="chromecastMuted" type="checkbox">Muted</p><p><input class="chromecastPlaying" type="checkbox">Playing</p><p><input class="chromecastPaused" type="checkbox">Paused</p><p>url2play: </p><form><input class="chromecastUrl2play" type="url"></form><p></p><p><span class="chromecastDisplayName">Default Media Receiver</span></p><p><span class="chromecastPlayerDescription">Now Casting: FOOLS GARDEN - LEMON TREE</span></p><p>Status: <span class="chromecastPlayerState">PLAYING</span></p><p>Playing URL: <span class="chromecastPlayerURL">http://edge.live.mp3.mdn.newmedia.nacamar.net/ps-dieneue_rock/livestream_hi.mp3</span></p><p>Title: <span class="chromecastMetadataTitle">THE ALL-AMERICAN REJECTS - GIVES YOU HELL</span></p></div><div class="chromecastDevice_7 chromecastDevice_div" style="display: none;"><p><input class="chromecastConnected" type="checkbox">Connected</p><p><input class="chromecastVolume" type="range" min="0" max="100">Volume</p><p><input class="chromecastMuted" type="checkbox">Muted</p><p><input class="chromecastPlaying" type="checkbox">Playing</p><p><input class="chromecastPaused" type="checkbox">Paused</p><p>url2play: </p><form><input class="chromecastUrl2play" type="url"></form><p></p><p><span class="chromecastDisplayName">Default Media Receiver</span></p><p><span class="chromecastPlayerDescription">Now Casting: MANOWAR - KINGDOM COME</span></p><p>Status: <span class="chromecastPlayerState">PLAYING</span></p><p>Playing URL: <span class="chromecastPlayerURL">http://edge.live.mp3.mdn.newmedia.nacamar.net/ps-dieneue_rock/livestream_hi.mp3</span></p><p>Title: <span class="chromecastMetadataTitle">THE ALL-AMERICAN REJECTS - GIVES YOU HELL</span></p></div><div class="chromecastDevice_8 chromecastDevice_div" style="display: none;"><p><input class="chromecastConnected" type="checkbox">Connected</p><p><input class="chromecastVolume" type="range" min="0" max="100">Volume</p><p><input class="chromecastMuted" type="checkbox">Muted</p><p><input class="chromecastPlaying" type="checkbox">Playing</p><p><input class="chromecastPaused" type="checkbox">Paused</p><p>url2play: </p><form><input class="chromecastUrl2play" type="url"></form><p></p><p><span class="chromecastDisplayName"></span></p><p><span class="chromecastPlayerDescription"></span></p><p>Status: <span class="chromecastPlayerState">STOP</span></p><p>Playing URL: <span class="chromecastPlayerURL">Unknown</span></p><p>Title: <span class="chromecastMetadataTitle">Unknown</span></p></div><div class="chromecastDevice_9 chromecastDevice_div" style="display: none;"><p><input class="chromecastConnected" type="checkbox">Connected</p><p><input class="chromecastVolume" type="range" min="0" max="100">Volume</p><p><input class="chromecastMuted" type="checkbox">Muted</p><p><input class="chromecastPlaying" type="checkbox">Playing</p><p><input class="chromecastPaused" type="checkbox">Paused</p><p>url2play: </p><form><input class="chromecastUrl2play" type="url"></form><p></p><p><span class="chromecastDisplayName">Backdrop</span></p><p><span class="chromecastPlayerDescription"></span></p><p>Status: <span class="chromecastPlayerState">STOP</span></p><p>Playing URL: <span class="chromecastPlayerURL">Unknown</span></p><p>Title: <span class="chromecastMetadataTitle">Unknown</span></p></div></div></div>'
        data-vis-attrs="nDevs[1]/number,1; selDev[1]/number,1,nDevs;"
        data-vis-attrs0="oid_dev_(1-nDevs)/id,device/oidChanged;"
        data-vis-attrs1="group.device/byindex;"
        data-vis-attrs2="oid_connected_(1-nDevs)/id/oidChanged;"
        data-vis-attrs3="oid_volume_(1-nDevs)/id/oidChanged;"
        data-vis-attrs4="oid_muted_(1-nDevs)/id/oidChanged;"
        data-vis-attrs5="oid_playing_(1-nDevs)/id/oidChanged;"
        data-vis-attrs6="oid_paused_(1-nDevs)/id/oidChanged;"
        data-vis-attrs7="oid_url2play_(1-nDevs)/id/oidChanged;"
        data-vis-attrs8="oid_playerState_(1-nDevs)/id/oidChanged;"
        data-vis-attrs9="oid_title_(1-nDevs)/id/oidChanged;"
        data-vis-attrs10="oid_url_(1-nDevs)/id/oidChanged;"
        data-vis-attrs11="oid_displayName_(1-nDevs)/id/oidChanged;"
        data-vis-attrs12="oid_statusText_(1-nDevs)/id/oidChanged;"
        data-vis-set="chromecast"
        data-vis-type="ctr,val,button"
        data-vis-name="Chomecast dev">
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 230px; height: 210px" id="<%= this.data.attr('wid') %>" >
        <% vis.binds.chromecast.device.init(this.data.wid, this.view, this.data, this.style); %>
    </div>
</script>



<!-- --------------chromecast.html--- END -->
<!-- --------------colorpicker.html--- START -->
<!--
    ioBroker.vis colorpicker Widget-Set

    version: "1.2.0"

    Copyright 2013-2020 hobbyquaker https://github.com/hobbyquaker, bluefox https://github.com/GermanBluefox
-->

<link rel="stylesheet" type="text/css" href="widgets/colorpicker/css/farbtastic.css" />
<link rel="stylesheet" type="text/css" href="widgets/colorpicker/css/spectrum.css" />

<script type="text/javascript" src="widgets/colorpicker/js/jscolor.js"></script>
<script type="text/javascript" src="widgets/colorpicker/js/farbtastic.js"></script>
<script type="text/javascript" src="widgets/colorpicker/js/spectrum.js"></script>
<script type="text/javascript" src="widgets/colorpicker/js/huepiHelper.js"></script>

<script type="text/javascript">
    
    if (vis.language === 'de'){
        var localization = $.spectrum.localization.de = {
            cancelText: 			'Abbrechen',
            chooseText: 			'Wählen',
            clearText: 				'Farbauswahl zurücksetzen',
            noColorSelectedText: 	'Keine Farbe ausgewählt',
            togglePaletteMoreText: 	'Mehr',
            togglePaletteLessText: 	'Weniger'
        };
        $.extend($.fn.spectrum.defaults, localization);
    } else if (vis.language === 'ru'){
        var localization = $.spectrum.localization.ru = {
            cancelText: 			'отмена',
            chooseText: 			'выбрать',
            clearText: 				'сбросить',
            noColorSelectedText: 	'никакой цвет не выбран',
            togglePaletteMoreText: 	'больше',
            togglePaletteLessText: 	'меньше'
        };
        $.extend($.fn.spectrum.defaults, localization);
    }

    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {
            "red-oid":              {"en": "Red ID",            "de": "Rot ID",             "ru": "Красный ID"},
            "green-oid":            {"en": "Green ID",          "de": "Grün ID",            "ru": "Зелёный ID"},
            "blue-oid":             {"en": "Blue ID",           "de": "Blau ID",            "ru": "Синий ID"},
            "divisor":              {"en": "divisor",           "de": "Divisor",            "ru": "Делитель"},
			"decimal": 		        {"en": "Precision",         "de": "Nach Komma",         "ru": "Чисел посля запятой"},
            "command-oid":          {"en": "Command ID",        "de": "Command ID",         "ru": "Command ID"},
            "xy-oid":               {"en": "XY ID",             "de": "XY ID",              "ru": "XY ID"},
            "level-oid":            {"en": "Level ID",          "de": "Level ID",           "ru": "Level ID"},
            "gamut":                {"en": "Gamut/Model",       "de": "Gamut/Model",        "ru": "Gamut/Model"},
            "gamut_tooltip": {
                "en": "Gamut ID (A,B,C) or Model ID (LCT001 etc.)",
                "de": "Gamut ID (A,B,C) oder Model ID (LCT001 usw.)",
                "ru": "Gamut ID (A,B,C) or Model ID (LCT001 etc.)"
            },
            "transitionTime":       {"en": "Transition Time",   "de": "Übergangszeit",      "ru": "Transition Time"},
            "transitionTime_tooltip": {
                "en": "Transition time in 1/10s",
                "de": "Übergangszeit in 1/10s",
                "ru": "Transition time in 1/10s"
            },
            "pickerBackground":     {"en": "Background Color",  "de": "Hintergrundfarbe",   "ru": "Background Color"},
            "pickerWidth":          {"en": "Picker Width",      "de": "Farbwahl Breite",    "ru": "Picker Width"},
            "pickerHeight":         {"en": "Picker Height",     "de": "Farbwahl Höhe",      "ru": "Picker Height"},
            "buttonName":           {"en": "Button Text",       "de": "Buttontext",         "ru": "Button Text"},
            "closeButton":          {"en": "Close button",      "de": "Schließen Button",   "ru": "Close button"},
            "group_rgb":            {"en": "R.G.B.",            "de": "R.G.B.",             "ru": "R.G.B."},
            "rgb-oid":              {"en": "RGB ID",            "de": "RGB ID",             "ru": "RGB ID"},
            "group_hue":            {"en": "H.S.L.",            "de": "H.S.L.",             "ru": "H.S.L."},
            "hue-oid":              {"en": "HUE ID",            "de": "HUE ID",             "ru": "HUE ID"},
            "sat-oid":              {"en": "Saturation ID",     "de": "Sättigung ID",       "ru": "ID Насыщенность"},
            "bri-oid":              {"en": "Brightness ID",     "de": "Helligkeit ID",      "ru": "ID Яркость"}
        });
    }

    vis.binds.colorpicker = {
		version: "1.2.0",
		showVersion: function () {
			if (vis.binds.colorpicker.version) {
				console.log('Version vis-colorpicker: ' + vis.binds.colorpicker.version);
				vis.binds.colorpicker.version = null;
			}
		},
        jscolor: function (el, data) {
            data = data._data || data;
            var $this = $(el);
            var handler = [];
            var factor  = parseFloat(data.factor) || 1;
            var decimal = parseInt(data.decimal || 0, 10) || 0;

            var picker = new jscolor($this[0], {
                valueElement:   data.showValue || false,
                onFineChange:   function () {
                    for (var h = 0; h < handler.length; h++) {
                        handler[h]();
                    }
                },
                closable:       !!data.closeText,
                closeText:      data.closeText
            });

            $this.click(function () {
                picker.show();
            });

            if (data['hue-oid'] && data['hue-oid'] !== 'nothing_selected' &&
                data['sat-oid'] && data['sat-oid'] !== 'nothing_selected' &&
                data['bri-oid'] && data['bri-oid'] !== 'nothing_selected') {
                var hue = data['hue-oid'];
                var sat = data['sat-oid'];
                var bri = data['bri-oid'];

                handler.push(function () {
                    vis.setValue(hue, parseFloat(picker.hsv[0]).toFixed(decimal));
                    vis.setValue(sat, parseFloat((picker.hsv[1] / factor).toFixed(decimal)));
                    vis.setValue(bri, parseFloat((picker.hsv[2] / factor).toFixed(decimal)));
                });

                var htimer = null;
                var hueChanged = function () {
                    if (htimer) clearTimeout(htimer);
                    htimer = setTimeout(function () {
                        htimer = null;
                        picker.fromHSV(
                                Math.round(parseFloat(vis.states[hue + '.val'] || 0)),
                                Math.round(parseFloat(vis.states[sat + '.val'] || 0) * factor),
                                Math.round(parseFloat(vis.states[bri + '.val'] || 0) * factor)
                        );
                    }, 10);
                };

                vis.states.bind(hue + '.val', hueChanged);
                vis.states.bind(sat + '.val', hueChanged);
                vis.states.bind(bri + '.val', hueChanged);

                hueChanged();
            }
            if (data['red-oid'] && data['red-oid']  !== 'nothing_selected' &&
                    data['green-oid'] && data['green-oid'] !== 'nothing_selected' &&
                    data['blue-oid']  && data['blue-oid']  !== 'nothing_selected') {
                var r = data['red-oid'];
                var g = data['green-oid'];
                var b = data['blue-oid'];

                handler.push(function () {
                    vis.setValue(r, parseFloat((picker.rgb[0] / factor).toFixed(decimal)));
                    vis.setValue(g, parseFloat((picker.rgb[1] / factor).toFixed(decimal)));
                    vis.setValue(b, parseFloat((picker.rgb[2] / factor).toFixed(decimal)));
                });

                var timer = null;
                var rgbChanged = function () {
                    if (timer) clearTimeout(timer);
                    timer = setTimeout(function () {
                        timer = null;
                        picker.fromRGB(
                                Math.round(parseFloat(vis.states[r + '.val'] || 0) * factor),
                                Math.round(parseFloat(vis.states[g + '.val'] || 0) * factor),
                                Math.round(parseFloat(vis.states[b + '.val'] || 0) * factor)
                        );
                    }, 10);
                };

                vis.states.bind(r + '.val', rgbChanged);
                vis.states.bind(g + '.val', rgbChanged);
                vis.states.bind(b + '.val', rgbChanged);

                rgbChanged();
            }
            if (data['rgb-oid'] && data['rgb-oid'] !== 'nothing_selected') {
                var rgb = data['rgb-oid'];

                handler.push(function () {
                    vis.setValue(rgb, picker.toHEXString());
                });

                var _rgbChanged = function () {
                    picker.fromString(vis.states[rgb + '.val'] || '');
                };

                vis.states.bind(rgb + '.val', _rgbChanged);

                _rgbChanged();
            }
        },
        rgb2hex: function (r,g,b) {
            return '#' + ('0' + r.toString(16)).slice(-2) + ('0' + g.toString(16)).slice(-2) + ('0' + b.toString(16)).slice(-2);
        },
        hex2rgb: function (hex) {
            var r = parseInt(hex.substr(1, 2), 16);
            var g = parseInt(hex.substr(3, 2), 16);
            var b = parseInt(hex.substr(5, 2), 16);
            return {r: r, g: g, b: b};
        },
        farbtastic: function (el, data) {
            var $this = $(el);
            $this.hide();

            data = data._data || data;
            var handler = [];
            var factor  = parseFloat(data.factor) || 1;
            var decimal = parseInt(data.decimal || 0, 10) || 0;

            var ft = $.farbtastic($this.prev(), function () {
                for (var h = 0; h < handler.length; h++) {
                    handler[h](this.color);
                }
            });

            if (data['hue-oid'] && data['hue-oid'] !== 'nothing_selected' &&
                data['sat-oid'] && data['sat-oid'] !== 'nothing_selected' &&
                data['bri-oid'] && data['bri-oid'] !== 'nothing_selected') {
                var hue = data['hue-oid'];
                var sat = data['sat-oid'];
                var bri = data['bri-oid'];

                handler.push(function (hex) {
                    var color = vis.binds.colorpicker.hex2rgb(hex);
                    vis.setValue(hue, parseFloat(picker.hsv[0]).toFixed(decimal));
                    vis.setValue(sat, parseFloat((picker.hsv[1] / factor).toFixed(decimal)));
                    vis.setValue(bri, parseFloat((picker.hsv[2] / factor).toFixed(decimal)));
                });

                var htimer = null;
                var hueChanged = function () {
                    if (htimer) clearTimeout(htimer);
                    htimer = setTimeout(function () {
                        htimer = null;
                        ft.setColor(vis.binds.colorpicker.rgb2hex(
                                Math.round(parseFloat(vis.states[hue + '.val'] || 0)),
                                Math.round(parseFloat(vis.states[sat + '.val'] || 0) * factor),
                                Math.round(parseFloat(vis.states[bri + '.val'] || 0) * factor)
                        ));
                    }, 10);
                };

                vis.states.bind(hue + '.val', hueChanged);
                vis.states.bind(sat + '.val', hueChanged);
                vis.states.bind(bri + '.val', hueChanged);

                hueChanged();
            }
            if (data['red-oid'] && data['red-oid']  !== 'nothing_selected' &&
                data['green-oid'] && data['green-oid'] !== 'nothing_selected' &&
                data['blue-oid']  && data['blue-oid']  !== 'nothing_selected') {
                var r = data['red-oid'];
                var g = data['green-oid'];
                var b = data['blue-oid'];

                handler.push(function (hex) {
                    var color = vis.binds.colorpicker.hex2rgb(hex);
                    vis.setValue(r, parseFloat((color.r / factor).toFixed(decimal)));
                    vis.setValue(g, parseFloat((color.g / factor).toFixed(decimal)));
                    vis.setValue(b, parseFloat((color.b / factor).toFixed(decimal)));
                });

                var timer = null;
                var rgbChanged = function () {
                    if (timer) clearTimeout(timer);
                    timer = setTimeout(function () {
                        timer = null;
                        ft.setColor(vis.binds.colorpicker.rgb2hex(
                                Math.round(parseFloat(vis.states[r + '.val'] || 0) * factor),
                                Math.round(parseFloat(vis.states[g + '.val'] || 0) * factor),
                                Math.round(parseFloat(vis.states[b + '.val'] || 0) * factor)
                        ));
                    }, 10);
                };

                vis.states.bind(r + '.val', rgbChanged);
                vis.states.bind(g + '.val', rgbChanged);
                vis.states.bind(b + '.val', rgbChanged);

                rgbChanged();
            }
            if (data['rgb-oid'] && data['rgb-oid'] !== 'nothing_selected') {
                var rgb = data['rgb-oid'];

                handler.push(function (hex) {
                    vis.setValue(rgb, hex);
                });

                var _rgbChanged = function () {
                    ft.setColor(vis.states[rgb + '.val'] || '');
                };

                vis.states.bind(rgb + '.val', _rgbChanged);

                _rgbChanged();
            }
        },
        spectrum: function (el, data) {
            data = data._data || data;
            var $this = $(el);
            var handler = [];
            var factor  = parseFloat(data.factor) || 1;
            var decimal = parseInt(data.decimal || 0, 10) || 0;

            $this.spectrum({
                preferredFormat: 'rgb'
            });

            $this.change(function() {
                for (var h = 0; h < handler.length; h++) {
                    handler[h]();
                }
            });
            if (data['hue-oid'] && data['hue-oid'] !== 'nothing_selected' &&
                data['sat-oid'] && data['sat-oid'] !== 'nothing_selected' &&
                data['bri-oid'] && data['bri-oid'] !== 'nothing_selected') {
                var hue = data['hue-oid'];
                var sat = data['sat-oid'];
                var bri = data['bri-oid'];


                handler.push(function () {
                    var hsl = $this.spectrum('get').toHsl();
                    vis.setValue(hue, parseFloat((hsl.h).toFixed(decimal)));
                    vis.setValue(sat, parseFloat((hsl.s * factor).toFixed(decimal)));
                    vis.setValue(bri, parseFloat((hsl.l * factor).toFixed(decimal)));
                });

                var htimer = null;
                var hueChanged = function () {
                    if (htimer) clearTimeout(htimer);
                    htimer = setTimeout(function () {
                        htimer = null;
                        $this.spectrum('set', {
                            h: Math.round(parseFloat(vis.states[hue + '.val'] || 0)),
                            s: Math.round(parseFloat(vis.states[sat + '.val'] || 0) / factor),
                            l: Math.round(parseFloat(vis.states[bri + '.val'] || 0) / factor)
                        });
                    }, 10);
                };

                vis.states.bind(hue + '.val', hueChanged);
                vis.states.bind(sat + '.val', hueChanged);
                vis.states.bind(bri + '.val', hueChanged);

                hueChanged();
            }
            if (data['red-oid']   && data['red-oid']   !== 'nothing_selected' &&
                data['green-oid'] && data['green-oid'] !== 'nothing_selected' &&
                data['blue-oid']  && data['blue-oid']  !== 'nothing_selected') {
                var r = data['red-oid'];
                var g = data['green-oid'];
                var b = data['blue-oid'];

                handler.push(function () {
                    var color = $this.spectrum('get').toRgb();
                    vis.setValue(r, parseFloat((color.r / factor).toFixed(decimal)));
                    vis.setValue(g, parseFloat((color.g / factor).toFixed(decimal)));
                    vis.setValue(b, parseFloat((color.b / factor).toFixed(decimal)));
                });

                var timer = null;
                var rgbChanged = function () {
                    if (timer) clearTimeout(timer);
                    timer = setTimeout(function () {
                        timer = null;
                        $this.spectrum('set', {
                            r: Math.round(parseFloat(vis.states[r + '.val'] || 0) * factor),
                            g: Math.round(parseFloat(vis.states[g + '.val'] || 0) * factor),
                            b: Math.round(parseFloat(vis.states[b + '.val'] || 0) * factor)
                        });
                    }, 10);
                };

                vis.states.bind(r + '.val', rgbChanged);
                vis.states.bind(g + '.val', rgbChanged);
                vis.states.bind(b + '.val', rgbChanged);

                rgbChanged();
            }
            if (data['rgb-oid'] && data['rgb-oid'] !== 'nothing_selected') {
                var rgb = data['rgb-oid'];

                handler.push(function () {
                    vis.setValue(rgb, $this.spectrum('get').toHexString());
                });

                var _rgbChanged = function () {
                    $this.spectrum('set', vis.states[rgb + '.val'] || '');
                };

                vis.states.bind(rgb + '.val', _rgbChanged);

                _rgbChanged();
            }
        },
        spectrumHomematic: function (el, data) {
            data = data._data || data;
            var $this = $(el);
            var handler = [];

            $this.spectrum({
                homematic: true,
                preferredFormat: "convert360To200",
                showInput: false,
                color: "hsv(360,0%,100%)",
                showPalette: true,
                palette: ["white"]
            });

            $this.change(function() {
                for (var h = 0; h < handler.length; h++) {
                    handler[h]();
                }
            });


            if (data['color-oid'] && data['color-oid'] !== 'nothing_selected') {
                var color = data['color-oid'];

                handler.push(function () {
                    vis.setValue(color, $this.spectrum('get').toHMString());
                });

                var _colorChanged = function () {
                    var currentColor = vis.states[color + '.val'] === 0 ? 0 : vis.states[color + '.val'] || 200;
                    var saturation = "100%";
                    if (currentColor >= 200) {
                        saturation = "0%";
                        currentColor = 200;
                    }
                    var hsvVal = Math.round(currentColor / 200 * 360);
                    $this.spectrum('set',"hsv(" + hsvVal + "," + saturation + ",100%)");
                };

                vis.states.bind(color + '.val', _colorChanged);

                _colorChanged();
            }
        },
        jscolorcie: function (el, data) {
            data = data._data ? JSON.parse(JSON.stringify(data._data)) : data;
            data.pickerWidth     = parseInt(data.pickerWidth)  || 100;
            data.pickerHeight    = parseInt(data.pickerHeight) || 100;
            data.gamut           = typeof data.gamut === 'string' ? data.gamut : 'default';
            var gamutZoom   = true;
            data.transitionTime  = parseInt(data.transitionTime) || 0;
            data.buttonName      = typeof data.buttonName  === 'string' ? data.buttonName  : '';
            data.closeButton     = typeof data.closeButton === 'string' ? data.closeButton : '';
            var factor  = parseFloat(data.factor) || 1;
            var decimal = parseInt(data.decimal || 0, 10) || 0;

            var $this = $(el);
            $this.html(data.buttonName);
            var handler = [];

            var picker = new jscolor($this[0], {
                valueElement:   false,
                onFineChange:   function () {
                    for (var h = 0; h < handler.length; h++) {
                        handler[h]();
                    }
                },
                mode:            'CIE',
                gamut:           data.gamut,
                gamutZoom:       gamutZoom,
                width:           data.pickerWidth,
                height:          data.pickerHeight,
                closable:        !!data.closeButton,
                closeText:       data.closeButton,
                padding:         0,
                shadow:          false,
                borderWidth:     0,
                backgroundColor: data.pickerBackground,
                insetColor:      '#000'
            });

            if (data['command-oid']  && data['command-oid'] !== 'nothing_selected' &&
                data['xy-oid']       && data['xy-oid']      !== 'nothing_selected' &&
                data['level-oid']    && data['level-oid']   !== 'nothing_selected') {
                var cmd_id   = data['command-oid'];
                var xy_id    = data['xy-oid'];
                var level_id = data['level-oid'];

                handler.push(function () {
                    if (cmd_id !== 'nothing_selected') {
                        var cmd = '{"transitiontime":' + data.transitionTime + ',"xy":"' + picker.xy[0] + ',' + picker.xy[1] + '",' + '"level":' + Math.round(picker.xy[2] * 100) + '}';
                        vis.setValue(cmd_id, cmd);
                    }
                });

                var onChange = function () {
                    var xy = vis.states[xy_id + '.val'] || '0.5,0.5';
                    if (typeof xy !== 'string') xy = '0.5,0.5';

                    var level = vis.states[level_id + '.val'] || 0;
                    xy = xy.split(',');
                    if (xy.length === 2) {
                        picker.fromXY(parseFloat(xy[0]), parseFloat(xy[1]), parseInt(level) / 100);
                    }
                };


                vis.states.bind(xy_id    + '.val', onChange);
                vis.states.bind(level_id + '.val', onChange);
                onChange();
            }
            if (data['hue-oid'] && data['hue-oid'] !== 'nothing_selected' &&
                    data['sat-oid'] && data['sat-oid'] !== 'nothing_selected' &&
                    data['bri-oid'] && data['bri-oid'] !== 'nothing_selected') {
                var hue = data['hue-oid'];
                var sat = data['sat-oid'];
                var bri = data['bri-oid'];

                handler.push(function () {
                    vis.setValue(hue, parseFloat(picker.hsv[0]).toFixed(decimal));
                    vis.setValue(sat, parseFloat((picker.hsv[1] / factor).toFixed(decimal)));
                    vis.setValue(bri, parseFloat((picker.hsv[2] / factor).toFixed(decimal)));
                });

                var htimer = null;
                var hueChanged = function () {
                    if (htimer) clearTimeout(htimer);
                    htimer = setTimeout(function () {
                        htimer = null;
                        picker.fromHSV(
                            Math.round(parseFloat(vis.states[hue + '.val'] || 0)),
                            Math.round(parseFloat(vis.states[sat + '.val'] || 0) * factor),
                            Math.round(parseFloat(vis.states[bri + '.val'] || 0) * factor)
                        );
                    }, 10);
                };

                vis.states.bind(hue + '.val', hueChanged);
                vis.states.bind(sat + '.val', hueChanged);
                vis.states.bind(bri + '.val', hueChanged);

                hueChanged();
            }
            if (data['red-oid'] && data['red-oid']  !== 'nothing_selected' &&
                    data['green-oid'] && data['green-oid'] !== 'nothing_selected' &&
                    data['blue-oid']  && data['blue-oid']  !== 'nothing_selected') {
                var r = data['red-oid'];
                var g = data['green-oid'];
                var b = data['blue-oid'];

                handler.push(function () {
                    vis.setValue(r, parseFloat((picker.rgb[0] / factor).toFixed(decimal)));
                    vis.setValue(g, parseFloat((picker.rgb[1] / factor).toFixed(decimal)));
                    vis.setValue(b, parseFloat((picker.rgb[2] / factor).toFixed(decimal)));
                });

                var timer = null;
                var rgbChanged = function () {
                    if (timer) clearTimeout(timer);
                    timer = setTimeout(function () {
                        timer = null;
                        picker.fromRGB(
                                Math.round(parseFloat(vis.states[r + '.val'] || 0) * factor),
                                Math.round(parseFloat(vis.states[g + '.val'] || 0) * factor),
                                Math.round(parseFloat(vis.states[b + '.val'] || 0) * factor)
                        );
                    }, 10);
                };

                vis.states.bind(r + '.val', rgbChanged);
                vis.states.bind(g + '.val', rgbChanged);
                vis.states.bind(b + '.val', rgbChanged);

                rgbChanged();
            }
            if (data['rgb-oid'] && data['rgb-oid'] !== 'nothing_selected') {
                var rgb = data['rgb-oid'];

                handler.push(function () {
                    vis.setValue(rgb, picker.toHEXString());
                });

                var _rgbChanged = function () {
                    picker.fromString(vis.states[rgb + '.val'] || '');
                };

                vis.states.bind(rgb + '.val', _rgbChanged);

                _rgbChanged();
            }
        },
        huepickerxy: function (el, data) {
            data = data._data ? JSON.parse(JSON.stringify(data._data)) : data;
            data.gamut = typeof data.gamut === 'string' ? data.gamut : 'default';
            data.transitionTime = parseInt(data.transitionTime) || 0;
            var gamutZoom = true;

            var $this = $(el);

            //build canvas
            var canvas = document.createElement('canvas');
            var img = document.createElement("img");
            canvas.appendChild(img);
            function redraw() {
                canvas.width = $this.width();
                canvas.height = $this.height();
                var ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = "#FFFFFF";
                ctx.fillRect(0, 0, canvas.width, canvas.height); // Need to Fill Canvas otherwise its unable to be modified...
                var XYImagedata = ctx.getImageData(0, 0, canvas.width, canvas.height);
                for (var x = 0; x < canvas.width; x++) { // Every Pixel on ScanLine
                    for (var y = 0; y < canvas.height; y++) { // Every ScanLine
                        var Index = (x + y * canvas.width) * 4; // Index of Pixel
                        var xy;
                        if (gamutZoom){
                            xy = huepi.HelperZoomXYforModel(x / canvas.width, 1 - (y / canvas.height), data.gamut);
                        }else {
                            xy = [
                                x / canvas.width,
                                1 - (y / canvas.height)
                            ]
                        }
                        var XYColor = huepi.HelperXYtoRGBforModel(xy[0], xy[1], 1, data.gamut);
                        var TestColor = huepi.HelperXYtoRGB(xy[0], xy[1], 1);
                        if (TestColor.Red !== XYColor.Red || TestColor.Green !== XYColor.Green || TestColor.Blue !== XYColor.Blue){
                            XYImagedata.data[Index] = XYColor.Red * 240;
                            XYImagedata.data[Index + 1] = XYColor.Green * 240;
                            XYImagedata.data[Index + 2] = XYColor.Blue * 240;
                        }else {
                            XYImagedata.data[Index] = XYColor.Red * 255;
                            XYImagedata.data[Index + 1] = XYColor.Green * 255;
                            XYImagedata.data[Index + 2] = XYColor.Blue * 255;
                        }
                    }
                }
                ctx.putImageData(XYImagedata, 0, 0);
                img.src = canvas.toDataURL("image/png");

                var xyGet = vis.states[xy_id + '.val'] || '0.5,0.5';
                if (typeof xyGet !== 'string') xyGet = '0.5,0.5';
                xyGet = xyGet.split(',');
                xyGet = huepi.HelperUnzoomXYforModel(xyGet[0], xyGet[1], data.gamut);
                var centerX = xyGet[0] * canvas.width;
                var centerY = canvas.height - (xyGet[1] * canvas.height);
                var radius = 6;
                ctx.beginPath();
                ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI, false);
                ctx.lineWidth = 2;
                ctx.strokeStyle = '#000000';
                ctx.stroke();
                $this.html(canvas);
            }
            $this.parent().parent().resize(function() {
				redraw();
			});
            $this.show(function() {
                redraw();
            });

			if (data['command-oid']  && data['command-oid'] !== 'nothing_selected' &&
                data['xy-oid']       && data['xy-oid']      !== 'nothing_selected') {
                var cmd_id   = data['command-oid'];
                var xy_id    = data['xy-oid'];

                $this.click(function (e) {
                    var xy = [e.offsetX / canvas.width, 1 - (e.offsetY / canvas.height)];
                    if (gamutZoom) {
                        xy = huepi.HelperZoomXYforModel(xy[0], xy[1], data.gamut);
					}
					var cmd = '{"transitiontime":' + data.transitionTime + ',"xy":"' + xy[0] + ',' + xy[1] + '"}';
					vis.setValue(cmd_id, cmd);
                });

                var onChange = function () {
                    redraw();
                };

                vis.states.bind(xy_id    + '.val', onChange);
            }
        },
        hueindicatorxy: function (el, data) {
            data = data._data ? JSON.parse(JSON.stringify(data._data)) : data;
            data.gamut = typeof data.gamut === 'string' ? data.gamut : 'default';
            var $this = $(el);

            if (data['xy-oid']       && data['xy-oid']      !== 'nothing_selected') {
                var xy_id    = data['xy-oid'];

                var onChange = function () {
                    var xyGet = vis.states[xy_id + '.val'] || '0.5,0.5';
                    if (typeof xyGet !== 'string') xyGet = '0.5,0.5';
                    xyGet = xyGet.split(',');
                    var rgb = huepi.HelperXYtoRGBforModel(xyGet[0], xyGet[1], 1, data.gamut);
                    $this.css("background-color", huepi.HelperRGBToHEX(rgb));
                };

                vis.states.bind(xy_id    + '.val', onChange);
                onChange();
            }
        },
        huepickerct: function (el, data) {
            data = data._data ? JSON.parse(JSON.stringify(data._data)) : data;
            data.transitionTime = parseInt(data.transitionTime) || 0;
            var ctMin = 2000;
            var ctMax = 6500;

            var $this = $(el);

            //build canvas
            var canvas = document.createElement('canvas');
            var img = document.createElement("img");
            canvas.appendChild(img);
            function redraw() {
                canvas.width = $this.width();
                canvas.height = $this.height();
                var ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = "#FFFFFF";
                ctx.fillRect(0, 0, canvas.width, canvas.height); // Need to Fill Canvas otherwise its unable to be modified...
                var XYImagedata = ctx.getImageData(0, 0, canvas.width, canvas.height);
                for (var x = 0; x < canvas.width; x++) { // Every Pixel on ScanLine
                    var ctColor = huepi.HelperColortemperaturetoRGB(ctMin + (x / canvas.width * (ctMax - ctMin)));
                    for (var y = 0; y < canvas.height; y++) { // Every ScanLine
                        var Index = (x + y * canvas.width) * 4; // Index of Pixel
						XYImagedata.data[Index] = ctColor.Red * 255;
						XYImagedata.data[Index + 1] = ctColor.Green * 255;
						XYImagedata.data[Index + 2] = ctColor.Blue * 255;
                    }
                }
                ctx.putImageData(XYImagedata, 0, 0);
                img.src = canvas.toDataURL("image/png");
                var ctGet = parseInt(vis.states[ct_id + '.val']) || 153;
                ctGet = Math.max(2000, Math.min(6500, Math.round(Math.pow(10,6)/ctGet)));
                ctGet = canvas.width / ((ctMax-ctMin) / (ctGet-ctMin));
                ctx.beginPath();
                ctx.lineWidth = 2;
                ctx.strokeStyle = '#000000';
                ctx.moveTo(ctGet, 0);
                ctx.lineTo(ctGet, canvas.height);
                ctx.stroke();
                $this.html(canvas);
            }
            $this.parent().parent().resize(function() {
                redraw();
            });
            $this.show(function() {
                redraw();
            });

            if (data['command-oid']  && data['command-oid'] !== 'nothing_selected' &&
                data['ct-oid']       && data['ct-oid']      !== 'nothing_selected') {
                var cmd_id   = data['command-oid'];
                var ct_id    = data['ct-oid'];

                $this.click(function (e) {
                    var ct = e.offsetX / canvas.width;
                    ct = Math.round(ctMin + (ctMax-ctMin) * ct);
                    ct = Math.max(153, Math.min(500, Math.round(Math.pow(10,6)/ct)));
                    var cmd = '{"transitiontime":' + data.transitionTime + ',"ct":"' + ct + '"}';
                    vis.setValue(cmd_id, cmd);
                });

                var onChange = function () {
                    redraw();
                };

                vis.states.bind(ct_id    + '.val', onChange);
            }
        },
        hueindicatorct: function (el, data) {
            data = data._data ? JSON.parse(JSON.stringify(data._data)) : data;
            var $this = $(el);

            if (data['ct-oid']       && data['ct-oid']      !== 'nothing_selected') {
                var ct_id    = data['ct-oid'];

                var onChange = function () {
                    var ctGet = parseInt(vis.states[ct_id + '.val']) || 153;
                    ctGet = Math.max(2000, Math.min(6500, Math.round(Math.pow(10,6)/ctGet)));
                    var rgb = huepi.HelperColortemperaturetoRGB(ctGet);
                    $this.css("background-color", huepi.HelperRGBToHEX(rgb));
                };

                vis.states.bind(ct_id    + '.val', onChange);
                onChange();
            }
        }
    };

    if (vis.editMode) {
        vis.binds.colorpicker.changedHUE = function (widgetID, view, newId, fields) {
            var cmd     = vis.objects[newId];
            var changed = [];

            // If it is real object and state
            if (cmd && cmd.common && cmd.type === 'state') {
                var light   = vis.objects[newId.split('.').slice(0,-1).join('.')];
                var xy      = vis.objects[newId.split('.').slice(0,-1).join('.') + '.xy'];
                var level   = vis.objects[newId.split('.').slice(0,-1).join('.') + '.level'];

                if (xy && xy.type === 'state' && !vis.views[view].widgets[widgetID].data['xy-oid']) {
                    changed.push('xy-oid');
                    vis.views[view].widgets[widgetID].data['xy-oid'] = newId.split('.').slice(0,-1).join('.') + '.xy';
                    vis.widgets[widgetID].data['xy-oid'] = newId.split('.').slice(0,-1).join('.') + '.xy';
                }
                if (level && level.type === 'state' && !vis.views[view].widgets[widgetID].data['level-oid']) {
                    changed.push('level-oid');
                    vis.views[view].widgets[widgetID].data['level-oid'] = newId.split('.').slice(0,-1).join('.') + '.level';
                    vis.widgets[widgetID].data['level-oid'] = newId.split('.').slice(0,-1).join('.') + '.level';
                }
                if (light.native.modelid !== undefined && !vis.views[view].widgets[widgetID].data.gamut) {
                    changed.push('gamut');
                    vis.views[view].widgets[widgetID].data.gamut = light.native.modelid;
                    vis.widgets[widgetID].data.gamut = light.native.modelid;
                }
            }
            return changed;
        };
        vis.binds.colorpicker.changedHUEPickerXY = function (widgetID, view, newId, fields) {
            var cmd     = vis.objects[newId];
            var changed = [];

            // If it is real object and state
            if (cmd && cmd.common && cmd.type === 'state') {
                var light   = vis.objects[newId.split('.').slice(0,-1).join('.')];
                var xy      = vis.objects[newId.split('.').slice(0,-1).join('.') + '.xy'];

                if (xy && xy.type === 'state' && !vis.views[view].widgets[widgetID].data['xy-oid']) {
                    changed.push('xy-oid');
                    vis.views[view].widgets[widgetID].data['xy-oid'] = newId.split('.').slice(0,-1).join('.') + '.xy';
                    vis.widgets[widgetID].data['xy-oid'] = newId.split('.').slice(0,-1).join('.') + '.xy';
                }
                if (light.native.modelid !== undefined && !vis.views[view].widgets[widgetID].data.gamut) {
                    changed.push('gamut');
                    vis.views[view].widgets[widgetID].data.gamut = light.native.modelid;
                    vis.widgets[widgetID].data.gamut = light.native.modelid;
                }
            }
            return changed;
        };
        vis.binds.colorpicker.changedHUEPickerCT = function (widgetID, view, newId, fields) {
            var cmd     = vis.objects[newId];
            var changed = [];

            // If it is real object and state
            if (cmd && cmd.common && cmd.type === 'state') {
                var light   = vis.objects[newId.split('.').slice(0,-1).join('.')];
                var ct      = vis.objects[newId.split('.').slice(0,-1).join('.') + '.ct'];

                if (ct && ct.type === 'state' && !vis.views[view].widgets[widgetID].data['ct-oid']) {
                    changed.push('ct-oid');
                    vis.views[view].widgets[widgetID].data['ct-oid'] = newId.split('.').slice(0,-1).join('.') + '.ct';
                    vis.widgets[widgetID].data['ct-oid'] = newId.split('.').slice(0,-1).join('.') + '.ct';
                }
            }
            return changed;
        };
        vis.binds.colorpicker.changedHUEIndicatorXY = function (widgetID, view, newId, fields) {
            var xy     = vis.objects[newId];
            var changed = [];

            // If it is real object and state
            if (xy && xy.common && xy.type === 'state') {
                var light   = vis.objects[newId.split('.').slice(0,-1).join('.')];

                if (xy && xy.type === 'state' && !vis.views[view].widgets[widgetID].data['xy-oid']) {
                    changed.push('xy-oid');
                    vis.views[view].widgets[widgetID].data['xy-oid'] = newId.split('.').slice(0,-1).join('.') + '.xy';
                    vis.widgets[widgetID].data['xy-oid'] = newId.split('.').slice(0,-1).join('.') + '.xy';
                }
                if (light.native.modelid !== undefined && !vis.views[view].widgets[widgetID].data.gamut) {
                    changed.push('gamut');
                    vis.views[view].widgets[widgetID].data.gamut = light.native.modelid;
                    vis.widgets[widgetID].data.gamut = light.native.modelid;
                }
            }
            return changed;
        };
    }

	vis.binds.colorpicker.showVersion();
</script>

<script id="tplRGBSpectrum"
                 type="text/ejs"
                 class="vis-tpl"
                 data-vis-prev='<img src="widgets/colorpicker/img/Prev_tplRGBSpectrum.png"></img>'
                 data-vis-set="colorpicker"
                 data-vis-type="ctrl,color"
                 data-vis-name="RGB spectrum"
                 data-vis-attrs="rgb-oid/id;"
                 data-vis-attrs0="group.rgb;red-oid/id;green-oid/id;blue-oid/id;"
                 data-vis-attrs1="group.hue;hue-oid/id;sat-oid/id;bri-oid/id;"
                 data-vis-attrs2="group.extra;factor[1];decimal[0]/slider,0,5,1;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <input style="width: 100%; height: 100%" <%= (el) -> vis.binds.colorpicker.spectrum(el, data) %> />
        </div>
    </div>
</script>

<script id="tplSpectrumHomematic"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/colorpicker/img/Prev_tplRGBSpectrum.png"></img>'
        data-vis-set="colorpicker"
        data-vis-type="ctrl,color"
        data-vis-name="Homematic spectrum"
        data-vis-attrs="color-oid/id;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <input style="width: 100%; height: 100%" <%= (el) -> vis.binds.colorpicker.spectrumHomematic(el, data) %> />
        </div>
    </div>
</script>

<script id="tplRGBFarbtastic"
        class="vis-tpl" 
        type="text/ejs"
        data-vis-prev='<img src="widgets/colorpicker/img/Prev_tplRGBFarbtastic.png"></img>'
        data-vis-set="colorpicker"
        data-vis-type="ctrl,color"
        data-vis-name="farbtastic"
        data-vis-attrs="rgb-oid/id;"
        data-vis-attrs0="group.rgb;red-oid/id;green-oid/id;blue-oid/id;"
        data-vis-attrs1="group.hue;hue-oid/id;sat-oid/id;bri-oid/id;"
        data-vis-attrs2="group.extra;factor[1];decimal[0]/slider,0,5,1;"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 196px; height: 196px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div></div>
            <input <%= (el) -> vis.binds.colorpicker.farbtastic(el, data) %> />
        </div>
    </div>
</script>

<script id="tplHUEjscolor"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/colorpicker/img/Prev_tplHUEjscolor.png"></img>'
        data-vis-set="colorpicker"
        data-vis-type="ctrl,color"
        data-vis-name="Philips HUE"
        data-vis-attrs="command-oid/id/changedHUE;xy-oid/id;level-oid/id;gamut;transitionTime[4]/number,0,30000,1;pickerWidth[100]/number,0,500,1;pickerHeight[100]/number,0,500,1;pickerBackground/color;buttonName[HUE]/html;closeButton[close];"
        data-vis-attrs0="group.rgb;red-oid/id;green-oid/id;blue-oid/id;divisor[1];decimal[0]/slider,0,5,1;rgb-oid/id;"
        data-vis-attrs1="group.hue;hue-oid/id;sat-oid/id;bri-oid/id;"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:100px;height:100px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="display:table;">
            <div class="ui-button ui-state-default ui-corner-all" style="width:100%;height:100%;display:table-cell;" <%= (el) -> vis.binds.colorpicker.jscolorcie(el, data) %> ></div>
        </div>
    </div>
</script>

<script id="tplHUEPickerXY"
		type="text/ejs"
		class="vis-tpl"
		data-vis-prev='<img src="widgets/colorpicker/img/Prev_tplHUEPickerXY.png"></img>'
		data-vis-set="colorpicker"
		data-vis-type="ctrl,color"
		data-vis-name="Philips HUE XY-Picker"
		data-vis-attrs="command-oid/id/changedHUEPickerXY;xy-oid/id;gamut;transitionTime[4]/number,0,30000,1;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:100px;height:100px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div class="hue-canvas" style="width:100%;height:100%;cursor:crosshair;" <%= (el) -> vis.binds.colorpicker.huepickerxy(el, data) %> ></div>
        </div>
    </div>
</script>

<script id="tplHUEIndicatorXY"
		type="text/ejs"
		class="vis-tpl"
		data-vis-prev='<img src="widgets/colorpicker/img/Prev_tplHUEIndicatorXY.png"></img>'
		data-vis-set="colorpicker"
		data-vis-type="value,color"
		data-vis-name="Philips HUE XY-Indicator"
		data-vis-attrs="xy-oid/id/changedHUEIndicatorXY;gamut;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:100px;height:100px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div class="hue-indicator-xy" style="width:100%;height:100%;" <%= (el) -> vis.binds.colorpicker.hueindicatorxy(el, data) %> ></div>
        </div>
    </div>
</script>

<script id="tplHUEPickerCT"
		type="text/ejs"
		class="vis-tpl"
		data-vis-prev='<img src="widgets/colorpicker/img/Prev_tplHUEPickerCT.png"></img>'
		data-vis-set="colorpicker"
		data-vis-type="ctrl,color"
		data-vis-name="Philips HUE CT-Picker"
		data-vis-attrs="command-oid/id/changedHUEPickerCT;ct-oid/id;transitionTime[4]/number,0,30000,1;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:100px;height:100px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div class="hue-canvas-ct" style="width:100%;height:100%;cursor:crosshair;" <%= (el) -> vis.binds.colorpicker.huepickerct(el, data) %> ></div>
        </div>
    </div>
</script>

<script id="tplHUEIndicatorCT"
		type="text/ejs"
		class="vis-tpl"
		data-vis-prev='<img src="widgets/colorpicker/img/Prev_tplHUEIndicatorCT.png"></img>'
		data-vis-set="colorpicker"
		data-vis-type="value,color"
		data-vis-name="Philips HUE CT-Indicator"
		data-vis-attrs="ct-oid/id;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:100px;height:100px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div class="hue-indicator-xy" style="width:100%;height:100%;" <%= (el) -> vis.binds.colorpicker.hueindicatorct(el, data) %> ></div>
        </div>
    </div>
</script>

<script id="tplJscolor" 
		type="text/ejs" 
		class="vis-tpl"
        data-vis-prev='<img src="widgets/colorpicker/img/Prev_tplJscolor.png"></img>'
		data-vis-set="colorpicker"
        data-vis-type="ctrl,color"
		data-vis-name="RGBColor"
		data-vis-attrs="title[RGB:&nbsp];closeText[X];rgb-oid/id;"
        data-vis-attrs0="group.rgb;red-oid/id;green-oid/id;blue-oid/id;"
        data-vis-attrs1="group.hue;hue-oid/id;sat-oid/id;bri-oid/id;"
        data-vis-attrs2="group.extra;factor[1];decimal[0]/slider,0,5,1;"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 96px; height: 50px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="display: inline-block">
            <table style="border: 0; border-spacing: 0; width: 100%; height: 100%" class="vis-no-spaces">
            	<tr class="vis-no-spaces">
					<td class="vis-no-spaces"><%== this.data.attr('title') %></td>
					<td class="vis-no-spaces"><input style="width: calc(100% - 5px); height: 100%" readonly <%= (el) -> vis.binds.colorpicker.jscolor(el, this.data) %> /></td>
				</tr>
			</table>
        </div>
    </div>
</script>


<!-- --------------colorpicker.html--- END -->
<!-- --------------consumption.html--- START -->
<!--
    ioBroker.consumption

    version: "0.4.3"

    Copyright 2020 bluefox <dogafox@gmail.com>
-->
<link rel="stylesheet" type="text/css" href="widgets/consumption/css/styles.css" />

<script type="text/javascript">

    /*var vis = {
        editMode: false,
        binds: {},
        conn: {
            getStates: function () {}
        },
        unregisterOnChange: function () {}
    };
    function _(a) {return a; }
    function $(item) { return item; }*/

    $.extend(true, systemDictionary, {
        "%s overview": {
            "en": "%s overview",
            "de": "%s Übersicht",
            "ru": "%s обзор",
            "pt": "Visão geral do %s",
            "nl": "Overzicht van %s",
            "fr": "Présentation de %s",
            "it": "Panoramica di %s",
            "es": "Resumen de %s",
            "pl": "Przegląd %s",
            "zh-cn": "％s概述"
        },
        "Actual": {
            "en": "Actual",
            "de": "Tatsächlich",
            "ru": "Этот год",
            "pt": "Real",
            "nl": "Eigenlijk",
            "fr": "Réel",
            "it": "Effettivo",
            "es": "Real",
            "pl": "Rzeczywisty",
            "zh-cn": "实际"
        },
        "All": {
            "en": "All",
            "de": "Alle",
            "ru": "Все",
            "pt": "Tudo",
            "nl": "Allemaal",
            "fr": "Tout",
            "it": "Tutti",
            "es": "Todos",
            "pl": "Wszystko",
            "zh-cn": "所有"
        },
        "Costs for %s": {
            "en": "Costs for %s",
            "de": "Kosten für %s",
            "ru": "Затраты на %s",
            "pt": "Custos para %s",
            "nl": "Kosten voor %s",
            "fr": "Coûts pour %s",
            "it": "Costi per %s",
            "es": "Costos para %s",
            "pl": "Koszty dla %s",
            "zh-cn": "％s的费用"
        },
        "Forecast": {
            "en": "Forecast",
            "de": "Prognose",
            "ru": "Прогноз",
            "pt": "Previsão",
            "nl": "Voorspelling",
            "fr": "Prévoir",
            "it": "previsione",
            "es": "Pronóstico",
            "pl": "Prognoza",
            "zh-cn": "预测"
        },
        "Heat map": {
            "en": "Heat map",
            "de": "Wärmekarte",
            "ru": "Тепловая карта",
            "pt": "Mapa de calor",
            "nl": "Heat map",
            "fr": "Carte de chaleur",
            "it": "Mappa di calore",
            "es": "Mapa de calor",
            "pl": "Mapa ciepła",
            "zh-cn": "热图"
        },
        "Name": {
            "en": "Name",
            "de": "Name",
            "ru": "Имя",
            "pt": "Nome",
            "nl": "Naam",
            "fr": "Nom",
            "it": "Nome",
            "es": "Nombre",
            "pl": "Imię",
            "zh-cn": "名称"
        },
        "Now %s": {
            "en": "Now %s",
            "de": "Jetzt %s",
            "ru": "Сейчас %s",
            "pt": "Agora %s",
            "nl": "Nu %s",
            "fr": "Maintenant %s",
            "it": "Ora %s",
            "es": "Ahora %s",
            "pl": "Teraz %s",
            "zh-cn": "现在％s"
        },
        "Pie chart": {
            "en": "Pie chart",
            "de": "Kuchendiagramm",
            "ru": "Круговая диаграмма",
            "pt": "Gráfico de pizza",
            "nl": "Cirkeldiagram",
            "fr": "Diagramme circulaire",
            "it": "Grafico a torta",
            "es": "Gráfico circular",
            "pl": "Wykres kołowy",
            "zh-cn": "饼形图"
        },
        "Planned": {
            "en": "Planned",
            "de": "Geplant",
            "ru": "Запланированные",
            "pt": "Planejado",
            "nl": "Gepland",
            "fr": "Prévu",
            "it": "Planned",
            "es": "Planificado",
            "pl": "Zaplanowany",
            "zh-cn": "计划"
        },
        "Planning": {
            "en": "Planning",
            "de": "Planung",
            "ru": "Запланировано",
            "pt": "Planejamento",
            "nl": "Planning",
            "fr": "Planification",
            "it": "Pianificazione",
            "es": "Planificación",
            "pl": "Planowanie",
            "zh-cn": "规划"
        },
        "Reference": {
            "en": "Reference",
            "de": "Referenz",
            "ru": "Сравнение",
            "pt": "Referência",
            "nl": "Referentie",
            "fr": "Référence",
            "it": "Riferimento",
            "es": "Referencia",
            "pl": "Odniesienie",
            "zh-cn": "参考"
        },
        "Stack bar": {
            "en": "Stack bar",
            "de": "Stapelleiste",
            "ru": "Stack bar",
            "pt": "Barra de empilhamento",
            "nl": "Stapelbalk",
            "fr": "Barre de pile",
            "it": "Stack bar",
            "es": "Barra de pila",
            "pl": "Pasek stosu",
            "zh-cn": "堆叠栏"
        },
        "Table": {
            "en": "Table",
            "de": "Tabelle",
            "ru": "Таблица",
            "pt": "Tabela",
            "nl": "Tafel",
            "fr": "Table",
            "it": "tavolo",
            "es": "Mesa",
            "pl": "Stół",
            "zh-cn": "表"
        },
        "Total": {
            "en": "Total",
            "de": "Gesamt",
            "ru": "Итого",
            "pt": "Total",
            "nl": "Totaal",
            "fr": "Total",
            "it": "Totale",
            "es": "Total",
            "pl": "Całkowity",
            "zh-cn": "总"
        },
        "from": {
            "en": "from",
            "de": "von",
            "ru": "от",
            "pt": "de",
            "nl": "van",
            "fr": "de",
            "it": "a partire dal",
            "es": "desde",
            "pl": "od",
            "zh-cn": "从"
        },
        "rendering...": {
            "en": "rendering...",
            "de": "Rendern...",
            "ru": "рендеринг...",
            "pt": "Renderização...",
            "nl": "renderen...",
            "fr": "le rendu...",
            "it": "il rendering ...",
            "es": "representación...",
            "pl": "wykonanie...",
            "zh-cn": "渲染..."
        },
        "to": {
            "en": "to",
            "de": "bis",
            "ru": "до",
            "pt": "para",
            "nl": "naar",
            "fr": "à",
            "it": "per",
            "es": "a",
            "pl": "do",
            "zh-cn": "至"
        },
        "Total overview": {
            "en": "Total overview",
            "de": "Gesamtübersicht",
            "ru": "Общий обзор",
            "pt": "Visão geral total",
            "nl": "Totaal overzicht",
            "fr": "Vue d'ensemble",
            "it": "Panoramica totale",
            "es": "Resumen total",
            "pl": "Ogólny przegląd",
            "zh-cn": "总概述"
        }
    });

    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {
            "consInstance": {
                "en": "Instance",
                "de": "Instanz",
                "ru": "Инстанция",
                "pt": "Instância",
                "nl": "Voorbeeld",
                "fr": "Exemple",
                "it": "Esempio",
                "es": "Ejemplo",
                "pl": "Instancja",
                "zh-cn": "实例"
            },
            "colorTheme": {
                "en": "Theme",
                "de": "Thema",
                "ru": "Тема",
                "pt": "Tema",
                "nl": "Thema",
                "fr": "Thème",
                "it": "Tema",
                "es": "Tema",
                "pl": "Motyw",
                "zh-cn": "主题"
            },
            "startsFrom": {
                "en": "Data start from",
                "de": "Daten beginnen ab",
                "ru": "Данные начинаются с",
                "pt": "Os dados começam em",
                "nl": "Gegevens beginnen vanaf",
                "fr": "Les données commencent à partir de",
                "it": "I dati iniziano da",
                "es": "Los datos comienzan desde",
                "pl": "Dane zaczynają się od",
                "zh-cn": "数据从"
            },
            "startsFrom_tooltip": {
                "en": "In form 2020-01 or 2020-01-01",
                "de": "In Form 2020-01 oder 2020-01-01",
                "ru": "По форме 2020-01 или 2020-01-01",
                "pt": "No formulário 2020-01 ou 2020-01-01",
                "nl": "In vorm 2020-01 of 2020-01-01",
                "fr": "Sous forme 2020-01 ou 2020-01-01",
                "it": "Nel modulo 2020-01 o 2020-01-01",
                "es": "En forma 2020-01 o 2020-01-01",
                "pl": "W formie 2020-01 lub 2020-01-01",
                "zh-cn": "格式为2020-01或2020-01-01"
            },
            "consumption_station": {
                "en": "Consumption station",
                "de": "Verbrauchsstation",
                "ru": "Станция потребления",
                "pt": "Estação de consumo",
                "nl": "Verbruiksstation",
                "fr": "Station de consommation",
                "it": "Stazione di consumo",
                "es": "Estación de consumo",
                "pl": "Stacja zużycia",
                "zh-cn": "消费站"
            }
        });
    }

    vis.binds.consumption = {
        version: "0.4.3",
        showVersion: function () {
            if (vis.binds.consumption.version) {
                console.log('Version consumption: ' + vis.binds.consumption.version);
                vis.binds.consumption.version = null;
            }
        },
        months: {
            en: ['Jan', 'Feb', 'Mar', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
            de: ['Jan', 'Feb', 'Mar', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez'],
            ru: ['Янв', 'Фев', 'Мар', 'Апр', 'Май', 'Июн', 'Июл', 'Авг', 'Сен', 'Окт', 'Ноя', 'Дек']
        },

        padZero: function (num) {
            if (num.length < 2) {
                return '0' + num;
            } else {
                return num;
            }
        },
        invertColor: function (hex, bw) {
            // taken from here: https://stackoverflow.com/questions/35969656/how-can-i-generate-the-opposite-color-according-to-current-color
            if (hex.indexOf('#') === 0) {
                hex = hex.slice(1);
            }
            // convert 3-digit hex to 6-digits.
            if (hex.length === 3) {
                hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];
            }
            if (hex.length !== 6) {
                throw new Error('Invalid HEX color.');
            }
            var r = parseInt(hex.slice(0, 2), 16);
            var g = parseInt(hex.slice(2, 4), 16);
            var b = parseInt(hex.slice(4, 6), 16);

            if (bw) {
                // http://stackoverflow.com/a/3943023/112731
                return (r * 0.299 + g * 0.587 + b * 0.114) > 186
                    ? '#000000'
                    : '#FFFFFF';
            }
            // invert color components
            r = (255 - r).toString(16);
            g = (255 - g).toString(16);
            b = (255 - b).toString(16);
            // pad each with zeros and return
            return '#' + vis.binds.consumption.padZero(r) + vis.binds.consumption.padZero(g) + vis.binds.consumption.padZero(b);
        },
        getStations: function (instance, cb) {
            instance = instance || 0;
            vis.conn.getStates([
                'consumption.' + instance + '.instances.common.resources',
                'consumption.' + instance + '.instances.common.stations'
            ], function (err, data) {
                if (err) {
                    cb(err);
                } else {
                    try {
                        var stations  = JSON.parse(data['consumption.' + instance + '.instances.common.stations'].val  || '[]');
                        var resources = JSON.parse(data['consumption.' + instance + '.instances.common.resources'].val || '[]');
                        cb(null, {stations: stations, resources: resources});
                    } catch (e) {
                        cb('Cannot parse stations: ' + e);
                    }
                }
            });
        },
        renderStations: function ($div, $el, stations) {
            var text = '<table class="vis-cons-stations-table"><tr class="vis-cons-stations-tr>';
            text += '<td class="vis-cons-stations-td" data-name="">' + _('All') + '</td></tr>';
            for (var i = 0; i < stations.length; i++) {
                text += '<td class="vis-cons-stations-td" data-name="' + stations[i].name + '" data-color="' + stations[i].color + '">';
                text += stations[i].title;
                text += '</td>';
            }

            text += '</tr></table>';

            $el.html(text);

            var $items = $el.find('.vis-cons-stations-td');

            // install handlers
            $items.on('click', function () {
                $(this).parent().find('.vis-cons-stations-td').removeClass('vis-cons-stations-selected');
                $(this).addClass('vis-cons-stations-selected');
                vis.binds.consumption.setSettings($div, null, $(this).data('name'));
            });

            // select current resource
            var settings = $div.data('settings');

            $items.each(function () {
                if (settings.station === $(this).data('name')) {
                    $(this).addClass('vis-cons-resources-selected');
                }
            });
        },
        renderResources: function ($div, $el, resources) {
            var count = resources.length + 1; // + all
            var width = Math.round(10000 / count) / 100;

            var text = '<table class="vis-cons-resources-table"><tr class="vis-cons-resources-tr">';
            if (count > 2) {
                text += '<td class="vis-cons-resources-td vis-cons-resources-all" data-name="" style="width: ' + width + '%"><span class="vis-cons-types-icon">€</span><span class="vis-cons-types-title">' + _('all') + '</span></td>';
            }

            var ownClasses = $div.data('data').ownClasses || false;

            for (var r = 0; r < resources.length; r++) {
                var color = resources[r].color;
                var style = ownClasses ? '' : 'background: ' + color + '50; color: ' + vis.binds.consumption.invertColor(resources[r].color, true);

                text += '<td class="vis-cons-resources-td vis-cons-resources-td-' + resources[r].name + '" data-name="' + resources[r].name + '" style="width: ' + width + '%; ' + style + '">';
                if (resources[r].icon && resources[r].icon.length <= 2) {
                    text += '<span class="vis-cons-types-icon">' + resources[r].icon + '</span>';
                }
                text += '<span class="vis-cons-types-title">' + resources[r].title + '</span>';
                text += '</td>';
            }
            text += '</tr></table>';
            $el.html(text);

            // install handlers
            var $items = $el.find('.vis-cons-resources-td');
            $items.on('click', function () {
                $(this).parent().find('.vis-cons-resources-td').removeClass('vis-cons-resources-selected');
                $(this).addClass('vis-cons-resources-selected');
                vis.binds.consumption.setSettings($div, null, null, $(this).data('name'));
            });

            // select current resource
            var settings = $div.data('settings');

            if (count === 2 && !settings.resource) {
                vis.binds.consumption.setSettings($div, null, null, resources[0].name);
                $items.each(function () {
                    if ($(this).data('name')) {
                        $(this).addClass('vis-cons-resources-selected');
                    }
                });
            } else {
                $items.each(function () {
                    if (settings.resource === $(this).data('name')) {
                        $(this).addClass('vis-cons-resources-selected');
                    }
                });
            }
        },
        renderTypes: function ($div, $el) {
            var text = '<table class="vis-cons-types-table">';
            text += '<tr class="vis-cons-types-tr"><td class="vis-cons-types-td" data-name="plan" title="' + _('Planning') + '">' +
                '<img class="vis-cons-types-icon" src="widgets/consumption/img/market-research.svg" alt="analysis"/>' +
                '</td></tr>';
            text += '<tr class="vis-cons-types-tr"><td class="vis-cons-types-td" data-name="donut" title="' + _('Pie chart') + '">' +
                '<img class="vis-cons-types-icon" src="widgets/consumption/img/seo-and-web.svg" alt="donut"/>' +
                '</td></tr>';
            text += '<tr class="vis-cons-types-tr"><td class="vis-cons-types-td" data-name="stackbar" title="' + _('Stack bar') + '">' +
                '<img class="vis-cons-types-icon" src="widgets/consumption/img/stacked.svg" alt="stackbar"/>' +
                '</td></tr>';
            text += '<tr class="vis-cons-types-tr"><td class="vis-cons-types-td" data-name="heatmap" title="' + _('Heat map') + '">' +
                '<img class="vis-cons-types-icon" src="widgets/consumption/img/heatmap.svg" alt="heatmap"/>' +
                '</td></tr>';
            text += '<tr class="vis-cons-types-tr"><td class="vis-cons-types-td" data-name="table" title="' + _('Table') + '">' +
                '<img class="vis-cons-types-icon" src="widgets/consumption/img/spreadsheet.svg" alt="table"/>' +
                '</td></tr>';

            text += '</table>';
            $el.html(text);

            var $items = $el.find('.vis-cons-types-td');
            // install handlers
            $items.on('click', function () {
                $(this).parent().parent().find('.vis-cons-types-td').removeClass('vis-cons-types-selected');
                $(this).addClass('vis-cons-types-selected');
                vis.binds.consumption.setSettings($div, $(this).data('name'));
            });

            // select current resource
            var settings = $div.data('settings');

            $items.each(function () {
                if (settings.type === $(this).data('name')) {
                    $(this).addClass('vis-cons-types-selected');
                }
            });
        },
        loadCharts: function (cb) {
            if (!vis.binds.consumption.loaded) {
                vis.binds.consumption.loaded = true;
                $.ajax({
                    url: 'widgets/consumption/js/echarts.min.js',
                    dataType: 'script',
                    success: function () { cb && cb();}
                });
            } else {
                return cb && cb();
            }
        },
        setSettings: function ($div, type, station, resource, start, end, isEuro, force) {
            var settings = $div.data('settings');
            var changed = false;
            if (type && settings.type !== type) {
                settings.type = type;
                changed = true;
            }
            if (station !== null && station !== undefined && settings.station !== station) {
                settings.station = station;
                changed = true;
            }
            if (resource !== null && resource !== undefined && settings.resource !== resource) {
                settings.resource = resource;
                changed = true;
            }
            if (isEuro !== null && isEuro !== undefined && settings.isEuro !== isEuro) {
                settings.isEuro = isEuro;
                changed = true;
            }
            if (start && settings.start !== start) {
                var startsFrom = $div.data('data').startsFrom;
                if (startsFrom) {
                    var parts = startsFrom.split('-');
                    startsFrom = new Date(parseInt(parts[0], 10), parseInt(parts[1], 10) - 1, 1);
                    if (start < startsFrom.getTime()) {
                        start = startsFrom.getTime();
                    }
                }

                settings.start = start;
                changed = true;
            }
            if (end && settings.end !== end) {
                var startsFrom1 = $div.data('data').startsFrom;
                if (startsFrom1) {
                    var parts1 = startsFrom1.split('-');
                    startsFrom1 = new Date(parseInt(parts1[0], 10), parseInt(parts1[1], 10) - 1, 1);
                    if (start < startsFrom1.getTime()) {
                        end = startsFrom1.getTime();
                    }
                }
                settings.end = end;
                changed = true;
            }

            if (changed || force) {
                localStorage.setItem('vis-consumption', JSON.stringify(settings));
                $div.data('settings', settings);
                var instance = $div.data('instance');
                vis.conn.setState(instance + '.trigger', JSON.stringify(settings));
            }
        },
        initInstance: function (instId, instance, cb) {
            if (!vis.binds.consumption.instancePromise) {
                vis.binds.consumption.instancePromise = true;
                vis.conn.getStates([instId + '.lastTime'], function (err, data) {
                    if (!data[instId + '.lastTime'] || !data[instId + '.lastTime'].val) {
                        vis.conn.setState('consumption.' + instance + '.instances.common.addInstance', vis.instance.replace(/\./g, '_'), function () {
                            setTimeout(function () {
                                vis.conn.subscribe(instId + '.result', function () {
                                    cb && cb();
                                }, 200); // wait till
                            });
                        });
                    } else {
                        vis.conn.subscribe(instId + '.result', function () { cb && cb(); });
                    }
                });
            } else {
                cb && cb();
            }
        },
        init: function (el, wid, view, data, style) {
            var $div = $('#' + wid);
            if (!$div.length) {
                return setTimeout(function () {
                    vis.binds.consumption.init(el, wid, view, data, style);
                }, 100);
            }

            var _data = Object.assign({}, data);
            _data.consInstance = _data.consInstance || 0;
            _data.startsFrom = _data.startsFrom || '2020-01';
            var parts = _data.startsFrom.split('-');
            if ((parts[0] || '').length !== 4) {
                parts[0] = '2020';
            }
            if (!parts[1]) {
                parts[1] = '01';
            }
            _data.startsFrom = parts[0] + '-' + parts[1];

            // generate instance if not exists
            !vis.instance && vis.generateInstance();

            var inst = 'consumption.' + _data.consInstance + '.instances.' + vis.instance.replace(/\./g, '_');
            $div.data('instance', inst);
            $div.data('dateFormat', _data.dateFormat || 'yy-mm-dd');
            $div.data('data', Object.assign({}, _data));

            // load echarts
            vis.binds.consumption.loadCharts(function () {
                vis.binds.consumption.initInstance(inst, _data.consInstance, function () {
                    vis.binds.consumption.getStations(_data.consInstance, function (err, data) {
                        // init settings
                        var settings = localStorage.getItem('vis-consumption') || '{}';
                        try {
                            settings = JSON.parse(settings);
                        } catch (e) {

                        }
                        var now = new Date();
                        settings.end = settings.end || now.getTime();

                        if (!settings.start) {
                            now.setMonth(0);
                            now.setDate(1);
                            now.setHours(0);
                            now.setMinutes(0);
                            now.setSeconds(0);
                            now.setMilliseconds(0);
                            settings.start = now.getTime();
                        }

                        settings.type     = settings.type    || 'plan';
                        settings.station  = _data.consumption_station || settings.station || data.stations[0].name;
                        var s;
                        for (s = 0; s < data.stations.length; s++) {
                            if (settings.station === data.stations[s].name) {
                                break;
                            }
                        }
                        if (s === data.stations.length) {
                            settings.station  = data.stations[0].name;
                        }

                        settings.resource = settings.resource === null || settings.resource === undefined ? data.resources[0].name : settings.resource;
                        $div.data('settings', settings);

                        var text = '<table class="vis-cons-table"><tbody style="width:100%; height: 100%;">';

                        text += '<tr class="vis-cons-table-first-row">';
                        text += '<td class="vis-cons-table-empty-cell"></td>'; // empty
                        text += '<td class="vis-cons-resources"></td>';
                        text += '</tr>';

                        text += '<tr class="vis-cons-table-second-row">';
                        text += '<td class="vis-cons-types"></td>';
                        text += '<td class="vis-cons-toolbar-ans-results">';
                        text += '<div class="vis-cons-toolbar" style="color: ' + (_data.colorTheme === 'dark' ? 'white' : 'black') + '"><div class="vis-cons-toolbar-euro"></div><div class="vis-cons-toolbar-dates"></div></div><div class="vis-cons-results"></div></td>';
                        text += '</tr>';
                        text += '</tbody></table>';
                        $div.html(text);

                        var $types = $div.find('.vis-cons-types');
                        vis.binds.consumption.renderTypes($div, $types);

                        $div.data('resources', data.resources);
                        $div.data('stations', data.stations);

                        var $resources = $div.find('.vis-cons-resources');
                        vis.binds.consumption.renderResources($div, $resources, data.resources);

                        vis.binds.consumption.renderResults($div, settings);

                        function onChange(wid, id, newVal) {
                            if (id === inst + '.result') {
                                if (typeof newVal === 'string') {
                                    try {
                                        newVal = JSON.parse(newVal);
                                    } catch (e) {
                                        newVal = {};
                                    }
                                }
                                vis.binds.consumption.renderResults($div, settings, newVal);
                            }
                        }

                        vis.registerOnChange(onChange, wid);

                        /*vis.states.bind(inst + '.result.val', onChangeBindHandler);

                        // remember all ids, that bound
                        $div.data('bound', [inst + '.result.val']);

                        // remember bind handler
                        $div.data('bindHandler', onChangeBindHandler);*/

                        $div.data('destroy', function () {
                            vis.binds.consumption.instancePromise = null;
                            vis.conn.unsubscribe($(this).data('instance') + '.result');
                            vis.unregisterOnChange(onChange, wid);
                        });

                        // request data
                        vis.binds.consumption.setSettings($div, null, null, null, null, null, null, true);
                    });
                });
            });
        },
        destroyChart: function ($div, $report) {
            $report = $report || $div.find('.vis-cons-results');
            try {
                var chart = $report.data('chart');
                chart && echarts.dispose(chart);
                $report.data('chart', null);
            } catch (e) {

            }
        },
        renderEuroSwitch: function ($div, $results, $toolbar, settings, unit) {
            settings = settings || $div.data('settings');
            var $euro = $toolbar.find('.vis-cons-toolbar-euro');

            // install onclick handler once
            if (!$euro.data('installed')) {
                $euro.data('installed', true);

                $euro.on('click', function () {
                    $(this).find('.vis-cons-switch-input').prop('checked', !settings.isEuro);
                    vis.binds.consumption.setSettings($div, null, null, null, null, null, !settings.isEuro);
                });
            }


            var $input = $euro.find('.vis-cons-switch-input');
            if (unit) {
                $euro.css('padding-top', '15px');
                if (settings.resource) {
                    if ($input.length) {
                        $input.prop('checked', settings.isEuro);
                        $euro.find('.vis-cons-switch-unit').html(unit);
                    } else {
                        var text = '<span class="vis-cons-switch-label vis-cons-switch-unit">' + unit + '</span><input type="checkbox" class="vis-cons-switch-input" ' + (settings.isEuro ? 'checked' : '') + '/><label for="switch">Toggle</label><span class="vis-cons-switch-label vis-cons-switch-euro">€</span>';
                        $euro.html(text);
                    }
                } else {
                    $euro.css('padding-top', '0');
                    $input.length && $euro.html('');
                }
            } else {
                $input.length && $euro.html('');
                $euro.css('padding-top', '0');
            }
        },
        renderDatePicker: function ($div, $results, $toolbar, settings, visible) {
            settings = settings || $div.data('settings');
            var $dates = $toolbar.find('.vis-cons-toolbar-dates');
            var $inputs = $dates.find('select');
            var startsFrom = $div.data('data').startsFrom;
            if (visible) {
                var dateFormat = $div.data('dateFormat');
                if ($inputs.length) {
                    var $from = $dates.find('.vis-cons-toolbar-from');
                    var $to   = $dates.find('.vis-cons-toolbar-to');
                    $from.val(settings.start);
                    $to.val(settings.end);
                } else {
                    var theme = $div.data('data').colorTheme;
                    var textColor = theme === 'dark' ? 'white' : 'black';
                    var style = 'color: ' + textColor + '; background: #00000000; border: 1px solid lightgray; padding: 3px;';
                    var parts = startsFrom.split('-');

                    var _startsFrom = new Date(parseInt(parts[0], 10), parseInt(parts[1], 10) - 1, 1);
                    var now = new Date();
                    now.setMonth(now.getMonth() + 1);
                    var startOptions = [];
                    while (_startsFrom < now) {
                        startOptions.push('<option style="color: black" value="' + _startsFrom.getTime() + '">' + $.datepicker.formatDate(dateFormat, _startsFrom) + '</option>');
                        _startsFrom.setMonth(_startsFrom.getMonth() + 1);
                    }

                    var _endsTo = new Date(parseInt(parts[0], 10), parseInt(parts[1], 10) - 1, 1);
                    var endOptions = [];
                    while (_endsTo < now) {
                        var d = new Date(_endsTo);
                        d.setMonth(d.getMonth() + 1);
                        d.setMilliseconds(d.getMilliseconds() - 1);
                        endOptions.push('<option style="color: black" value="' + d.getTime() + '">' + $.datepicker.formatDate(dateFormat, d) + '</option>');
                        _endsTo.setMonth(_endsTo.getMonth() + 1);
                    }

                    var text = '<span class="vis-cons-toolbar-dates-label">' + _('from') + ':</span> ' +
                               '<select class="vis-cons-toolbar-from" style="' + style + '">' + startOptions.join('\n') + '</select> ' +
                               '<span class="vis-cons-toolbar-dates-label">' + _('to') + ':</span> ' +
                               '<select style="' + style + '" class="vis-cons-toolbar-to">' + endOptions.join('\n') + '</select>';
                    $dates.html(text);
                    var $from1 = $dates.find('.vis-cons-toolbar-from');
                    var $to1   = $dates.find('.vis-cons-toolbar-to');

                    $from1.on('change', function () {
                        var from = parseInt($(this).val(), 10);
                        var to = settings.end;
                        if (to <= from) {
                            var d = new Date(from);
                            d.setMonth(d.getMonth() + 1);
                            d.setMilliseconds(d.getMilliseconds() - 1);
                            to = d.getTime();
                        }
                        vis.binds.consumption.setSettings($div, null, null, null, from, to);
                    }).val(settings.start);
                    $to1.on('change', function () {
                        var to = parseInt($(this).val(), 10);
                        var from = settings.start;
                        if (to <= from) {
                            var d = new Date(to);
                            d.setMilliseconds(d.getMilliseconds() + 1);
                            d.setMonth(d.getMonth() - 1);
                            from = d.getTime();
                        }
                        vis.binds.consumption.setSettings($div, null, null, null, from, to);
                    }).val(settings.end);
                }
            } else {
                if ($inputs.length) {
                    $dates.html('');
                }
            }
        },
        renderToolbar: function ($div, $results, $toolbar, euroVisible, dateVisible) {
            if (euroVisible || dateVisible) {
                $results.css('height', 'calc(100% - 50px)');
                $toolbar.show();
            } else {
                $results.css('height', '100%');
                $toolbar.hide();
            }
        },
        renderResults: function ($div, settings, data) {
            settings = settings || $div.data('settings');
            var $toolbar = $div.find('.vis-cons-toolbar');
            var $report  = $div.find('.vis-cons-results');
            if (!data || !data.series) {
                return $report.html('<div class="vis-cons-rendering">' + _('rendering...') + '</div>');
            } else {
                var $render = $report.find('.vis-cons-rendering');
                $render && $render.length && $render.remove();
            }

            switch (settings.type) {
                case 'donut':
                    vis.binds.consumption.renderToolbar($div, $report, $toolbar, !!settings.resource, true);
                    vis.binds.consumption.renderEuroSwitch($div, $report, $toolbar, settings, !!settings.resource ? data.unitOriginal : '');
                    vis.binds.consumption.renderDatePicker($div, $report, $toolbar, settings, true);
                    vis.binds.consumption.renderDonut($div, $report, settings, data);
                    break;

                case 'stackbar':
                    vis.binds.consumption.renderToolbar($div, $report, $toolbar, !!settings.resource, false);
                    vis.binds.consumption.renderEuroSwitch($div, $report, $toolbar, settings, !!settings.resource ? data.unitOriginal : '');
                    vis.binds.consumption.renderDatePicker($div, $report, $toolbar, settings, false);
                    vis.binds.consumption.renderStackBar($div, $report, settings, data);
                    break;

                case 'heatmap':
                    vis.binds.consumption.renderToolbar($div, $report, $toolbar, !!settings.resource, false);
                    vis.binds.consumption.renderEuroSwitch($div, $report, $toolbar, settings, !!settings.resource ? data.unitOriginal : '');
                    vis.binds.consumption.renderDatePicker($div, $report, $toolbar, settings, false);
                    vis.binds.consumption.renderHeatMap($div, $report, settings, data);
                    break;

                case 'table':
                    vis.binds.consumption.destroyChart($div, $report);
                    vis.binds.consumption.renderToolbar($div, $report, $toolbar, !!settings.resource ? data.unitOriginal : '', false);
                    vis.binds.consumption.renderEuroSwitch($div, $report, $toolbar, settings, !!settings.resource ? data.unitOriginal : '');
                    vis.binds.consumption.renderDatePicker($div, $report, $toolbar, settings, false);
                    vis.binds.consumption.renderTable($div, $report, settings, data);
                    break;

                case 'plan':
                default:
                    vis.binds.consumption.destroyChart($div, $report);
                    vis.binds.consumption.renderToolbar($div, $report, $toolbar, !!settings.resource ? data.unitOriginal : '', false);
                    vis.binds.consumption.renderEuroSwitch($div, $report, $toolbar, settings, !!settings.resource ? data.unitOriginal : '');
                    vis.binds.consumption.renderDatePicker($div, $report, $toolbar, settings, false);
                    vis.binds.consumption.renderPlan($div, $report, settings, data);
                    break;
            }
        },
        renderDonut: function ($div, $report, settings, data) {
            var unit = data.unit;
            var option = {
                tooltip: {
                    show: true,
                    trigger: 'item',
                    formatter: '{b}<br/>{c} ' + unit + ' ({d}%)'
                },
                series: data.series
            };

            // var theme = $div.data('data').colorTheme;

            for (var i = 0; i < option.series.length; i++) {
                var serie = option.series[i];
                serie.type = 'pie';
                if (i === 0) {
                    if (option.series.length === 1) {
                        serie.radius = '65%';
                    } else {
                        serie.radius = ['40%', '65%'];
                    }
                    // only outer ring has labels
                    serie.label = {
                        formatter: ' {b|{b}}\n{hr|}\n  {c} ' + unit + ' {per|{d}%}  ',
                        backgroundColor: '#eee',
                        borderColor: '#aaa',
                        borderWidth: 1,
                        borderRadius: 2,
                        padding: [0, 7],
                        rich: {
                            b: {
                                color: '#999',
                                align: 'center',
                                fontSize: 14,
                                lineHeight: 20
                            },
                            hr: {
                                borderColor: '#aaa',
                                width: '100%',
                                borderWidth: 0.5,
                                height: 0
                            },
                            per: {
                                color: '#eee',
                                backgroundColor: '#334455',
                                padding: [2, 4],
                                borderRadius: 2,
                                lineHeight: 22
                            }
                        }
                    };
                } else {
                    // inner ring
                    serie.radius = [0, '35%'];
                    serie.label = {position: 'inner'};
                }
            }

            var chart = $report.data('chart');

            if (!chart || $report.data('type') !== 'donut' + data.series.length) {
                vis.binds.consumption.destroyChart($div, $report);
                $report.text(''); // remove old stuff
                chart = echarts.init($report[0]/*, null, {renderer: 'svg'}*/);
                $report.data('type', 'donut' + data.series.length);
                $report.data('chart', chart);
            }

            // console.log(JSON.stringify(option, null, 2));

            chart.setOption(option);
        },
        renderPlan: function ($div, $report, settings, data) {
            var theme = $div.data('data').colorTheme;
            var textColor = theme === 'dark' ? 'white' : 'black';

            var text = '<table class="vis-cons-plan-table" style="color: ' + textColor + '">';
            text += '<tr class="vis-cons-plan-tr-first"><td class="vis-cons-plan-td-main"></td><td class="vis-cons-plan-main-td-widget"><div class="vis-cons-plan-main-td-widget-div"></div></td></tr>';
            if (!settings.resource) {
                text += '<tr class="vis-cons-plan-tr-second"><td colspan="2" class="vis-cons-plan-td-additional"></td></tr>';
            }
            text += '</table>';
            $report.html(text);

            vis.binds.consumption.renderPlanMain($div, $report.find('.vis-cons-plan-td-main'), settings, data);
            var resources = $div.data('resources');

            var name = (settings.resource || 'all').toLowerCase();
            var resourceTitle = '';
            if (settings.resource) {
                for (var r = 0; r < resources.length; r++) {
                    if (resources[r].name === settings.resource) {
                        resourceTitle = resources[r].title;
                        break;
                    }
                }
            }

            var options = {
                reference: data.series[name].reference, // last year consumption
                actual:    data.series[name].actual,    // actual consumption
                planned:   data.series[name].planned,   // planned this year
                forecast:  data.series[name].forecast,  // forecast this year
                unit:      data.unit,
                height:    180,
                textColor: textColor,

                title: resourceTitle ? _('%s overview', resourceTitle) : _('Total overview')
            };

            vis.binds.consumption.forecastBar.init($report.find('.vis-cons-plan-main-td-widget-div'), options);

            if (!settings.resource) {
                var $additional = $report.find('.vis-cons-plan-td-additional');
                var divs = [];
                for (var rr = 0; rr < resources.length; rr++) {
                    divs.push('<div class="vis-cons-plan-div-additional-widget"><div class="vis-cons-plan-main-additional-widget-div" data-resource="' + resources[rr].name + '"></div></div>');
                }

                $additional.html(divs.join('\n'));

                for (var i = 0; i < resources.length; i++) {
                    var res = resources[i];
                    var $wDiv = $additional.find('.vis-cons-plan-main-additional-widget-div[data-resource="' + res.name + '"]');
                    var resourceTitle1 = resources[i].title;

                    var name1 = res.name.toLowerCase();

                    var options1 = {
                        reference: data.series[name1].reference, // last year consumption
                        actual:    data.series[name1].actual,    // actual consumption
                        planned:   data.series[name1].planned,   // planned this year
                        forecast:  data.series[name1].forecast,  // forecast this year
                        unit:      data.unit,
                        height:    100,
                        textColor: textColor,
                        onClick:   (function (n) { return function () {
                            vis.binds.consumption.setSettings($div, null, null, n);
                        }})(name1),

                        title: resourceTitle1
                    };

                    vis.binds.consumption.forecastBar.init($wDiv, options1);
                }
            }
        },
        renderStackBar: function ($div, $report, settings, data) {
            var unit = data.unit;
            var theme = $div.data('data').colorTheme;
            var color = theme === 'dark' ? '#CCC' : '#333';

            function formatter(year, month) {
                var sum = null;
                for (var s = 0; s < data.series.length; s++) {
                    if (data.series[s].stack === year && data.series[s].data[month] !== null && data.series[s].data[month] !== undefined) {
                        sum = sum || 0;
                        sum += data.series[s].data[month];
                    }
                }

                return vis.binds.consumption.format(sum, unit, true);
            }

            // find last items of every stack
            var last = {};
            for (var s = 0; s < data.series.length; s++) {
                last[data.series[s].stack] = data.series[s];
                data.series[s].type = 'bar';
            }

            // and place text on the top
            for (var stack in last) {
                last[stack].label = {
                    formatter: (function (stack) {
                        return function (opt) { return formatter(stack, opt.dataIndex); }
                    })(stack),
                    show: true,
                    color: color,
                    fontSize: 10,
                    rotate: 45,
                    offset: [5, -10],
                    position: 'top'
                }
            }

            // add year to name
            for (var ss = 0; ss < data.series.length; ss++) {
                data.series[ss].name = data.series[ss].year + ' ' + data.series[ss].name;
            }

            var option = {
                tooltip: {
                    show: true,
                    trigger: 'axis',
                    formatter: function (params) {
                        var len = params.length / 2;
                        var map = '';
                        for (var i = 0; i < params.length; i++) {
                            map += '<div style="opacity: ' + (i < len ? 0.5 : 1) + '"><span style="display: inline-block; margin-right: 5px;border-radius: 10px;width: 9px;height: 9px; background-color: ${params[i].color}; opacity: ' + params[i].opacity + '"></span>' + params[i].seriesName + ': ' + vis.binds.consumption.format(params[i].value, unit) + '</div>';
                        }

                        return '<div style="text-align: left"><strong style="padding-left: 15px">' + params[0].name + '</strong></br>' + map + '</div>';
                    },
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                grid: {
                    left: '0%',
                    right: '0%',
                    bottom: data.legend ? '50px' : '0%',
                    top: '30px',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: vis.binds.consumption.months[vis.language] || vis.binds.consumption.months.en,
                    axisLabel: {
                        color: color
                    },
                    axisTick: {
                        alignWithLabel: true,
                        lineStyle: {
                            color: color
                        }
                    },
                    axisLine: {
                        lineStyle: {
                            color: color
                        }
                    }
                },
                yAxis: {
                    type: 'value',
                    name: data.unit,
                    axisLabel: {
                        color: color
                    },
                    axisTick: {
                        lineStyle: {
                            color: color
                        }
                    },
                    axisLine: {
                        lineStyle: {
                            color: color
                        }
                    }
                },
                series: data.series
            };
            if (data.legend) {
                option.legend = {
                    data: data.legend,
                    //type: 'scroll',
                    bottom: 0,
                    selectedMode: false,
                    textStyle: {
                        color: color
                    }
                }
            }

            var chart;

            vis.binds.consumption.destroyChart($div, $report);
            $report.text(''); // remove old stuff
            chart = echarts.init($report[0], null, {renderer: 'svg'});
            $report.data('type', 'stackbar');
            $report.data('chart', chart);
            chart.setOption(option);
        },

        format: function (m, unit, noHtml) {
            if (m === undefined || m === null) {
                return '';
            }

            if (unit === '€' || unit === '$' || unit === '₽' || unit === '£' || unit === '元' || unit === 'CHF') {
                if (noHtml) {
                    if (m < 1000) {
                        return m.toFixed(1).toString().replace('.', ',') + ' ' + unit;
                    } else {
                        return Math.round(m) + ' ' + unit;
                    }
                } else {
                    return '<span class="vis-cons-table-value">' + m.toFixed(1).replace('.', ',') + '<span class="vis-cons-table-unit"> ' + unit + '</span>';
                }
            } else {
                var val = m < 1000 ? (Math.round(m * 10) / 10).toString().replace('.', ',') : Math.round(m);
                if (noHtml) {
                    return val + ' ' + (unit || '');
                } else {
                    return '<span class="vis-cons-table-value">' + val + '<span class="vis-cons-table-unit"> ' + (unit || '') + '</span>';
                }
            }
        },
        renderTable: function ($div, $report, settings, data) {
            // combine
            //          Jan Feb Mar                       Total
            // -----------------------
            // E1 2020
            // E1 2019
            // ----------------------
            // E2 2020
            // E2 2019
            // ----------------------
            // Total 2020                                  xxx
            // Total 2019                                  yyy
            var theme = $div.data('data').colorTheme;
            var textColor = theme === 'dark' ? 'white' : 'black';
            var lines = [];
            lines.push('<tr class="vis-cons-table-tr-header"><th>' + _('Name') + '</th><th></th><th>' + (vis.binds.consumption.months[vis.language] || vis.binds.consumption.months.en).join('</th><th>') + '</th><th>' + _('Total') + ' </th></tr>\n');
            var ids = {};

            var prevYear;
            var actualYear;
            for (var s = 0; s < data.series.length; s++) {
                ids[data.series[s]._id] = ids[data.series[s]._id] || {};

                if (data.series[s].stack === 'prev') {
                    prevYear = prevYear || data.series[s].year;
                    ids[data.series[s]._id].prev = data.series[s];
                } else {
                    actualYear = actualYear || data.series[s].year;
                    ids[data.series[s]._id].actual = data.series[s];
                }
            }
            actualYear = actualYear || new Date().getFullYear();
            prevYear   = prevYear || (actualYear - 1);

            var unit = data.unit;

            var items = Object.keys(ids).sort();
            var stats = {actual: [], prev:  []};

            for (var i = 0; i < items.length; i++) {
                var item = items[i];
                var line1 = '<tr class="vis-cons-table-tr-actual">';
                item = ids[item];
                if (!item.actual) {
                    line1 += '<td rowspan="2" class="vis-cons-table-td-name">' + (item.prev ? item.prev.name : '--') + '</td>';
                    line1 += '<td>' + actualYear + '</td>';
                    for (var m = 0; m < 12; m++) {
                        line1 += '<td>--</td>';
                    }
                    line1 += '<td>--</td>';
                } else {
                    line1 += '<td rowspan="2" class="vis-cons-table-td-name">' + item.actual.name + '</td>';
                    line1 += '<td>' + actualYear + '</td>';
                    item.actual.data = item.actual.data || [];
                    var sum1 = 0;
                    for (var mm = 0; mm < 12; mm++) {
                        line1 += '<td>' + (item.actual.data[mm] === null || item.actual.data[mm] === undefined ? '--' : vis.binds.consumption.format(item.actual.data[mm], unit)) + '</td>';
                        sum1 += parseFloat(item.actual.data[mm] || 0);

                        stats.actual[mm] = stats.actual[mm] || {c: 0, s: 0};

                        if (item.actual.data[mm] !== null || item.actual.data[mm] !== undefined) {
                            stats.actual[mm].c++;
                            stats.actual[mm].s += parseFloat(item.actual.data[mm] || 0);
                        }
                    }
                    line1 += '<td class="vis-cons-table-td-total">' + vis.binds.consumption.format(sum1, unit) + '</td>';
                }
                line1 += '</tr>';
                lines.push(line1);


                line1 = '<tr class="vis-cons-table-tr-prev">';
                if (!item.prev) {
                    //line += '<td>--</td>';
                    line1 += '<td>' + prevYear + '</td>';
                    for (var mmm = 0; mmm < 12; mmm++) {
                        line1 += '<td>--</td>';
                    }
                    line1 += '<td>--</td>';
                } else {
                    //line += '<td>' + item.prev.name + '</td>';
                    line1 += '<td>' + prevYear + '</td>';
                    item.prev.data = item.prev.data || [];
                    var sum = 0;
                    for (var m = 0; m < 12; m++) {
                        line1 += '<td>' + (item.prev.data[m] === null || item.prev.data[m] === undefined ? '--' : vis.binds.consumption.format(item.prev.data[m], unit)) + '</td>';
                        sum += parseFloat(item.prev.data[m] || 0);

                        stats.prev[m] = stats.prev[m] || {c: 0, s: 0};

                        if (item.prev.data[m] !== null || item.prev.data[m] !== undefined) {
                            stats.prev[m].c++;
                            stats.prev[m].s += parseFloat(item.prev.data[m] || 0);
                        }
                    }
                    line1 += '<td class="vis-cons-table-td-total">' + vis.binds.consumption.format(sum, unit) + '</td>';
                }
                line1 += '</tr>\n';
                lines.push(line1);
            }

            // total of all lines for actual
            var line = '<tr class="vis-cons-table-tr-actual vis-cons-table-tr-total">';
            if (!stats.actual.length) {
                line += '<td rowspan="2" class="vis-cons-table-td-name">' + _('All') + '</td>';
                line += '<td>' + actualYear + '</td>';
                for (var m = 0; m < 12; m++) {
                    line += '<td>--</td>';
                }
                line += '<td>--</td>';
            } else {
                line += '<td rowspan="2" class="vis-cons-table-td-name">' + _('All') + '</td>';
                line += '<td>' + actualYear + '</td>';
                var sum2 = 0;
                for (var m1 = 0; m1 < 12; m1++) {
                    line += '<td>' + (!stats.actual[m1].c ? '--' : vis.binds.consumption.format(stats.actual[m1].s, unit)) + '</td>';
                    sum2 += stats.actual[m1].s || 0;
                }
                line += '<td class="vis-cons-table-td-total">' + vis.binds.consumption.format(sum2, unit) + '</td>';
            }
            line += '</tr>\n';
            lines.push(line);

            // total of all lines for prev
            line = '<tr class="vis-cons-table-tr-prev vis-cons-table-tr-total">';
            if (!stats.prev.length) {
                //line += '<td>--</td>';
                line += '<td>' + prevYear + '</td>';
                for (var m4 = 0; m4 < 12; m4++) {
                    line += '<td>--</td>';
                }
                line += '<td>--</td>';
            } else {
                //line += '<td>' + _('Previous') + '</td>';
                line += '<td>' + prevYear + '</td>';
                var sum3 = 0;
                for (var m3 = 0; m3 < 12; m3++) {
                    line += '<td>' + (!stats.prev[m3].c ? '--' : vis.binds.consumption.format(stats.prev[m3].s, unit)) + '</td>';
                    sum3 += stats.prev[m3].s || 0;
                }
                line += '<td class="vis-cons-table-td-total">' + vis.binds.consumption.format(sum3, unit) + '</td>';
            }
            line += '</tr>\n';
            line += '<tr class="vis-cons-table-tr-spacer"><td colspan="15"></td></tr>';
            lines.push(line);

            $report.html('<table class="vis-cons-table" style="height: ' + (settings.resource ? 'calc(100% - 50px)' : '100%') + '; color: ' + textColor + '">' + lines.join('\n') + '</table>\n');
        },
        isLeapYear: function (date) {
            var year = typeof date !== 'object' ? date : date.getFullYear();
            if (year & 3) {
                return false;
            } else {
                return (year % 100 || !(year % 400));
            }
        },
        // Get Day of Year
        getMonth: function (day, year) {
            var dayCount = [31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334];
            if (vis.binds.consumption.isLeapYear(year || new Date())) {
                dayCount = [31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335];
            }
            var month = 0;

            for (;month < dayCount.length; month++) {
                if (day < dayCount[month]) {
                    break;
                }
            }
            return {month: month, date: month ? day - dayCount[month - 1] : day};
        },
        renderHeatMap: function ($div, $report, settings, data) {
            var months = vis.binds.consumption.months[vis.language] || vis.binds.consumption.months.en;
            var theme = $div.data('data').colorTheme;

            var maxDays = vis.binds.consumption.isLeapYear(new Date()) ? 366 : 365;
            var xData = [];
            for (var dd = 0; dd < maxDays; dd++) {
                xData[dd] = dd;
            }

            var yData = [];
            for (var d = 0; d < 24; d++) {
                yData[d] = d;
            }

            var values = data.series;

            var allData = [];
            var min = null;
            var max = null;
            for (var day = 0; day < values.length; day++) {
                if (!values[day]) {
                    continue;
                }
                for (var hour = 0; hour < values[day].length; hour++) {
                    var val = values[day][hour];
                    if (val !== null && val !== undefined) {
                        if (max === null || val > max) {
                            max = val;
                        }
                        if (min === null || val < min) {
                            min = val;
                        }
                        allData.push([day, hour, val]);
                    }
                }
            }

            var stats = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];

            // sort too less min and too less max values
            var _diff = max - min;
            var count = 0;
            for (var a = 0; a < allData.length; a++) {
                if (allData[a][2]) {
                    var ii = Math.round((allData[a][2] - min) / _diff * (stats.length - 1));
                    if (ii < 0) {
                        ii = 0;
                    } else if (ii > stats.length - 1) {
                        ii = stats.length - 1;
                    }
                    stats[ii]++;
                    count++;
                }
            }

            for (var i = 0; i < stats.length; i++) {
                stats[i] /= count;
            }
            var v = 0;
            while (stats[v] < 0.2 && v < stats.length - 2) {
                v++;
            }

            if (v) {
                min += _diff * v * (1 / (stats.length - 1));
            }

            var m = stats.length - 1;
            while (stats[m] < 0.2 && m > v) {
                m--;
            }
            if (m !== stats.length - 1) {
                if (m === v) {
                    m++;
                }
                max -= _diff * (stats.length - 1 - m) * (1 / (stats.length - 1));
            }

            var colors = ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026'];
            var size = colors.length;
            var diff = max - min;
            var width = $div.width();
            var unit = !settings.resource || settings.isEuro ? '€' : data.unit;
            var color = theme === 'dark' ? '#CCC' : '#333';

            var option = {
                tooltip: {
                    show: true,
                    formatter: function (data) {
                        var m = vis.binds.consumption.getMonth(data.data[0]);
                        return months[m.month] + '.' + (m.date + 1) + ' ' + data.data[1] + ':00 - ' + vis.binds.consumption.format(data.data[2], unit);
                    }
                },
                xAxis: {
                    type: 'category',
                    data: xData,
                    axisLabel: {
                        show: true,
                        color: color,
                        align: 'left',
                        interval: function (data, value) {
                            var m = vis.binds.consumption.getMonth(data);
                            if (m.date === 0) {
                                return m.month.toString();
                            } else {
                                return false;
                            }
                        },
                        formatter: function (data) {
                            var m = vis.binds.consumption.getMonth(parseInt(data, 10));
                            return months[m.month];
                        }
                    },
                    axisTick: {
                        lineStyle: {
                            color: color
                        }
                    },
                    axisLine: {
                        lineStyle: {
                            color: color
                        }
                    }
                },
                grid: {
                    right: 0,
                    top: 0,
                    bottom: 65,
                    left: 25
                },
                yAxis: {
                    type: 'category',
                    data: yData,
                    axisLabel: {
                        alignWithLabel: true,
                        color: color
                    },
                    axisTick: {
                        lineStyle: {
                            color: color
                        }
                    },
                    axisLine: {
                        lineStyle: {
                            color: color
                        }
                    }
                },
                visualMap: {
                    type: 'continuous',
                    min: min,
                    max: max,
                    calculable: true,
                    realtime: false,
                    orient: 'horizontal',
                    inRange: {color: colors},
                    precision: 1,
                    left: 50,
                    textStyle: {
                        color: color
                    },
                    itemHeight: Math.max(140, width - 280),
                    formatter: function (value) { return vis.binds.consumption.format(value, unit, true); }
                },
                series: [{
                    type: 'heatmap',
                    data: allData,
                    emphasis: {
                        itemStyle: {
                            borderColor: '#333',
                            borderWidth: 1
                        }
                    },
                    itemStyle1: {
                        color: function (data) {
                            var val = (data.data[2] - min) / diff;
                            var i = Math.round(val * 10);
                            if (i > size - 1) {
                                i = size - 1;
                            }
                            if (i < 0) {
                                i = 0;
                            }

                            return colors[i];
                        }
                    },
                    progressive: 1000,
                    animation: false
                }]
            };
            var chart = $report.data('chart');

            if (!chart || $report.data('type') !== 'heatmap_' + !!settings.resource) {
                vis.binds.consumption.destroyChart($div, $report);
                chart = echarts.init($report[0]);
                $report.data('type', 'heatmap_' + !!settings.resource);
                $report.data('chart', chart);
            }

            // console.log(JSON.stringify(option, null, 2));

            chart.setOption(option);
        },

        forecastBar: {
            getValue: function (oid) {
                var val = 0;
                if (oid || oid === '0') {
                    if (parseFloat(oid) !== oid) {
                        val = vis.states.attr(oid + '.val');
                    } else {
                        val = parseFloat(oid);
                    }
                    return val;
                } else {
                    return null;
                }
            },
            draw: function ($div, options) {
                var val1     = vis.binds.consumption.forecastBar.getValue(options.reference);
                var val2     = vis.binds.consumption.forecastBar.getValue(options.actual);
                var valLeft  = vis.binds.consumption.forecastBar.getValue(options.forecast);
                var valRight = vis.binds.consumption.forecastBar.getValue(options.planned);

                var max = val1 > val2 ? val1 : val2;
                max = max > valLeft  ? max : valLeft;
                max = max > valRight ? max : valRight;

                var val1Height     = Math.round(val1     / max * 100);
                var val2Height     = Math.round(val2     / max * 100);
                var valLeftHeight  = Math.round(valLeft  / max * 100);
                var valRightHeight = Math.round(valRight / max * 100);

                var color;
                if (val2 < valLeft && (!valRight || (val2 < valRight && valLeft < valRight))) {
                    color = options['color-border'];
                } else {
                    color = options['color-border-error'] || options['color-border'];
                }

                var backColor   = 'repeating-linear-gradient(135deg, ' + color + ', ' + color + ' 2px, rgba(0,0,0,0) 2px, rgba(0,0,0,0) 12px)';
                var $val1 = $div.find('.value-1').css({height: val1Height + '%', 'border-color': color}).attr('title', vis.binds.consumption.format(val1, options.unit, true));
                var $val2 = $div.find('.value-2').css({height: val2Height + '%', 'border-color': color}).attr('title', vis.binds.consumption.format(val2, options.unit, true));
                $div.find('.value-2-inner').css('background', backColor);
                $div.find('.label-value-1').css('top', 'calc(' + (100 - val1Height)  + '% - 5px)').attr('title', vis.binds.consumption.format(val1, options.unit, true));
                $div.find('.label-value-2').css('top', 'calc(' + (100 - val2Height)  + '% - 5px)').attr('title', vis.binds.consumption.format(val2, options.unit, true));

                                    $div.find('.line-left')    .css('top', (100 - valLeftHeight)  + '%');
                var $lineRight =  $div.find('.line-right')   .css('top', (100 - valRightHeight) + '%');

                                    $div.find('.label-left')   .css('top', 'calc(' + (100 - valLeftHeight)  + '% - 8px)').attr('title', vis.binds.consumption.format(valLeft, options.unit, true));
                var $labelRight = $div.find('.label-right')  .css('top', 'calc(' + (100 - valRightHeight) + '% - 8px)').attr('title', vis.binds.consumption.format(valRight, options.unit, true));

                                    $div.find('.arrow-left')   .css('top', 'calc(' + (100 - valLeftHeight)  + '% - 17px)');
                var $arrowRight = $div.find('.arrow-right')  .css('top', 'calc(' + (100 - valRightHeight) + '% - 17px)');

                if (!valRightHeight) {
                    $lineRight.hide();
                    $labelRight.hide();
                    $arrowRight.hide();
                } else {
                    $lineRight.show();
                    $labelRight.show();
                    $arrowRight.show();
                }

                if (val1 > val2) {
                    $val1.css({'z-index': 0, 'border-radius': '8px 8px 0 0'});
                    $val2.css({'z-index': 1, 'border-radius': ''});
                } else {
                    $val1.css({'z-index': 1, 'border-radius': ''});
                    $val2.css({'z-index': 0, 'border-radius': '8px 8px 0 0'});
                }
            },
            init: function ($div, options) {
                var year = new Date().getFullYear();

                var _options = Object.assign({
                    reference: 200, // last year consumption
                    actual:    100, // actual consumption
                    planned:   350, // planned this year
                    forecast:  400, // forecast this year
                    width:     100,
                    height:    200,
                    textColor: 'black',

                    'color-border': 'green',
                    'color-border-error': 'red',
                    title: '',
                    textForecast: _('Forecast'),
                    textPlanned: _('Planned'),
                    textActual: _('Now %s', year),
                    textPrev: year - 1,
                    unit: '€'
                }, options);

                var text = '<div style="overflow: visible; width: ' + _options.width + 'px; height: ' + _options.height + 'px; color: ' + _options.textColor + '">\n' +
                    '\t\t<div class="forecast-bar" style="max-width: 100px;" >\n' +
                    '\t\t\t<div   class="value-1" style=""><span>' + _options.textPrev + '</span></div>\n' +
                    '\t\t\t<div   class="value-2" style=""><div class="value-2-inner"><span>' + _options.textActual + '</span></div></div>\n' +
                    '\t\t\t<div   class="label-value-1 forecast-texts"></div>\n' +
                    '\t\t\t<div   class="label-value-2 forecast-texts"></div>\n' +
                    '\n' +
                    '\t\t\t<span  class="check-visibility arrow-left">\n' +
                    '\t\t\t    <svg viewBox="0 0 20 20" style="fill: #DDDDDD; width: 35px; height: auto"><path d="M15,10l-9,5V5L15,10z"/></svg>\n' +
                    '\t\t\t</span>\n' +
                    '\t\t\t<span  class="check-visibility arrow-right">\n' +
                    '\t\t\t    <svg viewBox="0 0 20 20" style="fill: #DDDDDD;width: 35px; height: auto"><path d="M14,5v10l-9-5L14,5z"/></svg>\n' +
                    '\t\t\t</span>\n' +
                    '\t\t\t<div   class="check-visibility line-left"></div>\n' +
                    '\t\t\t<div   class="check-visibility line-right"></div>\n' +
                    '\t\t\t<div   class="check-visibility label-left  forecast-texts">' + _options.textForecast + '</div>\n' +
                    '\t\t\t<div   class="check-visibility label-right forecast-texts">' + _options.textPlanned + '</div>\n' +
                    '\n' +
                    '\t\t\t<div   class="forecast-title forecast-texts"><div class="forecast-title-inner">' + _options.title + '</div></div>\n' +
                    '\t\t</div>\n' +
                    '\t</div>';
                $div.html(text);

                _options.onClick && $div.find('.forecast-texts').css('cursor', 'pointer').on('click', _options.onClick);

                vis.binds.consumption.forecastBar.draw($div, _options);
            }
        },

        renderPlanMain: function ($div, $td, settings, data) {
            var name = (settings.resource || 'all').toLowerCase();
            var stations = $div.data('stations');
            var theme = $div.data('data').colorTheme;
            var textColor = theme === 'dark' ? 'white' : 'black';

            var stationName;
            if (settings.station) {
                for (var i = 0; i < stations.length; i++) {
                    if (stations[i].name === settings.station) {
                        stationName = stations[i].title;
                        break;
                    }
                }
            }
            var isBad = data.series[name].planned && data.series[name].forecast > data.series[name].planned;
            var text = '<div class="vis-cons-plan-main-div-widget" style="color: ' + textColor + '">\n';
            text += '<div class="vis-cons-plan-main-div-widget-title">'     + _('Costs for %s', stationName) + '</div>\n';
            text += '<div class="vis-cons-plan-main-div-widget-actual">'    + _('Actual') + ': ' +  vis.binds.consumption.format(data.series[name].actual, data.unit) + '</div>\n';
            text += '<div class="vis-cons-plan-main-div-widget-reference">' + _('Reference') + ': ' + (data.series[name].reference ? vis.binds.consumption.format(data.series[name].reference, data.unit) : '--') + '</div>\n';
            text += '<img class="vis-cons-plan-main-div-widget-icon vis-cons-plan-main-div-widget-icon-' + (isBad ? 'bad' : 'good') + '" src="widgets/consumption/img/' + (isBad ? 'smileBad.svg' : 'smile.svg') + '"/>\n';
            text += '<div class="vis-cons-plan-main-div-widget-forecast">'  + _('Forecast') + ': ' +  vis.binds.consumption.format(data.series[name].forecast, data.unit) + '</div>\n';
            text += '<div class="vis-cons-plan-main-div-widget-planned">'   + _('Planned') + ': ' +  vis.binds.consumption.format(data.series[name].planned, data.unit) + '</div>\n';
            text += '</div>';

            $td.html(text);
        }
    };

    vis.binds.consumption.showVersion();

</script>

<script id="tplConsumption"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/consumption/img/Prev_tplConsumption.png"></img>'
        data-vis-set="consumption"
        data-vis-type="ctrl"
        data-vis-name="Charts"
        data-vis-attrs="consInstance[0]/number,0,5;colorTheme[light]/nselect,light,dark;ownClasses[false]/checkbox;"
        data-vis-attrs0="startsFrom[2020-01-01];dateFormat[yy-mm-dd];consumption_station;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 600px; height: 450px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="display: inline-block" <%= (el) -> vis.binds.consumption.init(el, this.data.wid, this.view, this.data, this.style) %> ></div>
    </div>
</script>

<!-- --------------consumption.html--- END -->
<!-- --------------coronavirus-statistics.html--- START -->
<!--
    ioBroker.vis coronavirus-statistics Widget-Set

    version: "0.1.0"
-->
<style>
    .covid-div {
        display: inline-block;
        height: calc(100% - 20px);
        text-align: center;
    }
    .covid-div-title {
        font-weight: bold;
	    white-space: nowrap;
        text-align: center;
        width: 100%;
    }
    .covid-div-img {
        width: 100%;
        height: calc(100% - 40px);
    }
    .covid-div-number {
        font-size: smaller;
        text-align: center;
        width: 100%;
    }
    .covid-title {
        font-weight: bold;
        font-size: larger;
    }
</style>
<script type="text/javascript">

    $.extend(true, systemDictionary, {
        "cases": {
            "en": "Confirmed",
            "de": "Bestätigt",
            "ru": "Всего",
            "pt": "Confirmado",
            "nl": "Bevestigd",
            "fr": "Confirmé",
            "it": "Confermato",
            "es": "Confirmado",
            "pl": "Potwierdzony",
            "zh-cn": "已确认"
        },
        "deaths": {
            "en": "Deaths",
            "de": "Todesfälle",
            "ru": "Смертей",
            "pt": "Mortes",
            "nl": "Sterfgevallen",
            "fr": "Des morts",
            "it": "morti",
            "es": "Muertes",
            "pl": "Zgony",
            "zh-cn": "死亡人数"
        },
        "recovered": {
            "en": "Recovered",
            "de": "wieder gesund",
            "ru": "Здоровы",
            "pt": "Recuperado",
            "nl": "Hersteld",
            "fr": "Rétabli",
            "it": "recuperato",
            "es": "Recuperado",
            "pl": "Odzyskany",
            "zh-cn": "已恢复"
        },
        "active": {
            "en": "Current",
            "de": "infiziert",
            "ru": "Больны",
            "pt": "Atual",
            "nl": "Huidige",
            "fr": "Courant",
            "it": "attuale",
            "es": "Actual",
            "pl": "obecny",
            "zh-cn": "当前"
        },
        "critical": {
            "en": "Critical",
            "de": "Kritisch",
            "ru": "Критическое",
            "pt": "Crítico",
            "nl": "Kritiek",
            "fr": "Critique",
            "it": "critico",
            "es": "Crítico",
            "pl": "Krytyczny",
            "zh-cn": "危急"
        },
        "todayCases": {
            "en": "Today cases",
            "de": "Heute infiziert",
            "ru": "Сегодня",
            "pt": "Casos de hoje",
            "nl": "Gevallen van vandaag",
            "fr": "Cas d'aujourd'hui",
            "it": "Casi oggi",
            "es": "Hoy casos",
            "pl": "Dzisiaj przypadki",
            "zh-cn": "今天的情况"
        },
        "todayDeaths": {
            "en": "Today death",
            "de": "Heute verstorben",
            "ru": "Сегодня",
            "pt": "Hoje a morte",
            "nl": "Vandaag dood",
            "fr": "Aujourd'hui la mort",
            "it": "Oggi morte",
            "es": "Hoy muerte",
            "pl": "Dziś śmierć",
            "zh-cn": "今天死亡"
        },
        "Worldwide": {
            "en": "Worldwide",
            "de": "Weltweit",
            "ru": "По всему миру",
            "pt": "No mundo todo",
            "nl": "Wereldwijd",
            "fr": "À l'échelle mondiale",
            "it": "In tutto il mondo",
            "es": "En todo el mundo",
            "pl": "Na całym świecie",
            "zh-cn": "全世界"
        }
    });

    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {
            "country": {
                "en": "Country",
                "de": "Land",
                "ru": "Страна",
                "pt": "País",
                "nl": "Land",
                "fr": "Pays",
                "it": "Nazione",
                "es": "País",
                "pl": "Kraj",
                "zh-cn": "国家"
            },
            "showCountry": {
                "en": "Show country",
                "de": "Land anzeigen",
                "ru": "Показать страну",
                "pt": "Mostrar país",
                "nl": "Land weergeven",
                "fr": "Afficher le pays",
                "it": "Mostra paese",
                "es": "Mostrar país",
                "pl": "Pokaż kraj",
                "zh-cn": "显示国家"
            },
            "countryFontSize": {
                "en": "Country",
                "de": "Land",
                "ru": "Страна",
                "pt": "País",
                "nl": "Land",
                "fr": "Pays",
                "it": "Nazione",
                "es": "País",
                "pl": "Kraj",
                "zh-cn": "国家"
            },
            "typeFontSize": {
                "en": "Type",
                "de": "Bezeichnungen",
                "ru": "Тип",
                "pt": "Tipo",
                "nl": "Type",
                "fr": "Type",
                "it": "genere",
                "es": "Tipo",
                "pl": "Rodzaj",
                "zh-cn": "类型"
            },
            "numberFontSize": {
                "en": "Numbers",
                "de": "Zahlen",
                "ru": "чисел",
                "pt": "Números",
                "nl": "Nummers",
                "fr": "Nombres",
                "it": "Numeri",
                "es": "Números",
                "pl": "Liczby",
                "zh-cn": "号码"
            },
            "group_fonts": {
                "en": "Font size",
                "de": "Schriftgröße",
                "ru": "Размер шрифта",
                "pt": "Tamanho da fonte",
                "nl": "Lettertypegrootte",
                "fr": "Taille de police",
                "it": "Dimensione del font",
                "es": "Tamaño de fuente",
                "pl": "Rozmiar czcionki",
                "zh-cn": "字体大小"
            }
        });
    }

    vis.binds['coronavirus-statistics'] = {
		version: "0.1.0",
		showVersion: function () {
			if (vis.binds['coronavirus-statistics'].version) {
				console.log('Version coronavirus-statistics: ' + vis.binds['coronavirus-statistics'].version);
				vis.binds['coronavirus-statistics'].version = null;
			}
		},
        one: function (data, type, count, fontTitleSize, fontNumberSize) {
		    return '<div class="covid-div" style="width: ' + ((100 / count) - 0.5).toFixed(2) +'%">\n' +
                '                    <div class="covid-div-title" style="' + (fontTitleSize ? 'font-size: ' + fontTitleSize : '') + '">' + _(type) + '</div>\n' +
                '                    <img class="covid-div-img" src="widgets/coronavirus-statistics/img/' + type + '.svg" alt="' + type + '"/>\n' +
                '                    <div class="covid-div-number" style="' + (fontNumberSize ? 'font-size: ' + fontNumberSize : '') + '">' + data[type].toLocaleString() + '</div>\n' +
                '                </div>';
        },
        init: function (wid, view, data, style) {
            var $div = $('#' + wid);
            if (!$div.length) {
                setTimeout(function () {
                    vis.binds['coronavirus-statistics'].init(wid, view, data, style);
                }, 100);
                return;
            }
            var text = '<div class="vis-widget-body">';
            if (data.showCountry !== 'false' && data.showCountry !== false) {
                var countryFontSize = data.countryFontSize;
                if (countryFontSize && countryFontSize.match(/\d$/)) {
                    countryFontSize += 'px';
                }
                text += '<div class="covid-title" style="' + (countryFontSize ? 'font-size: ' + countryFontSize : '') + '">' + _(!data.country || data.country === 'all' ? 'Worldwide' : data.country) + '</div>';
            }

            var fontTitleSize = data.typeFontSize;
            if (fontTitleSize && fontTitleSize.match(/\d$/)) {
                fontTitleSize += 'px';
            }
            var fontNumberSize = data.numberFontSize;
            if (fontNumberSize && fontNumberSize.match(/\d$/)) {
                fontNumberSize += 'px';
            }
            if (!data.country || data.country === 'all') {
                // https://coronavirus-19-api.herokuapp.com/all
                fetch('https://coronavirus-19-api.herokuapp.com/all')
                    .then((response) => {
                        return response.json();
                    })
                    .then((info) => {
                        var count = 0;
                        count += data.cases     === true || data.cases     === 'true' ? 1 : 0;
                        count += data.deaths    === true || data.deaths    === 'true' ? 1 : 0;
                        count += data.recovered === true || data.recovered === 'true' ? 1 : 0;

                        text += data.cases      === true || data.cases     === 'true' ? vis.binds['coronavirus-statistics'].one(info, 'cases',     count, fontTitleSize, fontNumberSize) : '';
                        text += data.recovered  === true || data.recovered === 'true' ? vis.binds['coronavirus-statistics'].one(info, 'recovered', count, fontTitleSize, fontNumberSize) : '';
                        text += data.deaths     === true || data.deaths    === 'true' ? vis.binds['coronavirus-statistics'].one(info, 'deaths',    count, fontTitleSize, fontNumberSize) : '';
                        $div.html(text + '</div>');
                    });
            } else {
                // https://coronavirus-19-api.herokuapp.com/countries
                fetch('https://coronavirus-19-api.herokuapp.com/countries')
                    .then((response) => {
                        return response.json();
                    })
                    .then((datas) => {
                        var count = 0;
                        count += data.cases       === true || data.cases       === 'true' ? 1 : 0;
                        count += data.todayCases  === true || data.todayCases  === 'true' ? 1 : 0;
                        count += data.recovered   === true || data.recovered   === 'true' ? 1 : 0;
                        count += data.deaths      === true || data.deaths      === 'true' ? 1 : 0;
                        count += data.todayDeaths === true || data.todayDeaths === 'true' ? 1 : 0;
                        count += data.active      === true || data.active      === 'true' ? 1 : 0;
                        count += data.critical    === true || data.critical    === 'true' ? 1 : 0;

                        var info = datas.find(it => it.country === data.country);
                        text += data.cases       === true || data.cases       === 'true' ? vis.binds['coronavirus-statistics'].one(info, 'cases',       count, fontTitleSize, fontNumberSize) : '';
                        text += data.todayCases  === true || data.todayCases  === 'true' ? vis.binds['coronavirus-statistics'].one(info, 'todayCases',  count, fontTitleSize, fontNumberSize) : '';
                        text += data.recovered   === true || data.recovered   === 'true' ? vis.binds['coronavirus-statistics'].one(info, 'recovered',   count, fontTitleSize, fontNumberSize) : '';
                        text += data.active      === true || data.active      === 'true' ? vis.binds['coronavirus-statistics'].one(info, 'active',      count, fontTitleSize, fontNumberSize) : '';
                        text += data.critical    === true || data.critical    === 'true' ? vis.binds['coronavirus-statistics'].one(info, 'critical',    count, fontTitleSize, fontNumberSize) : '';
                        text += data.deaths      === true || data.deaths      === 'true' ? vis.binds['coronavirus-statistics'].one(info, 'deaths',      count, fontTitleSize, fontNumberSize) : '';
                        text += data.todayDeaths === true || data.todayDeaths === 'true' ? vis.binds['coronavirus-statistics'].one(info, 'todayDeaths', count, fontTitleSize, fontNumberSize) : '';
                        $div.html(text + '</div>');
                    });
            }
            $div.data('destroy', function () {
                var interval = $div.data('interval');
                interval && clearInterval(interval);
            });
            // every 3 hours
            $div.data('interval', setInterval(function () {
                vis.binds['coronavirus-statistics'].init(wid, view, data, style);
            }, 3 * 3600000));
        },
    };

	vis.binds['coronavirus-statistics'].showVersion();
</script>

<script id="tplCovidInfo"
     type="text/ejs"
     class="vis-tpl"
     data-vis-prev='<img src="widgets/coronavirus-statistics/img/Prev_tplCovidInfo.png"></img>'
     data-vis-set="coronavirus-statistics"
     data-vis-type="ctrl,color"
     data-vis-name="Covid-19 info"
     data-vis-attrs="country/select,all,Germany,Austria,Switzerland,Russia,China,Italy,Iran,S. Korea,Spain,France,USA,UK,Norway,Netherlands,Sweden,Belgium,Denmark,Japan,Diamond Princess,Malaysia,Qatar,Greece,Canada,Australia,Portugal,Finland,Czechia,Singapore,Slovenia,Bahrain,Israel,Estonia,Iceland,Hong Kong,Philippines,Romania,Ireland,Brazil,Poland,Indonesia,Thailand,Kuwait,Iraq,India,Egypt,Saudi Arabia,San Marino,Lebanon,UAE,Chile,Luxembourg,Taiwan,Vietnam,Slovakia,Pakistan,Bulgaria,South Africa,Brunei,Croatia,Algeria,Serbia,Argentina,Panama,Peru,Albania,Mexico,Palestine,Colombia,Georgia,Hungary,Latvia,Ecuador,Morocco,Belarus,Costa Rica,Armenia,Cyprus,Senegal,Bosnia and Herzegovina,Azerbaijan,Moldova,Oman,Malta,North Macedonia,Sri Lanka,Tunisia,Afghanistan,Maldives,Cambodia,Lithuania,Dominican Republic,Faeroe Islands,Macao,Bolivia,Martinique,Venezuela,Kazakhstan,Jordan,New Zealand,Jamaica,French Guiana,Liechtenstein,Paraguay,Reunion,Ghana,Turkey,Uruguay,Andorra,Bangladesh,Guyana,Ivory Coast,Cuba,Ethiopia,Puerto Rico,Ukraine,Burkina Faso,Channel Islands,French Polynesia,Guadeloupe,Guam,Honduras,Kenya,Monaco,Nigeria,Aruba,Cameroon,Curacao,DRC,Namibia,Saint Lucia,Saint Martin,Seychelles,Trinidad and Tobago,Sudan,Nepal,Antigua and Barbuda,Bhutan,Cayman Islands,CAR,Congo,Equatorial Guinea,Gabon,Gibraltar,Guatemala,Guinea,Vatican City,Mauritania,Mayotte,Mongolia,Rwanda,St. Barth,St. Vincent Grenadines,Suriname,Eswatini,Togo,U.S. Virgin Islands,Uzbekistan;"
     data-vis-attrs0="showCountry[true]/checkbox;todayCases[true]/checkbox;recovered[true]/checkbox;active[true]/checkbox;critical[true]/checkbox;deaths[true]/checkbox;todayDeaths[true]/checkbox;"
     data-vis-attrs1="group.fonts;countryFontSize[16]/slider,6,32,1;typeFontSize[14]/slider,6,32,1;numberFontSize[12]/slider,6,32,1;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 400px; height: 110px; font-size: 14px" id="<%= this.data.attr('wid') %>">
        <%= (el) -> vis.binds['coronavirus-statistics'].init(this.data.wid, this.view, this.data, this.style) %>
    </div>
</script>


<!-- --------------coronavirus-statistics.html--- END -->
<!-- --------------dwd.html--- START -->
<!--
    ioBroker.vis dwd Widget-Set

    version: "2.4.5"

    Copyright 2013-2020 bluefox<dogafox@gmail.com>
-->

<script type="text/javascript">
    if (vis.editMode) {
        // Add words for widgets
        $.extend(true, systemDictionary, {
            "oid-begin":    {"en": "oid-begin",    "de": "oid-begin",    "ru": "oid-begin"},
            "oid-end":      {"en": "oid-end",      "de": "oid-end",      "ru": "oid-end"},
            "oid-headline": {"en": "oid-headline", "de": "oid-headline", "ru": "oid-headline"},
            "oid-severity": {"en": "oid-severity", "de": "oid-severity", "ru": "oid-severity"},
            "dwd-format": {
                "en": "Time format",
                "de": "Zeitformat",
                "ru": "Формат времени",
                "pt": "Formato da hora",
                "nl": "Tijd formaat",
                "fr": "Format de l'heure",
                "it": "Formato orario",
                "es": "Formato de tiempo",
                "pl": "Format czasu",
                "zh-cn": "时间格式"
            }
        });
    }
</script>

<script id="tplDwdAdapterSmall"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="dwd"
        data-vis-prev='<img src="widgets/dwd/img/Prev_DwdAdapterSmall.png"></img>'
        data-vis-name="DWD Wetterwarnungen klein"
        data-vis-attrs="oid[dwd.0.warning.text];oid-severity[dwd.0.warning.severity]">
    <%
    var dwdBackground = [
        "",        // 0
        "#ffeb3b", // 1 - Wetterwarnungen (Stufe 1)
        "#fb8c00", // 2 - Warnungen vor markantem Wetter (Stufe 2)
        "#e53935", // 3 - Unwetterwarnungen (Stufe 3)
        "#880e4f", // 4 - Warnungen vor extremem Unwetter (Stufe 4)
        "",        // 5 -
        "",        // 6 -
        "",        // 7 -
        "",        // 8 -
        "#c99afe", // 9 - Hitzewarnung
        "",        // 10
        "#c9f",    // 11 - Keine Warnungen
        "",        // 12 -
        "",        // 13 -
        "",        // 14 -
        "",        // 15 -
        "",        // 16 -
        "",        // 17 -
        "",        // 18 -
        "#fe68fe", // 19 - UV-Warnung
        "",        // 6 -
    ];
    %>
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 160px; height: 21px; font-family: Arial" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="padding: 3px; background-color: <%= dwdBackground[parseInt(vis.states.attr(this.data['oid-severity'] + '.val'), 10)] %>;">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== vis.states.attr(this.data.oid + '.val') %>
            </div>
        </div>
    </div>
</script>

<script id="tplDwdAdapter"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/dwd/img/Prev_DwdAdapter.png"></img>'
        data-vis-set="dwd"
        data-vis-name="DWD Wetterwarnungen"
        data-vis-attrs="oid-begin[dwd.0.warning.begin];oid-end[dwd.0.warning.end];oid-headline[dwd.0.warning.headline];oid[dwd.0.warning.description];oid-severity[dwd.0.warning.severity];dwd-format[DD.MM hh:mm]">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 585px; height: 85px; font-family: Arial" id="<%= this.data.attr('wid') %>">
        <%
		var dwdBackground = [
			"",        // 0
			"#ffeb3b", // 1 - Wetterwarnungen (Stufe 1)
			"#fb8c00", // 2 - Warnungen vor markantem Wetter (Stufe 2)
			"#e53935", // 3 - Unwetterwarnungen (Stufe 3)
			"#880e4f", // 4 - Warnungen vor extremem Unwetter (Stufe 4)
			"",        // 5 -
			"",        // 6 -
			"",        // 7 -
			"",        // 8 -
			"#c99afe", // 9 - Hitzewarnung
			"",        // 10
			"#c9f",    // 11 - Keine Warnungen
			"",        // 12 -
			"",        // 13 -
			"",        // 14 -
			"",        // 15 -
			"",        // 16 -
			"",        // 17 -
			"",        // 18 -
			"#fe68fe", // 19 - UV-Warnung
			"",        // 6 -
		];
        %>
        <div class="vis-widget-body" style="padding: 3px; background-color: <%= dwdBackground[parseInt(vis.states.attr(this.data['oid-severity'] + '.val'), 10)] %>;">
            <div style="font-size: 1.5em; font-weight: bold;" data-oid="<%= this.data.attr('oid-headline') %>">
                <%== vis.states.attr(this.data['oid-headline'] + '.val') %>
            </div>
            <p><%== vis.states.attr(this.data['oid'] + '.val') %><br/>
            <%== vis.states.attr(this.data['oid-begin'] + '.val') ? vis.binds.basic.formatDate(vis.states.attr(this.data['oid-begin'] + '.val'), this.data['dwd-format']) + ' - ' : '' %><%== vis.states.attr(this.data['oid-end'] + '.val') ? vis.binds.basic.formatDate(vis.states.attr(this.data['oid-end'] + '.val'), this.data['dwd-format']) : '' %></p>
        </div>
    </div>
</script>
<!-- --------------dwd.html--- END -->
<!-- --------------ebus.html--- START -->
﻿<!--
    ioBroker.vis ebus Widget-Set

    version: "1.0.0"

    Copyright 2017,2018,2019 René G. info@rg-engineering.eu
-->
<!--
<script language="javascript" type="text/javascript" src="widgets/weather/lib/js/flot/jquery.js"></script>
-->
<script language="javascript" type="text/javascript" src="widgets/ebus/lib/js/flot/jquery.canvaswrapper.js"></script>
<script language="javascript" type="text/javascript" src="widgets/ebus/lib/js/flot/jquery.colorhelpers.js"></script>
<script language="javascript" type="text/javascript" src="widgets/ebus/lib/js/flot/jquery.flot.js"></script>
<script language="javascript" type="text/javascript" src="widgets/ebus/lib/js/flot/jquery.flot.saturated.js"></script>
<script language="javascript" type="text/javascript" src="widgets/ebus/lib/js/flot/jquery.flot.browser.js"></script>
<script language="javascript" type="text/javascript" src="widgets/ebus/lib/js/flot/jquery.flot.drawSeries.js"></script>
<script language="javascript" type="text/javascript" src="widgets/ebus/lib/js/flot/jquery.flot.uiConstants.js"></script>
<script language="javascript" type="text/javascript" src="widgets/ebus/lib/js/flot/jquery.flot.time.js"></script>
<script language="javascript" type="text/javascript" src="widgets/ebus/lib/js/flot/jquery.flot.legend.js"></script>

<script language="javascript" type="text/javascript" src="widgets/ebus/lib/js/flot/jquery.flot.axislabels_V2.js"></script>

<!-- doku for flot : -->
<!--  https://github.com/flot/flot/blob/master/API.md -->

<style>
    .chart-placeholder {
        width: 100%;
        height: 100%;
        font-size: 14px;
        line-height: 1.2em;
    }

    .legendLayer .background {
        fill: rgba(255, 255, 255, 0.85);
        stroke: rgba(0, 0, 0, 0.85);
        stroke-width: 1;
    }
</style>

<script type="text/javascript">
    "use strict";

    var MarkingColor = "eaebe5";

    if (vis.editMode) {
        // add translations for non-edit mode
        $.extend(true, systemDictionary, {
            "ebus": {
                "en": "ebus",
                "de": "ebus",
                "ru": "EBUS",
                "pt": "ebus",
                "nl": "ebus",
                "fr": "ebus",
                "it": "eBUS",
                "es": "ebus",
                "pl": "ebus",
                "zh-cn": "巴士"
            },
            "1 second": {
                "en": "1 second",
                "de": "1 Sekunde",
                "ru": "1 секунда",
                "pt": "1 segundo",
                "nl": "1 seconde",
                "fr": "1 seconde",
                "it": "1 secondo",
                "es": "1 segundo",
                "pl": "1 sekunda",
                "zh-cn": "1秒"
            },
            "10 seconds": {
                "en": "10 seconds",
                "de": "10 Sekunden",
                "ru": "10 секунд",
                "pt": "10 segundos",
                "nl": "10 seconden",
                "fr": "10 secondes",
                "it": "10 secondi",
                "es": "10 segundos",
                "pl": "10 sekund",
                "zh-cn": "10秒"
            },
            "30 seconds": {
                "en": "30 seconds",
                "de": "30 Sekunden",
                "ru": "30 секунд",
                "pt": "30 segundos",
                "nl": "30 seconden",
                "fr": "30 secondes",
                "it": "30 secondi",
                "es": "30 segundos",
                "pl": "30 sekund",
                "zh-cn": "30秒"
            },
            "1 minute": {
                "en": "1 minute",
                "de": "1 Minute",
                "ru": "1 минута",
                "pt": "1 minuto",
                "nl": "1 minuut",
                "fr": "1 minute",
                "it": "1 minuto",
                "es": "1 minuto",
                "pl": "1 minuta",
                "zh-cn": "1分钟"
            },
            "2 minutes": {
                "en": "2 minutes",
                "de": "2 Minuten",
                "ru": "2 минуты",
                "pt": "2 minutos",
                "nl": "2 minuten",
                "fr": "2 minutes",
                "it": "2 minuti",
                "es": "2 minutos",
                "pl": "2 minuty",
                "zh-cn": "2分钟"
            },
            "5 minutes": {
                "en": "5 minutes",
                "de": "5 Minuten",
                "ru": "5 минут",
                "pt": "5 minutos",
                "nl": "5 minuten",
                "fr": "5 minutes",
                "it": "5 minuti",
                "es": "5 minutos",
                "pl": "5 minut",
                "zh-cn": "5分钟"
            },
            "10 minutes": {
                "en": "10 minutes",
                "de": "10 Minuten",
                "ru": "10 минут",
                "pt": "10 minutos",
                "nl": "10 minuten",
                "fr": "10 minutes",
                "it": "10 minuti",
                "es": "10 minutos",
                "pl": "10 minut",
                "zh-cn": "10分钟"
            },
            "30 minutes": {
                "en": "30 minutes",
                "de": "30 Minuten",
                "ru": "30 минут",
                "pt": "30 minutos",
                "nl": "30 minuten",
                "fr": "30 minutes",
                "it": "30 minuti",
                "es": "30 minutos",
                "pl": "30 minut",
                "zh-cn": "30分钟"
            },
            "1 hour": {
                "en": "1 hour",
                "de": "1 Stunde",
                "ru": "1 час",
                "pt": "1 hora",
                "nl": "1 uur",
                "fr": "1 heure",
                "it": "1 ora",
                "es": "1 hora",
                "pl": "1 godzina",
                "zh-cn": "1小时"
            },
            "2 hours": {
                "en": "2 hours",
                "de": "2 Stunden",
                "ru": "два часа",
                "pt": "2 horas",
                "nl": "twee uur",
                "fr": "2 heures",
                "it": "2 ore",
                "es": "2 horas",
                "pl": "2 godziny",
                "zh-cn": "2小时"
            },
            "4 hours": {
                "en": "4 hours",
                "de": "4 Stunden",
                "ru": "4 часа",
                "pt": "4 horas",
                "nl": "4 uur",
                "fr": "4 heures",
                "it": "4 ore",
                "es": "4 horas",
                "pl": "4 godziny",
                "zh-cn": "4个小时"
            },
            "8 hours": {
                "en": "8 hours",
                "de": "8 Stunden",
                "ru": "8 часов",
                "pt": "8 horas",
                "nl": "8 uur",
                "fr": "8 heures",
                "it": "8 ore",
                "es": "8 horas",
                "pl": "8 godzin",
                "zh-cn": "8小时"
            },
            "12 hours": {
                "en": "12 hours",
                "de": "12 Stunden",
                "ru": "12 часов",
                "pt": "12 horas",
                "nl": "12 uren",
                "fr": "12 heures",
                "it": "12 ore",
                "es": "12 horas",
                "pl": "12 godzin",
                "zh-cn": "12小时"
            },
            "24 hours": {
                "en": "24 hours",
                "de": "24 Stunden",
                "ru": "24 часа",
                "pt": "24 horas",
                "nl": "24 uur",
                "fr": "24 heures",
                "it": "24 ore",
                "es": "24 horas",
                "pl": "24 godziny",
                "zh-cn": "24小时"
            },
            "ebusinstance": {
                "en": "ebus instance",
                "de": "ebus-Instanz",
                "ru": "Ebus экземпляр",
                "pt": "instância ebus",
                "nl": "ebus-instantie",
                "fr": "instance ebus",
                "it": "istanza ebus",
                "es": "instancia de ebus",
                "pl": "instancja ebus",
                "zh-cn": "ebus实例"
            },
            "time_interval": {
                "en": "Time interval",
                "de": "Zeitintervall",
                "ru": "Интервал времени",
                "pt": "Intervalo de tempo",
                "nl": "Tijdsinterval",
                "fr": "Intervalle de temps",
                "it": "Intervallo di tempo",
                "es": "Intervalo de tiempo",
                "pl": "Przedział czasowy",
                "zh-cn": "时间间隔"
            },
            "withxaxix": {
                "en": "show X axis",
                "de": "X-Achse anzeigen",
                "ru": "показать ось X",
                "pt": "mostre o eixo X",
                "nl": "X-as weergeven",
                "fr": "afficher l'axe X",
                "it": "mostra l'asse X.",
                "es": "mostrar eje X",
                "pl": "pokaż oś X.",
            },
            

            "xDateFormat": {
                "en": "format for date/time on x-axis",
                "de": "Format für Datum / Uhrzeit auf der x-Achse",
                "ru": "формат даты / времени по оси X",
                "pt": "formato para data / hora no eixo x",
                "nl": "formaat voor datum / tijd op x-as",
                "fr": "format de date / heure sur l'axe des x",
                "it": "formato per data / ora sull'asse x",
                "es": "formato para fecha / hora en eje x",
                "pl": "format daty / godziny na osi x",
                "zh-cn": "x轴上日期/时间的格式"
            },
            /*
            "withborder": {
                "en": "show border of grid",
                "de": "Rahmen des Gitters anzeigen",
                "ru": "показать границу сетки",
                "pt": "mostrar borda da grade",
                "nl": "rand van raster weergeven",
                "fr": "montrer la bordure de la grille",
                "it": "mostra il bordo della griglia",
                "es": "mostrar borde de cuadrícula",
                "pl": "pokaż granicę siatki",
                "zh-cn": "显示网格边框"
            },*/
            "bordercolor": {
                "en": "color of grid border",
                "de": "Farbe des Gitterrandes",
                "ru": "цвет границы сетки",
                "pt": "cor da borda da grade",
                "nl": "kleur van de rasterrand",
                "fr": "couleur de la bordure de la grille",
                "it": "colore del bordo della griglia",
                "es": "color del borde de la cuadrícula",
                "pl": "kolor obramowania siatki",
                "zh-cn": "网格边框的颜色"
            },

            "nobgcolor": {
                "en": "no background color on grid",
                "de": "Keine Hintergrundfarbe im Raster",
                "ru": "нет цвета фона на сетке",
                "pt": "sem cor de fundo na grade",
                "nl": "geen achtergrondkleur op het raster",
                "fr": "pas de couleur d'arrière-plan sur la grille",
                "it": "nessun colore di sfondo sulla griglia",
                "es": "sin color de fondo en la cuadrícula",
                "pl": "brak koloru tła na siatce",
                "zh-cn": "网格上没有背景色"
            },

            "bgcolor": {
                "en": "background color on grid",
                "de": "Hintergrundfarbe auf Raster",
                "ru": "цвет фона на сетке",
                "pt": "cor de fundo na grade",
                "nl": "achtergrondkleur op het raster",
                "fr": "couleur de fond sur la grille",
                "it": "colore di sfondo sulla griglia",
                "es": "color de fondo en la cuadrícula",
                "pl": "kolor tła na siatce",
                "zh-cn": "网格上的背景色"
            },
            "withlegend": {
                "en": "show legend",
                "de": "Legende anzeigen",
                "ru": "показать легенду",
                "pt": "mostrar legenda",
                "nl": "toon legende",
                "fr": "montrer la légende",
                "it": "mostra legenda",
                "es": "Mostrar leyenda",
                "pl": "pokaż legendę",
                "zh-cn": "显示传奇"
            },
            "legendposition": {
                "en": "legend position",
                "de": "Legendenposition",
                "ru": "положение легенды",
                "pt": "posição da legenda",
                "nl": "legende positie",
                "fr": "position de la légende",
                "it": "posizione della legenda",
                "es": "posición de leyenda",
                "pl": "pozycja legendy",
                "zh-cn": "图例位置"
            },

           
   
            "none": {
                    "en": "none",
    "de": "kein",
    "ru": "никто",
    "pt": "Nenhum",
    "nl": "geen",
    "fr": "aucun",
    "it": "nessuna",
    "es": "ninguna",
    "pl": "Żaden",
    "zh-cn": "没有"
            },
            "kWh": {
                    "en": "kWh",
    "de": "kWh",
    "ru": "кВтч",
    "pt": "kWh",
    "nl": "kWh",
    "fr": "kWh",
    "it": "kWh",
    "es": "kWh",
    "pl": "kWh",
    "zh-cn": "千瓦时"
            },
            "degree": {
                    "en": "degree",
    "de": "Grad",
    "ru": "степень",
    "pt": "grau",
    "nl": "mate",
    "fr": "diplôme",
    "it": "grado",
    "es": "la licenciatura",
    "pl": "stopień",
    "zh-cn": "学位"
            },

            "group_graph1": {
                "en": "graph 1",
    "de": "Grafik 1",
    "ru": "график 1",
    "pt": "gráfico 1",
    "nl": "grafiek 1",
    "fr": "graphique 1",
    "it": "grafico 1",
    "es": "gráfico 1",
    "pl": "wykres 1",
                "zh-cn": "图1"
            },

            "graph1charttype": {
                 "en": "chart type",
                "de": "Diagramm Typ",
                "ru": "тип диаграммы",
                "pt": "tipo de gráfico",
                "nl": "grafiektype",
                "fr": "type de graphique",
                "it": "tipo di grafico",
                "es": "tipo de gráfico",
                "pl": "typ wykresu",
                "zh-cn": "图表类型"
            },
            "graph1visible": {
                "en": "visible",
                "de": "sichtbar",
                "ru": "видимый",
                "pt": "visível",
                "nl": "zichtbaar",
                "fr": "visible",
                "it": "visibile",
                "es": "visible",
                "pl": "widoczny",
                "zh-cn": "可见"
            },
            "graph1color": {
                "en": "color",
                "de": "Farbe",
                "ru": "цвет",
                "pt": "cor",
                "nl": "kleur",
                "fr": "Couleur",
                "it": "colore",
                "es": "color",
                "pl": "kolor",
                "zh-cn": "颜色"
            },
            "graph1withyaxix": {
                "en": "show y axis",
                "de": "y-Achse anzeigen",
                "ru": "показать ось у",
                "pt": "mostre o eixo y",
                "nl": "y-as weergeven",
                "fr": "afficher l'axe y",
                "it": "mostra l'asse y",
                "es": "mostrar eje y",
                "pl": "pokaż oś y",
                "zh-cn": "显示y轴"
            },
            "graph1YAxisFomat": { "en": "Y axis fomat", "de": "Y-Achsenformat", "ru": "graph1YAxisFomat" },

            "group_graph2": {
                    "en": "graph 2",
    "de": "Grafik 2",
    "ru": "график 2",
    "pt": "gráfico 2",
    "nl": "grafiek 2",
    "fr": "graphique 2",
    "it": "grafico 2",
    "es": "gráfico 2",
    "pl": "wykres 2",
    "zh-cn": "图2"
            },
            "graph2charttype": {
                 "en": "chart type",
                "de": "Diagramm Typ",
                "ru": "тип диаграммы",
                "pt": "tipo de gráfico",
                "nl": "grafiektype",
                "fr": "type de graphique",
                "it": "tipo di grafico",
                "es": "tipo de gráfico",
                "pl": "typ wykresu",
                "zh-cn": "图表类型"
            },
            "graph2visible": {
                "en": "visible",
                "de": "sichtbar",
                "ru": "видимый",
                "pt": "visível",
                "nl": "zichtbaar",
                "fr": "visible",
                "it": "visibile",
                "es": "visible",
                "pl": "widoczny",
                "zh-cn": "可见"
            },
            "graph2color": {
                "en": "color",
                "de": "Farbe",
                "ru": "цвет",
                "pt": "cor",
                "nl": "kleur",
                "fr": "Couleur",
                "it": "colore",
                "es": "color",
                "pl": "kolor",
                "zh-cn": "颜色"
            },
            "graph2withyaxix": {
                "en": "show y axis",
                "de": "y-Achse anzeigen",
                "ru": "показать ось у",
                "pt": "mostre o eixo y",
                "nl": "y-as weergeven",
                "fr": "afficher l'axe y",
                "it": "mostra l'asse y",
                "es": "mostrar eje y",
                "pl": "pokaż oś y",
                "zh-cn": "显示y轴"
            },
            "graph2YAxisFomat": { "en": "Y axis fomat", "de": "Y-Achsenformat", "ru": "graph1YAxisFomat" },

            "group_graph3": {
                    "en": "graph 3",
    "de": "Grafik 3",
    "ru": "график 3",
    "pt": "gráfico 3",
    "nl": "grafiek 3",
    "fr": "graphique 3",
    "it": "grafico 3",
    "es": "gráfico 3",
    "pl": "wykres 3",
    "zh-cn": "图3"
            },
            "graph3charttype": {
                 "en": "chart type",
                "de": "Diagramm Typ",
                "ru": "тип диаграммы",
                "pt": "tipo de gráfico",
                "nl": "grafiektype",
                "fr": "type de graphique",
                "it": "tipo di grafico",
                "es": "tipo de gráfico",
                "pl": "typ wykresu",
                "zh-cn": "图表类型"
            },
            "graph3visible": {
                "en": "visible",
                "de": "sichtbar",
                "ru": "видимый",
                "pt": "visível",
                "nl": "zichtbaar",
                "fr": "visible",
                "it": "visibile",
                "es": "visible",
                "pl": "widoczny",
                "zh-cn": "可见"
            },
            "graph3color": {
                "en": "color",
                "de": "Farbe",
                "ru": "цвет",
                "pt": "cor",
                "nl": "kleur",
                "fr": "Couleur",
                "it": "colore",
                "es": "color",
                "pl": "kolor",
                "zh-cn": "颜色"
            },
            "graph3withyaxix": {
                "en": "show y axis",
                "de": "y-Achse anzeigen",
                "ru": "показать ось у",
                "pt": "mostre o eixo y",
                "nl": "y-as weergeven",
                "fr": "afficher l'axe y",
                "it": "mostra l'asse y",
                "es": "mostrar eje y",
                "pl": "pokaż oś y",
                "zh-cn": "显示y轴"
            },
            "graph3YAxisFomat": { "en": "Y axis fomat", "de": "Y-Achsenformat", "ru": "graph1YAxisFomat" },

            "group_graph4": {
                    "en": "graph 4",
    "de": "Grafik 4",
    "ru": "график 4",
    "pt": "gráfico 4",
    "nl": "grafiek 4",
    "fr": "graphique 4",
    "it": "grafico 4",
    "es": "gráfico 4",
    "pl": "wykres 4",
    "zh-cn": "图4"
            },
            "graph4charttype": {
                 "en": "chart type",
                "de": "Diagramm Typ",
                "ru": "тип диаграммы",
                "pt": "tipo de gráfico",
                "nl": "grafiektype",
                "fr": "type de graphique",
                "it": "tipo di grafico",
                "es": "tipo de gráfico",
                "pl": "typ wykresu",
                "zh-cn": "图表类型"
            },
            "graph4visible": {
                "en": "visible",
                "de": "sichtbar",
                "ru": "видимый",
                "pt": "visível",
                "nl": "zichtbaar",
                "fr": "visible",
                "it": "visibile",
                "es": "visible",
                "pl": "widoczny",
                "zh-cn": "可见"
            },
            "graph4color": {
                "en": "color",
                "de": "Farbe",
                "ru": "цвет",
                "pt": "cor",
                "nl": "kleur",
                "fr": "Couleur",
                "it": "colore",
                "es": "color",
                "pl": "kolor",
                "zh-cn": "颜色"
            },
            "graph4withyaxix": {
                "en": "show y axis",
                "de": "y-Achse anzeigen",
                "ru": "показать ось у",
                "pt": "mostre o eixo y",
                "nl": "y-as weergeven",
                "fr": "afficher l'axe y",
                "it": "mostra l'asse y",
                "es": "mostrar eje y",
                "pl": "pokaż oś y",
                "zh-cn": "显示y轴"
            },
            "graph4YAxisFomat": {
                    "en": "Y axis format",
    "de": "Y-Achsen-Format",
    "ru": "Формат оси Y",
    "pt": "Formato do eixo Y",
    "nl": "Y-as formaat",
    "fr": "Format de l'axe Y",
    "it": "Formato dell'asse Y.",
    "es": "Formato del eje Y",
    "pl": "Format osi Y.",
    "zh-cn": "Y轴格式"
            },

            "oid_historygraph1": {
                    "en": "OID",
    "de": "OID",
    "ru": "OID",
    "pt": "OID",
    "nl": "OID",
    "fr": "OID",
    "it": "OID",
    "es": "OID",
    "pl": "OID",
    "zh-cn": "OID"
            },
            "oid_historygraph2": {
                    "en": "OID",
    "de": "OID",
    "ru": "OID",
    "pt": "OID",
    "nl": "OID",
    "fr": "OID",
    "it": "OID",
    "es": "OID",
    "pl": "OID",
    "zh-cn": "OID"
            },
            "oid_historygraph3": {
                    "en": "OID",
    "de": "OID",
    "ru": "OID",
    "pt": "OID",
    "nl": "OID",
    "fr": "OID",
    "it": "OID",
    "es": "OID",
    "pl": "OID",
    "zh-cn": "OID"
            },
            "oid_historygraph4": {
                    "en": "OID",
    "de": "OID",
    "ru": "OID",
    "pt": "OID",
    "nl": "OID",
    "fr": "OID",
    "it": "OID",
    "es": "OID",
    "pl": "OID",
    "zh-cn": "OID"
            },
            "oid_historydate": {
                    "en": "OID",
    "de": "OID",
    "ru": "OID",
    "pt": "OID",
    "nl": "OID",
    "fr": "OID",
    "it": "OID",
    "es": "OID",
    "pl": "OID",
    "zh-cn": "OID"
            },

            "graph1Name": {
                "en": "name on legend",
                "de": "Name auf Legende",
                "ru": "имя по легенде",
                "pt": "nome na legenda",
                "nl": "naam op legende",
                "fr": "nom sur la légende",
                "it": "nome sulla leggenda",
                "es": "nombre en la leyenda",
                "pl": "imię na legendzie",
                "zh-cn": "传说中的名字"
            },
            "graph2Name": {
                "en": "name on legend",
                "de": "Name auf Legende",
                "ru": "имя по легенде",
                "pt": "nome na legenda",
                "nl": "naam op legende",
                "fr": "nom sur la légende",
                "it": "nome sulla leggenda",
                "es": "nombre en la leyenda",
                "pl": "imię na legendzie",
                "zh-cn": "传说中的名字"
            },
            "graph3Name": {
                "en": "name on legend",
                "de": "Name auf Legende",
                "ru": "имя по легенде",
                "pt": "nome na legenda",
                "nl": "naam op legende",
                "fr": "nom sur la légende",
                "it": "nome sulla leggenda",
                "es": "nombre en la leyenda",
                "pl": "imię na legendzie",
                "zh-cn": "传说中的名字"
            },
            "graph4Name": {
                "en": "name on legend",
                "de": "Name auf Legende",
                "ru": "имя по легенде",
                "pt": "nome na legenda",
                "nl": "naam op legende",
                "fr": "nom sur la légende",
                "it": "nome sulla leggenda",
                "es": "nombre en la leyenda",
                "pl": "imię na legendzie",
                "zh-cn": "传说中的名字"
            },
            "axislabelcolor": {
                "en": "color of axis label",
                "de": "Farbe der Achsenbeschriftung",
                "ru": "цвет метки оси",
                "pt": "cor do rótulo do eixo",
                "nl": "kleur van aslabel",
                "fr": "couleur de l'étiquette de l'axe",
                "it": "colore dell'etichetta dell'asse",
                "es": "color de la etiqueta del eje",
                "pl": "kolor etykiety osi",
                "zh-cn": "轴标颜色"
            },
            "tickscolor": {
                "en": "color of axis ticks",
                "de": "Farbe der Achsenstriche",
                "ru": "цвет отметок оси",
                "pt": "cor dos tiques do eixo",
                "nl": "kleur van as tikken",
                "fr": "couleur des tiques des axes",
                "it": "colore delle zecche degli assi",
                "es": "color de las garrapatas del eje",
                "pl": "kolor znaczników osi",
                "zh-cn": "轴刻度的颜色"
            },
             "markingcolor": {
                "en": "color of marking",
                "de": "Farbe der Markierung",
                "ru": "цвет маркировки",
                "pt": "cor da marcação",
                "nl": "kleur van markering",
                "fr": "couleur de marquage",
                "it": "colore della marcatura",
                "es": "color de marcado",
                "pl": "kolor oznakowania",
                "zh-cn": "标记颜色"
            },
            "withmarking": {
                "en": "with marking",
                "de": "mit Markierung",
                "ru": "с маркировкой",
                "pt": "com marcação",
                "nl": "met markering",
                "fr": "avec marquage",
                "it": "con marcatura",
                "es": "con marcado",
                "pl": "z oznaczeniem",
                "zh-cn": "带标记"
            },


            "LabelFontSize": {
                "en": "size of Label Font",
                "de": "Größe der Beschriftungsschrift",
                "ru": "размер шрифта метки",
                "pt": "tamanho da fonte da etiqueta",
                "nl": "grootte van het lettertype",
                "fr": "taille de la police d'étiquette",
                "it": "dimensione del carattere dell'etichetta",
                "es": "tamaño de la fuente de la etiqueta",
                "pl": "rozmiar czcionki etykiety",
                "zh-cn": "标签字体的大小"
            },
            "LabelFontFamily": {
                "en": "family of label font",
                "de": "Schriftfamilie",
                "ru": "семейство меток шрифта",
                "pt": "família de fontes de rótulo",
                "nl": "familie van lettertype",
                "fr": "famille de polices d'étiquettes",
                "it": "famiglia di caratteri etichetta",
                "es": "familia de fuente de etiquetas",
                "pl": "rodzina czcionek etykiet",
                "zh-cn": "标签字体家族"
            },
            "graph1coloraxis": {
                "en": "color of axis",
                "de": "Farbe der Achse",
                "ru": "цвет оси",
                "pt": "cor do eixo",
                "nl": "kleur van de as",
                "fr": "couleur de l'axe",
                "it": "colore dell'asse",
                "es": "color del eje",
                "pl": "kolor osi",
                "zh-cn": "轴的颜色"
            },
            "graph1colorticklabel": {
                "en": "color tick label",
                "de": "Farbe Tick Label",
                "ru": "цветная метка",
                "pt": "etiqueta de escala de cores",
                "nl": "kleur maatlabel",
                "fr": "étiquette de couleur tique",
                "it": "etichetta con segno di spunta di colore",
                "es": "etiqueta de marca de color",
                "pl": "kolorowa etykieta kleszczowa",
                "zh-cn": "彩色刻度标签"
            },
            "graph2coloraxis": {
                "en": "color of axis",
                "de": "Farbe der Achse",
                "ru": "цвет оси",
                "pt": "cor do eixo",
                "nl": "kleur van de as",
                "fr": "couleur de l'axe",
                "it": "colore dell'asse",
                "es": "color del eje",
                "pl": "kolor osi",
                "zh-cn": "轴的颜色"
            },
            "graph2colorticklabel": {
                "en": "color tick label",
                "de": "Farbe Tick Label",
                "ru": "цветная метка",
                "pt": "etiqueta de escala de cores",
                "nl": "kleur maatlabel",
                "fr": "étiquette de couleur tique",
                "it": "etichetta con segno di spunta di colore",
                "es": "etiqueta de marca de color",
                "pl": "kolorowa etykieta kleszczowa",
                "zh-cn": "彩色刻度标签"
            },
            "graph3coloraxis": {
                "en": "color of axis",
                "de": "Farbe der Achse",
                "ru": "цвет оси",
                "pt": "cor do eixo",
                "nl": "kleur van de as",
                "fr": "couleur de l'axe",
                "it": "colore dell'asse",
                "es": "color del eje",
                "pl": "kolor osi",
                "zh-cn": "轴的颜色"
            },
            "graph3colorticklabel": {
                "en": "color tick label",
                "de": "Farbe Tick Label",
                "ru": "цветная метка",
                "pt": "etiqueta de escala de cores",
                "nl": "kleur maatlabel",
                "fr": "étiquette de couleur tique",
                "it": "etichetta con segno di spunta di colore",
                "es": "etiqueta de marca de color",
                "pl": "kolorowa etykieta kleszczowa",
                "zh-cn": "彩色刻度标签"
            },
            "graph4coloraxis": {
                "en": "color of axis",
                "de": "Farbe der Achse",
                "ru": "цвет оси",
                "pt": "cor do eixo",
                "nl": "kleur van de as",
                "fr": "couleur de l'axe",
                "it": "colore dell'asse",
                "es": "color del eje",
                "pl": "kolor osi",
                "zh-cn": "轴的颜色"
            },
            "graph4colorticklabel": {
                "en": "color tick label",
                "de": "Farbe Tick Label",
                "ru": "цветная метка",
                "pt": "etiqueta de escala de cores",
                "nl": "kleur maatlabel",
                "fr": "étiquette de couleur tique",
                "it": "etichetta con segno di spunta di colore",
                "es": "etiqueta de marca de color",
                "pl": "kolorowa etykieta kleszczowa",
                "zh-cn": "彩色刻度标签"
            },

            "graph1tickLength": {
                "en": "length of tick",
                "de": "Länge des Ticks",
                "ru": "длина тика",
                "pt": "comprimento do carrapato",
                "nl": "lengte van de teek",
                "fr": "longueur de tique",
                "it": "lunghezza del segno di spunta",
                "es": "longitud de la garrapata",
                "pl": "długość kleszcza",
                "zh-cn": "tick的长度"
            },
            "graph1showMinorTicks": {
                "en": "show minor tick",
                "de": "zeige kleine Ticks",
                "ru": "показать небольшую галочку",
                "pt": "mostre carrapato menor",
                "nl": "toon kleine vinkjes",
                "fr": "montrer une tique mineure",
                "it": "mostra segno di spunta minore",
                "es": "mostrar marca menor",
                "pl": "pokaż drobne kleszcze",
                "zh-cn": "显示小勾"
            },
            "graph1showTicks": {
                "en": "show tick",
                "de": "zeige ticks",
                "ru": "показать галочку",
                "pt": "show tick",
                "nl": "vinkje tonen",
                "fr": "montrer tique",
                "it": "mostra tick",
                "es": "mostrar marca",
                "pl": "pokaż tik",
                "zh-cn": "显示刻度"
            },
            "graph1tickDecimals": {
                "en": "decimals",
                "de": "Dezimalstellen",
                "ru": "десятичные",
                "pt": "decimais",
                "nl": "decimalen",
                "fr": "décimales",
                "it": "decimali",
                "es": "decimales",
                "pl": "miejsca po przecinku",
                "zh-cn": "小数点"
            },
            "graph1tickSize": {
                 "en": "tick size",
                "de": "Tick-Größe",
                "ru": "размер галочки",
                "pt": "tamanho do carrapato",
                "nl": "teken grootte",
                "fr": "taille de la tique",
                "it": "dimensione tick",
                "es": "tamaño de la garrapata",
                "pl": "rozmiar kleszcza",
                "zh-cn": "刻度大小"
            },
            "graph1minTickSize": {
                 "en": "min. tick size",
                "de": "Mindest. Tick-Größe",
                "ru": "минимум размер галочки",
                "pt": "min. tamanho do carrapato",
                "nl": "min. teken grootte",
                "fr": "min. taille de la tique",
                "it": "min. dimensione tick",
                "es": "min. tamaño de la garrapata",
                "pl": "min. rozmiar kleszcza",
                "zh-cn": "分钟刻度大小"
            },
            "graph1labelwidth": {
                "en": "label width",
                "de": "Labelbreite",
                "ru": "ширина этикетки",
                "pt": "largura da etiqueta",
                "nl": "labelbreedte",
                "fr": "largeur d'étiquette",
                "it": "larghezza dell'etichetta",
                "es": "ancho de etiqueta",
                "pl": "szerokość etykiety",
                "zh-cn": "标签宽度"
            },

            "graph2tickLength": {
                "en": "length of tick",
                "de": "Länge des Ticks",
                "ru": "длина тика",
                "pt": "comprimento do carrapato",
                "nl": "lengte van de teek",
                "fr": "longueur de tique",
                "it": "lunghezza del segno di spunta",
                "es": "longitud de la garrapata",
                "pl": "długość kleszcza",
                "zh-cn": "tick的长度"
            },
            "graph2showMinorTicks": {
                "en": "show minor tick",
                "de": "zeige kleine Ticks",
                "ru": "показать небольшую галочку",
                "pt": "mostre carrapato menor",
                "nl": "toon kleine vinkjes",
                "fr": "montrer une tique mineure",
                "it": "mostra segno di spunta minore",
                "es": "mostrar marca menor",
                "pl": "pokaż drobne kleszcze",
                "zh-cn": "显示小勾"
            },
            "graph2showTicks": {
                "en": "show tick",
                "de": "zeige ticks",
                "ru": "показать галочку",
                "pt": "show tick",
                "nl": "vinkje tonen",
                "fr": "montrer tique",
                "it": "mostra tick",
                "es": "mostrar marca",
                "pl": "pokaż tik",
                "zh-cn": "显示刻度"
            },
            "graph2tickDecimals": {
                "en": "decimals",
                "de": "Dezimalstellen",
                "ru": "десятичные",
                "pt": "decimais",
                "nl": "decimalen",
                "fr": "décimales",
                "it": "decimali",
                "es": "decimales",
                "pl": "miejsca po przecinku",
                "zh-cn": "小数点"
            },
            "graph2tickSize": {
                 "en": "tick size",
                "de": "Tick-Größe",
                "ru": "размер галочки",
                "pt": "tamanho do carrapato",
                "nl": "teken grootte",
                "fr": "taille de la tique",
                "it": "dimensione tick",
                "es": "tamaño de la garrapata",
                "pl": "rozmiar kleszcza",
                "zh-cn": "刻度大小"
            },
            "graph2minTickSize": {
                 "en": "min. tick size",
                "de": "Mindest. Tick-Größe",
                "ru": "минимум размер галочки",
                "pt": "min. tamanho do carrapato",
                "nl": "min. teken grootte",
                "fr": "min. taille de la tique",
                "it": "min. dimensione tick",
                "es": "min. tamaño de la garrapata",
                "pl": "min. rozmiar kleszcza",
                "zh-cn": "分钟刻度大小"
            },
            "graph2labelwidth": {
                "en": "label width",
                "de": "Labelbreite",
                "ru": "ширина этикетки",
                "pt": "largura da etiqueta",
                "nl": "labelbreedte",
                "fr": "largeur d'étiquette",
                "it": "larghezza dell'etichetta",
                "es": "ancho de etiqueta",
                "pl": "szerokość etykiety",
                "zh-cn": "标签宽度"
            },

            "graph3tickLength": {
                "en": "length of tick",
                "de": "Länge des Ticks",
                "ru": "длина тика",
                "pt": "comprimento do carrapato",
                "nl": "lengte van de teek",
                "fr": "longueur de tique",
                "it": "lunghezza del segno di spunta",
                "es": "longitud de la garrapata",
                "pl": "długość kleszcza",
                "zh-cn": "tick的长度"
            },
            "graph3showMinorTicks": {
                "en": "show minor tick",
                "de": "zeige kleine Ticks",
                "ru": "показать небольшую галочку",
                "pt": "mostre carrapato menor",
                "nl": "toon kleine vinkjes",
                "fr": "montrer une tique mineure",
                "it": "mostra segno di spunta minore",
                "es": "mostrar marca menor",
                "pl": "pokaż drobne kleszcze",
                "zh-cn": "显示小勾"
            },
            "graph3showTicks": {
                "en": "show tick",
                "de": "zeige ticks",
                "ru": "показать галочку",
                "pt": "show tick",
                "nl": "vinkje tonen",
                "fr": "montrer tique",
                "it": "mostra tick",
                "es": "mostrar marca",
                "pl": "pokaż tik",
                "zh-cn": "显示刻度"
            },
            "graph3tickDecimals": {
                "en": "decimals",
                "de": "Dezimalstellen",
                "ru": "десятичные",
                "pt": "decimais",
                "nl": "decimalen",
                "fr": "décimales",
                "it": "decimali",
                "es": "decimales",
                "pl": "miejsca po przecinku",
                "zh-cn": "小数点"
            },
            "graph3tickSize": {
                 "en": "tick size",
                "de": "Tick-Größe",
                "ru": "размер галочки",
                "pt": "tamanho do carrapato",
                "nl": "teken grootte",
                "fr": "taille de la tique",
                "it": "dimensione tick",
                "es": "tamaño de la garrapata",
                "pl": "rozmiar kleszcza",
                "zh-cn": "刻度大小"
            },
            "graph3minTickSize": {
                 "en": "min. tick size",
                "de": "Mindest. Tick-Größe",
                "ru": "минимум размер галочки",
                "pt": "min. tamanho do carrapato",
                "nl": "min. teken grootte",
                "fr": "min. taille de la tique",
                "it": "min. dimensione tick",
                "es": "min. tamaño de la garrapata",
                "pl": "min. rozmiar kleszcza",
                "zh-cn": "分钟刻度大小"
            },
            "graph3labelwidth": {
                "en": "label width",
                "de": "Labelbreite",
                "ru": "ширина этикетки",
                "pt": "largura da etiqueta",
                "nl": "labelbreedte",
                "fr": "largeur d'étiquette",
                "it": "larghezza dell'etichetta",
                "es": "ancho de etiqueta",
                "pl": "szerokość etykiety",
                "zh-cn": "标签宽度"
            },

            "graph4tickLength": {
                "en": "length of tick",
                "de": "Länge des Ticks",
                "ru": "длина тика",
                "pt": "comprimento do carrapato",
                "nl": "lengte van de teek",
                "fr": "longueur de tique",
                "it": "lunghezza del segno di spunta",
                "es": "longitud de la garrapata",
                "pl": "długość kleszcza",
                "zh-cn": "tick的长度"
            },
            "graph4showMinorTicks": {
                "en": "show minor tick",
                "de": "zeige kleine Ticks",
                "ru": "показать небольшую галочку",
                "pt": "mostre carrapato menor",
                "nl": "toon kleine vinkjes",
                "fr": "montrer une tique mineure",
                "it": "mostra segno di spunta minore",
                "es": "mostrar marca menor",
                "pl": "pokaż drobne kleszcze",
                "zh-cn": "显示小勾"
            },
            "graph4showTicks": {
                "en": "show tick",
                "de": "zeige ticks",
                "ru": "показать галочку",
                "pt": "show tick",
                "nl": "vinkje tonen",
                "fr": "montrer tique",
                "it": "mostra tick",
                "es": "mostrar marca",
                "pl": "pokaż tik",
                "zh-cn": "显示刻度"
            },
            "graph4tickDecimals": {
                "en": "decimals",
                "de": "Dezimalstellen",
                "ru": "десятичные",
                "pt": "decimais",
                "nl": "decimalen",
                "fr": "décimales",
                "it": "decimali",
                "es": "decimales",
                "pl": "miejsca po przecinku",
                "zh-cn": "小数点"
            },
            "graph4tickSize": {
                 "en": "tick size",
                "de": "Tick-Größe",
                "ru": "размер галочки",
                "pt": "tamanho do carrapato",
                "nl": "teken grootte",
                "fr": "taille de la tique",
                "it": "dimensione tick",
                "es": "tamaño de la garrapata",
                "pl": "rozmiar kleszcza",
                "zh-cn": "刻度大小"
            },
            "graph4minTickSize": {
                 "en": "min. tick size",
                "de": "Mindest. Tick-Größe",
                "ru": "минимум размер галочки",
                "pt": "min. tamanho do carrapato",
                "nl": "min. teken grootte",
                "fr": "min. taille de la tique",
                "it": "min. dimensione tick",
                "es": "min. tamaño de la garrapata",
                "pl": "min. rozmiar kleszcza",
                "zh-cn": "分钟刻度大小"
            },
            "graph4labelwidth": {
                "en": "label width",
                "de": "Labelbreite",
                "ru": "ширина этикетки",
                "pt": "largura da etiqueta",
                "nl": "labelbreedte",
                "fr": "largeur d'étiquette",
                "it": "larghezza dell'etichetta",
                "es": "ancho de etiqueta",
                "pl": "szerokość etykiety",
                "zh-cn": "标签宽度"
            }

        });
    }



    // this code can be placed directly in template.html
    vis.binds.ebus = {
        version: "1.0.0",
        showVersion: function () {
            if (vis.binds.ebus.version) {
                console.log('Version vis-ebus: ' + vis.binds.ebus.version);
                vis.binds.ebus.version = null;
            }
        },
        setup: {
            intervals: {
                '1 second': 1000,
                '10 seconds': 10000,
                '30 seconds': 30000,
                '1 minute': 60000,
                '2 minutes': 120000,
                '5 minutes': 300000,
                '10 minutes': 600000,
                '30 minutes': 1800000,
                '1 hour': 3600000,
                '2 hours': 7200000,
                '4 hours': 14400000,
                '8 hours': 28800000,
                '12 hours': 43200000,
                '24 hours': 86400000
            },

        },
        history: {

            init: function (widgetID, view, data1, style) {
                var $div = $('#' + widgetID);
                console.log("ebus history (" + widgetID + ")");
                var data = {};
                for (var s in data1) {
                    if (s[0] !== '_' && data1.hasOwnProperty(s) && typeof data1[s] !== 'object' && typeof data1[s] !== 'function') {
                        data[s] = data1[s];
                    }

                }


    function SetMarkingColor(color) {
        MarkingColor = color;
    }
    function noneFormatter(v, axis) {
        return v.toFixed(axis.tickDecimals);
    }

    function degreeFormatter(v, axis) {
        return v.toFixed(axis.tickDecimals) + "°C";
    }

    function xwhFormatter(val, axis) {
        if (val > 1000000)
            return (val / 1000000).toFixed(axis.tickDecimals) + " MWh";
        else if (val > 1000)
            return (val / 1000).toFixed(axis.tickDecimals) + " kWh";
        else
            return val.toFixed(axis.tickDecimals) + " Wh";
    }
    function xwFormatter(val, axis) {
        if (val > 1000000)
            return (val / 1000000).toFixed(axis.tickDecimals) + " MW";
        else if (val > 1000)
            return (val / 1000).toFixed(axis.tickDecimals) + " kW";
        else
            return val.toFixed(axis.tickDecimals) + " W";
    }

    function legendformater(label, series) {

        //wenn keine Daten, dann ausblenden ->  (return null)
        if (series.data == null || typeof series.data == "undefined" || typeof series.data[0] == "undefined") {

            console.log('legendformater no label because no data ');
            return null;
        }
        else {
            console.log('legendformater label ' + label);
            return label;
        }
    }

    function GridMarkings(axes) {

        var markings = [];
        var minDate = new Date(axes.xaxis.min);

        const dayDiff = (axes.xaxis.max - axes.xaxis.min) / 1000 / 60 / 60 / 24;
        console.log('GridMarkings: DayDiff ' + dayDiff + ' (' + axes.xaxis.max + ' ' + axes.xaxis.min + ')');

        var i = minDate.getTime();

        //if we only few hours then we need markings per hour otherwise per day
        if (dayDiff > 2) {
            do {
                markings.push({ xaxis: { from: i, to: i + 24 * 60 * 60 * 1000 }, color: MarkingColor });
                i += 2 * 24 * 60 * 60 * 1000;
            } while (i < axes.xaxis.max);

        }
        else {
            do {
                markings.push({ xaxis: { from: i, to: i + 60 * 60 * 1000 }, color: MarkingColor });
                i += 2 * 60 * 60 * 1000;
            } while (i < axes.xaxis.max);
        }
        return markings;

    }

    function CalcTicks4X(axis) {

        var ticks = [];

        var minDate = new Date(axis.min);

        const dayDiff = (axis.max - axis.min) / 1000 / 60 / 60 / 24;

        console.log('CalcTicks4X: DayDiff ' + dayDiff + ' (' + axis.max + ' ' + axis.min + ')');

        //if we only few hours then we need markings per hour otherwise per day
        if (dayDiff > 2) {
            minDate.setHours(12);
            minDate.setMinutes(0);
            var i = minDate.getTime();
            do {
                ticks.push([i]);
                i += 24 * 60 * 60 * 1000;
            } while (i < axis.max);
        }
        else {
            minDate.setHours(0);
            minDate.setMinutes(0);
            var i = minDate.getTime();
            do {
                ticks.push([i]);
                i += 6 * 60 * 60 * 1000;
            } while (i < axis.max);
        }
        return ticks;
    }










                function update() {

                    console.log("ShowChart ebus  (" + widgetID + ")");

                    var $div = $('#' + widgetID);
                    // if nothing found => wait
                    if (!$div.length) {
                        return setTimeout(function () {
                            console.log("need to wait... (" + widgetID + ")");
                            update();
                        }, 1000);
                    }

                    console.log("ShowChart ebus begin (" + widgetID + ")");

                    if (!data || !data.ebusinstance) {
                        console.log("keine instanz  (" + widgetID + ")");
                        $div.html("<br> <center> <font color='red'> no instance for ebus specified </font> </center></br>");
                    }

                    else {

                        SetMarkingColor(data.markingcolor);

                        var dateMin = -1;
                        var dateMax = -1;

                        //parse data
                        var oid_historydate = data.oid_historydate;
                        var oid_historygraph1 = data.oid_historygraph1;
                        var oid_historygraph2 = data.oid_historygraph2;
                        var oid_historygraph3 = data.oid_historygraph3;
                        var oid_historygraph4 = data.oid_historygraph4;
                        try {
                            var data_date = JSON.parse(vis.states[oid_historydate + '.val']);
                            var data_value1 = null;
                            if (oid_historygraph1 != "") {
                                data_value1 = JSON.parse(vis.states[oid_historygraph1 + '.val']);
                            }
                        } catch (e) {
                            console.warn('parse error [' + e + ']');
                            $div.html("<br> <center> <font color='red'>exception in parse data graph1 </font> </center></br>");
                            return;
                        }
                        try {
                            data_value2 = null;
                            if (oid_historygraph2 != "") {
                                var data_value2 = JSON.parse(vis.states[oid_historygraph2 + '.val']);
                            }
                        } catch (e) {
                            console.warn('parse error [' + e + ']');
                            $div.html("<br> <center> <font color='red'>exception in parse data graph2 </font> </center></br>");
                            return;
                        }
                        try {
                            data_value3 = null;
                            if (oid_historygraph3 != "") {
                                var data_value3 = JSON.parse(vis.states[oid_historygraph3 + '.val']);
                            }
                        } catch (e) {
                            console.warn('parse error [' + e + ']');
                            $div.html("<br> <center> <font color='red'>exception in parse data graph3 </font> </center></br>");
                            return;
                        }
                        try {
                            data_value4 = null;
                            if (oid_historygraph4 != "") {
                                var data_value4 = JSON.parse(vis.states[oid_historygraph4 + '.val']);
                            }
                        } catch (e) {
                            console.warn('parse error [' + e + ']');
                            $div.html("<br> <center> <font color='red'>exception in parse data graph4 </font> </center></br>");
                            return;
                        }

                        if (data_date === null || typeof data_date == "undefined" || data_date.length < 1) {
                            $div.html("<br> <center> <font color='red'>no data available yet for ebus </font> </center></br>");
                            return;
                        }

                        var values_graph1 = [];
                        var maxY_graph = [-99, -99, -99, -99];
                        var minY_graph = [999999, 999999, 999999, 999999];

                        var values_graph2 = [];


                        var values_graph3 = [];


                        var values_graph4 = [];

                        //since all datpoints should have the same length we use date datapoint as master
                        for (var i = 0; i < data_date.length; i++) {
                            try {
                                var oValDate = data_date[i];

                                var sDate = oValDate[0]["date"];
                                var sTime = oValDate[0]["time"];

                                var DateArray = sDate.split(".");
                                var TimeArray = sTime.split(":");
                                var hour = TimeArray[0];
                                var minute = TimeArray[1];
                                var day = DateArray[0];
                                var month = DateArray[1];
                                var year = DateArray[2];

                                var oDate = new Date();
                                oDate.setHours(hour);
                                oDate.setMinutes(minute);
                                oDate.setDate(day);
                                oDate.setMonth(month - 1);
                                oDate.setYear(year);

                                var date = oDate.getTime();

                                if (dateMin === -1) {
                                    dateMin = date;
                                }
                                dateMax = date;

                                var oValGraph1 = null;
                                if (data_value1 != null) {
                                    oValGraph1 = data_value1[i];
                                }
                                var oValGraph2 = null;
                                if (data_value2 != null) {
                                    var oValGraph2 = data_value2[i];
                                }
                                var oValGraph3 = null;
                                if (data_value3 != null) {
                                    var oValGraph3 = data_value3[i];
                                }
                                var oValGraph4 = null;
                                if (data_value4 != null) {
                                    var oValGraph4 = data_value4[i];
                                }
                                var sVal = oValGraph1;
                                if (sVal != null && typeof sVal != "undefined") {
                                    var names = Object.keys(sVal[0]);
                                    var sValGraph1 = sVal[0][names[0]];
                                    //console.log("graph1 " + sDate + " " + sTime + ": " + sValGraph1);
                                    console.log("graph1 " + oDate.toISOString() + " " + sValGraph1);
                                    values_graph1.push([oDate, sValGraph1]);

                                    if (sValGraph1 > maxY_graph[0]) maxY_graph[0] = sValGraph1;
                                    if (sValGraph1 < minY_graph[0]) minY_graph[0] = sValGraph1;

                                    if (vis.editMode) {
                                        if (vis.views[view].widgets[widgetID].data.graph1Name == "") {
                                            vis.views[view].widgets[widgetID].data.graph1Name = names[0];
                                            vis.widgets[widgetID].data.graph1Name = names[0];
                                        }
                                    }

                                }

                                sVal = oValGraph2;
                                if (sVal != null && typeof sVal != "undefined") {
                                    var names = Object.keys(sVal[0]);
                                    var sValGraph2 = sVal[0][names[0]];
                                    //console.log("graph2 " + sDate + " " + sTime + ": " + sValGraph2);
                                    console.log("graph2 " + oDate.toISOString() + " " + sValGraph2);
                                    values_graph2.push([oDate, sValGraph2]);

                                    if (sValGraph2 > maxY_graph[1]) maxY_graph[1] = sValGraph2;
                                    if (sValGraph2 < minY_graph[1]) minY_graph[1] = sValGraph2;

                                    if (vis.editMode) {
                                        if (vis.views[view].widgets[widgetID].data.graph2Name == "") {
                                            vis.views[view].widgets[widgetID].data.graph2Name = names[0];
                                            vis.widgets[widgetID].data.graph2Name = names[0];
                                        }
                                    }
                                }

                                sVal = oValGraph3;
                                if (sVal != null && typeof sVal != "undefined") {
                                    var names = Object.keys(sVal[0]);
                                    var sValGraph3 = sVal[0][names[0]];
                                    //console.log("graph3 " + sDate + " " + sTime + ": " + sValGraph3);
                                    console.log("graph3 " + oDate.toISOString() + " " + sValGraph3);
                                    values_graph3.push([oDate, sValGraph3]);

                                    if (sValGraph3 > maxY_graph[2]) maxY_graph[2] = sValGraph3;
                                    if (sValGraph3 < minY_graph[2]) minY_graph[2] = sValGraph3;

                                    if (vis.editMode) {
                                        if (vis.views[view].widgets[widgetID].data.graph3Name == "") {
                                            vis.views[view].widgets[widgetID].data.graph3Name = names[0];
                                            vis.widgets[widgetID].data.graph3Name = names[0];
                                        }
                                    }
                                }

                                sVal = oValGraph4;
                                if (sVal != null && typeof sVal != "undefined") {
                                    var names = Object.keys(sVal[0]);
                                    var sValGraph4 = sVal[0][names[0]];
                                    //console.log("graph4 " + sDate + " " + sTime + ": " + sValGraph4);
                                    console.log("graph4 " + oDate.toISOString() + " " + sValGraph4);
                                    values_graph4.push([oDate, sValGraph4]);

                                    if (sValGraph4 > maxY_graph[3]) maxY_graph[3] = sValGraph4;
                                    if (sValGraph4 < minY_graph[3]) minY_graph[3] = sValGraph4;


                                    if (vis.editMode) {
                                        if (vis.views[view].widgets[widgetID].data.graph4Name == "") {
                                            vis.views[view].widgets[widgetID].data.graph4Name = names[0];
                                            vis.widgets[widgetID].data.graph4Name = names[0];
                                        }
                                    }
                                }

                            }
                            catch (e) {
                                console.warn('parse error [' + e + ']');
                                $div.html("<br> <center> <font color='red'>data parse error </font> </center></br>");
                                return;
                            }
                        }


                        for (var n = 0; n < 4; n++) {

                            console.log("****** before Graph" + n + " max " + maxY_graph[n] + " min " + minY_graph[n]);

                            var nTemp = parseFloat(maxY_graph[n]);
                            //console.log(nTemp);
                            nTemp = nTemp + 1;
                            //console.log(nTemp);
                            nTemp = nTemp / 10;
                            //console.log(nTemp);
                            maxY_graph[n] = Math.ceil(nTemp) * 10;
                            if (minY_graph[n] >= 0 && minY_graph[n] < 1000) { //only for temperature and pressure values
                                minY_graph[n] = 0;
                            }
                            else if (minY_graph[n] < 0) {
                                var temp1 = Math.abs(minY_graph[n]);

                                minY_graph[n] = Math.ceil((temp1 + 1) / 10) * 10;
                                minY_graph[n] = -1.0 * minY_graph[n];
                            }
                            else {
                                nTemp = parseFloat(minY_graph[n]);
                                //console.log(nTemp);
                                nTemp = nTemp + 1;
                                //console.log(nTemp);
                                nTemp = nTemp / 10;
                                //console.log(nTemp);
                                minY_graph[n] = Math.ceil(nTemp) * 10;
                            }
                            console.log("****** after Graph" + n + "max " + maxY_graph[n] + " min " + minY_graph[n]);
                        }

                        var barwidth = 1000 * 60 * 5; //5 Minuten

                        console.log("barwidth = " + barwidth); // in ms

                        var Graph1Formatter = noneFormatter;
                        switch (data.graph1YAxisFomat) {
                            case "kWh":
                                Graph1Formatter = xwhFormatter;
                                console.log("kWh format");
                                break;
                            case "kW":
                                Graph1Formatter = xwFormatter;
                                console.log("kW format");
                                break;
                            case "degree":
                                Graph1Formatter = degreeFormatter;
                                console.log("degree format");
                                break;
                            default:
                                console.log("unknown format: " + data.graph1YAxisFomat);
                                break;

                        }

                        var Graph2Formatter = noneFormatter;
                        switch (data.graph2YAxisFomat) {
                            case "kWh":
                                Graph2Formatter = xwhFormatter;
                                console.log("kWh format");
                                break;
                            case "kW":
                                Graph2Formatter = xwFormatter;
                                console.log("kW format");
                                break;
                            case "degree":
                                Graph2Formatter = degreeFormatter;
                                console.log("degree format");
                                break;
                            default:
                                console.log("unknown format " + data.graph2YAxisFomat);
                                break;

                        }

                        var Graph3Formatter = noneFormatter;
                        switch (data.graph3YAxisFomat) {
                            case "kWh":
                                Graph3Formatter = xwhFormatter;
                                console.log("kWh format");
                                break;
                            case "kW":
                                Graph3Formatter = xwFormatter;
                                console.log("kW format");
                                break;

                            case "degree":
                                Graph3Formatter = degreeFormatter;
                                console.log("degree format");
                                break;
                            default:
                                console.log("unknown format " + data.graph3YAxisFomat);
                                break;

                        }

                        var Graph4Formatter = noneFormatter;
                        switch (data.graph4YAxisFomat) {
                            case "kWh":
                                Graph4Formatter = xwhFormatter;
                                console.log("kWh format");
                                break;
                            case "kW":
                                Graph4Formatter = xwFormatter;
                                console.log("kW format");
                                break;
                            case "degree":
                                Graph4Formatter = degreeFormatter;
                                console.log("degree format");
                                break;
                            default:
                                console.log("unknown format " + data.graph4YAxisFomat);
                                break;

                        }


                        $.plot($div,
                            [
                                {
                                    data: data.graph1visible ? values_graph1 : {},
                                    color: data.graph1color,
                                    label: data.graph1Name,
                                    xaxis: 1,
                                    yaxis: 1,
                                    lines: { show: data.graph1charttype == "charttypeline" },
                                    bars:
                                    {
                                        show: data.graph1charttype == "charttypebar",
                                        barWidth: [barwidth, true],
                                        align: "left", //"center",
                                        horizontal: false
                                    }
                                },
                                {
                                    data: data.graph2visible ? values_graph2 : {},
                                    color: data.graph2color,
                                    label: data.graph2Name,
                                    xaxis: 1,
                                    yaxis: 2,
                                    lines: { show: data.graph2charttype == "charttypeline" },
                                    bars:
                                    {
                                        show: data.graph2charttype == "charttypebar",
                                        barWidth: [barwidth, true],
                                        align: "left", //"center",
                                        horizontal: false
                                    }
                                },
                                {
                                    data: data.graph3visible ? values_graph3 : {},
                                    color: data.graph3color,
                                    label: data.graph3Name,
                                    xaxis: 1,
                                    yaxis: 3,
                                    lines: { show: data.graph3charttype == "charttypeline" },
                                    bars:
                                    {
                                        show: data.graph3charttype == "charttypebar",
                                        barWidth: [barwidth, true],
                                        align: "left", //"center",
                                        horizontal: false
                                    }
                                },
                                {
                                    data: data.graph4visible ? values_graph4 : {},
                                    color: data.graph4color,
                                    label: data.graph4Name,
                                    xaxis: 1,
                                    yaxis: 4,
                                    lines: { show: data.graph4charttype == "charttypeline" },
                                    bars:
                                    {
                                        show: data.graph4charttype == "charttypebar",
                                        barWidth: [barwidth, true],
                                        align: "left", //"center",
                                        horizontal: false
                                    }
                                }
                            ],
                            {

                                xaxes:
                                    [
                                        {
                                            axisLabelUseCanvas: true,
                                            axisLabelColour: 'orange',

                                            show: data.withxaxix,
                                            mode: "time",
                                            timeBase: "milliseconds",
                                            tickLength: 5,

                                            min: dateMin,
                                            max: dateMax,
                                            //ticks: data.ticksonxaxix > 0 ? parseInt(data.ticksonxaxix, 10) : 5,
                                            ticks: CalcTicks4X,
                                            autoScale: "none",
                                            timeformat: data.xDateFormat,
                                            monthNames: ["Jan", "Feb", "Mar", "Apr", "Mai", "Jun", "Jul", "Aug", "Sep", "Okt", "Nov", "Dez"],
                                            color: data.tickscolor,
                                            tickColor: data.tickscolor,
                                            font: {
                                                size: data.LabelFontSize,
                                                lineHeight: 13,
                                                style: "normal", //"italic",
                                                weight: "bold",
                                                family: data.LabelFontFamily,
                                                variant: "small-caps",
                                                color: data.axislabelcolor,
                                            },
                                            timezone: "browser"
                                        }
                                    ],
                                yaxes:
                                    [
                                        {
                                            axisLabelUseCanvas: true,
                                            axisLabelColour: 'orange',

                                            show: data.graph1visible && data.graph1withyaxix,
                                            max: maxY_graph[0],
                                            min: minY_graph[0],
                                            autoScale: "none", // Available modes: "none", "loose", "exact"

                                            showTickLabels: "major",
                                            alignTicksWithAxis: null, //1,

                                            position: 'left',
                                            //ticks: 3,
                                            tickLength: parseFloat(data.graph1tickLength),            //20, // size in pixels of major tick marks
                                            showMinorTicks: data.graph1showMinorTicks,    //false, // true = show minor tick marks, false = hide minor tick marks
                                            showTicks: data.graph1showTicks,              //true, // true = show tick marks, false = hide all tick marks
                                            tickDecimals: data.graph1tickDecimals,        //1, // no. of decimals, null means auto
                                            tickSize: data.graph1tickSize,                //3, // number or [number, "unit"]
                                            minTickSize: data.graph1minTickSize,          //1, // number or [number, "unit"]

                                            color: data.tickscolor,

                                            tickColor: data.graph1coloraxis,

                                            labelWidth: parseFloat(data.graph1labelwidth),

                                            font: {
                                                size: data.LabelFontSize,
                                                lineHeight: 13,
                                                style: "normal", //"italic",
                                                weight: "bold",
                                                family: data.LabelFontFamily,
                                                variant: "small-caps",
                                                color: data.graph1color,
                                            },
                                            tickFormatter: Graph1Formatter
                                        },
                                        {
                                            axisLabelUseCanvas: true,
                                            axisLabelColour: 'orange',

                                            show: data.graph2visible && data.graph2withyaxix,
                                            max: maxY_graph[1],
                                            min: minY_graph[1],
                                            autoScale: "none", // Available modes: "none", "loose", "exact"
                                            showTickLabels: "major",
                                            alignTicksWithAxis: null, //1,

                                            position: 'left',
                                            //ticks: 3,

                                            tickLength: parseFloat(data.graph2tickLength),            //20, // size in pixels of major tick marks
                                            showMinorTicks: data.graph2showMinorTicks,    //false, // true = show minor tick marks, false = hide minor tick marks
                                            showTicks: data.graph2showTicks,              //true, // true = show tick marks, false = hide all tick marks
                                            tickDecimals: data.graph2tickDecimals,        //1, // no. of decimals, null means auto
                                            tickSize: data.graph2tickSize,                //3, // number or [number, "unit"]
                                            minTickSize: data.graph2minTickSize,          //1, // number or [number, "unit"]

                                            color: data.tickscolor,
                                            tickColor: data.graph2coloraxis,

                                            labelWidth: parseFloat(data.graph2labelwidth),
                                            font: {
                                                size: data.LabelFontSize,
                                                lineHeight: 13,
                                                style: "normal", //"italic",
                                                weight: "bold",
                                                family: data.LabelFontFamily,
                                                variant: "small-caps",
                                                color: data.graph2color,
                                            },
                                            tickFormatter: Graph2Formatter
                                        },
                                        {
                                            axisLabelUseCanvas: true,
                                            axisLabelColour: 'orange',

                                            show: data.graph3visible && data.graph3withyaxix,
                                            max: maxY_graph[2],
                                            min: minY_graph[2],
                                            autoScale: "none", // Available modes: "none", "loose", "exact"
                                            showTickLabels: "major",
                                            alignTicksWithAxis: null, //1,

                                            position: 'left',
                                            //ticks: 3,

                                            tickLength: parseFloat(data.graph3tickLength),            //20, // size in pixels of major tick marks
                                            showMinorTicks: data.graph3showMinorTicks,    //false, // true = show minor tick marks, false = hide minor tick marks
                                            showTicks: data.graph3showTicks,              //true, // true = show tick marks, false = hide all tick marks
                                            tickDecimals: data.graph3tickDecimals,        //1, // no. of decimals, null means auto
                                            tickSize: data.graph3tickSize,                //3, // number or [number, "unit"]
                                            minTickSize: data.graph3minTickSize,          //1, // number or [number, "unit"]

                                            color: data.tickscolor,
                                            tickColor: data.graph3coloraxis,

                                            labelWidth: parseFloat(data.graph3labelwidth),
                                            font: {
                                                size: data.LabelFontSize,
                                                lineHeight: 13,
                                                style: "normal", //"italic",
                                                weight: "bold",
                                                family: data.LabelFontFamily,
                                                variant: "small-caps",
                                                color: data.graph3color,
                                            },
                                            tickFormatter: Graph3Formatter
                                        },
                                        {
                                            axisLabelUseCanvas: true,
                                            axisLabelColour: 'orange',

                                            show: data.graph4visible && data.graph4withyaxix,
                                            max: maxY_graph[3],
                                            min: minY_graph[3],
                                            autoScale: "none", // Available modes: "none", "loose", "exact"
                                            showTickLabels: "major",
                                            alignTicksWithAxis: null, //1,

                                            position: 'left',
                                            //ticks: 3,

                                            tickLength: parseFloat(data.graph4tickLength),            //20, // size in pixels of major tick marks
                                            showMinorTicks: data.graph4showMinorTicks,    //false, // true = show minor tick marks, false = hide minor tick marks
                                            showTicks: data.graph4showTicks,              //true, // true = show tick marks, false = hide all tick marks
                                            tickDecimals: data.graph4tickDecimals,        //1, // no. of decimals, null means auto
                                            tickSize: data.graph4tickSize,                //3, // number or [number, "unit"]
                                            minTickSize: data.graph4minTickSize,          //1, // number or [number, "unit"]

                                            color: data.tickscolor,
                                            tickColor: data.graph4coloraxis,

                                            labelWidth: parseFloat(data.graph4labelwidth),
                                            font: {
                                                size: data.LabelFontSize,
                                                lineHeight: 13,
                                                style: "normal", //"italic",
                                                weight: "bold",
                                                family: data.LabelFontFamily,
                                                variant: "small-caps",
                                                color: data.graph4color,
                                            },
                                            tickFormatter: Graph4Formatter
                                        }
                                    ],
                                grid:
                                {
                                    markings: data.withmarking ? GridMarkings : null,

                                    // backgroundColor: data.nobgcolor ? null : { colors: ["#fff", "#eee"] },
                                    backgroundColor: data.nobgcolor ? null : data.bgcolor,
                                    borderWidth:  parseFloat(data.borderWidth), //data.withborder,
                                    borderColor: data.bordercolor,
                                    margin: 1,
                                    /*
                                    borderWidth: {
                                        top: data.withborder ? 1 : 0,
                                        right: data.withborder ? 1 : 0,
                                        bottom: data.withborder ? 2 : 0,
                                        left: data.withborder ? 2 : 0
                                    },*/

                                },
                                legend: {
                                    show: data.withlegend,
                                    labelFormatter: legendformater,
                                    //labelBoxBorderColor: color,
                                    //noColumns: number,
                                    position: data.legendposition,
                                    //margin: number of pixels or [x margin, y margin]
                                    backgroundColor: null,
                                    backgroundOpacity: 0,
                                    container: null,
                                    sorted: false
                                }
                            }
                        );
                    }
                };

                if (data.ebusinstance) {

                    //bind to oid to be informed about updates
                    var oid_historydate = data.oid_historydate;
                    console.log("bind " + oid_historydate);
                    vis.states.bind(oid_historydate + '.val', function () {
                        vis.binds.ebus.history.update($div, oView);
                    });

                    var oid_historygraph1 = data.oid_historygraph1;
                    console.log("bind " + oid_historygraph1);
                    vis.states.bind(oid_historygraph1 + '.val', function () {
                        vis.binds.ebus.history.update($div, oView);
                    });
                    var oid_historygraph2 = data.oid_historygraph2;
                    console.log("bind " + oid_historygraph2);
                    vis.states.bind(oid_historygraph2 + '.val', function () {
                        vis.binds.ebus.history.update($div, oView);
                    });
                    var oid_historygraph3 = data.oid_historygraph3;
                    console.log("bind " + oid_historygraph3);
                    vis.states.bind(oid_historygraph3 + '.val', function () {
                        vis.binds.ebus.history.update($div, oView);
                    });
                    var oid_historygraph4 = data.oid_historygraph4;
                    console.log("bind " + oid_historygraph4);
                    vis.states.bind(oid_historygraph4 + '.val', function () {
                        vis.binds.ebus.history.update($div, oView);
                    });
                    // update every x seconds
                    if (!vis.editMode) {
                        $div.data('timer', setInterval(function () {
                            vis.binds.ebus.history.update($div, oView);
                        }, parseInt(vis.binds.ebus.setup.intervals[data.time_interval] / (parseInt(data.points, 10) || 10), 10)));
                    }

                }
                else {
                    console.log("instance not set ");
                }
                update();
                if (vis.editMode) {
                    console.log("flot version " + $.plot.version + " for ebus");
                }
            }
        },
    };

    if (vis.editMode) {
        vis.binds.ebus.onInstanceChanged = function (widgetID, view, newId, fields) {
            console.log('---------: ' + widgetID + ' - ' + view + ' - ' + newId + ' - ' + fields);

            var changed = [];
            //delete all
            vis.views[view].widgets[widgetID].data.oid_historydate = "";
            vis.views[view].widgets[widgetID].data.oid_historygraph1 = "";
            vis.views[view].widgets[widgetID].data.oid_historygraph2 = "";
            vis.views[view].widgets[widgetID].data.oid_historygraph3 = "";
            vis.views[view].widgets[widgetID].data.oid_historygraph4 = "";
            //then copy new values
            if (newId.indexOf("ebus") > -1) {

                //ebus.0.data.history
                console.log('calc new oids');
                vis.views[view].widgets[widgetID].data.oid_historydate = newId + ".history.date";
                vis.widgets[widgetID].data.oid_historydate = newId + ".history.date";

                vis.views[view].widgets[widgetID].data.oid_historygraph1 = newId + ".history.value1";
                vis.widgets[widgetID].data.oid_historygraph1 = newId + ".history.value1";

                vis.views[view].widgets[widgetID].data.oid_historygraph2 = newId + ".history.value2";
                vis.widgets[widgetID].data.oid_historygraph2 = newId + ".history.value2";

                vis.views[view].widgets[widgetID].data.oid_historygraph3 = newId + ".history.value3";
                vis.widgets[widgetID].data.oid_historygraph3 = newId + ".history.value3";

                vis.views[view].widgets[widgetID].data.oid_historygraph4 = newId + ".history.value4";
                vis.widgets[widgetID].data.oid_historygraph4 = newId + ".history.value4";
            }
            return changed;
        }
    }

    vis.binds.ebus.showVersion();

</script>

<script id="tplEbusShowInstance"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/ebus/img/Prev_tplebus.png"></img>'
        data-vis-set="ebus"
        data-vis-type="ebus"
        data-vis-name="ebus"
        data-vis-update-style="true"
        data-vis-attrs="ebusinstance/ebus/onInstanceChanged;"
        data-vis-attrs0="time_interval[30 minutes]/select,1 second,10 seconds,30 seconds,1 minute,2 minutes,5 minutes,10 minutes,30 minutes,1 hour,2 hours,4 hours,8 hours,12 hours,24 hours;withxaxix[true]/checkbox;axislabelcolor[#ffffff]/color;tickscolor[#ffffff]/color;LabelFontSize[8];LabelFontFamily[Arial]/fontname;withmarking[true]/checkbox;markingcolor[#eaebe5]/color;xDateFormat[%H:%M];borderWidth[1];bordercolor[#000000]/color;nobgcolor[true]/checkbox;bgcolor[#FFFFFF]/color;withlegend[false]/checkbox;legendposition[ne]/select,ne,nw,se,sw;"
        data-vis-attrs1="group.graph1;graph1visible[true]/checkbox;oid_historygraph1/id;graph1charttype[charttypeline]/select,charttypeline,charttypebar;graph1Name;graph1color[#f1f113]/color;graph1coloraxis[#1d0ed8]/color;graph1colorticklabel[#1d0ed8]/color;graph1withyaxix[true]/checkbox;graph1YAxisFomat[none]/select,none,kWh,kW,degree;graph1tickLength[5];graph1showMinorTicks[true]/checkbox;graph1showTicks[true]/checkbox;graph1tickDecimals[1];graph1tickSize[3];graph1minTickSize[2];graph1labelwidth[30];"
        data-vis-attrs2="group.graph2;graph2visible[true]/checkbox;oid_historygraph2/id;graph2charttype[charttypeline]/select,charttypeline,charttypebar;graph2Name;graph2color[#f1f113]/color;graph2coloraxis[#1d0ed8]/color;graph2colorticklabel[#1d0ed8]/color;graph2withyaxix[true]/checkbox;graph2YAxisFomat[none]/select,none,kWh,kW,degree;graph2tickLength[5];graph2showMinorTicks[true]/checkbox;graph2showTicks[true]/checkbox;graph2tickDecimals[1];graph2tickSize[3];graph2minTickSize[2];graph2labelwidth[30];"
        data-vis-attrs3="group.graph3;graph3visible[true]/checkbox;oid_historygraph3/id;graph3charttype[charttypeline]/select,charttypeline,charttypebar;graph3Name;graph3color[#f1f113]/color;graph3coloraxis[#1d0ed8]/color;graph3colorticklabel[#1d0ed8]/color;graph3withyaxix[true]/checkbox;graph3YAxisFomat[none]/select,none,kWh,kW,degree;graph3tickLength[5];graph3showMinorTicks[true]/checkbox;graph3showTicks[true]/checkbox;graph3tickDecimals[1];graph3tickSize[3];graph3minTickSize[2];graph3labelwidth[30];"
        data-vis-attrs4="group.graph4;graph4visible[true]/checkbox;oid_historygraph4/id;graph4charttype[charttypeline]/select,charttypeline,charttypebar;graph4Name;graph4color[#f1f113]/color;graph4coloraxis[#1d0ed8]/color;graph4colorticklabel[#1d0ed8]/color;graph4withyaxix[true]/checkbox;graph4YAxisFomat[none]/select,none,kWh,kW,degree;graph4tickLength[5];graph4showMinorTicks[true]/checkbox;graph4showTicks[true]/checkbox;graph4tickDecimals[1];graph4tickSize[3];graph4minTickSize[2];graph4labelwidth[30];"
        data-vis-attrs5="group.oids;oid_historydate/id;">

    <div class="vis-widget <%== this.data.attr('class') %>" style="width:210px; height:170px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-ebus-widget-body"
             <% vis.binds.ebus.history.init(this.data.wid, this.view, this.data, this.style) %>>
        </div>
    </div>

</script>



<!-- --------------ebus.html--- END -->
<!-- --------------echarts.html--- START -->
<!--
    ioBroker.echarts high quality Widget-Set

    version: "0.0.1"

    Copyright 2019-2020 bluefox <dogafox@gmail.com>

-->
<script type="text/javascript" >
    if (vis.editMode) {
        $.extend(true, systemDictionary, {
            "echart_oid": {
                "en": "EChart ID",
                "de": "EChart ID",
                "ru": "EChart ID",
                "pt": "EChart ID",
                "nl": "EChart ID",
                "fr": "ID de graphique",
                "it": "ID EChart",
                "es": "EChart ID",
                "pl": "Identyfikator EChart",
                "zh-cn": "图表ID"
            },
            "noChartBackground": {
                "en": "No background",
                "de": "Kein Hintergrund",
                "ru": "Без фона",
                "pt": "Sem fundo",
                "nl": "Geen achtergrond",
                "fr": "Pas de fond",
                "it": "Nessuno sfondo",
                "es": "Sin antecedentes",
                "pl": "Bez tła",
                "zh-cn": "没有背景"
            },
        });
    }
</script>

<script id="tplEchartsChart"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="echarts"
        data-vis-name="Chart"
        data-vis-type="chart"
        data-vis-prev='<img src="widgets/echarts/img/Prev_tplEchartsChart.png"/>'
        data-vis-attrs="echart_oid[nothing_selected]/id/filterTypeChart;noChartBackground/checkbox;"
        data-vis-filter="chart">
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 64px; height: 64px; border-radius: 64px" id="<%= this.data.attr('wid') %>">
         <iframe style="width: 100%; height: 100%; border: 0" src="../echarts/index.html?preset=<%== this.data.attr('echart_oid') %>&noBG=<%== this.data.attr('noChartBackground') %>"></iframe>
    </div>
</script>
<!-- --------------echarts.html--- END -->
<!-- --------------eventlist.html--- START -->
<!--
    ioBroker.vis eventlist Widget-Set

    version: "0.1.3"

    Copyright 2020 ioBroker dogafox@gmail.com
-->

<link rel="stylesheet" href="widgets/eventlist/css/style.css" />

<script type="text/javascript">
    'use strict';

    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {
            // Bars
            "eventlistInstance":              {
                "en": "Instance",
                "de": "Instanz",
                "ru": "Инстанция",
                "pt": "Instância",
                "nl": "Instance",
                "fr": "Instance",
                "it": "Instance",
                "es": "Instance",
                "pl": "Instancja",
                "zh-cn": "实例"
            },
            "showEventTime": {
                "en": "Time",
                "de": "Zeit",
                "ru": "Время",
                "pt": "Tempo",
                "nl": "Tijd",
                "fr": "Temps",
                "it": "Tempo",
                "es": "Hora",
                "pl": "Czas",
                "zh-cn": "时间"
            },
            "showEventValue": {
                "en": "Value",
                "de": "Wert",
                "ru": "Значение",
                "pt": "Valor",
                "nl": "Waarde",
                "fr": "Valeur",
                "it": "Valore",
                "es": "Valor",
                "pl": "Wartość",
                "zh-cn": "值"
            },
            "showEventDuration": {
                "en": "Duration",
                "de": "Dauer",
                "ru": "Продолжительность",
                "pt": "Duração",
                "nl": "Looptijd",
                "fr": "Durée",
                "it": "Durata",
                "es": "Duración",
                "pl": "Trwanie",
                "zh-cn": "持续时间"
            },
            "textEventEvent": {
                "en": "Event",
                "de": "Ereignis",
                "ru": "Мероприятие",
                "pt": "Evento",
                "nl": "Evenement",
                "fr": "un événement",
                "it": "Evento",
                "es": "Evento",
                "pl": "Zdarzenie",
                "zh-cn": "事件"
            },
            "textEventTime": {
                "en": "Time",
                "de": "Zeit",
                "ru": "Время",
                "pt": "Tempo",
                "nl": "Tijd",
                "fr": "Temps",
                "it": "Tempo",
                "es": "Hora",
                "pl": "Czas",
                "zh-cn": "时间"
            },
            "textEventValue": {
                "en": "Value",
                "de": "Wert",
                "ru": "Значение",
                "pt": "Valor",
                "nl": "Waarde",
                "fr": "Valeur",
                "it": "Valore",
                "es": "Valor",
                "pl": "Wartość",
                "zh-cn": "值"
            },
            "textEventDuration": {
                "en": "Duration",
                "de": "Dauer",
                "ru": "Продолжительность",
                "pt": "Duração",
                "nl": "Looptijd",
                "fr": "Durée",
                "it": "Durata",
                "es": "Duración",
                "pl": "Trwanie",
                "zh-cn": "持续时间"
            },
            'group_headerTitle': {
                "en": "Header texts",
                "de": "Kopfzeilentexte",
                "ru": "Тексты заголовков",
                "pt": "Textos de cabeçalho",
                "nl": "Kopteksten",
                "fr": "Textes d'en-tête",
                "it": "Testi di intestazione",
                "es": "Textos de encabezado",
                "pl": "Teksty nagłówka",
                "zh-cn": "标题文字"
            },
            "widthEventEvent": {
                "en": "Event",
                "de": "Ereignis",
                "ru": "Мероприятие",
                "pt": "Evento",
                "nl": "Evenement",
                "fr": "un événement",
                "it": "Evento",
                "es": "Evento",
                "pl": "Zdarzenie",
                "zh-cn": "事件"
            },
            "widthEventTime": {
                "en": "Time",
                "de": "Zeit",
                "ru": "Время",
                "pt": "Tempo",
                "nl": "Tijd",
                "fr": "Temps",
                "it": "Tempo",
                "es": "Hora",
                "pl": "Czas",
                "zh-cn": "时间"
            },
            "widthEventValue": {
                "en": "Value",
                "de": "Wert",
                "ru": "Значение",
                "pt": "Valor",
                "nl": "Waarde",
                "fr": "Valeur",
                "it": "Valore",
                "es": "Valor",
                "pl": "Wartość",
                "zh-cn": "值"
            },
            "widthEventDuration": {
                "en": "Duration",
                "de": "Dauer",
                "ru": "Продолжительность",
                "pt": "Duração",
                "nl": "Looptijd",
                "fr": "Durée",
                "it": "Durata",
                "es": "Duración",
                "pl": "Trwanie",
                "zh-cn": "持续时间"
            },
            "group_headerWidths": {
                "en": "Columns widths",
                "de": "Spaltenbreiten",
                "ru": "Ширина столбцов",
                "pt": "Larguras das colunas",
                "nl": "Kolombreedtes",
                "fr": "Largeurs de colonnes",
                "it": "Larghezze delle colonne",
                "es": "Anchos de columnas",
                "pl": "Szerokość kolumn",
                "zh-cn": "列宽"
            },
            "eventListSampleEvent": {
                "en": "Temperature outside changed to",
                "de": "Außentemperatur auf geändert",
                "ru": "Температура снаружи изменилась на",
                "pt": "A temperatura externa mudou para",
                "nl": "Temperatuur buiten veranderd naar",
                "fr": "Température extérieure modifiée à",
                "it": "La temperatura esterna è cambiata a",
                "es": "La temperatura exterior cambió a",
                "pl": "Temperatura na zewnątrz zmieniona na",
                "zh-cn": "外界温度更改为"
            },
            "alignEventEvent": {
                "en": "Event",
                "de": "Ereignis",
                "ru": "Мероприятие",
                "pt": "Evento",
                "nl": "Evenement",
                "fr": "un événement",
                "it": "Evento",
                "es": "Evento",
                "pl": "Zdarzenie",
                "zh-cn": "事件"
            },
            "alignEventTime": {
                "en": "Time",
                "de": "Zeit",
                "ru": "Время",
                "pt": "Tempo",
                "nl": "Tijd",
                "fr": "Temps",
                "it": "Tempo",
                "es": "Hora",
                "pl": "Czas",
                "zh-cn": "时间"
            },
            "alignEventValue": {
                "en": "Value",
                "de": "Wert",
                "ru": "Значение",
                "pt": "Valor",
                "nl": "Waarde",
                "fr": "Valeur",
                "it": "Valore",
                "es": "Valor",
                "pl": "Wartość",
                "zh-cn": "值"
            },
            "alignEventDuration": {
                "en": "Duration",
                "de": "Dauer",
                "ru": "Продолжительность",
                "pt": "Duração",
                "nl": "Looptijd",
                "fr": "Durée",
                "it": "Durata",
                "es": "Duración",
                "pl": "Trwanie",
                "zh-cn": "持续时间"
            },
            "group_headerAligns": {
                "en": "Align columns",
                "de": "Spalten ausrichten",
                "ru": "Выровнять столбцы",
                "pt": "Alinhar colunas",
                "nl": "Lijn kolommen uit",
                "fr": "Aligner les colonnes",
                "it": "Allinea le colonne",
                "es": "Alinear columnas",
                "pl": "Wyrównaj kolumny",
                "zh-cn": "对齐列"
            },
            "showScroll": {
                "en": "Show scroll",
                "de": "Schriftrolle anzeigen",
                "ru": "Показать прокрутку",
                "pt": "Mostrar pergaminho",
                "nl": "Toon scroll",
                "fr": "Afficher le défilement",
                "it": "Mostra scorrimento",
                "es": "Mostrar desplazamiento",
                "pl": "Pokaż przewijanie",
                "zh-cn": "显示滚动"
            },
            "defaultStyle": {
                "en": "Default style",
                "de": "Standardstil",
                "ru": "Стиль по умолчанию",
                "pt": "Estilo padrão",
                "nl": "Standaard stijl",
                "fr": "Style par défaut",
                "it": "Stile predefinito",
                "es": "Estilo por Defecto",
                "pl": "Domyślny styl",
                "zh-cn": "默认样式"
            },
            "center": {
                "en": "center",
                "de": "Center",
                "ru": "по центру",
                "pt": "сentro",
                "nl": "centrum",
                "fr": "centre",
                "it": "centro",
                "es": "centrar",
                "pl": "środek",
                "zh-cn": "中央"
            },
            tooltip_defaultStyle: {
                "en": "You can overload following classes: event-table for table, event-table-header for header",
                "de": "Sie können folgende Klassen überladen: event-table für table, event-table-header für header",
                "ru": "Вы можете перегрузить следующие классы: event-table для таблицы, event-table-header для заголовка.",
                "pt": "Você pode sobrecarregar as seguintes classes: event-table para a tabela, event-table-header` para o cabeçalho",
                "nl": "U kunt de volgende klassen overbelasten: event-table voor tabel, event-table-header` voor header",
                "fr": "Vous pouvez surcharger les classes suivantes: event-table pour la table, event-table-header` pour l'en-tête",
                "it": "Puoi sovraccaricare le seguenti classi: event-table per table, event-table-header` per header",
                "es": "Puede sobrecargar las siguientes clases: event-table para la tabla, event-table-header` para el encabezado",
                "pl": "Możesz przeciążać następujące klasy: event-table dla tabeli, event-table-header` dla nagłówka",
                "zh-cn": "您可以重载以下类：表的“事件表”，标头的“事件表头”"
            }
        });
    }

    $.extend(true, systemDictionary, {
        "eventtableTime": {
            "en": "Time",
            "de": "Zeit",
            "ru": "Время",
            "pt": "Tempo",
            "nl": "Tijd",
            "fr": "Temps",
            "it": "Tempo",
            "es": "Hora",
            "pl": "Czas",
            "zh-cn": "时间"
        },
        "eventtableValue": {
            "en": "Value",
            "de": "Wert",
            "ru": "Значение",
            "pt": "Valor",
            "nl": "Waarde",
            "fr": "Valeur",
            "it": "Valore",
            "es": "Valor",
            "pl": "Wartość",
            "zh-cn": "值"
        },
        "eventtableEvent": {
            "en": "Event",
            "de": "Ereignis",
            "ru": "Мероприятие",
            "pt": "Evento",
            "nl": "Evenement",
            "fr": "un événement",
            "it": "Evento",
            "es": "Evento",
            "pl": "Zdarzenie",
            "zh-cn": "事件"
        },
        "eventtableDuration": {
            "en": "Duration",
            "de": "Dauer",
            "ru": "Продолжительность",
            "pt": "Duração",
            "nl": "Looptijd",
            "fr": "Durée",
            "it": "Durata",
            "es": "Duración",
            "pl": "Trwanie",
            "zh-cn": "持续时间"
        }
    });

    vis.binds.eventlist = {
        version: "0.1.3",
        showVersion: function () {
            if (vis.binds.eventlist.version) {
                console.log('Version eventlist: ' + vis.binds.eventlist.version);
                vis.binds.eventlist.version = null;
            }
        },
        renderHeader(el, wid, view, data) {
            var text = '<tr class="' + (data.defaultStyle ? 'event-table-header' : '') + '">';
            if (data.showEventTime || data.showEventTime === undefined) {
                text += '<th width="' + data.widthEventTime + '" style="text-align: ' + data.alignEventTime + '">' + (data.textEventTime === '_' || data.textEventTime === undefined ? _('eventtableTime') : data.textEventTime) + '</th>';
            }
            text += '<th width="' + data.widthEventEvent + '" style="text-align: ' + data.alignEventEvent + '">' + (data.textEventEvent === '_' || data.textEventEvent === undefined ? _('eventtableEvent') : data.textEventEvent) + '</th>';
            if (data.showEventValue || data.showEventValue === undefined) {
                text += '<th width="' + data.widthEventValue + '" style="text-align: ' + data.alignEventValue + '">' + (data.textEventValue === '_' || data.textEventValue === undefined ? _('eventtableValue') : data.textEventValue) + '</th>';
            }
            if (data.showEventDuration || data.showEventDuration === undefined) {
                text += '<th width="' + data.widthEventDuration + '" style="text-align: ' + data.alignEventDuration + '">' + (data.textEventDuration === '_' || data.textEventDuration === undefined ? _('eventtableDuration') : data.textEventDuration) + '</th>';
            }
            text += '</tr>\n';
            return text;
        },
        renderRow(el, wid, view, data, json, i) {
            var item = json[i];
            var style = [];
            if (item._style) {
                var attrs = Object.keys(item._style);
                for (var t = 0; t < attrs.length; t++) {
                    style.push(attrs[t] + ': ' + item._style[attrs[t]]);
                }
            }
            var line = '<tr style="' + style.join('; ') + '">';
            if (data.showEventTime) {
                line += '<td style="text-align: ' + data.alignEventTime + '">' + item.ts + '</td>';
            }
            line += '<td style="text-align: ' + data.alignEventEvent + '">' + item.event + '</td>';
            if (data.showEventValue) {
                line += '<td style="text-align: ' + data.alignEventValue + '">' + (item.val === undefined || item.val === null ? '' : item.val) + '</td>';
            }
            if (data.showEventDuration) {
                line += '<td style="text-align: ' + data.alignEventDuration + '">' + (item.duration === undefined || item.duration === null ? '' : item.duration) + '</td>';
            }
            line += '</tr>\n';
            return line;
        },
        state2json(state) {
            state = state || {};
            let table = state.val || [];

            if (typeof table !== 'object') {
                try {
                    table = JSON.parse(table);
                } catch (e) {
                    console.warn('Cannot parse event list: "' + table + '"');
                    table = [];
                }
            }

            table = table || [];

            return table;
        },
        renderTable(el, wid, view, data, style, json) {
            var table = '<table style="width: 100%;" class="' + (data.defaultStyle || data.defaultStyle === undefined ? 'event-table' : '') + '"><tbody style="width: 100%;">'
            table += vis.binds.eventlist.renderHeader(el, wid, view, data);
            for (var i = 0; i < json.length; i++) {
                if (!data.max_rows || i < data.max_rows) {
                    table += vis.binds.eventlist.renderRow(el, wid, view, data, json, i);
                } else {
                    break;
                }
            }

            table += '</tbody></table>\n';
            return table;
        },
        subscribes: [],
        init: function (el, wid, view, data, style) {
            var $div = $('#' + wid);
            if (!$div.length) {
                return setTimeout(function () {
                    vis.binds.eventlist.init(el, wid, view, data, style);
                }, 100);
            }
            data.max_rows = parseInt(data.max_rows, 10) || 0;
            data.widthEventTime     = data.widthEventTime     === parseFloat(data.widthEventTime).toString()     ? data.widthEventTime     + 'px' : data.widthEventTime || '';
            data.widthEventEvent    = data.widthEventEvent    === parseFloat(data.widthEventEvent).toString()    ? data.widthEventEvent    + 'px' : data.widthEventEvent || '';
            data.widthEventValue    = data.widthEventValue    === parseFloat(data.widthEventValue).toString()    ? data.widthEventValue    + 'px' : data.widthEventValue || '';
            data.widthEventDuration = data.widthEventDuration === parseFloat(data.widthEventDuration).toString() ? data.widthEventDuration + 'px' : data.widthEventDuration || '';
            data.showEventTime      = data.showEventTime      === undefined ? true : data.showEventTime;
            data.showEventValue     = data.showEventValue     === undefined ? true : data.showEventValue;
            data.showEventDuration  = data.showEventDuration  === undefined ? true : data.showEventDuration;

            if (data.showScroll) {
                $div.css('overflow-y', 'auto');
            }

            var jsonID = 'eventlist.' + (parseInt(data.eventlistInstance, 10) || 0) + '.eventJSONList';

            vis.conn.getStates(jsonID, (err, state) => {
                var json = vis.binds.eventlist.state2json(state[jsonID]);

                if (vis.editMode && !json.length) {
                    json.push({
                        ts: new Date().toLocaleTimeString(),
                        val: '5°C',
                        event: _('eventListSampleEvent'),
                        duration: '1h 2s'
                    });
                }

                var text = vis.binds.eventlist.renderTable(el, wid, view, data, style, json);
                $div.html(text);

                function onChange(wid, id, newVal) {
                    if (id === jsonID) {
                        var json = vis.binds.eventlist.state2json({val: newVal});
                        var text = vis.binds.eventlist.renderTable(el, wid, view, data, style, json);
                        $div.html(text);
                    }
                }

                if (vis.binds.eventlist.subscribes[jsonID]) {
                    vis.binds.eventlist.subscribes[jsonID]++;
                } else {
                    vis.binds.eventlist.subscribes[jsonID] = 1;
                    vis.conn.subscribe(jsonID);
                    console.log('Subscribe on ' + jsonID);
                }

                vis.registerOnChange(onChange, jsonID);

                $div.data('destroy', function () {
                    if (vis.binds.eventlist.subscribes[jsonID]) {
                        vis.binds.eventlist.subscribes[jsonID]--;
                        if (!vis.binds.eventlist.subscribes[jsonID]) {
                            console.log('Unsubscribe on ' + jsonID);
                            vis.conn.unsubscribe(jsonID);
                            delete vis.binds.eventlist.subscribes[jsonID];
                        }
                        vis.unregisterOnChange(onChange, jsonID);
                    }
                });
            });
        },
    };

    vis.binds.eventlist.showVersion();
</script>

<script id="tplEventlist"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="eventlist"
        data-vis-type="json,table"
        data-vis-name="Events"
        data-vis-prev='<img src="widgets/eventlist/img/Prev_Eventlist.png"></img>'
        data-vis-attrs="eventlistInstance[0]/instance,eventlist;"
        data-vis-attrs0="max_rows/number;defaultStyle[true]/checkbox;defaultStyle[true]/checkbox;"
        data-vis-attrs1="group.header;showEventTime[true]/checkbox;showEventValue[true]/checkbox;showEventDuration[false]/checkbox;"
        data-vis-attrs2="group.headerTitle;textEventTime[_];textEventEvent[_];textEventValue[_];textEventDuration[_];"
        data-vis-attrs3="group.headerWidths;widthEventTime;widthEventEvent;widthEventValue;widthEventDuration;"
        data-vis-attrs4="group.headerAligns;alignEventTime[right]/select,left,right,center;alignEventEvent[right]/select,left,right,center;alignEventValue[right]/select,left,right,center;alignEventDuration[right]/select,left,right,center;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width: 300px; height: 150px; overflow-x: hidden">
        <div class="vis-widget-body" style="display: inline-block" <%= (el) -> vis.binds.eventlist.init(el, this.data.wid, this.view, this.data, this.style) %> ></div>
    </div>
</script>
<!-- --------------eventlist.html--- END -->
<!-- --------------fancyswitch.html--- START -->
<!--
    ioBroker.vis fancyswitch Widget-Set

    version: "1.0.0"

    Copyright 2013-2015 hobbyquaker, bluefox<dogafox@gmail.com>
-->
<style type="text/css">
    .fancy-switch{
        border:none;
        background:left no-repeat;
        width:105px;
        height:46px;
        padding:0;
        margin:0;
        white-space: nowrap;
    }

    .fancy-on, .fancy-off{
        width:50px;
        height:40px;
        display:inline-block;
        cursor:pointer;
    }


</style>
<link rel="stylesheet" type="text/css" href="widgets/fancyswitch/css/jquery.ibutton.min.css"/>

<script type="text/javascript" src="widgets/fancyswitch/js/jquery-ui.toggleSwitch.js"></script>
<script type="text/javascript" src="widgets/fancyswitch/js/jquery.ibutton.min.js"></script>

<script type="text/javascript">
    "use strict";

    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {
            "text_true":        {"en": "Label for true",             "de": "Text für TRUE",      "ru": "Текст для 1"},
            "text_false":       {"en": "Label for false",            "de": "Text für FALSE",     "ru": "Текст для 0"},
            "width":            {"en": "Width",                      "de": "Breite",             "ru": "Ширина"},
            "auto":             {"en": "auto",                       "de": "auto",               "ru": "автоматически"},
            "true":             {"en": "true",                       "de": "true",               "ru": "да"},
            "false":            {"en": "false",                      "de": "false",              "ru": "нет"},
            "labelOn":          {"en": "Label for 'ON'",             "de": "Text für AN",        "ru": "Подпись для 'истина/1'"},
            "labelOff":         {"en": "Label for 'OFF'",            "de": "Text für AUS",       "ru": "Подпись для 'ложь/0'"},
            "resizeHandle":     {"en": "resizeHandle",               "de": "Hebelgröße",         "ru": "Изменить размер клавиши"},
            "resizeContainer":  {"en": "resizeContainer",            "de": "Konteinergröße",     "ru": "Изменить размер виджета"},
            "enableDrag":       {"en": "Enable drag",                "de": "Ziehen erlaubt",     "ru": "Можно тащить мышкой"},
            "enableFx":         {"en": "Animation",                  "de": "Animation",          "ru": "Анимация"},
            "duration":         {"en": "Effect duration(ms)",        "de": "Umschaltdauer(ms)",  "ru": "Длительность анимации"},
            "highlight_switch": {"en": "Highlight switch",           "de": "Highlight Schalter", "ru": "Подсветить выключатель"},
            "invert":           {"en": "Invert state",               "de": "Zustand invertieren", "ru": "Инвертировать состояние"},
            "test":             {"en": "Test",                       "de": "Testen",             "ru": "Тест"},
            "valFalse":         {"en": "False value",                "de": "Falsch-Wert",        "ru": "False-значение"},
            "valTrue":          {"en": "True value",                 "de": "Wahr-Wert",          "ru": "True-значение"},
            "lightStyle":       {"en": "Light style",                "de": "Hellstil",           "ru": "Светлый стиль"},
            "autoOff":          {"en": "Auto OFF in (ms)",           "de": "Auto AUS(ms)",       "ru": "Авто Выкл.(мс)"},
            "autoOff_tooltip":  {
                "en": "Chnage to previous state after given interval automatically",
                "de": "Ändert Zustand auf vorheriger nach eingegebenem Intervall",
                "ru": "Меняет состояние на обратное по истечении указанного времени"
            }
        });
    }

    vis.binds.fancyswitch = {
	    version: "1.0.0",
		showVersion: function () {
			if (vis.binds.fancyswitch.version) {
				console.log('Version vis-fancyswitch:' + vis.binds.fancyswitch.version);
				vis.binds.fancyswitch.version = null;
			}
		},
        fancyswitch: function (el, options) {
			vis.binds.fancyswitch.showVersion();
            var $this = $(el).parent().find('.fancy-switch');
            var oid   = $this.attr('data-oid');
            options.valTrue = (options.valTrue === null || options.valTrue === '' || options.valTrue === undefined) ? null: options.valTrue;
            options.valFalse = (options.valFalse === null || options.valFalse === '' || options.valFalse === undefined) ? null: options.valFalse;
            if (options.valTrue === null) options.valTrue = 1;
            if (options.valTrue === "true") options.valTrue = true;
            if (options.valTrue === "false") options.valTrue = false;
            if (options.valFalse === null) options.valFalse = 0;
            if (options.valFalse === "true") options.valFalse = true;
            if (options.valFalse === "false") options.valFalse = false;
            if (oid && oid != 'nothing_selected') {
                vis.states.bind(oid + '.val', function (e, newVal, oldVal) {
                    if (newVal === null || newVal === undefined) newVal = options.valFalse;
                    var num = newVal;
                    if (num === "true") num = true;
                    if (num === "false") num = false;
                    if (num !== true && num !== false) {
                        if (typeof num === 'string') {
                            var f = parseFloat(num);
                            if (f == num) {
                                num = f;
                            }
                        }
                        if ((typeof num === 'number' && num > 0) || (options.valTrue === 1 && newVal === true) || newVal.toString() === options.valTrue) {
                            num = true;
                        }
                        else {
                            num = false;
                        }
                    }
                    else {
                        if (num === options.valTrue) num = true;
                            else num = false;
                    }

                    if (options.invert) {
                        num = !num;
                    }
                    $this.css('background-position', num ? 'left' : 'right');
                    $this.find('input.fancy-on_off[value="' + options.valFalse + '"]').prop('checked', !num);
                    $this.find('input.fancy-on_off[value="' + options.valTrue + '"]').prop('checked', num);
                });
            }
            $this.css('background', 'url("' + options.src + '")');
            $this.find('.fancy-on_off').css('display', 'none');
            $this.find('.fancy-on, .fancy-off').css('text-indent', '-10000px');

            var newVal = vis.states.attr(oid + '.val');
            if (newVal === null || newVal === undefined) newVal = options.valFalse;
            var num = newVal;
            if (num === "true") num = true;
            if (num === "false") num = false;
            if (num !== true && num !== false) {
                if (typeof num === 'string') {
                    var f = parseFloat(num);
                    if (f == num) {
                        num = f;
                    }
                }
                if ((typeof num === 'number' && num > 0) || (options.valTrue === 1 && newVal === true) || newVal.toString() === options.valTrue) {
                    num = true;
                }
                else {
                    num = false;
                }
            }
            else {
                if (num === options.valTrue) num = true;
                    else num = false;
            }
            if (options.invert) {
                num = !num;
            }
            $this.css('background-position', num ? 'left' : 'right');

            if (!vis.editMode && oid && oid != 'nothing_selected') {
                options.autoOff = parseInt(options.autoOff, 10) || 0;

                $this.find("input.fancy-on_off").change(function() {
                    var newVal = $(this).val();
                    if (newVal === null || newVal === undefined) newVal = options.valFalse;
                    var num = newVal;
                    if (num === "true") num = true;
                    if (num === "false") num = false;
                    if (num !== true && num !== false) {
                        if (typeof num === 'string') {
                            var f = parseFloat(num);
                            if (f == num) {
                                num = f;
                            }
                        }
                        if ((typeof num === 'number' && num > 0) || (options.valTrue === 1 && newVal === true) || newVal.toString() === options.valTrue) {
                            num = true;
                        }
                        else {
                            num = false;
                        }
                    }
                    else {
                        if (num === options.valTrue) num = true;
                            else num = false;
                    }
                    if (options.invert) {
                        num = !num;
                    }

                    $this.css('background-position', num ? 'left' : 'right');
                    vis.setValue(oid, num ? options.valTrue : options.valFalse);
                    if (options.autoOff) {
                        setTimeout(function () {
                            vis.setValue(oid, num ? options.valFalse : options.valTrue);
                        }, options.autoOff);
                    }
                });
            }
        },
        toggleSwitch: function (el, options) {
 			vis.binds.fancyswitch.showVersion();
            var $this = $(el).prev();
            $this.toggleSwitch({
                highlight: options.highlight,
                width:     parseInt(options.width, 10) || 40/*,
                change: function (e) {
                    console.log(e);
                }*/
            });

            if (vis.editMode) {
                if (options.test) {
                    $this.val(!parseInt($this.val(), 10) ? '1' : '0').trigger('change');
                }
                setTimeout(function () {
                    var id = $this.attr('id');
                    id = id.substring(0, id.length - '_select'.length);
                    $('#' + id).find('.ui-toggle-switch').css({'pointer-events': 'none'});
                }, 100);
            }
        },
        iButton: function (el, options) {
			vis.binds.fancyswitch.showVersion();
            var $this = $(el);

            setTimeout(function () {
                $this.iButton(options);
            }, 20);

            if (!options.enableFx)   options.enableFx   = false;
            if (!options.enableDrag) options.enableDrag = false;
            if (options.resizeHandle === 'false') options.resizeHandle = false;
            if (options.resizeContainer === 'false') options.resizeContainer = false;

            var oid = $this.attr('data-oid');
            if (oid != 'nothing_selected') {
                vis.states.bind(oid + '.val', function (e, newVal, oldVal) {
                    var num = (parseFloat(newVal) > 0 || newVal === 'true' || newVal === true);
                    $this.prop('checked', num).trigger('change');
                });
            }

            if (vis.editMode) {
                if (options.test) $this.prop('checked', !$this.prop('checked')).trigger('change');
                setTimeout(function () {
                    var id = $this.attr('id');
                    id = id.substring(0, id.length - '_checkbox'.length);
                    $('#' + id).find('.ibutton-container').css({'pointer-events': 'none'});
                }, 100);
            }
        }
    };
</script>

<script id="tplFancySwitch1"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplFancySwitch1" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev" style="width: 104px; height: 40px; left: 179.5px; top: 46px; position: absolute;" > <div class="vis-widget-prev-body"> <fieldset class="fancy-switch" data-o style="background-image: url(widgets/fancyswitch/img/fancyswitch-1.png); background-position: 100% 50%; background-repeat: initial initial;"> <label class="fancy-off" style="text-indent: -10000px;">Off<input type="radio" class="fancy-on_off" name="w00004_on_off" value="0" style="display: none;"></label> <label class="fancy-on" style="text-indent: -10000px;">On<input type="radio" class="fancy-on_off" name="w00004_on_off" value="1" style="display: none;"></label> </fieldset> <div></div> </div> </div>'
        data-vis-set="fancyswitch"
        data-vis-type="ctrl - Bool"
        data-vis-name="Switch light Off/On"
        data-vis-attrs="oid;invert/checkbox;valFalse[0];valTrue[1];autoOff/slider,0,5000,100">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:105px; height:46px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <fieldset id="<%= this.data.attr('wid') %>_fancy" class="fancy-switch" data-oid="<%= this.data.attr('oid') %>">
                <label class="fancy-off">Off<input type="radio" class="fancy-on_off" name="<%= this.data.attr('wid') %>_on_off" value="<%= (this.data.attr('valFalse') !== undefined) ? this.data.attr('valFalse') : 0 %>"/></label>
                <label class="fancy-on">On<input type="radio" class="fancy-on_off" name="<%= this.data.attr('wid') %>_on_off" value="<%= (this.data.attr('valTrue') === '' || this.data.attr('valTrue') === null || this.data.attr('valTrue') === undefined) ? 1 : this.data.attr('valTrue') %>"/></label>
            </fieldset>
            <div <%= (el) -> vis.binds.fancyswitch.fancyswitch(el, {src: "widgets/fancyswitch/img/fancyswitch-1.png", invert: data.attr('invert'), valTrue: this.data.attr('valTrue'), valFalse: this.data.attr('valFalse'), autoOff: this.data.attr('autoOff')}) %>></div>
        </div>
    </div>
</script>

<script id="tplFancySwitch2"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplFancySwitch2" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-selectee" style="width: 105px; height: 46px; left: 408px; top: 404px;" > <div class="vis-widget-prev-body"> <fieldset class="fancy-switch" data-o style="background-image: url(widgets/fancyswitch/img/fancyswitch-2.png); background-position: 100% 50%; background-repeat: initial initial;"> <label class="fancy-off" style="text-indent: -10000px;">Off<input type="radio" class="fancy-on_off" name="w00005_on_off" value="0" style="display: none;"></label> <label class="fancy-on" style="text-indent: -10000px;">On<input type="radio" class="fancy-on_off" name="w00005_on_off" value="1" style="display: none;"></label> </fieldset> <div></div> </div> </div>'
        data-vis-set="fancyswitch"
        data-vis-type="ctrl - Bool"
        data-vis-name="Slider dark Off/On"
        data-vis-attrs="oid;invert/checkbox;valFalse[0];valTrue[1];autoOff/slider,0,5000,100">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:105px; height:46px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <fieldset id="<%= this.data.attr('wid') %>_fancy" class="fancy-switch" data-oid="<%= this.data.attr('oid') %>">
                <label class="fancy-off">Off<input type="radio" class="fancy-on_off" name="<%= this.data.attr('wid') %>_on_off" value="<%= (this.data.attr('valFalse') !== undefined) ? this.data.attr('valFalse') : 0 %>"/></label>
                <label class="fancy-on">On<input type="radio" class="fancy-on_off" name="<%= this.data.attr('wid') %>_on_off" value="<%= (this.data.attr('valTrue') === '' || this.data.attr('valTrue') === null || this.data.attr('valTrue') === undefined) ? 1 : this.data.attr('valTrue') %>"/></label>
            </fieldset>
            <div <%= (el) -> vis.binds.fancyswitch.fancyswitch(el, {src: "widgets/fancyswitch/img/fancyswitch-2.png", invert: data.attr('invert'), valTrue: this.data.attr('valTrue'), valFalse: this.data.attr('valFalse'), autoOff: this.data.attr('autoOff')}) %>></div>
        </div>
    </div>
</script>

<script id="tplFancyDarkAnAus"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplFancyDarkAnAus" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev" style="width: 105px; height: 46px; left: 136px; top: 613px;" > <div class="vis-widget-prev-body"> <fieldset class="fancy-switch" data-o style="background-image: url(widgets/fancyswitch/img/fancyswitch-3.png); background-position: 100% 50%; background-repeat: initial initial;"> <label class="fancy-off" style="text-indent: -10000px;">Off<input type="radio" class="fancy-on_off" name="w00006_on_off" value="0" style="display: none;"></label> <label class="fancy-on" style="text-indent: -10000px;">On<input type="radio" class="fancy-on_off" name="w00006_on_off" value="1" style="display: none;"></label> </fieldset> <div></div> </div> </div>'
        data-vis-set="fancyswitch"
        data-vis-type="ctrl - Bool"
        data-vis-name="Schieber dunkel Ein/Aus"
        data-vis-attrs="oid;invert/checkbox;valFalse[0];valTrue[1];autoOff/slider,0,5000,100">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:105px; height:46px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <fieldset id="<%= this.data.attr('wid') %>_fancy" class="fancy-switch" data-oid="<%= this.data.attr('oid') %>">
                <label class="fancy-off">Off<input type="radio" class="fancy-on_off" name="<%= this.data.attr('wid') %>_on_off" value="<%= (this.data.attr('valFalse') !== undefined) ? this.data.attr('valFalse') : 0 %>"/></label>
                <label class="fancy-on">On<input type="radio" class="fancy-on_off" name="<%= this.data.attr('wid') %>_on_off" value="<%= (this.data.attr('valTrue') === '' || this.data.attr('valTrue') === null || this.data.attr('valTrue') === undefined) ? 1 : this.data.attr('valTrue') %>"/></label>
            </fieldset>
            <div <%= (el) -> vis.binds.fancyswitch.fancyswitch(el, {src: "widgets/fancyswitch/img/fancyswitch-3.png", invert: data.attr('invert'), valTrue: this.data.attr('valTrue'), valFalse: this.data.attr('valFalse'), autoOff: this.data.attr('autoOff')}) %>></div>
        </div>
    </div>
</script>

<script id="tplFancyDarkAnAusRev"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplFancyDarkAnAusRev" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev" style="width: 105px; height: 46px; left: 278px; top: 527px;" > <div class="vis-widget-prev-body"> <fieldset class="fancy-switch" data-o style="background-image: url(widgets/fancyswitch/img/fancyswitch-4.png); background-position: 100% 50%; background-repeat: initial initial;"> <label class="fancy-off" style="text-indent: -10000px;">Off<input type="radio" class="fancy-on_off" name="w00007_on_off" value="0" style="display: none;"></label> <label class="fancy-on" style="text-indent: -10000px;">On<input type="radio" class="fancy-on_off" name="w00007_on_off" value="1" style="display: none;"></label> </fieldset> <div></div> </div> </div>'
        data-vis-set="fancyswitch"
        data-vis-type="ctrl - Bool"
        data-vis-name="Schieber dunkel Aus/Ein"
        data-vis-attrs="oid;invert/checkbox;valFalse[0];valTrue[1];autoOff/slider,0,5000,100">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:105px; height:46px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <fieldset id="<%= this.data.attr('wid') %>_fancy" class="fancy-switch" data-oid="<%= this.data.attr('oid') %>">
                <label class="fancy-off">Off<input type="radio" class="fancy-on_off" name="<%= this.data.attr('wid') %>_on_off" value="<%= (this.data.attr('valFalse') !== undefined) ? this.data.attr('valFalse') : 0 %>"/></label>
                <label class="fancy-on">On<input type="radio" class="fancy-on_off" name="<%= this.data.attr('wid') %>_on_off" value="<%= (this.data.attr('valTrue') === '' || this.data.attr('valTrue') === null || this.data.attr('valTrue') === undefined) ? 1 : this.data.attr('valTrue') %>"/></label>
            </fieldset>
            <div <%= (el) -> vis.binds.fancyswitch.fancyswitch(el, {src: "widgets/fancyswitch/img/fancyswitch-4.png", invert: data.attr('invert'), valTrue: this.data.attr('valTrue'), valFalse: this.data.attr('valFalse'), autoOff: this.data.attr('autoOff')}) %>></div>
        </div>
    </div>
</script>

<script id="tplFancyDarkAnAusWippe"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplFancyDarkAnAusWippe" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-selectee" style="width: 102px; height: 49px; left: 73px; top: 232px; position: absolute;" > <div class="vis-widget-prev-body"> <fieldset class="fancy-switch" data-o style="background-image: url(widgets/fancyswitch/img/fancyswitch-5.png); background-position: 100% 50%; background-repeat: initial initial;"> <label class="fancy-off" style="text-indent: -10000px;">Off<input type="radio" class="fancy-on_off" name="w00002_on_off" value="0" style="display: none;"></label> <label class="fancy-on" style="text-indent: -10000px;">On<input type="radio" class="fancy-on_off" name="w00002_on_off" value="1" style="display: none;"></label> </fieldset> <div></div> </div> </div>'
        data-vis-set="fancyswitch"
        data-vis-type="ctrl - Bool"
        data-vis-name="Wippe dunkel Aus/Ein"
        data-vis-attrs="oid;invert/checkbox;valFalse[0];valTrue[1];autoOff/slider,0,5000,100;lightStyle/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:105px; height:46px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <fieldset id="<%= this.data.attr('wid') %>_fancy" class="fancy-switch" data-oid="<%= this.data.attr('oid') %>">
                <label class="fancy-off">Off<input type="radio" class="fancy-on_off" name="<%= this.data.attr('wid') %>_on_off" value="<%= (this.data.attr('valFalse') !== undefined) ? this.data.attr('valFalse') : 0 %>"/></label>
                <label class="fancy-on">On<input type="radio" class="fancy-on_off" name="<%= this.data.attr('wid') %>_on_off" value="<%= (this.data.attr('valTrue') === '' || this.data.attr('valTrue') === null || this.data.attr('valTrue') === undefined) ? 1 : this.data.attr('valTrue') %>"/></label>
            </fieldset>
            <div <%= (el) -> vis.binds.fancyswitch.fancyswitch(el, {src: data.attr('lightStyle') ? "widgets/fancyswitch/img/fancyswitch-6.png" : "widgets/fancyswitch/img/fancyswitch-5.png", invert: data.attr('invert'), valTrue: this.data.attr('valTrue'), valFalse: this.data.attr('valFalse'), autoOff: this.data.attr('autoOff')}) %>></div>
        </div>
    </div>
</script>

<script id="tplFancyGivaIButton"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplFancyGivaIButton" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-selectee" style="top: 514px; left: 186px;" > <div class="vis-widget-prev-body"> <div class="ibutton-container" style="pointer-events: none;"><input type="checkbox" name="w00004_checkbox" data-o value="1"><div class="ibutton-handle" style="left: 0px;"><div class="ibutton-handle-right"><div class="ibutton-handle-middle"></div></div></div><div class="ibutton-label-off"><span style="margin-right: 0px;"><label>OFF</label></span></div><div class="ibutton-label-on" style="width: 4px;"><span style="margin-left: -50px;"><label>ON</label></span></div><div class="ibutton-padding-left"></div><div class="ibutton-padding-right"></div></div> </div> </div>'
        data-vis-set="fancyswitch"
        data-vis-type="ctrl - Bool"
        data-vis-name="Giva Labs iButton"
        data-vis-attrs="oid;labelOn[ON];labelOff[OFF];resizeHandle[auto]/select,auto,true,false;resizeContainer[auto]/select,auto,true,false;enableDrag/checkbox;enableFx/checkbox;duration[200]/slider,0,5000,100;test/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0px; left:0px;" id="<%= this.data.attr('wid') %>" >
        <div class="vis-widget-body">
            <input type="checkbox" name="<%= this.data.attr('wid') %>_checkbox"
                   id="<%= this.data.attr('wid') %>_checkbox"
                   data-oid="<%= this.data.attr('oid') %>"
                   value="1"
                    <%= (el) -> vis.binds.basic.checkbox(el); vis.binds.fancyswitch.iButton(el, {duration: data.attr('duration'), labelOn: data.attr('labelOn'), labelOff: data.attr('labelOff'), resizeHandle: data.attr('resizeHandle'), resizeContainer: data.attr('resizeContainer'), enableDrag: data.attr('enableDrag'), enableFx: data.attr('enableFx'), test: data.attr('test')}); %>/>
        </div>
    </div>
</script>

<script id="tplFancyToggleswitch"
        type="text/ejs"
        data-vis-prev='<div id="prev_tplFancyToggleswitch" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-selectee" style="padding-left: 10px; left: 109px; top: 604px; position: absolute; height: 62px; width: 45px;" > <div class="vis-widget-prev-body" style="padding-top:5px; text-align: center"> <select data-oid="" class="ui-toggle-switch" style="display: none; pointer-events: none;"> <option value="0">OFF</option> <option value="1">ON</option> </select> <div></div> <div class="ui-toggle-switch" style="pointer-events: none;"><label style="border: 0px" class="ui-state-active">OFF</label><div class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" aria-disabled="false" style="width: 40px;"><div class="ui-slider-range ui-widget-header ui-corner-all ui-slider-range-max" style="width: 100%;"></div><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="left: 0%;"></a></div><label style="border: 0px">ON</label></div></div> </div>'
        class="vis-tpl"
        data-vis-set="fancyswitch"
        data-vis-type="ctrl - Bool"
        data-vis-name="Taitem jqui Toggleswitch"
        data-vis-attrs="html_prepend;html_append;oid;text_true[ON];text_false[OFF];highlight_switch/checkbox;width[40]/slider,10,500,1;test/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" style="padding-left:10px;" id="<%= this.data.attr('wid') %>" >
        <div class="vis-widget-body" style="padding-top:5px; text-align: center">
            <%== this.data.attr("html_prepend") %>
            <select id="<%= this.data.attr('wid') %>_select" data-oid="<%= (this.data.attr('oid') == 'nothing_selected' ? '' : this.data.attr('oid')) %>">
                <option value="0"><%= this.data.attr('text_false') %></option>
                <option value="1"><%= this.data.attr('text_true') %></option>
            </select>
            <div <%= (el) -> vis.binds.basic.select(el); vis.binds.fancyswitch.toggleSwitch(el, {highlight: data.attr('highlight_switch'), width: data.attr('width'), test: data.attr('test')}); %>></div>
            <%== this.data.attr("html_append") %>
        </div>
    </div>
</script>

<!-- --------------fancyswitch.html--- END -->
<!-- --------------google-fonts.html--- START -->
<!--
ioBroker.vis google fonts Widget-Set

version: "0.0.1"

Copyright 2015 bluefox<dogafox@gmail.com>

-->
<style>
/* following text generated automatically -- START STYLE--*/
@font-face {
	font-family: Alegreya-Black;
	src: url(widgets/google-fonts/fonts/Alegreya/Alegreya-Black.ttf);
}
@font-face {
	font-family: Alegreya-BlackItalic;
	src: url(widgets/google-fonts/fonts/Alegreya/Alegreya-BlackItalic.ttf);
}
@font-face {
	font-family: Alegreya-Bold;
	src: url(widgets/google-fonts/fonts/Alegreya/Alegreya-Bold.ttf);
}
@font-face {
	font-family: Alegreya-BoldItalic;
	src: url(widgets/google-fonts/fonts/Alegreya/Alegreya-BoldItalic.ttf);
}
@font-face {
	font-family: Alegreya-Italic;
	src: url(widgets/google-fonts/fonts/Alegreya/Alegreya-Italic.ttf);
}
@font-face {
	font-family: Alegreya-Regular;
	src: url(widgets/google-fonts/fonts/Alegreya/Alegreya-Regular.ttf);
}
@font-face {
	font-family: Anton;
	src: url(widgets/google-fonts/fonts/Anton/Anton.ttf);
}
@font-face {
	font-family: Arimo-Bold;
	src: url(widgets/google-fonts/fonts/Arimo/Arimo-Bold.ttf);
}
@font-face {
	font-family: Arimo-BoldItalic;
	src: url(widgets/google-fonts/fonts/Arimo/Arimo-BoldItalic.ttf);
}
@font-face {
	font-family: Arimo-Italic;
	src: url(widgets/google-fonts/fonts/Arimo/Arimo-Italic.ttf);
}
@font-face {
	font-family: Arimo-Regular;
	src: url(widgets/google-fonts/fonts/Arimo/Arimo-Regular.ttf);
}
@font-face {
	font-family: BadScript-Regular;
	src: url(widgets/google-fonts/fonts/Bad_Script/BadScript-Regular.ttf);
}
@font-face {
	font-family: Bangers;
	src: url(widgets/google-fonts/fonts/Bangers/Bangers.ttf);
}
@font-face {
	font-family: Candal;
	src: url(widgets/google-fonts/fonts/Candal/Candal.ttf);
}
@font-face {
	font-family: Comfortaa-Bold;
	src: url(widgets/google-fonts/fonts/Comfortaa/Comfortaa-Bold.ttf);
}
@font-face {
	font-family: Comfortaa-Light;
	src: url(widgets/google-fonts/fonts/Comfortaa/Comfortaa-Light.ttf);
}
@font-face {
	font-family: Comfortaa-Regular;
	src: url(widgets/google-fonts/fonts/Comfortaa/Comfortaa-Regular.ttf);
}
@font-face {
	font-family: DancingScript-Bold;
	src: url(widgets/google-fonts/fonts/Dancing_Script/DancingScript-Bold.ttf);
}
@font-face {
	font-family: DancingScript-Regular;
	src: url(widgets/google-fonts/fonts/Dancing_Script/DancingScript-Regular.ttf);
}
@font-face {
	font-family: IndieFlower;
	src: url(widgets/google-fonts/fonts/Indie_Flower/IndieFlower.ttf);
}
@font-face {
	font-family: Jura-DemiBold;
	src: url(widgets/google-fonts/fonts/Jura/Jura-DemiBold.ttf);
}
@font-face {
	font-family: Jura-Light;
	src: url(widgets/google-fonts/fonts/Jura/Jura-Light.ttf);
}
@font-face {
	font-family: Jura-Medium;
	src: url(widgets/google-fonts/fonts/Jura/Jura-Medium.ttf);
}
@font-face {
	font-family: Jura-Regular;
	src: url(widgets/google-fonts/fonts/Jura/Jura-Regular.ttf);
}
@font-face {
	font-family: Lobster-Regular;
	src: url(widgets/google-fonts/fonts/Lobster/Lobster-Regular.ttf);
}
@font-face {
	font-family: MarckScript-Regular;
	src: url(widgets/google-fonts/fonts/Marck_Script/MarckScript-Regular.ttf);
}
@font-face {
	font-family: Neucha;
	src: url(widgets/google-fonts/fonts/Neucha/Neucha.ttf);
}
@font-face {
	font-family: OpenSans-CondBold;
	src: url(widgets/google-fonts/fonts/Open_Sans_Condensed/OpenSans-CondBold.ttf);
}
@font-face {
	font-family: OpenSans-CondLight;
	src: url(widgets/google-fonts/fonts/Open_Sans_Condensed/OpenSans-CondLight.ttf);
}
@font-face {
	font-family: OpenSans-CondLightItalic;
	src: url(widgets/google-fonts/fonts/Open_Sans_Condensed/OpenSans-CondLightItalic.ttf);
}
@font-face {
	font-family: Pacifico;
	src: url(widgets/google-fonts/fonts/Pacifico/Pacifico.ttf);
}
@font-face {
	font-family: Play-Bold;
	src: url(widgets/google-fonts/fonts/Play/Play-Bold.ttf);
}
@font-face {
	font-family: Play-Regular;
	src: url(widgets/google-fonts/fonts/Play/Play-Regular.ttf);
}
@font-face {
	font-family: PoiretOne-Regular;
	src: url(widgets/google-fonts/fonts/Poiret_One/PoiretOne-Regular.ttf);
}
@font-face {
	font-family: PressStart2P-Regular;
	src: url(widgets/google-fonts/fonts/Press_Start_2P/PressStart2P-Regular.ttf);
}
@font-face {
	font-family: RobotoCondensed-Bold;
	src: url(widgets/google-fonts/fonts/Roboto_Condensed/RobotoCondensed-Bold.ttf);
}
@font-face {
	font-family: RobotoCondensed-BoldItalic;
	src: url(widgets/google-fonts/fonts/Roboto_Condensed/RobotoCondensed-BoldItalic.ttf);
}
@font-face {
	font-family: RobotoCondensed-Italic;
	src: url(widgets/google-fonts/fonts/Roboto_Condensed/RobotoCondensed-Italic.ttf);
}
@font-face {
	font-family: RobotoCondensed-Light;
	src: url(widgets/google-fonts/fonts/Roboto_Condensed/RobotoCondensed-Light.ttf);
}
@font-face {
	font-family: RobotoCondensed-LightItalic;
	src: url(widgets/google-fonts/fonts/Roboto_Condensed/RobotoCondensed-LightItalic.ttf);
}
@font-face {
	font-family: RobotoCondensed-Regular;
	src: url(widgets/google-fonts/fonts/Roboto_Condensed/RobotoCondensed-Regular.ttf);
}
@font-face {
	font-family: RubikMonoOne-Regular;
	src: url(widgets/google-fonts/fonts/Rubik_Mono_One/RubikMonoOne-Regular.ttf);
}
@font-face {
	font-family: RubikOne-Regular;
	src: url(widgets/google-fonts/fonts/Rubik_One/RubikOne-Regular.ttf);
}
@font-face {
	font-family: RuslanDisplay;
	src: url(widgets/google-fonts/fonts/Ruslan_Display/RuslanDisplay.ttf);
}
@font-face {
	font-family: RussoOne-Regular;
	src: url(widgets/google-fonts/fonts/Russo_One/RussoOne-Regular.ttf);
}
@font-face {
	font-family: ShadowsIntoLight;
	src: url(widgets/google-fonts/fonts/Shadows_Into_Light/ShadowsIntoLight.ttf);
}
@font-face {
	font-family: SigmarOne;
	src: url(widgets/google-fonts/fonts/Sigmar_One/SigmarOne.ttf);
}
@font-face {
	font-family: StalinistOne-Regular;
	src: url(widgets/google-fonts/fonts/Stalinist_One/StalinistOne-Regular.ttf);
}
@font-face {
	font-family: Ubuntu-Bold;
	src: url(widgets/google-fonts/fonts/Ubuntu/Ubuntu-Bold.ttf);
}
@font-face {
	font-family: Ubuntu-BoldItalic;
	src: url(widgets/google-fonts/fonts/Ubuntu/Ubuntu-BoldItalic.ttf);
}
@font-face {
	font-family: Ubuntu-Italic;
	src: url(widgets/google-fonts/fonts/Ubuntu/Ubuntu-Italic.ttf);
}
@font-face {
	font-family: Ubuntu-Light;
	src: url(widgets/google-fonts/fonts/Ubuntu/Ubuntu-Light.ttf);
}
@font-face {
	font-family: Ubuntu-LightItalic;
	src: url(widgets/google-fonts/fonts/Ubuntu/Ubuntu-LightItalic.ttf);
}
@font-face {
	font-family: Ubuntu-Medium;
	src: url(widgets/google-fonts/fonts/Ubuntu/Ubuntu-Medium.ttf);
}
@font-face {
	font-family: Ubuntu-MediumItalic;
	src: url(widgets/google-fonts/fonts/Ubuntu/Ubuntu-MediumItalic.ttf);
}
@font-face {
	font-family: Ubuntu-Regular;
	src: url(widgets/google-fonts/fonts/Ubuntu/Ubuntu-Regular.ttf);
}

/* following text generated automatically -- END STYLE--*/
</style>


<script>
    "use strict";
    if (vis.editMode) {
        var fonts =
/* following text generated automatically -- START LIST--*/
[
    "Alegreya-Black",
    "Alegreya-BlackItalic",
    "Alegreya-Bold",
    "Alegreya-BoldItalic",
    "Alegreya-Italic",
    "Alegreya-Regular",
    "Anton",
    "Arimo-Bold",
    "Arimo-BoldItalic",
    "Arimo-Italic",
    "Arimo-Regular",
    "BadScript-Regular",
    "Bangers",
    "Candal",
    "Comfortaa-Bold",
    "Comfortaa-Light",
    "Comfortaa-Regular",
    "DancingScript-Bold",
    "DancingScript-Regular",
    "IndieFlower",
    "Jura-DemiBold",
    "Jura-Light",
    "Jura-Medium",
    "Jura-Regular",
    "Lobster-Regular",
    "MarckScript-Regular",
    "Neucha",
    "OpenSans-CondBold",
    "OpenSans-CondLight",
    "OpenSans-CondLightItalic",
    "Pacifico",
    "Play-Bold",
    "Play-Regular",
    "PoiretOne-Regular",
    "PressStart2P-Regular",
    "RobotoCondensed-Bold",
    "RobotoCondensed-BoldItalic",
    "RobotoCondensed-Italic",
    "RobotoCondensed-Light",
    "RobotoCondensed-LightItalic",
    "RobotoCondensed-Regular",
    "RubikMonoOne-Regular",
    "RubikOne-Regular",
    "RuslanDisplay",
    "RussoOne-Regular",
    "ShadowsIntoLight",
    "SigmarOne",
    "StalinistOne-Regular",
    "Ubuntu-Bold",
    "Ubuntu-BoldItalic",
    "Ubuntu-Italic",
    "Ubuntu-Light",
    "Ubuntu-LightItalic",
    "Ubuntu-Medium",
    "Ubuntu-MediumItalic",
    "Ubuntu-Regular"
]
/* following text generated automatically -- END LIST--*/
                ;
        // wait till visEditInspect loaded
        setTimeout(function () {
            for (var f = 0; f < fonts.length; f++) {
                vis.addFont(fonts[f]);
            }
        }, 100);
        vis.binds['google-fonts'] = {
            version: "0.0.1",
            showVersion: function () {
                if (vis.binds['google-fonts'].version) {
                    console.log('Version vis-google-fonts: ' + vis.binds['google-fonts'].version);
                    vis.binds['google-fonts'].version = null;
                }
            }
        };
        vis.binds['google-fonts'].showVersion();
    }
</script>
<!-- --------------google-fonts.html--- END -->
<!-- --------------history.html--- START -->
<!--
    ioBroker.vis history widgets

    version: "1.0.0"

    Copyright 2016-2019 bluefox<dogafox@gmail.com>

-->
<script type="text/javascript" src="widgets/history/lib/js/jquery.sparkline.min.js"></script>

<script type="text/javascript">
    'use strict';
    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {
            "format_date":          {"en": "Dateformat",        "de": "Datumformat",            "ru": "Формат даты"},
            "format_date_tooltip": {
                "en": "Dateformat",
                "de": "Datumformat",
                "ru": "Формат даты"
            },
            "1 second":         {"en": "1 second",              "de": "1 Sekunde",              "ru": "1 секунда"},
            "10 seconds":       {"en": "10 seconds",            "de": "10 Sekunden",            "ru": "10 секунд"},
            "30 seconds":       {"en": "30 seconds",            "de": "30 Sekunden",            "ru": "30 секунд"},
            "1 minute":         {"en": "1 minute",              "de": "1 Minute",               "ru": "1 минута"},
            "2 minutes":        {"en": "2 minutes",             "de": "2 Minuten",              "ru": "2 минуты"},
            "5 minutes":        {"en": "5 minutes",             "de": "5 Minuten",              "ru": "5 минут"},
            "10 minutes":       {"en": "10 minutes",            "de": "10 Minuten",             "ru": "10 минут"},
            "30 minutes":       {"en": "30 minutes",            "de": "30 Minuten",             "ru": "30 минут"},
            "1 hour":           {"en": "1 hour",                "de": "1 Stunde",               "ru": "1 час"},
            "2 hours":          {"en": "2 hours",               "de": "2 Stunden",              "ru": "2 часа"},
            "4 hours":          {"en": "4 hours",               "de": "4 Stunden",              "ru": "4 часа"},
            "8 hours":          {"en": "8 hours",               "de": "8 Stunden",              "ru": "8 часов"},
            "12 hours":         {"en": "12 hours",              "de": "12 Stunden",             "ru": "12 часов"},
            "24 hours":         {"en": "24 hours",              "de": "24 Stunden",             "ru": "24 часа"},
            "instance":         {"en": "history instance",      "de": "Historyinstanz",         "ru": "Экземпляр"},
            "group_advanced":   {"en": "Advanced",              "de": "Erweitert",              "ru": "Дополнительно"},
            "max_lines":        {"en": "Max. event amount",     "de": "max. Ereignisse",        "ru": "Макс. кол-во событий"},
            "time_interval_min": {"en": "Not older than",       "de": "Nicht älter als",        "ru": "Не позже чем"},
            "timeAsInterval":   {"en": "Time as interval",      "de": "Zeit als Intervall",     "ru": "Время, как интервал"},
            "inverseOrder":     {"en": "Inverse order",         "de": "Reihenfolge invertieren", "ru": "Обратный порядок"},
            "group_columns":    {"en": "Columns",               "de": "Spalten",                "ru": "Колонки"},
            "table_attr":       {"en": "Table CSS style",       "de": "CSS Stil - Tabelle",     "ru": "Таблица - CSS стиль"},
            "header_attr":      {"en": "Header CSS style",      "de": "CSS Stil - Beschriftung", "ru": "Заголовок - CSS стиль"},
            "time_name":        {"en": "Time - name",           "de": "Zeit - Name",            "ru": "Время - имя"},
            "time_hide":        {"en": "Time - hide",           "de": "Zeit - nicht zeigen",    "ru": "Время - скрыть"},
            "time_width":       {"en": "Time - width",          "de": "Zeit - Breite",          "ru": "Время - ширина"},
            "time_attr":        {"en": "Time - CSS style",      "de": "Zeit - CSS Stil",        "ru": "Время - CSS стиль"},
            "time_unit":        {"en": "Time - suffix",         "de": "Zeit - Suffix",          "ru": "Время - суффикс"},
            "val_name":         {"en": "Val- name",             "de": "Wert - Name",            "ru": "Значение - имя"},
            "val_hide":         {"en": "Val - hide",            "de": "Wert - nicht zeigen",    "ru": "Значение - скрыть"},
            "val_width":        {"en": "Val - width",           "de": "Wert - Breite",          "ru": "Значение - ширина"},
            "val_attr":         {"en": "Val - CSS style",       "de": "Wert - CSS Stil",        "ru": "Значение - CSS стиль"},
            "val_unit":         {"en": "Val - units",           "de": "Wert - Einheit",         "ru": "Значение - единицы"},
            "from_name":        {"en": "From - name",           "de": "Von - Name",             "ru": "От - имя"},
            "from_hide":        {"en": "From - hide",           "de": "Von - nicht zeigen",     "ru": "От - скрыть"},
            "from_width":       {"en": "From - width",          "de": "Von - Breite",           "ru": "От - ширина"},
            "from_attr":        {"en": "From - CSS style",      "de": "Von - CSS Stil",         "ru": "От - CSS стиль"},
            "from_unit":        {"en": "From - suffix",         "de": "Von - Suffix",           "ru": "От - суффикс"},
            "average":          {"en": "average",               "de": "Mittelwert",             "ru": "среднее"},
            "total":            {"en": "total",                 "de": "Summe",                  "ru": "сумма"},
            "line":             {"en": "line",                  "de": "Linie",                  "ru": "Линия"},
            "aggregate":        {"en": "Aggregation",           "de": "Aggregation",            "ru": "Аггрегирование"},
            "chartType":        {"en": "chartType",             "de": "Charttyp",               "ru": "Тип графика"},
            "points":           {"en": "points",                "de": "Anzahl Werten",          "ru": "Кол-во точек"},
            "time_interval":    {"en": "Time interval",         "de": "Zeitintervall",          "ru": "Интервал"},
            "group_line":       {"en": "Line",                  "de": "Linie-Chart",            "ru": "Линия"},
            "lineColor":        {"en": "Line color",            "de": "Linie-Farbe",            "ru": "Цвет линии"},
            "fillColor":        {"en": "Fill color",            "de": "Füllfarbe",              "ru": "Цвет заливки"},
            "lineWidth":        {"en": "Line width",            "de": "Liniendicke",            "ru": "Ширина линии"},
            "group_bar":        {"en": "Bar",                   "de": "Bar-Chart",              "ru": "Столбцы"},
            "barColor":         {"en": "Positive color",        "de": "Positivfarbe",           "ru": "Цвет положительных столбцов"},
            "negBarColor":      {"en": "negative color",        "de": "Negativfarbe",           "ru": "Цвет отрицательных столбцов"},
            "zeroColor":        {"en": "Zero color",            "de": "0-Farbe",                "ru": "Цвер нулевых значений"},
            "barSpacing":       {"en": "Bar's spacing",         "de": "Abstand",                "ru": "Расстояние между столбцами"},
            "disableTooltips":  {"en": "Hide tooltips",         "de": "Kein Tooltips",          "ru": "Нет подсказки"},
            "history":          {"en": "history",               "de": "history",                "ru": "history"}
        });
    }

    vis.binds.history = {
        version: "1.0.0",
        showVersion: function () {
            if (vis.binds.history.version) {
                console.log('Version vis-history: ' + vis.binds.history.version);
                vis.binds.history.version = null;
            }
        },
        updateWidgets: [],
        updateIntervalTimer: null,
        startIntervalUpdate: function () {
            if (vis.editMode) return;
            if (vis.binds.history.updateWidgets.length && !vis.binds.history.updateIntervalTimer) {
                vis.binds.history.updateIntervalTimer = setInterval(vis.binds.history.updateInterval, 30000);
            } else if (!vis.binds.history.updateWidgets.length && vis.binds.history.updateIntervalTimer) {
                clearInterval(vis.binds.history.updateIntervalTimer);
                vis.binds.history.updateIntervalTimer = null;
            }
        },
        updateInterval: function () {
            for (var wid = 0; wid < vis.binds.history.updateWidgets.length; wid++) {
                vis.binds.history.eventList.update($('#' + vis.binds.history.updateWidgets[wid]).find('.vis-widget-body'));
            }
        },
        eventList: {
            intervals: {
                '1 second':     1000,
                '10 seconds':   10000,
                '30 seconds':   30000,
                '1 minute':     60000,
                '2 minutes':    120000,
                '5 minutes':    300000,
                '10 minutes':   600000,
                '30 minutes':   1800000,
                '1 hour':       3600000,
                '2 hours':      7200000,
                '4 hours':      14400000,
                '8 hours':      28800000,
                '12 hours':     43200000,
                '24 hours':     86400000

            },
            header: function (data) {
                var text = data.title ? '<div style="text-align: center; width: 100%;' + (data.title_attr || '') + '">' + data.title + '</div>' : '';
                text += '<table class="vis-no-spaces">\n';
                var table_attr = (data.table_attr || '');
                var attrTime = (data.time_width ? 'width: ' + data.time_width + 'px;' : '');
                var attrVal  = (data.val_width  ? 'width: ' + data.val_width  + 'px;' : '');
                var attrFrom = (data.from_width ? 'width: ' + data.from_width + 'px;' : '');

                if ((!data.time_hide && data.time_name) ||
                    (!data.val_hide  && data.val_name) ||
                    (!data.from_hide && data.from_name)) {
                    text += '<tr style="' + (data.header_attr || '') + ';' + table_attr + '">';
                    if (!data.time_hide) text += '<th style="' + attrTime + table_attr + '">' + (data.time_name || '') + '</th>';
                    if (!data.val_hide)  text += '<th style="' + attrVal  + table_attr + '">' + (data.val_name  || '') + '</th>';
                    if (!data.from_hide) text += '<th style="' + attrFrom + table_attr + '">' + (data.from_name || '') + '</th>';
                    attrTime = '';
                    attrVal  = '';
                    attrFrom = '';
                }
                return {text: text, attrTime: attrTime, attrVal: attrVal, attrFrom: attrFrom, table_attr: table_attr};
            },
            renderLine: function (header, data, result, line) {
                var resLine = result[line] || {val: '&nbsp;', from: '&nbsp;'};
                var text = '<tr style="' + header.table_attr + '">';
                var time;
                if (resLine.ts) {
                    time = data.timeAsInterval ? vis.binds.basic.getTimeInterval(resLine.ts) : vis.binds.basic.formatDate(resLine.ts, data.format_date);
                } else {
                    time = '&nbsp;';
                }

                if (time !== '&nbsp;' && data.time_unit) time += data.time_unit;
                if (data.val_unit && resLine.val !== '&nbsp;' && resLine.val !== null && resLine.val !== undefined && resLine.val !== '') resLine.val += data.val_unit;
                if (data.from_unit && resLine.from !== '&nbsp;' && resLine.from !== null && resLine.from !== undefined && resLine.from !== '') resLine.from += data.from_unit;

                if (!data.time_hide) text += '<td style="' + header.attrTime + (data.time_attr || '') + ';' + header.table_attr + '">' + time + '</td>';
                if (!data.val_hide) {
                    if (resLine.val && typeof resLine.val === 'string' && resLine.val.match(/https?:\/\//)) resLine.val = '<a href="' + resLine.val + '" target="eventList">' + resLine.val.split('/').pop() + '</a>';
                    text += '<td style="' + header.attrVal  + (data.val_attr  || '') + ';' + header.table_attr + '">' + resLine.val + '</td>';
                }
                if (!data.from_hide) text += '<td style="' + header.attrFrom + (data.from_attr || '') + ';' + header.table_attr + '">' + (resLine.from || '') + '</td>';

                text += '</tr>\n';
                return text;
            },
            update: function ($div) {
                var data = $div.data('options');
                if (!data.oid || !data.instance) {
                    var header = vis.binds.history.eventList.header(data);
                    if (data.max_lines) {
                        for (var e = 0; e < data.max_lines; e++) {
                            header.text += vis.binds.history.eventList.renderLine(header, data, [], e);
                        }
                    }
                    header.text += '</table>';
                    $div.html(header.text);
                } else {
                    vis.getHistory(data.oid, {
                        instance:   data.instance,
                        count:      parseInt(data.max_lines, 10) || 10,
                        aggregate:  'none',
                        from:       !data.from_hide,
                        start:      vis.binds.history.eventList.intervals[data.time_interval_min] ? new Date().getTime() - vis.binds.history.eventList.intervals[data.time_interval_min] : undefined,
                        timeout:    2000
                    }, function (err, result) {
                        var e;
                        if (err) console.log(err);
                        if (result && result.length) {
                            var header = vis.binds.history.eventList.header(data);
                            var cnt = 0;
                            if (data.inverseOrder) {
                                for (e = 0; e < result.length; e++) {
                                    header.text += vis.binds.history.eventList.renderLine(header, data, result, e);
                                    if (data.max_lines && ++cnt >= data.max_lines) break;
                                }
                            } else {
                                for (e = result.length - 1; e >= 0; e--) {
                                    header.text += vis.binds.history.eventList.renderLine(header, data, result, e);
                                    if (data.max_lines && ++cnt >= data.max_lines) break;
                                }
                            }

                            if (data.max_lines) {
                                for (e = result.length; e < data.max_lines; e++) {
                                    header.text += vis.binds.history.eventList.renderLine(header, data, result, e);
                                }
                            }
                            header.text += '</table>';
                            $div.html(header.text);
                        } else {
                            var header = vis.binds.history.eventList.header(data);
                            header.text += '<tr><td colspan="3">' + (err || _('no data')) + '</td></tr>';
                            if (data.max_lines) {
                                for (e = 1; e < data.max_lines; e++) {
                                    header.text += vis.binds.history.eventList.renderLine(header, data, [], e);
                                }
                            }
                            header.text += '</table>';
                            $div.html(header.text);
                        }
                    });
                }
            },
            init: function (el, view, data) {
                var $div = $(el);

                var _data = {};
                for (var s  in data) {
                    if (s[0] !== '_' && data.hasOwnProperty(s) && typeof data[s] !== 'object' && typeof data[s] !== 'function') {
                        _data[s] = data[s];
                    }
                }
                data = null;
                $div.data('options', _data);

                if (_data.oid && _data.instance) {
                    if (_data.timeAsInterval && vis.binds.history.updateWidgets.indexOf(_data.wid) === -1) {
                        vis.binds.history.updateWidgets.push(_data.wid);
                        vis.binds.history.startIntervalUpdate();
                    }

                    var updateTimer = null;
                    function onChange () {
                        if (!updateTimer) {
                            updateTimer = setTimeout(function () {
                                updateTimer = null;
                                vis.binds.history.eventList.update($div);
                            }, 100);
                        }
                    }

                    vis.states.bind(_data.oid + '.val', onChange);
                    vis.states.bind(_data.oid + '.ts', onChange);

                    $div.data('bound', [_data.oid + '.val', _data.oid + '.ts'])
                        // remember bind handler
                        .data('bindHandler', onChange);
                }
                vis.binds.history.eventList.update($div);
            }
        },
        sparkLine: {
            update: function ($div) {
                var data = $div.data('options');
                if (!data.oid || !data.instance) {
                    $div.sparkline([0,0], {
                        width: $div.width(),
                        height: $div.height(),
                        lineColor: data.lineColor,
                        fillColor: data.fillColor,
                        chartRangeMin: data.min === '' || data.min === null || data.min === 'undefined' ? undefined : parseFloat(data.min),
                        chartRangeMax: data.max === '' || data.max === null || data.max === 'undefined' ? undefined : parseFloat(data.max),
                        lineWidth: parseInt(data.lineWidth, 10) || 1
                    });
                } else {
                    vis.getHistory(data.oid, {
                        instance:   data.instance,
                        count:      parseInt(data.points, 10) || 10,
                        step:       parseInt(data.time_interval_min, 10) || 60000,
                        aggregate:  data.aggregate || 'average',
                        start:      vis.binds.history.eventList.intervals[data.time_interval] ? new Date().getTime() - vis.binds.history.eventList.intervals[data.time_interval] : undefined,
                        end:        new Date().getTime() + 5000,
                        timeout:    2000
                    }, function (err, result) {
                        var data = $div.data('options');
                        if (err) console.log(err);
                        if (result && result.length) {
                            var values = [];
                            for (var i = 0; i < result.length; i++) {
                                values.push(result[i].val)
                            }
                            var barWidth = $div.width() / result.length - (parseFloat(data.barSpacing) || 1);

                            $div.sparkline(values, {
                                type: data.chartType || 'line',
                                width: $div.width(),
                                height: $div.height(),
                                lineColor: data.lineColor || undefined,
                                barColor: data.barColor || undefined,
                                negBarColor: data.negBarColor || undefined,
                                zeroColor: data.zeroColor || undefined,
                                fillColor: data.fillColor || undefined,
                                barWidth: barWidth,
                                disableTooltips: data.disableTooltips || undefined,
                                barSpacing: parseFloat(data.barSpacing) || 1,
                                chartRangeMin: data.min === '' || data.min === null || data.min === 'undefined' ? undefined : parseFloat(data.min),
                                chartRangeMax: data.max === '' || data.max === null || data.max === 'undefined' ? undefined : parseFloat(data.max),
                                lineWidth: parseInt(data.lineWidth, 10) || 1
                            });
                        } else {
                            $div.sparkline([0,0], {
                                width: $div.width(),
                                height: $div.height(),
                                lineColor: data.lineColor || undefined,
                                fillColor: data.fillColor || undefined,
                                chartRangeMin: data.min === '' || data.min === null || data.min === 'undefined' ? undefined : parseFloat(data.min),
                                chartRangeMax: data.max === '' || data.max === null || data.max === 'undefined' ? undefined : parseFloat(data.max),
                                lineWidth: parseInt(data.lineWidth, 10) || 1
                            });
                        }
                    });
                }

            },
            init: function (el, view, data) {
                var $div = $(el);

                var _data = {};
                for (var s  in data) {
                    if (s[0] !== '_' && data.hasOwnProperty(s) && typeof data[s] !== 'object' && typeof data[s] !== 'function') {
                        _data[s] = data[s];
                    }
                }
                data = null;
                $div.data('options', _data);

                if (_data.oid && _data.instance) {
                    var updateTimer = null;
                    function onChange () {
                        if (!updateTimer) {
                            updateTimer = setTimeout(function () {
                                updateTimer = null;
                                vis.binds.history.sparkLine.update($div);
                            }, 100);
                        }
                    }

                    vis.states.bind(_data.oid + '.val', onChange);
                    vis.states.bind(_data.oid + '.ts', onChange);

                    $div.data('bound', [_data.oid + '.val', _data.oid + '.ts'])
                    // remember bind handler
                        .data('bindHandler', onChange);

                    // update every x seconds
                    if (!vis.editMode) {
                        $div.data('timer', setInterval(function () {
                            vis.binds.history.sparkLine.update($div);
                        }, parseInt(vis.binds.history.eventList.intervals[_data.time_interval] / (parseInt(_data.points, 10) || 10), 10)));
                    }
                }
                vis.binds.history.sparkLine.update($div);
            }
        }
    };

    if (vis.editMode) {
        vis.binds.history.onHidChanged = function (widgetID, view, newId, fields) {
            var obj = vis.objects[newId];
            if (!obj || !obj.common) return null;
            var changed = [];
            var actualInstance = vis.views[view].widgets[widgetID].data.instance;
            // Check if actual instance still in options
            var firstInstance = '';
            var found = false;
            var custom = obj.common.custom || obj.common.history;
            for (var h in custom) {
                if (!custom.hasOwnProperty(h)) continue;
                if (custom[h].enabled) {
                    if (firstInstance === '') firstInstance = h;
                    if (h === actualInstance) {
                        found = true;
                        break;
                    }
                }
            }
            if (!found) {
                changed.push('instance');
                vis.views[view].widgets[widgetID].data.instance = firstInstance;
            }
            return changed.length ? changed : null;
        };
    }

    vis.binds.history.showVersion();
</script>

<script id="tplHistoryEventList"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="history"
        data-vis-name="Event list"
        data-vis-type="history"
        data-vis-prev='<img src="widgets/history/img/Prev_tplHistoryEventList.png"></img>'
        data-vis-attrs="oid/hid/onHidChanged;instance/history;"
        data-vis-attrs0="group.advanced;max_lines[6]/slider,1,100,1;time_interval_min/select,none,1 second,10 seconds,30 seconds,1 minute,2 minutes,5 minutes,10 minutes,30 minutes,1 hour,2 hours,4 hours,8 hours,12 hours,24 hours;"
        data-vis-attrs1="format_date[hh:mm:ss.sss]/auto,YYYY.MM.DD hh:mm:ss,DD.MM.YYYY hh:mm:ss,YYYY.MM.DD,DD.MM.YYYY,YYYY/MM/DD hh:mm:ss,YYYY/MM/DD,hh:mm:ss;timeAsInterval/checkbox;inverseOrder/checkbox;"
        data-vis-attrs2="group.columns;table_attr;header_attr;"
        data-vis-attrs3="time_name[Time];time_hide/checkbox;time_width[100]/slider,0,300,1;time_attr;time_unit;"
        data-vis-attrs4="val_name[Value];val_hide/checkbox;val_width/slider,0,300,1;val_attr[text-align: center§];val_unit;"
        data-vis-attrs5="from_name[Form];from_hide[true]/checkbox;from_width/slider,0,300,1;from_attr;from_unit;"
        data-vis-attrs6="class[vis-style-green-gray]/hidden"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow: hidden; width: 210px; height: 170px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.history.eventList.init(el, this.view, this.data) %>></div>
    </div>
</script>

<script id="tplHistorySparkLIne"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="history"
        data-vis-name="Sparkline"
        data-vis-type="history"
        data-vis-update-style="true"
        data-vis-prev='<img src="widgets/history/img/Prev_tplHistorySparkLine.png"></img>'
        data-vis-attrs="oid/hid/onHidChanged;instance/history;aggregate[average]/select,average,min,max,total;chartType[line]/select,line,bar;"
        data-vis-attrs0="points[20]/slider,1,100,1;time_interval[10 minutes]/select,1 second,10 seconds,30 seconds,1 minute,2 minutes,5 minutes,10 minutes,30 minutes,1 hour,2 hours,4 hours,8 hours,12 hours,24 hours;;min;max;disableTooltips/checkbox;"
        data-vis-attrs1="group.line;lineColor/color;fillColor/color;lineWidth/slider,1,10,1;"
        data-vis-attrs2="group.bar;barColor/color;negBarColor/color;zeroColor/color;min;max;barSpacing/slider,1,10,1;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow: hidden; width: 210px; height: 170px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.history.sparkLine.init(el, this.view, this.data) %>></div>
    </div>
</script>

<!-- --------------history.html--- END -->
<!-- --------------hqwidgets.html--- START -->
<!--
    ioBroker.vis high quality Widget-Set

    version: "1.1.4"

    Copyright 6'2014-2020 bluefox <dogafox@gmail.com>

-->
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/hqwidgets.css" />
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/hqwidgetsButtons.css"/>
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/checkbox.css" />
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/glossy.css" />
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/odometer-theme-car.css" />
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/odometer-theme-default.css" />
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/odometer-theme-digital.css" />
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/odometer-theme-minimal.css" />
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/odometer-theme-plaza.css" />
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/odometer-theme-slot-machine.css" />
<link rel="stylesheet" type="text/css" href="widgets/hqwidgets/css/odometer-theme-train-station.css" />

<script type="text/javascript" src="widgets/hqwidgets/js/jquery.knob.js"></script>
<script type="text/javascript" src="widgets/hqwidgets/js/odometer.min.js"></script>
<script type="text/javascript" src="widgets/hqwidgets/js/hqwidgets.js"></script>

<style>
        .odometer-leading .odometer-inside .odometer-digit:first-child,
        /*, .odometer-leading .odometer-inside .odometer-formatting-mark:nth-child(2),*/
        .odometer-leading .odometer-inside .odometer-digit:last-child {
            display: none
        }
</style>

<script id="tplHqButton"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="hqwidgets"
        data-vis-name="On/Off"
        data-vis-update-style="true"
        data-vis-type="ctrl,bool,button,state"
        data-vis-prev='<div id="prev_tplHqButton" style="position: relative; text-align: initial;padding: 10px !important"><div class="vis-widget_prev vis-hq-button-base" style="overflow: visible; width: 64px; height: 64px; border-radius: 64px; left: 543px; top: 37px; position: absolute;"><div class="vis-hq-main vis-hq-button-base-on" style="z-index: 1; border-radius: 64px;"><div class="vis-hq-middle"><table class="vis-hq-table hq-no-space" style="position: absolute; left: 4px; top: 2px;"><tbody><tr class="hq-no-space"><td class="hq-no-space"><div class="vis-hq-icon" style="text-align: center;"><img class="vis-hq-icon-img" style="height: 56px; width: auto;" src="img/bulb_off.png"></div></td></tr></tbody></table></div></div></div></div>'
        data-vis-attrs="oid[nothing_selected]/id/changedButtonId;oid-working;oid-battery;oid-signal;readOnly/checkbox;"
        data-vis-attrs0="group.value;min[false];max[true];pushButton/checkbox;"
        data-vis-attrs1="group.center;caption;captionOn;iconName[img~bulb_off.png]/image;iconOn/image;btIconWidth[56]/slider,0,400,1;offsetAuto[true]/checkbox;leftOffset[15]/slider,0,100,1;topOffset[55]/slider,0,100,1;"
        data-vis-attrs2="group.leftRight;hoursLastAction/nselect,,1,2,3,6,12,24,1024;timeAsInterval[true]/checkbox;format_date/auto,YYYY.MM.DD hh:mm:ss,DD.MM.YYYY hh:mm:ss,YYYY/MM/DD hh:mm:ss,hh:mm:ss,hh:mm;descriptionLeftDisabled/checkbox;descriptionLeft;infoLeftFontSize[12]/slider,6,50,1;infoRight;infoFontRightSize[12]/slider,6,50,1;infoColor/color;infoBackground/color;infoLeftPaddingLeft[15]/slider,0,100,1;infoLeftPaddingRight[50]/slider,0,100,1;infoRightPaddingLeft/slider,0,100,1;infoRightPaddingRight[15]/slider,0,100,1;"
        data-vis-attrs3="group.styles;styleNormal/style,hqwidgetsButtons glossy,-button,background;styleActive/style,hqwidgetsButtons glossy,-button,background;usejQueryStyle/checkbox;changeEffect/nselect,,waves,wobble,tada,swing,shake,rubberBand,pulse,flash,bounce;waveColor/color;testActive/checkbox;"
        data-vis-attrs4="group.ccontrol;urlTrue;urlFalse;oidTrue/id;oidFalse/id;oidTrueValue;oidFalseValue;"
        data-vis-filter="HM-LC-Sw1-Pl,HM-LC-Sw1-FM,HM-Dis-TD-T,HM-LC-Sw2-FM,HM-LC-Sw1PBU-FM,HM-LC-Sw1-SM,HM-LC-Sw1-FM,HM-LC-Sw2-FM,HM-LC-Sw4-PCB,HM-LC-Sw4-SM,HM-LC-Sw4-DR,HM-LC-Sw4-WM,HM-Sec-SFA-SM,HM-OU-CF-Pl,HM-OU-CFM-Pl,HMW-LC-Sw2-DR,HM-LC-Sw1-PB-FM,HM-LC-Sw2-PB-FM,HMW-IO-12-Sw14-DR,HMW-IO-12-Sw7-DR,HM-ES-PMSw1-Pl">
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 64px; height: 64px; border-radius: 64px" id="<%= this.data.attr('wid') %>"><%
         vis.binds.hqwidgets.button.init(this.data.wid, this.view, this.data, this.style);
    %></div>
</script>

<script id="tplHqDimmer"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="hqwidgets"
        data-vis-name="Dimmer"
        data-vis-type="ctrl,dimmer,button"
        data-vis-prev='<img src="widgets/hqwidgets/img/prev/Prev_hqwidgetsDimmer.png"></img>'
        data-vis-update-style="true"
        data-vis-attrs="oid[nothing_selected]/id/changedButtonId;oid-working;oid-battery;oid-signal;"
        data-vis-attrs0="group.value;unit[%];min[0];max[100];digits[0]/number;step[1];is_comma[true]/checkbox;"
        data-vis-attrs1="group.center;caption;iconName[img~bulb_off.png]/image;iconOn/image;btIconWidth[56]/slider,0,400,1;offsetAuto[true]/checkbox;leftOffset[15]/slider,0,100,1;topOffset[55]/slider,0,100,1;circleWidth[50]/slider,1,200,1;showValue[true]/checkbox;alwaysShow/checkbox;"
        data-vis-attrs2="group.leftRight;hoursLastAction/nselect,,1,2,3,6,12,24,1024;timeAsInterval[true]/checkbox;format_date/auto,YYYY.MM.DD hh:mm:ss,DD.MM.YYYY hh:mm:ss,YYYY/MM/DD hh:mm:ss,hh:mm:ss,hh:mm;descriptionLeftDisabled/checkbox;descriptionLeft;infoLeftFontSize[12]/slider,6,50,1;infoFontRightSize[12]/slider,6,50,1;infoColor/color;infoBackground/color;infoLeftPaddingLeft[15]/slider,0,100,1;infoLeftPaddingRight[50]/slider,0,100,1;infoRightPaddingLeft/slider,0,100,1;infoRightPaddingRight[15]/slider,0,100,1;"
        data-vis-attrs3="group.styles;styleNormal/style,hqwidgetsButtons glossy,-button,background;styleActive/style,hqwidgetsButtons glossy,-button,background;usejQueryStyle/checkbox;changeEffect/nselect,,waves,wobble,tada,swing,shake,rubberBand,pulse,flash,bounce;waveColor/color;testActive/checkbox"
        data-vis-filter="light.dimmer">
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 64px; height: 64px; border-radius: 64px" id="<%= this.data.attr('wid') %>"><%
        vis.binds.hqwidgets.button.init(this.data.wid, this.view, this.data, this.style, 'number');
    %></div>
</script>

<script id="tplHqInTemp"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="hqwidgets"
        data-vis-name="Inner temperature"
        data-vis-type="ctrl,temperature"
        data-vis-prev='<img src="widgets/hqwidgets/img/prev/Prev_hqwidgetsInTemp.png"></img>'
        data-vis-update-style="true"
        data-vis-attrs="oid[nothing_selected]/id,level.temperature/changedTempId;oid-humidity/id,value.humidity;oid-actual/id,value.temperature/changedTemperatureId;oid-drive/id,value.valve;valveBinary/checkbox;oid-battery/id,indicator.battery;"
        data-vis-attrs0="group.value;unit[°C];min[6];max[30];digits[0]/number;step[1];is_comma[true]/checkbox;"
        data-vis-attrs1="group.center;caption;iconName[img~Heating.png]/image;btIconWidth[45]/slider,0,400,1;offsetAuto[true]/checkbox;leftOffset[25]/slider,0,100,1;topOffset[55]/slider,0,100,1;circleWidth[50]/slider,1,100,1;showValue[true]/checkbox;alwaysShow/checkbox;midTextColor/color;"
        data-vis-attrs2="group.leftRight;hoursLastAction/nselect,,1,2,3,6,12,24,1024;timeAsInterval[true]/checkbox;format_date/auto,YYYY.MM.DD hh:mm:ss,DD.MM.YYYY hh:mm:ss,YYYY/MM/DD hh:mm:ss,hh:mm:ss,hh:mm;descriptionLeftDisabled/checkbox;descriptionLeft;infoLeftFontSize[12]/slider,6,50,1;infoFontRightSize[12]/slider,6,50,1;infoColor/color;infoBackground/color;infoLeftPaddingLeft[15]/slider,0,100,1;infoLeftPaddingRight[50]/slider,0,100,1;infoRightPaddingLeft/slider,0,100,1;infoRightPaddingRight[15]/slider,0,100,1;"
        data-vis-attrs3="group.styles;styleNormal[hq-button-base-intemp]/style,hqwidgetsButtons,-button,background;usejQueryStyle/checkbox;changeEffect/nselect,,waves,wobble,tada,swing,shake,rubberBand,pulse,flash,bounce;waveColor/color;testActive/checkbox;"
        data-vis-attrs4="group.chart;url;dialog_title;dialog_width;dialog_height;dialog_effect/effect;dialog_timeout/number,0,3600000,100;dialog_modal/checkbox;dialog_open/checkbox"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 64px; height: 64px; border-radius: 64px" id="<%= this.data.attr('wid') %>"><%
        this.data.temperature = true;
        vis.binds.hqwidgets.button.init(this.data.wid, this.view, this.data, this.style, 'number');
    %></div>
</script>

<script id="tplHqOutTemp"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="hqwidgets"
        data-vis-name="Outdoor temperature"
        data-vis-type="value,temperature"
        data-vis-prev='<img src="widgets/hqwidgets/img/prev/Prev_hqwidgetsOutTemp.png"></img>'
        data-vis-update-style="true"
        data-vis-attrs="oid-actual/id,value.temperature/changedTempId;oid-humidity/id,value.humidity;oid-battery/id,indicator.battery;"
        data-vis-attrs0="group.value;unit[°C];min[6];max[30];digits[0]/number;step[1];is_comma[true]/checkbox;"
        data-vis-attrs1="group.center;caption;iconName[img~Heating.png]/image;btIconWidth[45]/slider,0,400,1;offsetAuto[true]/checkbox;leftOffset[25]/slider,0,100,1;topOffset[55]/slider,0,100,1;circleWidth[50]/slider,1,100,1;showValue[true]/checkbox;alwaysShow/checkbox;midTextColor/color;"
        data-vis-attrs2="group.leftRight;hoursLastAction/nselect,,1,2,3,6,12,24,1024;timeAsInterval[true]/checkbox;format_date/auto,YYYY.MM.DD hh:mm:ss,DD.MM.YYYY hh:mm:ss,YYYY/MM/DD hh:mm:ss,hh:mm:ss,hh:mm;descriptionLeftDisabled/checkbox;descriptionLeft;infoLeftFontSize[12]/slider,6,50,1;infoFontRightSize[12]/slider,6,50,1;infoColor/color;infoBackground/color;infoLeftPaddingLeft[15]/slider,0,100,1;infoLeftPaddingRight[50]/slider,0,100,1;infoRightPaddingLeft/slider,0,100,1;infoRightPaddingRight[15]/slider,0,100,1;"
        data-vis-attrs3="group.styles;styleNormal[hq-button-base-outtemp]/style,hqwidgetsButtons,-button,background;usejQueryStyle/checkbox;changeEffect/nselect,,waves,wobble,tada,swing,shake,rubberBand,pulse,flash,bounce;waveColor/color;testActive/checkbox;"
        data-vis-attrs4="group.chart;url;dialog_title;dialog_width;dialog_height;dialog_effect/effect;dialog_timeout/number,0,3600000,100;dialog_modal/checkbox;dialog_open/checkbox"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 64px; height: 64px; border-radius: 64px" id="<%= this.data.attr('wid') %>"><%
        this.data.temperature = true;
        vis.binds.hqwidgets.button.init(this.data.wid, this.view, this.data, this.style, 'number');
    %></div>
</script>

<script id="tplHqShutter"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="hqwidgets"
        data-vis-type="ctrl;window;shutter"
        data-vis-name="Window and Shutter"
        data-vis-prev='<div id="prev_tplHqShutter" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev hq-blind-base vis-hq-button-base" style="overflow: visible; width: 110px; height: 90px; left: 109px; top: 74px; position: absolute; padding: 3px 4px 2px;"><table class="hq-blind hq-no-space" style="width: 100%; height: 100%"><tbody><tr><td><div class="hq-blind-blind1" style="border-width: 3px;border-color: #a9a7a8;"><div class="hq-blind-blind2" style="border-width: 3px; "><div class="hq-blind-blind3"><table class="hq-no-space" style="width: 100%; height: 100%; position: absolute"><tbody><tr class="hq-no-space hq-blind-position" style="height: 20%"><td class="hq-no-space hq-blind-blind"></td></tr><tr class="hq-no-space"><td class="hq-no-space"></td></tr></tbody></table><div class="hq-blind-blind4" style="border-width: 3px;border-color: #a5aaad;"><div class="hq-blind-handle hq-blind-handle-bg" style="border-width: 1px;top: 50%; width: 3px; height: 15%;left: calc(100% - 5px);"></div></div></div></div></div></td><td><div class="hq-blind-blind1" style="border-width: 3px;border-color: #a9a7a8;"><div class="hq-blind-blind2" style="border-width: 3px; "><div class="hq-blind-blind3"><table class="hq-no-space" style="width: 100%; height: 100%; position: absolute"><tbody><tr class="hq-no-space hq-blind-position" style="height: 20%"><td class="hq-no-space hq-blind-blind"></td></tr><tr class="hq-no-space"><td class="hq-no-space"></td></tr></tbody></table><div class="hq-blind-blind4 hq-blind-blind4-opened-left" style="border-width: 3px;border-color: #a5aaad;"><div class="hq-blind-handle hq-blind-handle-bg" style="border-width: 1px;top: 50%; width: 3px; height: 15%;-moz-transform-origin: 3px 3px;-ms-transform-origin: 3px 3px;-o-transform-origin: 3px 3px;-webkit-transform-origin: 3px 3px;transform-origin: 3px 3px;-moz-transform: rotate(-90deg);-ms-transform: rotate(-90deg);-o-transform: rotate(-90deg);-webkit-transform: rotate(-90deg);transform: rotate(-90deg);"></div></div></div></div></div></td></tr></tbody></table></div></div>'
        data-vis-attrs="oid/id,level.blind/changedWindowId;oid-working/id,indicator.working;min[0];max[100];border_width/slider,0,10,1;slide_count[1]/nselect,1,2,3,4,5,6;invert/checkbox;hide_timeout[2000];noAnimate/checkbox;popupHorizontalPos[center]/select,top,center,bottom;popupVerticalPos[center]/select,left,center,right;"
        data-vis-attrs0="group.leftRight;descriptionLeftDisabled/checkbox;descriptionLeft;infoLeftFontSize[12]/slider,6,50,1;show_value/checkbox;infoFontRightSize[12]/slider,6,50,1;infoColor/color;infoBackground/color;infoLeftPaddingLeft[15]/slider,0,100,1;infoLeftPaddingRight[50]/slider,0,100,1;infoRightPaddingLeft/slider,0,100,1;infoRightPaddingRight[15]/slider,0,100,1;"
        data-vis-attrs1="group.slides/byindex;slide_type(1-slide_count)/select,,left,right,top,bottom;oid-slide-sensor(1-slide_count)/id/changedSensorId;oid-slide-sensor-lowbat(1-slide_count)/id,indicator.battery;oid-slide-handle(1-slide_count)/id/changedSensorId;oid-slide-handle-lowbat(1-slide_count)/id,indicator.battery;"
        >
    <div class="vis-widget hq-blind-base <%== this.data.attr('class') %>" style="overflow:visible; width: 64px; height: 64px" id="<%= this.data.attr('wid') %>"><%
        vis.binds.hqwidgets.window.init(this.data.wid, this.view, this.data, this.style);
    %></div>
</script>

<script id="tplHqDoor"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="hqwidgets"
        data-vis-type="state;door"
        data-vis-name="Door"
        data-vis-prev='<div id="prev_tplHqDoor" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev hq-blind-base vis-hq-button-base" style="overflow: visible; width: 47px; height: 93px; padding: 3px 4px 2px;"><table class="vis-hq-main vis-hq-door vis-hq-no-space" style="border: 2px #8E8D8D solid;"><tbody><tr class="vis-hq-no-space"><td class="vis-hq-no-space vis-hq-door-empty-right"></td><td class="vis-hq-no-space vis-hq-door-sheet" style="width: 100%;"><div class="vis-hq-door-handle" style="left: 75%;"></div></td><td class="vis-hq-no-space vis-hq-door-empty-left" style="width: 0px; background: rgb(81, 81, 81);"></td></tr></tbody></table></div></div></div>'
        data-vis-attrs="oid/id,state/changedButtonId;oid-battery/id,indicator.battery;border_width/slider,0,10,1;invert/checkbox;door_type/select,,left,right;noAnimate/checkbox;"
        data-vis-attrs0="group.leftRight;descriptionLeftDisabled/checkbox;descriptionLeft;infoLeftFontSize[12]/slider,6,50,1;infoColor/color;infoBackground/color;infoLeftPaddingLeft[15]/slider,0,100,1;infoLeftPaddingRight[50]/slider,0,100,1;"
        >
    <div class="vis-widget hq-blind-base <%== this.data.attr('class') %>" style="overflow:visible; width: 50px; height: 100px" id="<%= this.data.attr('wid') %>"><%
        vis.binds.hqwidgets.door.init(this.data.wid, this.view, this.data, this.style);
    %></div>
</script>

<script id="tplHqLock"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplHqLock" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-hq-lock-base vis-hq-button-base hq-button-no-background" style="overflow: visible; width: 30px; height: 30px;" ><img src="widgets/hqwidgets/img/lockUnlocked.png" class="vis-hq-lock1" style="width: 100%; height:100%;"></div></div>'
        data-vis-set="hqwidgets"
        data-vis-type="control;lock"
        data-vis-name="Lock"
        data-vis-attrs="oid/id,state/changedLockId;oid-open/id;oid-battery/id,indicator.battery;noAnimate/checkbox;"
        data-vis-attrs0="group.image;closedIcon[widgets~hqwidgets~img~lockLocked.png]/image;openedIcon[widgets~hqwidgets~img~lockUnlocked.png]/image;"
        data-vis-attrs1="group.popup;popupRadius[75]/slider,50,150,1;buttonRadius[50]/slider,0,150,1;closeIcon[widgets~hqwidgets~img~lockLocked.png]/image;closeValue;closeStyle/style,hqwidgetsButtons glossy,-button,background;"
        data-vis-attrs2="openIcon[widgets~hqwidgets~img~lockUnlocked.png]/image;openValue;openStyle/style,hqwidgetsButtons glossy,-button,background;"
        data-vis-attrs3="openDoorIcon[widgets~hqwidgets~img~openDoor.png]/image;openDoorValue;openDoorStyle/style,hqwidgetsButtons glossy,-button,background;showTimeout[5000]/slider,0,30000,100;"
        data-vis-attrs4="group.leftRight;descriptionLeftDisabled/checkbox;descriptionLeft;infoLeftFontSize[12]/slider,6,50,1;infoFontRightSize[12]/slider,6,50,1;infoColor/color;infoBackground/color;infoLeftPaddingLeft[15]/slider,0,100,1;infoLeftPaddingRight[50]/slider,0,100,1;infoRightPaddingLeft/slider,0,100,1;infoRightPaddingRight[15]/slider,0,100,1;"
        data-vis-attrs5="group.styles;styleNormal[hq-button-no-background]/style,hqwidgetsButtons glossy,-button,background;styleActive[hq-button-no-background]/style,hqwidgetsButtons glossy,-button,background;usejQueryStyle/checkbox;changeEffect/nselect,,waves,wobble,tada,swing,shake,rubberBand,pulse,flash,bounce;waveColor/color;testActive/checkbox;"
        >
    <div class="vis-widget vis-hq-lock-base <%== this.data.attr('class') %>" style="overflow:visible; width: 30px; height: 30px" id="<%= this.data.attr('wid') %>"><%
        vis.binds.hqwidgets.lock.init(this.data.wid, this.view, this.data, this.style);
    %></div>
</script>


<!--script type="text/ejs" id="tplHqText" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="Text" data-vis-render-visible="true" data-vis-attrs="hqoptions">
    <%
    if (this && this.data && this.data.attr) {
        if (this.data.attr('hqoptions')){
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
        }
        else {
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqText", this.view);
        }
    }
    %>
</script>
<script type="text/ejs" id="tplHqInfo" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="Info" data-vis-render-visible="true" data-vis-attrs="hm_id;hqoptions">
    <%
    if (this && this.data && this.data.attr) {
        if (this.data.attr('hqoptions')){
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
        }
        else {
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqInfo", this.view);
        }
    }
    %>
</script>
<script type="text/ejs" id="tplHqImage" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="Image" data-vis-render-visible="true" data-vis-attrs="hqoptions">
    <%
    if (this && this.data && this.data.attr) {
        if (this.data.attr('hqoptions')){
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
        }
        else {
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqImage", this.view);
        }
    }
    %>
</script>
<script type="text/ejs" id="tplHqCam" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="IpCamera" data-vis-render-visible="true" data-vis-attrs="hm_id;hqoptions" data-hqwidgets-filter="HM-OU-CFM-Pl,HM-Sec-SFA-SM,HM-OU-CF-Pl,HM-Sec-SC,HM-SCI-3-FM,HMW-Sen-SC-12-DR,HMW-IO-12-Sw14-DR;.STATE,.OPEN,HM-Sec-Key-S,HM-LC-Sw4-WM,HM-LC-Sw1-Pl,HM-LC-SW1-FM,HM-LC-Sw2-FM,HM-LC-Sw1-SM,HM-LC-Sw4-PCB,HM-LC-Sw4-PCB,HM-LC-Sw4-SM,HM-LC-Sw1-BA-PCB">
    <%
    if (this && this.data && this.data.attr) {
        if (this.data.attr('hqoptions')){
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
        }
        else {
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqCam", this.view);
        }
    }
    %>
</script>
<script type="text/ejs" id="tplHqGong" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="Gong" data-vis-render-visible="true" data-vis-attrs="hm_id;hqoptions" data-hqwidgets-filter="HM-OU-CFM-Pl,HM-Sec-SFA-SM,HM-OU-CF-Pl,HM-Sec-SC,HM-SCI-3-FM,HMW-Sen-SC-12-DR,HMW-IO-12-Sw14-DR;.STATE,.OPEN,HM-Sec-Key-S,HM-LC-Sw4-WM,HM-LC-Sw1-Pl,HM-LC-SW1-FM,HM-LC-Sw2-FM,HM-LC-Sw1-SM,HM-LC-Sw4-PCB,HM-LC-Sw4-SM,HM-LC-Sw1-BA-PCB">
    <%
    if (this && this.data && this.data.attr) {
        if (this.data.attr('hqoptions')){
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
        }
        else {
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqGong", this.view);
        }
    }
    %>
</script>
<script type="text/ejs" id="tplHqGauge" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="Gauge" data-vis-render-visible="true" data-vis-attrs="hm_id;hqoptions">
    <%
    if (this && this.data && this.data.attr) {
		if (this.data.attr('hqoptions')){
			vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
		}
		else {
			vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqGauge", this.view);
		}
    }
    %>
</script>
<script type="text/ejs" id="tplHqMotion" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="Motion Detector" data-vis-render-visible="true" data-vis-attrs="hm_id;hqoptions" data-hqwidgets-filter=".STATE,.MOTION;">
    <%
    if (this && this.data && this.data.attr) {
		if (this.data.attr('hqoptions')){
			vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
		}
		else {
			vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqMotion", this.view);
		}
    }
    %>
</script>
<script type="text/ejs" id="tplHqLowbat" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="Battery Indicator" data-vis-render-visible="true" data-vis-attrs="hqoptions" data-hqwidgets-filter=".LOWBAT">
    <%
    if (this && this.data && this.data.attr) {
        if (this.data.attr('hqoptions')){
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
        }
        else {
            vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqLowbat", this.view);
        }
    }
    %>
</script>
<script type="text/ejs" id="tplHqIp" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="Ping device" data-vis-render-visible="true" data-vis-attrs="hqoptions" data-hqwidgets-filter="PING">
    <%
    if (this && this.data && this.data.attr) {
		if (this.data.attr('hqoptions')){
			vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
		} else {
			vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqIp", this.view);
		}
    }
    %>
</script>
<script type="text/ejs" id="tplHqCharts" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="Charts" data-vis-render-visible="true" data-vis-attrs="hqoptions">
    <%
    if (this && this.data && this.data.attr) {
		if (this.data.attr('hqoptions')){
			vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
		} else {
			vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqCharts", this.view);
		}
    }
    %>
</script>
<script type="text/ejs" id="tplHqEventlist" class="vis-tpl" data-vis-set="hqwidgets" data-vis-name="Eventlist" data-vis-render-visible="true" data-vis-attrs="hqoptions">
    <%
    if (this && this.data && this.data.attr) {
		if (this.data.attr('hqoptions')){
			vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, this.data.attr('hqoptions'), undefined, this.view);
		} else {
			vis.binds.hqWidgetsExt.hqButtonExt (this.data.wid, undefined, "tplHqEventlist", this.view);
		}
    }
    %>
</script-->

<script id="tplHqCheckbox"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="hqwidgets"
        data-vis-name="Checkbox"
        data-vis-type="ctrl,checkbox"
        data-vis-prev='<div id="prev_tplHqCheckbox" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev " style="overflow: visible; width: 108px; height: 35px"><div class="checkbox-small-orange-wrap"><div class="checkbox-small-orange-button"><input type="checkbox" style="display: none;"></div></div></div></div>'
        data-vis-update-style="true"
        data-vis-attrs="oid[nothing_selected]/id;val_false[false];val_true[true];staticValue;"
        data-vis-attrs0="checkboxSize[big]/select,big,small;checkboxColor[grey]/select,orange,blue,green,grey;checkboxColorOn[orange]/select,orange,blue,green,grey;readOnly/checkbox"
    >
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 216px; height: 68px" id="<%= this.data.attr('wid') %>"  data-vis-resizable='{"disabled":true, "handles":"e"}'><%
            vis.binds.hqwidgets.checkbox.init(this.data.wid, this.view, this.data, this.style);
    %></div>
</script>

<script id="tplHqCircle"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="hqwidgets"
        data-vis-name="CircleKnob"
        data-vis-update-style="true"
        data-vis-type="ctrl,number,dimmer,knob"
        data-vis-prev='<img src="widgets/hqwidgets/img/prev/Prev_hqwidgetsCircleKnob.png"></img>'
        data-vis-attrs="oid[nothing_selected]/id/changedButtonId;oid-working;oid-battery;oid-signal;"
        data-vis-attrs0="group.value;unit;min[0];max[100];digits[0]/number;step[1];is_comma[true]/checkbox;readOnly/checkbox;"
        data-vis-attrs1="group.center;caption;hideNumber/checkbox;"
        data-vis-attrs2="group.arc;angleOffset/slider,0,360,1;angleArc/slider,0,360,1;displayPrevious[true]/checkbox;"
        data-vis-attrs3="group.style;cursor/slider,1,350,1;thickness/slider,0.05,1,0.05;color/color;bgcolor/color;linecap/checkbox;anticlockwise/checkbox"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 64px; height: 64px" id="<%= this.data.attr('wid') %>"><%
        vis.binds.hqwidgets.circle.init(this.data.wid, this.view, this.data);
        %><input type="text" style="display: none"/></div>
</script>
<script id="tplHqOdometer"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="hqwidgets"
        data-vis-name="Odometer"
        data-vis-beta="true"
        data-vis-update-style="true"
        data-vis-type="val,number"
        data-vis-prev='<img src="widgets/hqwidgets/img/prev/Prev_hqOdometer.png"></img>'
        data-vis-attrs="oid;style[car]/nselect,car,default,digital,minimal,plaza,slot-machine,train-station;group.extended;format[(ddd),dd];factor[1];leadingZeros[true]/checkbox"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 125px; height: 42px; font-size: 24px" id="<%= this.data.attr('wid') %>"></div>
    <% vis.binds.hqwidgets.odometer(this.view, this.data) %>
</script>

<!-- --------------hqwidgets.html--- END -->
<!-- --------------info.html--- START -->
<link rel="stylesheet" href="widgets/info/css/style.css" />

<script type="text/javascript" src="../socket.io/socket.io.js"></script>
<script type="text/javascript" src="../adapter/info/lib/js/commons.js"></script>
<script type="text/javascript" src="../adapter/info/lib/js/popupnews.js"></script>
<script type="text/javascript" src="widgets/info/js/info.js"></script>

<script id="tplInfoMessages"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/info/img/messages.png" style="width: 115px;"></img>'
        data-vis-attrs="oid[info.0.newsfeed]/id"
        data-vis-set="info"
        data-vis-type="data"
        data-vis-name="Messages">
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 530px; height: 210px" id="<%= this.data.attr('wid') %>">
    <% vis.binds.info.createMessage(this.data.wid, this.view, this.data, this.style); %>
    </div>
</script>

<script id="tplInfoCalendar"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/info/img/calendar.png" style="width: 115px;"></img>'
        data-vis-attrs="width[400]/number;height[400]/number;bgcolor[ffffff]/text;mode[AGENDA]/select,AGENDA,MONTH,WEEK"
        data-vis-set="info"
        data-vis-type="data"
        data-vis-name="Event calendar">  
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 400px; height: 400px" id="<%= this.data.attr('wid') %>">
    <% vis.binds.info.createCalendar(this.data.wid, this.view, this.data, this.style); %>
    </div>
</script>

<!-- Popup News -->
<div id="popupNewsTemplate" style="display: none;">
    <div class="info-adapter-class">
        <div class="alert alert-info alert-dismissible row" role="alert">
            <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <div class="col-xs-2"><i class="fa fa-exclamation-triangle fa-5x"></i></div>
            <div class="col-xs-9">
                <h2 class="popupnews_title"></h2>
                <p class="popupnews_content"></p>
            </div>
        </div>
    </div>
</div>
<!-- / Popup News -->
<!-- --------------info.html--- END -->
<!-- --------------jqplot.html--- START -->
<link rel="stylesheet" type="text/css" href="widgets/jqplot/css/jquery.jqplot.min.css" />

<script type="text/javascript" src="widgets/jqplot/js/jquery.jqplot.min.js"></script>

<script type="text/javascript">

    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {
            "background":           {"en": "Background",            "de": "Hintergrund",                    "ru": "Фон"},
            "group_ticks":          {"en": "Ticks",                 "de": "Tick",                           "ru": "Штрихи"},
            "ticks":                {"en": "Ticks-Namen",           "de": "Tick-Beschriftungen",            "ru": "Подписи штрихов"},
            "ticks_tooltip":        {"en": "Divide with semicolon, e.g '10;50;70'", "de": "Mit Semikolon trennen, z.B. '10;50;70'", "ru": "Разделять точкой запятой, например '10;50;70'"},
            "showTickLabels":       {"en": "Show tick labels",      "de": "Zeige Tick-Beschriftungen",      "ru": "Показать подписи"},
            "tickPadding":          {"en": "Tick padding",          "de": "Tick-Abstand",                   "ru": "Отступ штрихов"},
            "group_intervals":      {"en": "Intervals",             "de": "Intervalle",                     "ru": "Интервалы"},
            "intervals":            {"en": "Intervals",             "de": "Intervalle",                     "ru": "Отрезки"},
            "intervals_tooltip":    {"en": "Divide with semicolon, e.g '10;50;70'", "de": "Mit Semikolon trennen, z.B. ''10;50;70'", "ru": "Разделять точкой запятой, например '10;50;70'"},
            "intervalColors":       {"en": "Interval colors",       "de": "Intervallfarben",                "ru": "Цвета интервалов"},
            "intervalColors_tooltip": {"en": "Divide with semicolon, e.g 'green;#0000FF;red'", "de": "Mit Semikolon trennen, z.B. 'green;#0000FF;red'", "ru": "Разделять точкой запятой, например 'green;#0000FF;red'"},
            "intervalInnerRadius":  {"en": "Inner interval raduis", "de": "Intervall-Radius innen",         "ru": "Внутренний радиус интервалов"},
            "intervalOuterRadius":  {"en": "Outer interval radius", "de": "Intervall-Radius außen",         "ru": "Внешний радиус интервалов"},
            "diameter":             {"en": "Diameter",              "de": "Durchmesser",                    "ru": "Диаметер"},
            "padding":              {"en": "Padding",               "de": "Abstand",                        "ru": "Отступ"},
            "group_shadow":         {"en": "Shadow",                "de": "Schatten",                       "ru": "Тень"},
            "shadowOffset":         {"en": "shadowOffset",          "de": "Schatten offset",                "ru": "Сдвиг тени"},
            "shadowAlpha":          {"en": "Shadow transparence",   "de": "Schatten Alpha",                 "ru": "Прозрачость тени"},
            "shadowDepth":          {"en": "Shadow depth",          "de": "Schattentiefe",                  "ru": "Глубина тени"},
            "group_ring":           {"en": "Ring",                  "de": "Rand",                           "ru": "Кайма"},
            "ringColor":            {"en": "Ring color",            "de": "Randfarbe",                      "ru": "Цвет окантовки"},
            "ringWidth":            {"en": "Ring width",            "de": "Randbreite",                     "ru": "Ширина окантовки"},
            "group_needle":         {"en": "Needle",                "de": "Zeiger",                         "ru": "Стрелка"},
            "needleThickness":      {"en": "Needle thickness",      "de": "Zeigerdicke",                    "ru": "Ширина стрелки"},
            "needlePad":            {"en": "Needle pad",            "de": "Zeigeroffset",                   "ru": "Радиус основания"},
            "hubRadius":            {"en": "Hub radius",            "de": "Zeigerbasis-Radius",             "ru": "Основание стрелки"}
        });
    }

    vis.binds.jqplot = {
        gauge: function (el, data) {
            var $this = $(el).find('.jqplot-gauge');

            var id = $(el).attr('id');
            if (id && id.match(/_removed$/)) {
                return;
            }

            if (!$this.length || !$this.is(':visible')) {
                setTimeout(function () {
                    vis.binds.jqplot.gauge(el, data);
                }, 100);
                return;
            }

            if (!data) return;

            var options = {
                title: data.title,
                seriesDefaults: {
                    rendererOptions: {
                        min:            (data.min ? parseFloat(data.min) : undefined),
                        max:            (data.max ? parseFloat(data.max) : undefined),
                        ticks:          (data.ticks ? jQuery.map(data.ticks.split(';'), Number) : undefined),
                        intervals:      (data.intervals ? jQuery.map(data.intervals.split(';'), Number) : undefined),
                        intervalColors: (data.intervalColors ? data.intervalColors.split(';') : undefined),
                        label:          data.label,
                        showTickLabels: ((data.showTickLabels === 'false' || data.showTickLabels === false) ? false : undefined),
                        intervalInnerRadius: (!data.intervalInnerRadius ? undefined : parseInt(data.intervalInnerRadius, 10)),
                        intervalOuterRadius: (!data.intervalOuterRadius ? undefined : parseInt(data.intervalOuterRadius, 10)),
                        diameter:       (!data.diameter ? undefined : parseInt(data.diameter, 10)),
                        padding:        (!data.padding ? undefined : parseInt(data.padding, 10)),
                        shadowOffset:   (!data.shadowOffset ? undefined : parseInt(data.shadowOffset, 10)),
                        shadowAlpha:    (!data.shadowAlpha ? undefined : parseInt(data.shadowAlpha, 10)),
                        shadowDepth:    (!data.shadowDepth ? undefined : parseInt(data.shadowDepth, 10)),
                        background:     data.background, ringColor: data.ringColor,
                        tickColor:      data.tickColor,
                        ringWidth:      (!data.ringWidth ? undefined : parseInt(data.ringWidth, 10)),
                        hubRadius:      (!data.hubRadius ? undefined : parseInt(data.hubRadius, 10)),
                        tickPadding:    (!data.tickPadding ? undefined : parseInt(data.tickPadding, 10)),
                        needleThickness: (!data.needleThickness ? undefined : parseInt(data.needleThickness, 10)),
                        needlePad:      (!data.needlePad ? undefined : parseInt(data.needlePad, 10))
                    }
                }
            };
            if (options.seriesDefaults.rendererOptions.ticks && options.seriesDefaults.rendererOptions.ticks.length === 1) {
                options.seriesDefaults.rendererOptions.ticks[1] = options.seriesDefaults.rendererOptions.ticks[0];
            }

            $(el).data('options', data);
            $this.html('');

            try {
                var jqplotOptions = $.extend(true, {
                    title: {show: false},
                    grid: {
                        background: 'transparent'
                    },
                    seriesDefaults: {
                        renderer: $.jqplot.MeterGaugeRenderer,
                        rendererOptions: {
                            min: 0,
                            max: 100
                        }
                    }
                }, options);

                var oid = $this.attr('data-oid');
                var series;
                if (oid !== 'nothing_selected' && vis.states[oid + '.val'] !== undefined) {
                    series = [[vis.states[oid + '.val']]];
                } else {
                    series = [[1, 0]];
                }

                function onChange(e, newVal/* , oldVal */) {
                    plot.series[0].data = [[1, newVal]];
                    plot.redraw();
                }

                var bound = [];

                if (oid) {
                    vis.states.bind(oid + '.val', onChange);
                    bound.push(oid + '.val');
                }
                var plot = $.jqplot($this.attr('id'), series, jqplotOptions);

                if (bound.length) {
                    // remember all ids, that bound
                    $(el).data('bound', bound);
                    // remember bind handler
                    $(el).data('bindHandler', onChange);
                }
            } catch(e) {
                servConn.logError('Cannot render widget jqplot: ' + e);
            }

            if (vis.editMode) {
                $(el).resize(function () {
                    var timer = $(this).data('timer');
                    if (timer) {
                        clearTimeout(timer);
                    }
                    var that = this;
                    $(this).data('timer', setTimeout(function () {
                        $(that).data('timer', null);
                        $('#' + $(that).attr('id') + '_gauge').html('');
                        vis.binds.jqplot.gauge(that, $(that).data('options'));
                    }, 300));
                });

                $(el).data('destroy', function (id, $widget) {
                    $widget.off('resize');
                });
            }
        }
    };
</script>

<script type="text/ejs"
        id="tplJqplotGauge"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/jqplot/img/Prev_MeterGauge.png"></img>'
        data-vis-set="jqplot"
        data-vis-type="number"
        data-vis-name="MeterGauge"
        data-vis-attrs="oid;title;min/number;max/number;label;background/color;padding/slider,0,50,1;group.ticks;ticks;showTickLabels[true]/checkbox;tickPadding/slider,0,50,1;group.intervals;intervals;intervalColors;intervalInnerRadius/slider,0,550,1;intervalOuterRadius/slider,0,550,1;group.shadow;shadowOffset/slider,0,50,1;shadowAlpha/slider,0,1,0.05;shadowDepth/slider,0,50,1;group.ring;ringColor/color;ringWidth/slider,0,150,1;group.needle;needleThickness/slider,0,50,1;needlePad/slider,0,150,1;hubRadius/slider,0,150,1"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:460px; height:280px;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.jqplot.gauge(el, data) %>>
        <div class="vis-widget-body" style="width: 100%; height: 100%">
            <div class="jqplot-gauge" id="_<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" style="width: 100%; height: 100%"/>
        </div>
    </div>
</script>

<!-- --------------jqplot.html--- END -->
<!-- --------------jqui-mfd.html--- START -->
<!--
    ioBroker.vis JQuery widgets with MFD icons

    version: "1.0.12"

    Copyright 6'2014-2018 bluefox<dogafox@gmail.com>,
                     2014 hobbyquaker<hobbyquaker@ccu.io>

-->
 <style type="text/css">
 .hue-slider-hue.ui-slider {
     background-image: url(widgets/jqui/img/hue.png);
     background-size: 100%;
 }

 .hue-slider-ct.ui-slider {
     background-image: url(widgets/jqui/img/ct.png);
     background-size: 100%;
 }
</style>

<script type="text/javascript">
    'use strict';

    if (vis.editMode) {
        $.extend(systemDictionary, {
            "autoclose":    {"en": "Auto close",            "de": "Auto-zu",                "ru": "Автозакрытие"},
            "modal":        {"en": "Modal",                 "de": "Modal",                  "ru": "Модальное"},
            "invert_state": {"en": "Invert state",          "de": "Invertiere Zustand",     "ru": "Инвертировать состояние"},
            "asButton":     {"en": "Button rectangle",      "de": "Knopf-Viereck",          "ru": "Фон кнопки"},
            "icon_off":     {"en": "Icon for OFF",          "de": "Symbol für AUS",         "ru": "Иконка для ВЫКЛ"},
            "iconColor_off":{"en": "Icon color for OFF",    "de": "Symbolfarbe für AUS",    "ru": "Цвет иконки для ВЫКЛ"},
            "icon_on":      {"en": "Icon for ON",           "de": "Symbol für AN",          "ru": "Иконка для ВКЛ"},
            "iconColor_on": {"en": "Icon color for ON",     "de": "Symbolfarbe für AN",     "ru": "Цвет иконки для ВКЛ"},
            "closed_value": {"en": "Value for CLOSED",      "de": "Wert für ZU",            "ru": "Значение для ЗАКРЫТО"},
            "tilted_value": {"en": "Value for TILTED",      "de": "Wert für GEKIPPT",       "ru": "Значение для ОТКИНУТО"},
            "opened_value": {"en": "Value for OPENED",      "de": "Wert für AUF",           "ru": "Значение для ОТКРЫТО"},
            "closed_icon":  {"en": "Icon for CLOSED",       "de": "Symbol für ZU",          "ru": "Иконка для ЗАКРЫТО"},
            "closed_iconColor":{"en": "Icon color for CLOSED", "de": "Symbolfarbe für ZU",  "ru": "Цвет иконки для ЗАКРЫТО"},
            "tilted_icon":  {"en": "Icon for TILTED",       "de": "Symbol für GEKIPPT",     "ru": "Иконка для ОТКИНУТО"},
            "tilted_iconColor":{"en": "Icon color for TILTED", "de": "Symbolfarbe für GEKIPPT", "ru": "Цвет иконки для ОТКИНУТО"},
            "opened_icon":  {"en": "Icon for OPENED",       "de": "Symbol für AUF",         "ru": "Иконка для ОТКРЫТО"},
            "opened_iconColor":{"en": "Icon color for OPENED", "de": "Symbolfarbe für AUF", "ru": "Цвет иконки для ОТКРЫТО"},
            "invert_value": {"en": "Invert value",          "de": "Invertiere Wert",        "ru": "Инвертировать значение"},
            "show_active":  {"en": "Show active background", "de": "Zeige aktiven Hintergrund", "ru": "Показать активный фон"},
            "set_oid":      {"en": "Set temperature ID",    "de": "Soll-Temperature ID",    "ru": "ID задаваемой температуры"},
            "temp_oid":     {"en": "Actual temperature ID", "de": "Ist-Temperature ID",     "ru": "ID актуальной температуры"},
            "drive_oid":    {"en": "Valve position ID",     "de": "VentilID",               "ru": "ID Положения вентиля"},
            "label_set":    {"en": "Label for 'set'",       "de": "Beschriftung für 'Soll'", "ru": "Надпись для 'задаваемой'"},
            "label_temp":   {"en": "Label for 'actual'",    "de": "Beschriftung für 'Ist'", "ru": "Надпись для 'актуальной'"},
            "label_drive":  {"en": "Label for position",    "de": "Beschriftung für Ventil", "ru": "Надпись для вентиля"},
            "src_url":      {"en": "Stream URL",            "de": "Stream URL",             "ru": "URL потока"},
            "qtsrc_url":    {"en": "Stream URL (qtsrc)",    "de": "Stream URL (qtsrc)",     "ru": "URL потока (qtsrc)"},
            "type_application": {"en": "Application mime-type", "de": "Applikationstyp (mime)",   "ru": "Тип приложения (mime)"},
            "plugin":       {"en": "Plug-in",               "de": "Plugin",                 "ru": "Плагин"},
            "autoplay":     {"en": "Auto-play",             "de": "Automatisch abspielen",  "ru": "Автостарт"},
            "url":          {"en": "URL",                   "de": "URL",                    "ru": "URL"},
            "interval":     {"en": "Update interval(ms)",   "de": "Update-Intervall(ms)",   "ru": "Интервал обновления (мс)"},
            "group_icons":  {"en": "Icons",                 "de": "Symbole",                "ru": "Иконки"},
            "group_values": {"en": "Values",                "de": "Werte",                  "ru": "Значения"},
            "icon_interval": {"en": "Update interval(ms)",        "de": "Updateintervall(ms)", "ru": "Интервал обновления (мс)"},
            "iconColor":    {"en": "Icon color",            "de": "Symbolfarbe",            "ru": "Цвет иконки"},
            "group_images": {"en": "Icons",                 "de": "Symbole",                "ru": "Картинки"},
            "group_colors": {"en": "Icon colors (SVG)",     "de": "Symbolfarben (SVG)",     "ru": "Цвета картинки (SVG)"},
            "icon0":        {"en": "Icon 0%",               "de": "Symbol für 0%",          "ru": "Картинка для 0%"},
            "iconColor0":   {"en": "Icon color 0%",         "de": "Symbolfarbe bei 0%",     "ru": "Цвет для 0%"},
            "iconValue0":   {"en": "Icon value 0%",         "de": "Symbolwert für 0%",      "ru": "Значение для 0%"},
            "iconValue0_tooltip":   {
                "en": "Icon value when defined picture must be shown",
                "de": "Symbolwert bei welchem sollte das Bild erscheinen",
                "ru": "Значение, когда должна появлятся эта иконка"
            },
            "icon1":        {"en": "Icon 10%",              "de": "Symbol für 10%",         "ru": "Картинка 10%"},
            "iconColor1":   {"en": "Icon color 10%",        "de": "Symbolfarbe bei 10%",    "ru": "Цвет для 0%"},
            "iconValue1":   {"en": "Icon value 10%",        "de": "Symbolwert für 10%",     "ru": "Значение для 0%"},
            "icon2":        {"en": "Icon 20%",              "de": "Symbol für 20%",         "ru": "Картинка 20%"},
            "iconColor2":   {"en": "Icon color 20%",        "de": "Symbolfarbe bei 20%",    "ru": "Цвет для 0%"},
            "iconValue2":   {"en": "Icon value 20%",        "de": "Symbolwert für 20%",     "ru": "Значение для 0%"},
            "icon3":        {"en": "Icon 30%",              "de": "Symbol für 30%",         "ru": "Картинка 30%"},
            "iconColor3":   {"en": "Icon color 30%",        "de": "Symbolfarbe bei 30%",    "ru": "Цвет для 0%"},
            "iconValue3":   {"en": "Icon value 30%",        "de": "Symbolwert für 30%",     "ru": "Значение для 0%"},
            "icon4":        {"en": "Icon 40%",              "de": "Symbol für 40%",         "ru": "Картинка 40%"},
            "iconColor4":   {"en": "Icon color 40%",        "de": "Symbolfarbe bei 40%",    "ru": "Цвет для 0%"},
            "iconValue4":   {"en": "Icon value 40%",        "de": "Symbolwert für 40%",     "ru": "Значение для 0%"},
            "icon5":        {"en": "Icon 50%",              "de": "Symbol für 50%",         "ru": "Картинка 50%"},
            "iconColor5":   {"en": "Icon color 50%",        "de": "Symbolfarbe bei 50%",    "ru": "Цвет для 0%"},
            "iconValue5":   {"en": "Icon value 50%",        "de": "Symbolwert für 50%",     "ru": "Значение для 0%"},
            "icon6":        {"en": "Icon 60%",              "de": "Symbol für 60%",         "ru": "Картинка 60%"},
            "iconColor6":   {"en": "Icon color 60%",        "de": "Symbolfarbe bei 60%",    "ru": "Цвет для 0%"},
            "iconValue6":   {"en": "Icon value 60%",        "de": "Symbolwert für 60%",     "ru": "Значение для 0%"},
            "icon7":        {"en": "Icon 70%",              "de": "Symbol für 70%",         "ru": "Картинка 70%"},
            "iconColor7":   {"en": "Icon color 70%",        "de": "Symbolfarbe bei 70%",    "ru": "Цвет для 0%"},
            "iconValue7":   {"en": "Icon value 70%",        "de": "Symbolwert für 70%",     "ru": "Значение для 0%"},
            "icon8":        {"en": "Icon 80%",              "de": "Symbol für 80%",         "ru": "Картинка 80%"},
            "iconColor8":   {"en": "Icon color 80%",        "de": "Symbolfarbe bei 80%",    "ru": "Цвет для 0%"},
            "iconValue8":   {"en": "Icon value 80%",        "de": "Symbolwert für 80%",     "ru": "Значение для 0%"},
            "icon9":        {"en": "Icon 90%",              "de": "Symbol für 90%",         "ru": "Картинка 90%"},
            "iconColor9":   {"en": "Icon color 90%",        "de": "Symbolfarbe bei 90%",    "ru": "Цвет для 0%"},
            "iconValue9":   {"en": "Icon value 90%",        "de": "Symbolwert für 90%",     "ru": "Значение для 0%"},
            "icon10":       {"en": "Icon 100%",             "de": "Symbol für 100%",        "ru": "Картинка 100%"},
            "iconColor10":  {"en": "Icon color 100%",       "de": "Symbolfarbe bei 100%",   "ru": "Цвет для 0%"},
            "iconValue10":  {"en": "Icon value 100%",       "de": "Symbolwert für 100%",    "ru": "Значение для 0%"},
            "iconOff":      {"en": "Inactive Icon",         "de": "Inaktivbild",            "ru": "Неактиваня картинка"},
            "textOff":      {"en": "Text for Off",          "de": "Text für Aus",           "ru": "Надпись для Выкл"},
            "textOn":       {"en": "Text for On",           "de": "Text für Ein",           "ru": "Надпись для Вкл"},
            "iconColorOff": {"en": "Inactive Icon color",   "de": "Inaktive Symbolfarbe",   "ru": "Цвет не активной иконки"},
            "iconColorOn":  {"en": "Active Icon color",     "de": "Aktive Symbolfarbe",     "ru": "Цвет активной иконки"},
            "show_value":   {"en": "Show value",            "de": "Wert zeigen",            "ru": "Показывать значение"},
            "units":        {"en": "Units",                 "de": "Einheit",                "ru": "Единицы измерения"},
            "roundnumber":  {"en": "Decimal Place",         "de": "Nachkommastellen",       "ru": "Decimal Place"}
        });
    }

    $.extend(systemDictionary, {
        "off":      {"en": "off",       "de": "aus",    "ru": "выкл"},
        "on":       {"en": "on",        "de": "an",     "ru": "вкл"},
        "closed":   {"en": "closed",    "de": "zu",     "ru": "закр."},
        "open":     {"en": "open",      "de": "auf",    "ru": "откр."}
    });

vis.binds['jqui-mfd'] = {
    version: "1.0.12",
    isNotEmpty: function (val) {
        return val !== '' && val !== null && val !== undefined;
    },
    removeSvg: function (wid) {
        $('#' + wid).find('svg').remove();
    },
    showVersion: function () {
        if (vis.binds['jqui-mfd'].version) {
            console.log('Version vis-jqui-mfd: ' + vis.binds['jqui-mfd'].version);
            vis.binds['jqui-mfd'].version = null;
        }
    }
};
vis.binds['jqui-mfd'].showVersion();
</script>

<script id="tplMfdLight" 
        type="text/ejs" 
        class="vis-tpl" 
        data-vis-set="jqui-mfd"
        data-vis-type="val;light;state"
        data-vis-prev='<div id="prev_tplMfdLight" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget ui-widget ui-button ui-corner-all ui-state-default" style="width: 70px; height: 70px;"> <div class="vis-widget-prev-body"> <img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" width="100%" src="widgets/jqui-mfd/img/light_light_dim.png"></div></div></div>'
        data-vis-name="Light/Dimmer"
        data-vis-attrs="oid;min;max;invert_icon/checkbox;asButton[true]/checkbox;iconColor/color;"
        data-vis-attrs0="group.colors;iconColor0/color;iconColor1/color;iconColor2/color;iconColor3/color;iconColor4/color;iconColor5/color;iconColor6/color;iconColor7/color;iconColor8/color;iconColor9/color;iconColor10/color;"
        >
    <div data-oid="<%= this.data.attr('oid') %>" class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default ui-state-active' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute" data-min="<%= this.data.attr('min') %>" data-max="<%= this.data.attr('max') %>" <%= (el) -> this.data.attr('asButton') ? vis.binds.jqueryui.active(el) : '' %> >
        <div class="vis-widget-body" <%= (el) -> vis.preloadImages(['widgets/jqui-mfd/img/light_light_dim_100.png','widgets/jqui-mfd/img/light_light_dim_90.png','widgets/jqui-mfd/img/light_light_dim_80.png','widgets/jqui-mfd/img/light_light_dim_70.png','widgets/jqui-mfd/img/light_light_dim_60.png','widgets/jqui-mfd/img/light_light_dim_50.png','widgets/jqui-mfd/img/light_light_dim_40.png','widgets/jqui-mfd/img/light_light_dim_30.png','widgets/jqui-mfd/img/light_light_dim_20.png','widgets/jqui-mfd/img/light_light_dim_10.png','widgets/jqui-mfd/img/light_light_dim.png']);  %>>
            <%
            var styles = '';
            if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
                styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
            }

            var max = (this.data.attr('max') !== undefined) ? this.data.attr('max') : 100;
            var min = (this.data.attr('min') !== undefined) ? this.data.attr('min') : 0;
            
            if (typeof max === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
            if (typeof min === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);
            
            var str = vis.states.attr(this.data.oid + '.val');
            var val = parseFloat(str);
            if (str === true  || str === 'true')  val = max;
            if (str === false || str === 'false') val = min;
            var image = '';
            var imageColor = null;
            if (val >= max) {
               image = "light_light_dim_100";
               imageColor = this.data.attr('iconColor10');
            } else if (val >= min + (max - min) * 0.9) {
               image = "light_light_dim_90";
               imageColor = this.data.attr('iconColor9');
            } else if (val >= min + (max - min) * 0.8) {
               image = "light_light_dim_80";
               imageColor = this.data.attr('iconColor8');
            } else if (val >= min + (max - min) * 0.7) {
               image = "light_light_dim_70";
               imageColor = this.data.attr('iconColor7');
            } else if (val >= min + (max - min) * 0.6) {
               image = "light_light_dim_60";
               imageColor = this.data.attr('iconColor6');
            } else if (val >= min + (max - min) * 0.5) {
               image = "light_light_dim_50";
               imageColor = this.data.attr('iconColor5');
            } else if (val >= min + (max - min) * 0.4) {
               image = "light_light_dim_40";
               imageColor = this.data.attr('iconColor4');
            } else if (val >= min + (max - min) * 0.3) {
               image = "light_light_dim_30";
               imageColor = this.data.attr('iconColor3');
            } else if (val >= min + (max - min) * 0.2) {
               image = "light_light_dim_20";
               imageColor = this.data.attr('iconColor2');
            } else if (val >= min + (max - min) * 0.1) {
               image = "light_light_dim_10";
               imageColor = this.data.attr('iconColor1');
            } else if (val >= min + (max - min) * 0.01) {
               image = "light_light_dim_00";
               imageColor = this.data.attr('iconColor0');
            } else {
               image = "light_light_dim";
               imageColor = this.data.attr('iconColor0');
            }

            if (!vis.binds['jqui-mfd'].isNotEmpty(imageColor)) {
               imageColor = this.data.attr('iconColor');
            }

            if (imageColor) {
            %>
                <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/<%= image %>.svg" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, imageColor) %>/>
            <%
               } else {
            %>
                <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/<%= image %>.png" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% } %>
        </div>
    </div>
</script>

<script id="tplMfdLightCtrl"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMfdLight" style="position: relative; text-align: initial;padding: 4px "><div data-oid="dev1" class="vis-widget_prev  vis-widget ui-widget ui-button ui-corner-all ui-state-default ui-state-active" style="width: 70px; height: 70px;"> <div class="vis-widget-prev-body"> <img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" width="100%" src="widgets/jqui-mfd/img/light_light_dim.png"> </div> </div></div>'
        data-vis-set="jqui-mfd"
        data-vis-type="light;ctrl"
        data-vis-name="ctrl - Light"
        data-vis-attrs="oid;min;max;invert_icon/checkbox;asButton[true]/checkbox;iconColor/color;"
        data-vis-attrs0="group.colors;iconColor0/color;iconColor1/color;iconColor2/color;iconColor3/color;iconColor4/color;iconColor5/color;iconColor6/color;iconColor7/color;iconColor8/color;iconColor9/color;iconColor10/color;"
        >
    <div data-oid="<%= this.data.attr('oid') %>" class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute" data-min="<%= this.data.attr('min') %>" data-max="<%= this.data.attr('max') %>" <%= (el) -> vis.binds.basic.toggle(el); this.data.attr('asButton') ? vis.binds.jqueryui.classes(el) : '' %>>
        <div class="vis-widget-body" <%= (el) -> vis.preloadImages(['widgets/jqui-mfd/img/light_light_dim_100.png','widgets/jqui-mfd/img/light_light_dim_90.png','widgets/jqui-mfd/img/light_light_dim_80.png','widgets/jqui-mfd/img/light_light_dim_70.png','widgets/jqui-mfd/img/light_light_dim_60.png','widgets/jqui-mfd/img/light_light_dim_50.png','widgets/jqui-mfd/img/light_light_dim_40.png','widgets/jqui-mfd/img/light_light_dim_30.png','widgets/jqui-mfd/img/light_light_dim_20.png','widgets/jqui-mfd/img/light_light_dim_10.png','widgets/jqui-mfd/img/light_light_dim.png']);  %>>
            <%
            var styles = '';
            if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
                styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
            }
            var max = (this.data.attr('max') !== undefined) ? this.data.attr('max') : 100;
            var min = (this.data.attr('min') !== undefined) ? this.data.attr('min') : 0;

            if (typeof max === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
            if (typeof min === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);

            var str = vis.states.attr(this.data.oid + '.val');
            var val = parseFloat(str);
            if (str === true  || str === 'true')  val = max;
            if (str === false || str === 'false') val = min;
            var image = '';
            var imageColor = null;
            if (val >= max) {
               image = "light_light_dim_100";
               imageColor = this.data.attr('iconColor10');
            } else if (val >= min + (max - min) * 0.9) {
               image = "light_light_dim_90";
               imageColor = this.data.attr('iconColor9');
            } else if (val >= min + (max - min) * 0.8) {
               image = "light_light_dim_80";
               imageColor = this.data.attr('iconColor8');
            } else if (val >= min + (max - min) * 0.7) {
               image = "light_light_dim_70";
               imageColor = this.data.attr('iconColor7');
            } else if (val >= min + (max - min) * 0.6) {
               image = "light_light_dim_60";
               imageColor = this.data.attr('iconColor6');
            } else if (val >= min + (max - min) * 0.5) {
               image = "light_light_dim_50";
               imageColor = this.data.attr('iconColor5');
            } else if (val >= min + (max - min) * 0.4) {
               image = "light_light_dim_40";
               imageColor = this.data.attr('iconColor4');
            } else if (val >= min + (max - min) * 0.3) {
               image = "light_light_dim_30";
               imageColor = this.data.attr('iconColor3');
            } else if (val >= min + (max - min) * 0.2) {
               image = "light_light_dim_20";
               imageColor = this.data.attr('iconColor2');
            } else if (val >= min + (max - min) * 0.1) {
               image = "light_light_dim_10";
               imageColor = this.data.attr('iconColor1');
            } else if (val >= min + (max - min) * 0.01) {
               image = "light_light_dim_00";
               imageColor = this.data.attr('iconColor0');
            } else {
               image = "light_light_dim";
               imageColor = this.data.attr('iconColor0');
            }

            if (!vis.binds['jqui-mfd'].isNotEmpty(imageColor)) {
               imageColor = this.data.attr('iconColor');
            }

            if (vis.binds['jqui-mfd'].isNotEmpty(imageColor)) {
            %>
                <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/<%= image %>.svg" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, imageColor) %>/>
            <%
               } else {
            %>
                <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/<%= image %>.png" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% } %>
        </div>
    </div>
</script>

<script id="tplMfdLightOnOffDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui-mfd"
        data-vis-prev='<img src="widgets/jqui-mfd/img/Prev_Light_jquiDialog.png"></img>'
        data-vis-type="light;ctrl;dialog"
        data-vis-name="OnOff + jqui Dialog"
        data-vis-attrs="oid;oid-working;min;max;"
        data-vis-attrs0="group.style;iconOff/image;iconColorOff/color;iconOn/image;iconColorOn/color;invert_icon/checkbox;asButton[true]/checkbox;"
        data-vis-attrs1="group.dialog;textOff;textOn;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width[440];dialog_height[200];dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit;"
        >
    <div data-oid="<%= this.data.attr('oid') %>" data-hm-wid="<%= this.data.attr('oid-working') %>" class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute" <%= (el) -> this.data.attr('asButton') ? vis.binds.jqueryui.classes(el) : '' %>>
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body" style="width:100%; height:100%" <%= (el) -> vis.preloadImages(['widgets/jqui-mfd/img/light_light_dim_100.png','widgets/jqui-mfd/img/light_light_dim_90.png','widgets/jqui-mfd/img/light_light_dim_80.png','widgets/jqui-mfd/img/light_light_dim_70.png','widgets/jqui-mfd/img/light_light_dim_60.png','widgets/jqui-mfd/img/light_light_dim_50.png','widgets/jqui-mfd/img/light_light_dim_40.png','widgets/jqui-mfd/img/light_light_dim_30.png','widgets/jqui-mfd/img/light_light_dim_20.png','widgets/jqui-mfd/img/light_light_dim_10.png','widgets/jqui-mfd/img/light_light_dim.png']); %>>
            <%
            var styles = '';
            if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
                styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
            }
            var isFalse = vis.binds.basic.isFalse(vis.states.attr(this.data.oid + '.val'), this.data.attr('min'), this.data.attr('max'));
            var image = '';
            if (!isFalse) {
                image = this.data.attr('iconOn')  || "widgets/jqui-mfd/img/light_light_dim_100.svg";
                imageColor = this.data.attr('iconColorOn');
            } else {
                image = this.data.attr('iconOff') || "widgets/jqui-mfd/img/light_light_dim.svg";
                imageColor = this.data.attr('iconColorOff');
            }

            if (vis.binds['jqui-mfd'].isNotEmpty(imageColor)) {
            %>
                <img style="<%= styles %>" width="100%" src="<%= image %>" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, imageColor) %>/>
            <%
               } else {
            %>
                <img style="<%= styles %>" width="100%" src="<%= image %>" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% } %>
        </div>
        <div id="<%= this.data.attr('wid') %>_dialog" class="<%= this.data.attr('wid') %>_dialog vis-widget-dialog" title="<%== this.data.title || this.data.attr('oid') %>">
            <div id="<%= this.data.attr('wid') %>_radio"  class="<%= this.data.attr('wid') %>_radio" style="text-align: center" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
                <%
                    var max = (this.data.attr('max') !== undefined) ? this.data.attr('max') : 100;
                    var min = (this.data.attr('min') !== undefined) ? this.data.attr('min') : 0;

                    if (typeof max === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
                    if (typeof min === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);
                    if (max === 'true')  max = true;
                    if (max === 'false') max = false;
                    if (min === 'true')  min = true;
                    if (min === 'false') min = false;
                %>
                <input type="radio" id="<%= this.data.attr('wid') %>_radioOff" name="<%= this.data.attr('wid') %>_radio" value="<%= min %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radioOff"><%= this.data.attr('textOff') || _('off') %></label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radioOn"  name="<%= this.data.attr('wid') %>_radio" value="<%= max %>"/><label for="<%= this.data.attr('wid') %>_radioOn"><%= this.data.attr('textOn') || _('on') %></label>
            </div>
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el, this.data, true) %> />
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>

<script id="tplMfdLightDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui-mfd"
        data-vis-type="dimmer,ctrl,dialog"
        data-vis-prev='<img src="widgets/jqui-mfd/img/Prev_Dimmer_jquiDialog.png"></img>'
        data-vis-name="Dimmer + jqui Dialog"
        data-vis-attrs="oid;oid-working;min;max;invert_icon/checkbox;asButton[true]/checkbox;iconColor/color;"
        data-vis-attrs0="group.colors;iconColor0/color;iconColor1/color;iconColor2/color;iconColor3/color;iconColor4/color;iconColor5/color;iconColor6/color;iconColor7/color;iconColor8/color;iconColor9/color;iconColor10/color;"
        data-vis-attrs1="group.dialog;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width[470];dialog_height[210];dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit;show_value/checkbox;units;"
        >
    <div data-oid="<%= this.data.attr('oid') %>" class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute" <%= (el) -> this.data.attr('asButton') ? vis.binds.jqueryui.classes(el) : '' %>>
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body" style="width:100%; height:100%" <%= (el) -> vis.preloadImages(['widgets/jqui-mfd/img/light_light_dim_100.png','widgets/jqui-mfd/img/light_light_dim_90.png','widgets/jqui-mfd/img/light_light_dim_80.png','widgets/jqui-mfd/img/light_light_dim_70.png','widgets/jqui-mfd/img/light_light_dim_60.png','widgets/jqui-mfd/img/light_light_dim_50.png','widgets/jqui-mfd/img/light_light_dim_40.png','widgets/jqui-mfd/img/light_light_dim_30.png','widgets/jqui-mfd/img/light_light_dim_20.png','widgets/jqui-mfd/img/light_light_dim_10.png','widgets/jqui-mfd/img/light_light_dim.png']); %>>
            <%
            var styles = '';
            if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
                styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
            }

            var max = (this.data.attr('max') !== undefined) ? parseFloat(this.data.attr('max')) : 100;
            var min = (this.data.attr('min') !== undefined) ? parseFloat(this.data.attr('min')) : 0;

            if (typeof max === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
            if (typeof min === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);

            var str = vis.states.attr(this.data.oid + '.val');
            var val = parseFloat(str);
            if (str === true  || str === 'true')  val = max;
            if (str === false || str === 'false') val = min;
            var image = '';
            var imageColor = null;
            if (val >= max) {
               image = "light_light_dim_100";
               imageColor = this.data.attr('iconColor10');
            } else if (val >= min + (max - min) * 0.9) {
               image = "light_light_dim_90";
               imageColor = this.data.attr('iconColor9');
            } else if (val >= min + (max - min) * 0.8) {
               image = "light_light_dim_80";
               imageColor = this.data.attr('iconColor8');
            } else if (val >= min + (max - min) * 0.7) {
               image = "light_light_dim_70";
               imageColor = this.data.attr('iconColor7');
            } else if (val >= min + (max - min) * 0.6) {
               image = "light_light_dim_60";
               imageColor = this.data.attr('iconColor6');
            } else if (val >= min + (max - min) * 0.5) {
               image = "light_light_dim_50";
               imageColor = this.data.attr('iconColor5');
            } else if (val >= min + (max - min) * 0.4) {
               image = "light_light_dim_40";
               imageColor = this.data.attr('iconColor4');
            } else if (val >= min + (max - min) * 0.3) {
               image = "light_light_dim_30";
               imageColor = this.data.attr('iconColor3');
            } else if (val >= min + (max - min) * 0.2) {
               image = "light_light_dim_20";
               imageColor = this.data.attr('iconColor2');
            } else if (val >= min + (max - min) * 0.1) {
               image = "light_light_dim_10";
               imageColor = this.data.attr('iconColor1');
            } else if (val >= min + (max - min) * 0.01) {
               image = "light_light_dim_00";
               imageColor = this.data.attr('iconColor0');
            } else {
               image = "light_light_dim";
               imageColor = this.data.attr('iconColor0');
            }

            if (!vis.binds['jqui-mfd'].isNotEmpty(imageColor)) {
               imageColor = this.data.attr('iconColor');
            }

            if (vis.binds['jqui-mfd'].isNotEmpty(imageColor)) {
            %>
                <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/<%= image %>.svg" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, imageColor) %>/>
            <%
               } else {
            %>
                <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/<%= image %>.png" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% } %>
        </div>
        <div id="<%= this.data.attr('wid') %>_dialog" class="<%= this.data.attr('wid') %>_dialog vis-widget-dialog" title="<%== this.data.title || this.data.attr('oid') %>" style="padding-left:20px;">
            <div id="<%= this.data.attr('wid') %>_radio"  class="<%= this.data.attr('wid') %>_radio" style="text-align: center" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
                <%
                    var max = (this.data.attr('max') !== undefined) ? parseFloat(this.data.attr('max')) : 100;
                    var min = (this.data.attr('min') !== undefined) ? parseFloat(this.data.attr('min')) : 0;

                    if (typeof max === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
                    if (typeof min === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);
                %>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio0" name="<%= this.data.attr('wid') %>_radio" value="<%= min %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio0"><%= _('off') %></label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio1" name="<%= this.data.attr('wid') %>_radio" value="<%= min + (max - min) * 0.25 %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio1">25%</label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio2" name="<%= this.data.attr('wid') %>_radio" value="<%= min + (max - min) * 0.5  %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio2">50%</label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio3" name="<%= this.data.attr('wid') %>_radio" value="<%= min + (max - min) * 0.75 %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio3">75%</label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio4" name="<%= this.data.attr('wid') %>_radio" value="<%= max %>"/><label for="<%= this.data.attr('wid') %>_radio4">100%</label>
            </div>
            <br/>
            <div class="sliderJQUI" style="width: 90%" id="<%= this.data.attr('wid') %>_slider" data-oid="<%= this.data.attr('oid') %>" data-hm-wid="<%= this.data.attr('oid-working') %>" <%= (el) -> vis.binds.jqueryui.slider(el, {min: min, max: max, step: (max - min) / 100}) %> />
            <br/>
        <%= vis.states.attr(this.data.oid + '.val') ? (((parseFloat(vis.states.attr(this.data.oid + '.val')) - min) / (max - min)) * 100).toFixed(0) : 0 %>%
        <%= (this.data.show_value === 'true' || this.data.show_value === true) ? '(' + Math.round(parseFloat(vis.states.attr(this.data.oid + '.val') * 100) / 100) + ' ' + this.data.attr('units') + ')' : '' %>
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el, data, true) %> />
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>

<script id="tplMfdSocket"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMfdSocket" style="position: relative; text-align: initial; padding: 4px"><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default" style="width: 70px; height: 70px"><div class="vis-widget-prev-body"><img width="100%" style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" src="widgets/jqui-mfd/img/message_socket_on.png"></div></div></div>'
        data-vis-set="jqui-mfd"
        data-vis-name="value - Socket"
        data-vis-attrs="oid;min;max;invert_icon/checkbox;invert_state/checkbox;asButton[true]/checkbox;icon_off/image;iconColor_off/color;icon_on/image;iconColor_on/color;"
        >
    <div data-oid="<%= this.data.attr('oid') %>" class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute"  <%= (el) -> this.data.attr('asButton') ? vis.binds.jqueryui.active(el, this.data.invert_state) : '' %> >
        <div class="vis-widget-body" <%= (el) -> vis.preloadImages(['widgets/jqui-mfd/img/message_socket_on.png','widgets/jqui-mfd/img/message_socket_off.png']);  %>>
            <%
            var styles = '';
            if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
                styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
            }

            var str = vis.states.attr(this.data.oid + '.val');
            var val = parseFloat(str);
            var max = (this.data.attr('max') !== undefined) ? this.data.attr('max') : 1;
            var min = (this.data.attr('min') !== undefined) ? this.data.attr('min') : 0;

            if (typeof max === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
            if (typeof min === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);
            if (max === 'true')  max = true;
            if (max === 'false') max = false;
            if (min === 'true')  min = true;
            if (min === 'false') min = false;

            if (str === true  || str === 'true')  val = max;
            if (str === false || str === 'false') val = min;
            if (this.data.invert_state) {
                if (val == min) {
                    val = max;
                } else {
                    val = min;
                }
            }

            if (val != min) {
                if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor_on'))) {
            %>
                    <img style="<%= styles %>" width="100%" src="<%= this.data.attr('icon_on')  ? this.data.attr('icon_on')  : 'widgets/jqui-mfd/img/message_socket_on.svg'  %>" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, this.data.attr('iconColor_on')) %>/>
            <%  } else { %>
                    <img style="<%= styles %>" width="100%" src="<%= this.data.attr('icon_on') ? this.data.attr('icon_on') : 'widgets/jqui-mfd/img/message_socket_on.png' %>" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <%  }
            } else {
                if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor_off'))) {
            %>
                    <img style="<%= styles %>" width="100%" src="<%= this.data.attr('icon_off')  ? this.data.attr('icon_off')  : 'widgets/jqui-mfd/img/message_socket_off.svg' %>" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, this.data.attr('iconColor_off')) %>/>
            <%  } else { %>
                    <img style="<%= styles %>" width="100%" src="<%= this.data.attr('icon_off') ? this.data.attr('icon_off') : 'widgets/jqui-mfd/img/message_socket_off.png' %>" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <%  }
            } %>
        </div>
    </div>
</script>

<script id="tplMfdSocketCtrl"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui-mfd"
        data-vis-name="ctrl - Socket"
        data-vis-prev='<div id="prev_tplMfdSocketCtrl" style="position: relative; text-align: initial;padding: 4px"><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default  ui-state-active" style="width: 70px; height: 70px"><div class="vis-widget-prev-body"><img width="100%" style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" src="widgets/jqui-mfd/img/message_socket_on.png"></div></div></div>'
        data-vis-attrs="oid;min;max;invert_state/checkbox;asButton[true]/checkbox;"
        data-vis-attrs0="group.icon;invert_icon/checkbox;icon_off/image;iconColor_off/color;icon_on/image;iconColor_on/color;"
        data-vis-attrs1="group.ccontrol;urlTrue;urlFalse;oidTrue/id;oidFalse/id;oidTrueValue;oidFalseValue;"
        >
    <div
        data-oid="<%= this.data.attr('oid') %>"
        class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>"
        id="<%= this.data.attr('wid') %>"
        style="width:76px; height:76px; position:absolute"
        data-min="<%= this.data.attr('min') %>"
        data-max="<%= this.data.attr('max') %>"
        data-as-button="<%= this.data.attr('asButton') %>"
        data-url-true="<%=  this.data.attr('urlTrue') %>"
        data-url-false="<%= this.data.attr('urlFalse') %>"
        data-oid-true="<%=  this.data.attr('oidTrue') %>"
        data-oid-false="<%= this.data.attr('oidFalse') %>"
        data-oid-true-value="<%=  this.data.attr('oidTrueValue') %>"
        data-oid-false-value="<%= this.data.attr('oidFalseValue') %>"
        data-img-class="toggle-image"
        data-img-true="<%=  this.data.attr('icon_on')  ? this.data.attr('icon_on')  : 'widgets/jqui-mfd/img/message_socket_on.png'  %>"
        data-img-false="<%= this.data.attr('icon_off') ? this.data.attr('icon_off') : 'widgets/jqui-mfd/img/message_socket_off.png' %>"
        <%= (el) -> vis.binds.basic.toggle(el); this.data.attr('asButton') ? vis.binds.jqueryui.classes(el) : '' %>
        >
        <div class="vis-widget-body" <%= (el) -> vis.preloadImages(['widgets/jqui-mfd/img/message_socket_on.png','widgets/jqui-mfd/img/message_socket_off.png']);  %>>
            <%
            var styles = '';
            if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
                styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
            }
            var str = (this.data.oid && this.data.oid !== 'nothing_selected') ? vis.states.attr(this.data.oid + '.val') : false;
            var val = parseFloat(str);
            var max = (this.data.attr('max') !== undefined) ? this.data.attr('max') : 1;
            var min = (this.data.attr('min') !== undefined) ? this.data.attr('min') : 0;

            if (typeof max === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
            if (typeof min === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);
            if (max === 'true')  max = true;
            if (max === 'false') max = false;
            if (min === 'true')  min = true;
            if (min === 'false') min = false;

            if (str === true  || str === 'true')  val = max;
            if (str === false || str === 'false') val = min;
            if (this.data.invert_state) {
                if (val == min) {
                    val = max;
                } else {
                    val = min;
                }
            }

            if (val != min) {
                if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor_on'))) {
            %>
                    <img style="<%= styles %>" width="100%" src="<%= this.data.attr('icon_on')  ? this.data.attr('icon_on')  : 'widgets/jqui-mfd/img/message_socket_on.svg'  %>" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, this.data.attr('iconColor_on')) %>/>
            <%  } else { %>
                    <img style="<%= styles %>" width="100%" src="<%= this.data.attr('icon_on') ? this.data.attr('icon_on') : 'widgets/jqui-mfd/img/message_socket_on.png' %>" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <%  }
            } else {
                if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor_off'))) {
            %>
                    <img style="<%= styles %>" width="100%" src="<%= this.data.attr('icon_off')  ? this.data.attr('icon_off')  : 'widgets/jqui-mfd/img/message_socket_off.svg' %>" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, this.data.attr('iconColor_off')) %>/>
            <%  } else { %>
                    <img style="<%= styles %>" width="100%" src="<%= this.data.attr('icon_off') ? this.data.attr('icon_off') : 'widgets/jqui-mfd/img/message_socket_off.png' %>" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <%  }
            } %>
        </div>
    </div>
</script>

<script id="tplMfdShutter"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui-mfd"
        data-vis-type="state,shutter"
        data-vis-name="Shutter"
        data-vis-prev='<div id="prev_tplMfdShutter" style="position: relative; text-align: initial;padding: 4px "><div data-oid="dev1" class="vis-widget_prev vis-widget ui-widget ui-button ui-corner-all ui-state-default" style="width: 70px; height: 70px;"><div class="vis-widget-prev-body"> <img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" width="100%" src="widgets/jqui-mfd/img/fts_shutter_30.png"> </div></div></div>'
        data-vis-attrs="oid;min;max;invert_icon/checkbox;asButton[true]/checkbox;iconColor/color;invert_value/checkbox;show_active/checkbox;"
        data-vis-attrs0="group.colors;iconColor0/color;iconColor1/color;iconColor2/color;iconColor3/color;iconColor4/color;iconColor5/color;iconColor6/color;iconColor7/color;iconColor8/color;iconColor9/color;iconColor10/color;"
        >
    <div data-oid="<%= this.data.attr('oid') %>" class="vis-widget vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute" <%= (el) -> this.data.attr('show_active') ? vis.binds.jqueryui.classes(el, true) : '' %>><div class="vis-widget-body">
        <%
            var styles = '';
            if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
                styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
            }

            var max = (this.data.attr('max') !== undefined) ? this.data.attr('max') : 100;
            var min = (this.data.attr('min') !== undefined) ? this.data.attr('min') : 0;

            if (typeof max === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
            if (typeof min === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);

            var val = max - parseFloat(vis.states.attr(this.data.oid + '.val')) + min;
            if (this.data.invert_value) val = max - val + min;
            var image = '';
            var imageColor = null;
            if (val >= max) {
                image = "fts_shutter_100";
                imageColor = this.data.attr('iconColor10');
            } else if (val >= min + (max - min) * 0.9) {
                image = "fts_shutter_90";
                imageColor = this.data.attr('iconColor9');
            } else if (val >= min + (max - min) * 0.8) {
                image = "fts_shutter_80";
                imageColor = this.data.attr('iconColor8');
            } else if (val >= min + (max - min) * 0.7) {
                image = "fts_shutter_70";
                imageColor = this.data.attr('iconColor7');
            } else if (val >= min + (max - min) * 0.6) {
                image = "fts_shutter_60";
                imageColor = this.data.attr('iconColor6');
            } else if (val >= min + (max - min) * 0.5) {
                image = "fts_shutter_50";
                imageColor = this.data.attr('iconColor5');
            } else if (val >= min + (max - min) * 0.4) {
                image = "fts_shutter_40";
                imageColor = this.data.attr('iconColor4');
            } else if (val >= min + (max - min) * 0.3) {
                image = "fts_shutter_30";
                imageColor = this.data.attr('iconColor3');
            } else if (val >= min + (max - min) * 0.2) {
                image = "fts_shutter_20";
                imageColor = this.data.attr('iconColor2');
            } else if (val >= min + (max - min) * 0.1) {
                image = "fts_shutter_10";
                imageColor = this.data.attr('iconColor1');
            } else {
                image = "fts_window_2w";
                imageColor = this.data.attr('iconColor0');
            }

            if (!vis.binds['jqui-mfd'].isNotEmpty(imageColor)) {
               imageColor = this.data.attr('iconColor');
            }

            if (vis.binds['jqui-mfd'].isNotEmpty(imageColor)) {
            %>
                <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/<%= image %>.svg" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, imageColor) %>/>
            <% } else { %>
                <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/<%= image %>.png" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% } %>
    </div></div>
</script>

<script id="tplMfdShutterDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui-mfd"
        data-vis-type="ctrl,shutter,dialog"
        data-vis-name="Shutter + jqui Dialog"
        data-vis-prev='<div id="prev_tplMfdShutter" style="position: relative; text-align: initial;padding: 4px "><div data-oid="dev1" class="vis-widget_prev vis-widget ui-widget ui-button ui-corner-all ui-state-default  ui-state-active" style="width: 70px; height: 70px;"><div class="vis-widget-prev-body"> <img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" width="100%" src="widgets/jqui-mfd/img/fts_shutter_30.png"> </div></div></div>'
        data-vis-attrs="oid;oid-working;min;max;invert_icon/checkbox;asButton[true]/checkbox;invert_value/checkbox;show_active/checkbox;iconColor/color;"
        data-vis-attrs0="group.colors;iconColor0/color;iconColor1/color;iconColor2/color;iconColor3/color;iconColor4/color;iconColor5/color;iconColor6/color;iconColor7/color;iconColor8/color;iconColor9/color;iconColor10/color;"
        data-vis-attrs1="group.dialog;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width[450];dialog_height[210];dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit;show_value/checkbox;units;"
        >
    <div data-oid="<%= this.data.attr('oid') %>" data-hm-wid="<%= this.data.attr('oid-working') %>" class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute" <%= (el) -> this.data.attr('show_active') ? vis.binds.jqueryui.classes(el, true) : '' %>>
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body" style="width:100%; height:100%" <%= (el) -> vis.preloadImages(['widgets/jqui-mfd/img/light_light_dim_100.png','widgets/jqui-mfd/img/light_light_dim_90.png','widgets/jqui-mfd/img/light_light_dim_80.png','widgets/jqui-mfd/img/light_light_dim_70.png','widgets/jqui-mfd/img/light_light_dim_60.png','widgets/jqui-mfd/img/light_light_dim_50.png','widgets/jqui-mfd/img/light_light_dim_40.png','widgets/jqui-mfd/img/light_light_dim_30.png','widgets/jqui-mfd/img/light_light_dim_20.png','widgets/jqui-mfd/img/light_light_dim_10.png','widgets/jqui-mfd/img/light_light_dim.png']); %>>
            <%
                var styles = '';
                if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
                    styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
                }
                var max = (this.data.attr('max') !== undefined) ? this.data.attr('max') : 100;
                var min = (this.data.attr('min') !== undefined) ? this.data.attr('min') : 0;

                if (typeof max === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
                if (typeof min === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);

                var val = max - parseFloat(vis.states.attr(this.data.oid + '.val')) + min;

                if (this.data.attr('invert_value')) val = max - val + min;

                var image = '';
                var imageColor = null;
            if (val >= max) {
                image = "fts_shutter_100";
                imageColor = this.data.attr('iconColor10');
            } else if (val >= min + (max - min) * 0.9) {
                image = "fts_shutter_90";
                imageColor = this.data.attr('iconColor9');
            } else if (val >= min + (max - min) * 0.8) {
                image = "fts_shutter_80";
                imageColor = this.data.attr('iconColor8');
            } else if (val >= min + (max - min) * 0.7) {
                image = "fts_shutter_70";
                imageColor = this.data.attr('iconColor7');
            } else if (val >= min + (max - min) * 0.6) {
                image = "fts_shutter_60";
                imageColor = this.data.attr('iconColor6');
            } else if (val >= min + (max - min) * 0.5) {
                image = "fts_shutter_50";
                imageColor = this.data.attr('iconColor5');
            } else if (val >= min + (max - min) * 0.4) {
                image = "fts_shutter_40";
                imageColor = this.data.attr('iconColor4');
            } else if (val >= min + (max - min) * 0.3) {
                image = "fts_shutter_30";
                imageColor = this.data.attr('iconColor3');
            } else if (val >= min + (max - min) * 0.2) {
                image = "fts_shutter_20";
                imageColor = this.data.attr('iconColor2');
            } else if (val >= min + (max - min) * 0.1) {
                image = "fts_shutter_10";
                imageColor = this.data.attr('iconColor1');
            } else {
                image = "fts_window_2w";
                imageColor = this.data.attr('iconColor0');
            }

            if (!vis.binds['jqui-mfd'].isNotEmpty(imageColor)) {
                imageColor = this.data.attr('iconColor');
            }

            if (vis.binds['jqui-mfd'].isNotEmpty(imageColor)) {
            %>
                <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/<%= image %>.svg" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, imageColor) %>/>
            <% } else { %>
                <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/<%= image %>.png" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% } %>
        </div>
        <div id="<%= this.data.attr('wid') %>_dialog" class="<%= this.data.attr('wid') %>_dialog vis-widget-dialog" title="<%== this.data.title || this.data.attr('oid') %>" style="padding-left: 20px;">
            <div id="<%= this.data.attr('wid') %>_radio"  class="<%= this.data.attr('wid') %>_radio" style="text-align: center" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
                <%
                    var max = (this.data.attr('max') !== undefined) ? this.data.attr('max') : 100;
                    var min = (this.data.attr('min') !== undefined) ? this.data.attr('min') : 0;

                    if (typeof max === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
                    if (typeof min === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);

                %>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio0" name="<%= this.data.attr('wid') %>_radio" value="<%= !this.data.attr('invert_value') ? min : max                                           %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio0"><%= _('closed') %></label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio1" name="<%= this.data.attr('wid') %>_radio" value="<%= !this.data.attr('invert_value') ? min + (max - min) * 0.25 : min + (max - min) * 0.75 %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio1"><%= !this.data.attr('invert_value') ? '25%' : '75%' %></label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio2" name="<%= this.data.attr('wid') %>_radio" value="<%=                                   min + (max - min) * 0.5                             %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio2">50%</label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio3" name="<%= this.data.attr('wid') %>_radio" value="<%= !this.data.attr('invert_value') ? min + (max - min) * 0.75 : min + (max - min) * 0.25 %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio3"><%= !this.data.attr('invert_value') ? '75%' : '25%' %></label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio4" name="<%= this.data.attr('wid') %>_radio" value="<%= !this.data.attr('invert_value') ? max : min                                           %>"/><label for="<%= this.data.attr('wid') %>_radio4"><%= _('open') %></label>
            </div>
            <br/>
            <div class="sliderJQUI" style="width: 90%" id="<%= this.data.attr('wid') %>_slider" data-oid="<%= this.data.attr('oid') %>" data-hm-wid="<%= this.data.attr('oid-working') %>" <%= (el) -> vis.binds.jqueryui.slider(el, {min: min, max: max, step: (max - min) / 100, inverted: this.data.attr('invert_value')}) %> />
            <br/>
            <%= vis.states.attr(this.data.oid + '.val') ? (((parseFloat(vis.states.attr(this.data.oid + '.val')) - min) / (max - min)) * 100).toFixed(0) : 0 %>%
            <%= (this.data.show_value === 'true' || this.data.show_value === true) ? '(' + Math.round(parseFloat(vis.states.attr(this.data.oid + '.val') * 100) / 100) + ' ' + this.data.attr('units') + ')' : '' %>
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el, data, true) %> />
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>

<script id="tplMfdBlind"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui-mfd"
        data-vis-type="state,blind"
        data-vis-name="Shutter"
        data-vis-prev='<div id="prev_tplMfdBlind" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget ui-widget ui-button ui-corner-all ui-state-default" style="width: 70px; height: 70px;"><div class="vis-widget-prev-body"> <img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" width="100%" src="widgets/jqui-mfd/img/fts_markise_75.png"> </div></div></div>'
        data-vis-attrs="oid;min;max;invert_icon/checkbox;asButton[true]/checkbox;iconColor/color;invert_value/checkbox;show_active/checkbox;"
        data-vis-attrs0="group.colors;iconColor0/color;iconColor25/color;iconColor5/color;iconColor75/color;iconColor10/color;"
>
    <div data-oid="<%= this.data.attr('oid') %>" class="vis-widget vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute" <%= (el) -> this.data.attr('show_active') ? vis.binds.jqueryui.classes(el, true) : '' %>><div class="vis-widget-body">
        <%
            var styles = '';
            if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
                styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
            }

            var max = (this.data.attr('max') !== undefined) ? this.data.attr('max') : 100;
            var min = (this.data.attr('min') !== undefined) ? this.data.attr('min') : 0;

            if (typeof max === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
            if (typeof min === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);

            var val = parseFloat(vis.states.attr(this.data.oid + '.val'));
            if (this.data.invert_value) val = max - val + min;
            var image = '';
            var imageColor = null;
            if (val >= max) {
                image = "fts_markise_100";
                imageColor = this.data.attr('iconColor10');
            } else if (val >= min + (max - min) * 0.75) {
                image = "fts_markise_75";
                imageColor = this.data.attr('iconColor75');
            } else if (val >= min + (max - min) * 0.5) {
                image = "fts_markise_50";
                imageColor = this.data.attr('iconColor5');
            } else if (val >= min + (max - min) * 0.25) {
                image = "fts_markise_25";
                imageColor = this.data.attr('iconColor25');
            } else {
                image = "fts_markise_0";
                imageColor = this.data.attr('iconColor0');
            }

            if (!vis.binds['jqui-mfd'].isNotEmpty(imageColor)) {
               imageColor = this.data.attr('iconColor');
            }

            if (vis.binds['jqui-mfd'].isNotEmpty(imageColor)) {
            %>
                <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/<%= image %>.svg" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, imageColor) %>/>
            <% } else { %>
                <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/<%= image %>.png" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% } %>
    </div></div>
</script>

<script id="tplMfdBlindDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui-mfd"
        data-vis-type="ctrl,blind,dialog"
        data-vis-name="Blind + jqui Dialog"
        data-vis-prev='<div id="prev_tplMfdBlind" style="position: relative; text-align: initial; padding: 4px "><div data-oid="dev1" class="vis-widget_prev vis-widget ui-widget ui-button ui-corner-all ui-state-default  ui-state-active" style="width: 70px; height: 70px;"><div class="vis-widget-prev-body"> <img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" width="100%" src="widgets/jqui-mfd/img/fts_markise_100.png"> </div></div></div>'
        data-vis-attrs="oid;oid-working;min;max;invert_icon/checkbox;asButton[true]/checkbox;invert_value/checkbox;show_active/checkbox;iconColor/color;"
        data-vis-attrs0="group.colors;iconColor0/color;iconColor25/color;iconColor5/color;iconColor75/color;iconColor10/color;"
        data-vis-attrs1="group.dialog;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width[450];dialog_height[210];dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit;show_value/checkbox;units;"
>
    <div data-oid="<%= this.data.attr('oid') %>" data-hm-wid="<%= this.data.attr('oid-working') %>" class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute" <%= (el) -> this.data.attr('show_active') ? vis.binds.jqueryui.classes(el, true) : '' %>>
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body" style="width:100%; height:100%" <%= (el) -> vis.preloadImages(['widgets/jqui-mfd/img/light_light_dim_100.png','widgets/jqui-mfd/img/light_light_dim_90.png','widgets/jqui-mfd/img/light_light_dim_80.png','widgets/jqui-mfd/img/light_light_dim_70.png','widgets/jqui-mfd/img/light_light_dim_60.png','widgets/jqui-mfd/img/light_light_dim_50.png','widgets/jqui-mfd/img/light_light_dim_40.png','widgets/jqui-mfd/img/light_light_dim_30.png','widgets/jqui-mfd/img/light_light_dim_20.png','widgets/jqui-mfd/img/light_light_dim_10.png','widgets/jqui-mfd/img/light_light_dim.png']); %>>
            <%
                var styles = '';
                if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
                    styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
                }
                var max = (this.data.attr('max') !== undefined) ? this.data.attr('max') : 100;
                var min = (this.data.attr('min') !== undefined) ? this.data.attr('min') : 0;

                if (typeof max === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
                if (typeof min === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);

                var val = parseFloat(vis.states.attr(this.data.oid + '.val'));

                if (this.data.attr('invert_value')) val = max - val + min;
				
                var image = '';
                var imageColor = null;
            if (val >= max) {
                image = "fts_markise_100";
                imageColor = this.data.attr('iconColor10');
            } else if (val >= min + (max - min) * 0.75) {
                image = "fts_markise_75";
                imageColor = this.data.attr('iconColor75');
            } else if (val >= min + (max - min) * 0.5) {
                image = "fts_markise_50";
                imageColor = this.data.attr('iconColor5');
            } else if (val >= min + (max - min) * 0.25) {
                image = "fts_markise_25";
                imageColor = this.data.attr('iconColor25');
            } else {
                image = "fts_markise_0";
                imageColor = this.data.attr('iconColor0');
            }

            if (!vis.binds['jqui-mfd'].isNotEmpty(imageColor)) {
                imageColor = this.data.attr('iconColor');
            }

            if (vis.binds['jqui-mfd'].isNotEmpty(imageColor)) {
            %>
                <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/<%= image %>.svg" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, imageColor) %>/>
            <% } else { %>
                <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/<%= image %>.png" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% } %>
        </div>
        <div id="<%= this.data.attr('wid') %>_dialog" class="<%= this.data.attr('wid') %>_dialog vis-widget-dialog" title="<%== this.data.title || this.data.attr('oid') %>" style="padding-left: 20px;">
            <div id="<%= this.data.attr('wid') %>_radio"  class="<%= this.data.attr('wid') %>_radio" style="text-align: center" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
                <%
                    var max = (this.data.attr('max') !== undefined) ? this.data.attr('max') : 100;
                    var min = (this.data.attr('min') !== undefined) ? this.data.attr('min') : 0;

                    if (typeof max === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
                    if (typeof min === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);

                %>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio0" name="<%= this.data.attr('wid') %>_radio" value="<%= !this.data.attr('invert_value') ? min : max                                           %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio0"><%= _('closed') %></label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio1" name="<%= this.data.attr('wid') %>_radio" value="<%= !this.data.attr('invert_value') ? min + (max - min) * 0.25 : min + (max - min) * 0.75 %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio1">25%</label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio2" name="<%= this.data.attr('wid') %>_radio" value="<%=                                   min + (max - min) * 0.5                             %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio2">50%</label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio3" name="<%= this.data.attr('wid') %>_radio" value="<%= !this.data.attr('invert_value') ? min + (max - min) * 0.75 : min + (max - min) * 0.25 %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio3">75%</label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio4" name="<%= this.data.attr('wid') %>_radio" value="<%= !this.data.attr('invert_value') ? max : min                                           %>"/><label for="<%= this.data.attr('wid') %>_radio4"><%= _('open') %></label>
            </div>
            <br/>
            <div class="sliderJQUI" style="width: 90%" id="<%= this.data.attr('wid') %>_slider" data-oid="<%= this.data.attr('oid') %>" data-hm-wid="<%= this.data.attr('oid-working') %>" <%= (el) -> vis.binds.jqueryui.slider(el, {min: min, max: max, step: (max - min) / 100, inverted: this.data.attr('invert_value')}) %> />
            <br/>
            <%= vis.states.attr(this.data.oid + '.val') ? (((parseFloat(vis.states.attr(this.data.oid + '.val')) - min) / (max - min)) * 100).toFixed(0) : 0 %>%
            <%= (this.data.show_value === 'true' || this.data.show_value === true) ? '(' + Math.round(parseFloat(vis.states.attr(this.data.oid + '.val') * 100) / 100) + ' ' + this.data.attr('units') + ')' : '' %>
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el, data, true) %> />
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>

<script id="tplMfdHeating"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui-mfd"
        data-vis-prev='<div id="prev_tplMfdHeating" style="position: relative; text-align: initial;padding: 4px"><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default " style="width: 70px; height: 70px;"> <div class="vis-widget-prev-body" style="width:100%; height:100%"> <img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" src="widgets/jqui-mfd/img/sani_heating_temp.png" width="100%"> </div></div>'
        data-vis-type="ctrl,heating,dialog"
        data-vis-name="ctrl - Heating + jqui Dialog"
        data-vis-attrs="oid;oid-working;min[18];max[30];step[2];roundnumber[0];checkboxDisplay[image]/select,image,text;invert_icon/checkbox;asButton[true]/checkbox;iconColor/color;"
        data-vis-attrs0="group.dialog;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width[600];dialog_height[200];"
        >
    <div data-oid="<%= this.data.attr('oid') %>" class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="<%= this.data.attr('checkboxDisplay') == 'image' ? 'width:76px; height:76px; ' : '' %>position:absolute" >
    <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body" style="width:100%; height:100%">
        <%			
        var styles = '';
        if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
            styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
        }
		if (this.data.attr('checkboxDisplay') == 'image') {
			if (this.data.attr('iconColor')) {
			%>
				<img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/sani_heating_temp.svg" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, this.data.attr('iconColor')) %>/>
			<% } else { %>
				<img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/sani_heating_temp.png" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
			<% } %>
		<% } else { %>
			<% var dec = (this.data.attr('roundnumber') !== undefined || this.data.attr('roundnumber') >= 0) ? this.data.attr('roundnumber') : 0; %>
			<span class="actTemp"><%= (parseFloat(vis.states.attr(this.data.oid + '.val'))).toFixed(dec) %> °C</span>
		<% } %>	
    </div>
    <div id="<%= this.data.attr('wid') %>_dialog" class="<%= this.data.attr('wid') %>_dialog vis-widget-dialog" title="<%== this.data.title || this.data.attr('oid') %>" style="padding-left:20px;">
        <div id="<%= this.data.attr('wid') %>_radio"  class="<%= this.data.attr('wid') %>_radio" style="text-align: center" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
			<% 			
			var min  = (this.data.attr('min') !== undefined) ? this.data.attr('min') : 18;
			var max  = (this.data.attr('max') !== undefined) ? this.data.attr('max') : 30;
			var step = (this.data.attr('step') !== undefined) ? this.data.attr('step') : 2;
			var dec	 = (this.data.attr('roundnumber') !== undefined || this.data.attr('roundnumber') >= 0) ? this.data.attr('roundnumber') : 0;
			

			if (typeof min  === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);
			if (typeof max  === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
			if (typeof step === 'string' && parseFloat(step).toString() == step) step = parseFloat(step);

			var temparr = [];
			if (step > 0 && min < max) {
				for (var i = min; i <= max; i += step) {
					temparr.push(i);
				}
			}
			for (var i = 0; i < temparr.length; i++) { %>
				<input type="radio" id="<%= this.data.attr('wid') %>_radio<%= i %>" name="<%= this.data.attr('wid') %>_radio" value="<%= parseFloat(temparr[i]).toFixed(dec) %>" /><label for="<%= this.data.attr('wid') %>_radio<%= i %>"><%= parseFloat(temparr[i]).toFixed(dec) %> °C</label>
			<% } %>
        </div>
        <br/>
		<% 
		var min  = (this.data.attr('min') !== undefined) ? this.data.attr('min') : 18;
		var max  = (this.data.attr('max') !== undefined) ? this.data.attr('max') : 30;
		var step = (this.data.attr('step') !== undefined) ? this.data.attr('step') : 2;
		var dec	 = (this.data.attr('roundnumber') !== undefined || this.data.attr('roundnumber') >= 0) ? this.data.attr('roundnumber') : 0;

		if (typeof min  === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);
		if (typeof max  === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
		if (typeof step === 'string' && parseFloat(step).toString() == step) step = parseFloat(step);
		%>
        <div class="sliderJQUI" style="width:90%" id="<%= this.data.attr('wid') %>_slider" data-oid="<%= this.data.attr('oid') %>" data-hm-wid="<%= this.data.attr('oid-working') %>" <%= (el) -> vis.binds.jqueryui.slider(el, {min: min, max: max,step: step}) %> />
            <br/>
            <%= (parseFloat(vis.states.attr(this.data.oid + '.val'))).toFixed(dec) %>°C
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el, data, true) %> />
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>

<script id="tplMfdWindow"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui-mfd"
        data-vis-type="val,window"
        data-vis-name="Window Rotate Handle"
        data-vis-prev='<div id="prev_tplMfdWindow" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default" style="height: 70px; width: 70px;"> <div class="vis-widget-prev-body"> <img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" height="100%" src="widgets/jqui-mfd/img/fts_window_1w_open.png"> </div> </div></div>'
        data-vis-attrs="oid;invert_icon/checkbox;asButton[true]/checkbox;iconColor/color;"
        data-vis-attrs0="group.values;closed_value;tilted_value;opened_value;"
        data-vis-attrs1="group.icons;closed_icon/image;closed_iconColor/color;tilted_icon/image;tilted_iconColor/color;opened_icon/image;opened_iconColor/color"
        >
    <div class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" style="height:76px; width:76px; position:absolute" data-min="<%= this.data.attr('closed_value') %>" data-max="<%= this.data.attr('opened_value') %>" <%= (el) -> this.data.attr('asButton') ? vis.binds.jqueryui.active(el) : '' %> >
        <div class="vis-widget-body">
            <%
            var styles = '';
            if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
                styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
            }

            var opened = this.data.attr('opened_value');
            if (opened === undefined || opened === '') opened = 1;

            var closed = this.data.attr('closed_value');
            if (closed === undefined || closed === '') closed = 0;

            var tilted = this.data.attr('tilted_value');
            if (tilted === undefined || tilted === '') tilted = 2;

            var val = vis.states.attr(this.data.oid + '.val');
            if (val === 'true'  || val === true)  val = opened;
            if (val === 'false' || val === false || val === undefined || val === null || val === '') val = closed;

            var image = null;
            var imageColor = null;
            if (val == closed) {
                imageColor = this.data.attr('closed_iconColor') ? this.data.attr('closed_iconColor') : this.data.attr('iconColor');
                image = this.data.attr('closed_icon');
                if (!image) {
                    image = imageColor ? "widgets/jqui-mfd/img/fts_window_1w.svg" : "widgets/jqui-mfd/img/fts_window_1w.png";
                }
            } else if (val == tilted) {
                imageColor = this.data.attr('tilted_iconColor') ? this.data.attr('tilted_iconColor') : this.data.attr('iconColor');
                image = this.data.attr('tilted_icon');
                if (!image) {
                    image = imageColor ? "widgets/jqui-mfd/img/fts_window_1w_tilt.svg" : "widgets/jqui-mfd/img/fts_window_1w_tilt.png";
                }
            } else {
                imageColor = this.data.attr('opened_iconColor') ? this.data.attr('opened_iconColor') : this.data.attr('iconColor');
                image = this.data.attr('opened_icon');
                if (!image) {
                    image = imageColor ? "widgets/jqui-mfd/img/fts_window_1w_open.svg" : "widgets/jqui-mfd/img/fts_window_1w_open.png";
                }
            }

            if (vis.binds['jqui-mfd'].isNotEmpty(imageColor)) {
            %>
                <img style="<%= styles %>" width="100%" src="<%= image %>" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, imageColor) %> />
            <% 
            } else {
            %>
                <img style="<%= styles %>" width="100%" src="<%= image %>" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% 
            } 
            %>
        </div>
    </div>
</script>

<script id="tplMfdWindowBool"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui-mfd"
        data-vis-type="val,window"
        data-vis-name="Window"
        data-vis-prev='<div id="prev_tplMfdWindowBool" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default ui-state-active" style="height: 70px; width: 70px;"> <div class="vis-widget-prev-body"> <img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" height="100%" src="widgets/jqui-mfd/img/fts_window_1w_open.png"></div></div></div>'
        data-vis-attrs="oid;invert_icon/checkbox;invert_state/checkbox;asButton[true]/checkbox;iconColor/color;"
        data-vis-attrs0="group.values;closed_value;opened_value;"
        data-vis-attrs1="group.icons;closed_icon/image;closed_iconColor/color;opened_icon/image;opened_iconColor/color;"
        >
    <div class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" style="height:76px; width:76px; position:absolute" data-min="<%= this.data.attr('closed_value') %>" data-max="<%= this.data.attr('opened_value') %>" <%= (el) -> this.data.attr('asButton') ?  vis.binds.jqueryui.active(el, this.data.invert_state) : '' %> >
        <div class="vis-widget-body">
            <%
            var styles = '';
            if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
                 styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
            }

            var opened = this.data.attr('opened_value');
            var closed = this.data.attr('closed_value');

            var val = vis.states.attr(this.data.oid + '.val');

            if (opened === undefined || opened === '' || opened === null) {
                opened = 1;
                closed = 0;

                if (val === 'true'  || val === true)  val = opened;
                if (val === 'false' || val === false) val = closed;

                val = parseFloat(val) || 0;
                val = (val > closed) ? opened : closed;
            }
            if (this.data.invert_state) {
                if (val == opened) {
                    val = closed;
                } else {
                    val = opened;
                }
            }

            var image = null;
            var imageColor = null;
            if (val != opened) {
                imageColor = this.data.attr('closed_iconColor') ? this.data.attr('closed_iconColor') : this.data.attr('iconColor');
                image = this.data.attr('closed_icon');
                if (!image) {
                    image = imageColor ? "widgets/jqui-mfd/img/fts_window_1w.svg" : "widgets/jqui-mfd/img/fts_window_1w.png";
                }
            } else {
                imageColor = this.data.attr('opened_iconColor') ? this.data.attr('opened_iconColor') : this.data.attr('iconColor');
                image = this.data.attr('opened_icon');
                if (!image) {
                    image = imageColor ? "widgets/jqui-mfd/img/fts_window_1w_open.svg" : "widgets/jqui-mfd/img/fts_window_1w_open.png";
                }
            }

            if (vis.binds['jqui-mfd'].isNotEmpty(imageColor)) {
            %>
                <img style="<%= styles %>" width="100%" src="<%= image %>" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, imageColor) %>/>
            <% 
            } else {
            %>
                <img style="<%= styles %>" width="100%" src="<%= image %>" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% 
            } 
            %>
        </div>
    </div>
</script>

<script id="tplMfdRoofWindowBool"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui-mfd"
        data-vis-type="val,window"
        data-vis-prev='<div id="prev_tplMfdRoofWindowBool" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default" style="height: 70px; width: 70px;"> <div class="vis-widget-prev-body"> <img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" height="100%" src="widgets/jqui-mfd/img/fts_window_roof.png"> </div> </div></div>'
        data-vis-name="Roof window"
        data-vis-attrs="oid;invert_icon/checkbox;invert_state/checkbox;asButton[true]/checkbox;iconColor/color;"
        data-vis-attrs0="group.values;closed_value;opened_value;"
        data-vis-attrs1="group.icons;closed_icon/image;closed_iconColor/color;opened_icon/image;opened_iconColor/color;"
        >
    <div class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" style="height:76px; width:76px; position:absolute" data-min="<%= this.data.attr('closed_value') %>" data-max="<%= this.data.attr('opened_value') %>" <%= (el) -> this.data.attr('asButton') ? vis.binds.jqueryui.active(el, this.data.invert_state) : '' %> >
        <div class="vis-widget-body">
            <%
            var styles = '';
            if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
                styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
            }
            var opened = this.data.attr('opened_value');
            var closed = this.data.attr('closed_value');

            var val = vis.states.attr(this.data.oid + '.val');

            if (opened === undefined || opened === '' || opened === null) {
                opened = 1;
                closed = 0;

                if (val === 'true'  || val === true)  val = opened;
                if (val === 'false' || val === false) val = closed;

                val = parseFloat(val) || 0;
                val = (val > closed) ? opened : closed;
            }
            if (this.data.invert_state) {
                if (val == opened) {
                    val = closed;
                } else {
                    val = opened;
                }
            }

            var image = null;
            var imageColor = null;
            if (val != opened) {
                imageColor = this.data.attr('closed_iconColor') ? this.data.attr('closed_iconColor') : this.data.attr('iconColor');
                image = this.data.attr('closed_icon');
                if (!image) {
                    image = imageColor ? "widgets/jqui-mfd/img/fts_window_roof.svg" : "widgets/jqui-mfd/img/fts_window_roof.png";
                }
            } else {
                imageColor = this.data.attr('opened_iconColor') ? this.data.attr('opened_iconColor') : this.data.attr('iconColor');
                image = this.data.attr('opened_icon');
                if (!image) {
                    image = imageColor ? "widgets/jqui-mfd/img/fts_window_roof_open_2.svg" : "widgets/jqui-mfd/img/fts_window_roof_open_2.png";
                }
            }

            if (imageColor) {
            %>
                <img style="<%= styles %>" width="100%" src="<%= image %>" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, imageColor) %>/>
            <% 
            } else {
            %>
                <img style="<%= styles %>" width="100%" src="<%= image %>" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% 
            } 
            %>
        </div>
    </div>
</script>

<script id="tplMfdDoor"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui-mfd"
        data-vis-name="val - Door"
        data-vis-prev='<div id="prev_tplMfdDoor" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default" style="height: 76px; width: 76px"> <div class="vis-widget-prev-body"> <img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" height="100%" src="widgets/jqui-mfd/img/fts_door.png"> </div> </div></div>'
        data-vis-attrs="oid;invert_icon/checkbox;invert_state/checkbox;asButton[true]/checkbox;iconColor/color;"
        data-vis-attrs0="group.values;closed_value;tilted_value;opened_value;"
        data-vis-attrs1="group.icons;closed_icon/image;closed_iconColor/color;tilted_icon/image;tilted_iconColor/color;opened_icon/image;opened_iconColor/color;"
        >
    <div data-oid="<%= this.data.attr('oid') %>" class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="height:76px; width:76px; position:absolute"  data-min="<%= this.data.attr('closed_value') %>" data-max="<%= this.data.attr('opened_value') %>" <%= (el) -> this.data.attr('asButton') ? vis.binds.jqueryui.active(el, this.data.invert_state) : '' %>>
        <div class="vis-widget-body">
            <%
            var styles = '';
            if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
                styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
            }
            var opened = this.data.attr('opened_value');
            if (opened === undefined || opened === '') opened = 1;

            var closed = this.data.attr('closed_value');
            if (closed === undefined || closed === '') closed = 0;

            var tilted = this.data.attr('tilted_value');
            if (tilted === undefined || tilted === '') tilted = 2;

            var val = vis.states.attr(this.data.oid + '.val');
            if (val === 'true'  || val === true)  val = opened;
            if (val === 'false' || val === false || val === undefined || val === null) val = closed;

            var image = null;
            var imageColor = null;
            if (val == closed) {
                imageColor = this.data.attr('closed_iconColor') ? this.data.attr('closed_iconColor') : this.data.attr('iconColor');
                image = this.data.attr('closed_icon');
                if (!image) {
                    image = imageColor ? "widgets/jqui-mfd/img/fts_door.svg" : "widgets/jqui-mfd/img/fts_door.png";
                }
            } else if (val == tilted) {
                imageColor = this.data.attr('tilted_iconColor') ? this.data.attr('tilted_iconColor') : this.data.attr('iconColor');
                image = this.data.attr('tilted_icon');
                if (!image) {
                    image = imageColor ? "widgets/jqui-mfd/img/fts_door_tilt.svg" : "widgets/jqui-mfd/img/fts_door_tilt.png";
                }
            } else {
                imageColor = this.data.attr('opened_iconColor') ? this.data.attr('opened_iconColor') : this.data.attr('iconColor');
                image = this.data.attr('opened_icon');
                if (!image) {
                    image = imageColor ? "widgets/jqui-mfd/img/fts_door_open.svg" : "widgets/jqui-mfd/img/fts_door_open.png";
                }
            }

            if (imageColor) {
            %>
                <img style="<%= styles %>" width="100%" src="<%= image %>" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, imageColor) %>/>
            <% 
            } else {
            %>
                <img style="<%= styles %>" width="100%" src="<%= image %>" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% 
            } 
            %>
        </div>
    </div>

</script>

<script id="tplMfdGarage"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui-mfd"
        data-vis-name="val - Garage"
        data-vis-prev='<div id="prev_tplMfdGarage" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default" style="height: 76px; width: 76px;"><div class="vis-widget-prev-body"><img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" height="100%" src="widgets/jqui-mfd/img/fts_garage_door_100.png"></div></div></div>'
        data-vis-attrs="oid;invert_icon/checkbox;invert_state/checkbox;asButton[true]/checkbox;iconColor/color;"
        data-vis-attrs0="group.values;closed_value;opened_value;"
        data-vis-attrs1="group.icons;closed_icon/image;closed_iconColor/color;opened_icon/image;opened_iconColor/color;"
        >
    <div data-oid="<%= this.data.attr('oid') %>" class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="height:76px; width:76px; position:absolute" data-min="<%= this.data.attr('closed_value') %>" data-max="<%= this.data.attr('opened_value') %>" <%= (el) -> this.data.attr('asButton') ? vis.binds.jqueryui.active(el, this.data.invert_state) : '' %>>
        <div class="vis-widget-body">
            <%
            var styles = '';
            if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
                styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
            }

            var opened = this.data.attr('opened_value');
            var closed = this.data.attr('closed_value');

            var val = vis.states.attr(this.data.oid + '.val');

            if (opened === undefined || opened === '' || opened === null) {
                opened = 1;
                closed = 0;

                if (val === 'true'  || val === true)  val = opened;
                if (val === 'false' || val === false) val = closed;

                val = parseFloat(val) || 0;
                val = (val > closed) ? opened : closed;
            }
            if (this.data.invert_state) {
                if (val == opened) {
                    val = closed;
                } else {
                    val = opened;
                }
            }

            var image = null;
            var imageColor = null;
            if (val != opened) {
                imageColor = this.data.attr('closed_iconColor') ? this.data.attr('closed_iconColor') : this.data.attr('iconColor');
                image = this.data.attr('closed_icon');
                if (!image) {
                    image = imageColor ? "widgets/jqui-mfd/img/fts_garage_door_100.svg" : "widgets/jqui-mfd/img/fts_garage_door_100.png";
                }
            } else {
                imageColor = this.data.attr('opened_iconColor') ? this.data.attr('opened_iconColor') : this.data.attr('iconColor');
                image = this.data.attr('opened_icon');
                if (!image) {
                    image = imageColor ? "widgets/jqui-mfd/img/fts_garage_door_10.svg" : "widgets/jqui-mfd/img/fts_garage_door_10.png";
                }
            }

            if (imageColor) {
            %>
                <img style="<%= styles %>" width="100%" src="<%= image %>" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, imageColor) %>/>
            <% 
            } else {
            %>
                <img style="<%= styles %>" width="100%" src="<%= image %>" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% 
            } 
            %>
        </div>
    </div>
</script>

<script id="tplMfdValve"
     type="text/ejs"
     class="vis-tpl"
     data-vis-set="jqui-mfd"
     data-vis-type="state,valve"
     data-vis-name="Valve"
     data-vis-prev='<div id="prev_tplMfdValve" style="position: relative; text-align: initial;padding: 4px "><div data-oid="dev1" class="vis-widget_prev vis-widget ui-widget ui-button ui-corner-all ui-state-default" style="width: 70px; height: 70px;"><div class="vis-widget-prev-body"> <img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" width="100%" src="widgets/jqui-mfd/img/sani_valve_30.png"> </div></div></div>'
     data-vis-attrs="oid;min;max;invert_icon/checkbox;asButton[true]/checkbox;iconColor/color;invert_value/checkbox;show_active/checkbox;"
     data-vis-attrs0="group.colors;iconColor0/color;iconColor1/color;iconColor2/color;iconColor3/color;iconColor4/color;iconColor5/color;iconColor6/color;iconColor7/color;iconColor8/color;iconColor9/color;iconColor10/color;"
     >
    <div data-oid="<%= this.data.attr('oid') %>" class="vis-widget vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute" <%= (el) -> this.data.attr('show_active') ? vis.binds.jqueryui.classes(el, true) : '' %>><div class="vis-widget-body">
    <%
        var styles = '';
        if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
            styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
        }

        var max = (this.data.attr('max') !== undefined) ? this.data.attr('max') : 100;
        var min = (this.data.attr('min') !== undefined) ? this.data.attr('min') : 0;

        if (typeof max === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
        if (typeof min === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);

        var val = parseFloat(vis.states.attr(this.data.oid + '.val'));
        if (this.data.invert_value) val = max - val + min;
        var image = '';
        var imageColor = null;
        if (val >= max) {
            image = "sani_valve_100";
            imageColor = this.data.attr('iconColor10');
        } else if (val >= min + (max - min) * 0.9) {
            image = "sani_valve_90";
            imageColor = this.data.attr('iconColor9');
        } else if (val >= min + (max - min) * 0.8) {
            image = "sani_valve_80";
            imageColor = this.data.attr('iconColor8');
        } else if (val >= min + (max - min) * 0.7) {
            image = "sani_valve_70";
            imageColor = this.data.attr('iconColor7');
        } else if (val >= min + (max - min) * 0.6) {
            image = "sani_valve_60";
            imageColor = this.data.attr('iconColor6');
        } else if (val >= min + (max - min) * 0.5) {
            image = "sani_valve_50";
            imageColor = this.data.attr('iconColor5');
        } else if (val >= min + (max - min) * 0.4) {
            image = "sani_valve_40";
            imageColor = this.data.attr('iconColor4');
        } else if (val >= min + (max - min) * 0.3) {
            image = "sani_valve_30";
            imageColor = this.data.attr('iconColor3');
        } else if (val >= min + (max - min) * 0.2) {
            image = "sani_valve_20";
            imageColor = this.data.attr('iconColor2');
        } else if (val >= min + (max - min) * 0.1) {
            image = "sani_valve_10";
            imageColor = this.data.attr('iconColor1');
        } else {
            image = "sani_valve_0";
            imageColor = this.data.attr('iconColor0');
        }

        if (!imageColor) {
            imageColor = this.data.attr('iconColor');
        }

        if (imageColor) { %>
            <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/<%= image %>.svg" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, imageColor) %>/>
        <% } else { %>
            <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/<%= image %>.png" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
        <% } %>
    </div></div>
</script>

<script id="tplMfdValveDialog"
     type="text/ejs"
     class="vis-tpl"
     data-vis-set="jqui-mfd"
     data-vis-type="ctrl,valve,dialog"
     data-vis-name="Valve + jqui Dialog"
     data-vis-prev='<div id="prev_tplMfdValveDialog" style="position: relative; text-align: initial;padding: 4px "><div data-oid="dev1" class="vis-widget_prev vis-widget ui-widget ui-button ui-corner-all ui-state-default  ui-state-active" style="width: 70px; height: 70px;"><div class="vis-widget-prev-body"> <img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" width="100%" src="widgets/jqui-mfd/img/sani_valve_30.png"> </div></div></div>'
     data-vis-attrs="oid;oid-working;min;max;invert_icon/checkbox;asButton[true]/checkbox;iconColor/color;invert_value/checkbox;show_active/checkbox;"
     data-vis-attrs0="group.colors;iconColor0/color;iconColor1/color;iconColor2/color;iconColor3/color;iconColor4/color;iconColor5/color;iconColor6/color;iconColor7/color;iconColor8/color;iconColor9/color;iconColor10/color;"
     data-vis-attrs1="group.dialog;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width[440];dialog_height[200];dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit;show_value/checkbox;units;">
<div data-oid="<%= this.data.attr('oid') %>" data-hm-wid="<%= this.data.attr('oid-working') %>" class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute" <%= (el) -> this.data.attr('show_active') ? vis.binds.jqueryui.classes(el, true) : '' %>>
    <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body" style="width:100%; height:100%" <%= (el) -> vis.preloadImages(['widgets/jqui-mfd/img/sani_valve_100.png','widgets/jqui-mfd/img/sani_valve_90.png','widgets/jqui-mfd/img/sani_valve_80.png','widgets/jqui-mfd/img/sani_valve_70.png','widgets/jqui-mfd/img/sani_valve_60.png','widgets/jqui-mfd/img/sani_valve_50.png','widgets/jqui-mfd/img/sani_valve_40.png','widgets/jqui-mfd/img/sani_valve_30.png','widgets/jqui-mfd/img/sani_valve_20.png','widgets/jqui-mfd/img/sani_valve_10.png','widgets/jqui-mfd/img/sani_valve_0.png']); %>>
    <%
        var styles = '';
        if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
            styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
        }
        var max = (this.data.attr('max') !== undefined) ? this.data.attr('max') : 100;
        var min = (this.data.attr('min') !== undefined) ? this.data.attr('min') : 0;

        if (typeof max === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
        if (typeof min === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);

        var val = parseFloat(vis.states.attr(this.data.oid + '.val'));

        if (this.data.attr('invert_value')) val = max - val + min;

        var image = '';
        var imageColor = null;
        if (val >= max) {
            image = "sani_valve_100";
            imageColor = this.data.attr('iconColor10');
        } else if (val >= min + (max - min) * 0.9) {
            image = "sani_valve_90";
            imageColor = this.data.attr('iconColor9');
        } else if (val >= min + (max - min) * 0.8) {
            image = "sani_valve_80";
            imageColor = this.data.attr('iconColor8');
        } else if (val >= min + (max - min) * 0.7) {
            image = "sani_valve_70";
            imageColor = this.data.attr('iconColor7');
        } else if (val >= min + (max - min) * 0.6) {
            image = "sani_valve_60";
            imageColor = this.data.attr('iconColor6');
        } else if (val >= min + (max - min) * 0.5) {
            image = "sani_valve_50";
            imageColor = this.data.attr('iconColor5');
        } else if (val >= min + (max - min) * 0.4) {
            image = "sani_valve_40";
            imageColor = this.data.attr('iconColor4');
        } else if (val >= min + (max - min) * 0.3) {
            image = "sani_valve_30";
            imageColor = this.data.attr('iconColor3');
        } else if (val >= min + (max - min) * 0.2) {
            image = "sani_valve_20";
            imageColor = this.data.attr('iconColor2');
        } else if (val >= min + (max - min) * 0.1) {
            image = "sani_valve_10";
            imageColor = this.data.attr('iconColor1');
        } else {
            image = "sani_valve_0";
            imageColor = this.data.attr('iconColor0');
        }

        if (!imageColor) {
            imageColor = this.data.attr('iconColor');
        }

        if (imageColor) { %>
            <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/<%= image %>.svg" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, imageColor) %>/>
        <% } else { %>
            <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/<%= image %>.png" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
        <% } %>
    </div>
    <div id="<%= this.data.attr('wid') %>_dialog" class="<%= this.data.attr('wid') %>_dialog vis-widget-dialog" title="<%== this.data.title || this.data.attr('oid') %>" style="padding-left: 20px;">
        <div id="<%= this.data.attr('wid') %>_radio"  class="<%= this.data.attr('wid') %>_radio" style="text-align: center" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
            <%
                var max = (this.data.attr('max') !== undefined) ? this.data.attr('max') : 100;
                var min = (this.data.attr('min') !== undefined) ? this.data.attr('min') : 0;

                if (typeof max === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
                if (typeof min === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);
            %>
            <input type="radio" id="<%= this.data.attr('wid') %>_radio0" name="<%= this.data.attr('wid') %>_radio" value="<%= !this.data.attr('invert_value') ? min : max                                           %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio0"><%= _('closed') %></label>
            <input type="radio" id="<%= this.data.attr('wid') %>_radio1" name="<%= this.data.attr('wid') %>_radio" value="<%= !this.data.attr('invert_value') ? min + (max - min) * 0.25 : min + (max - min) * 0.75 %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio1">25%</label>
            <input type="radio" id="<%= this.data.attr('wid') %>_radio2" name="<%= this.data.attr('wid') %>_radio" value="<%=                                   min + (max - min) * 0.5                             %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio2">50%</label>
            <input type="radio" id="<%= this.data.attr('wid') %>_radio3" name="<%= this.data.attr('wid') %>_radio" value="<%= !this.data.attr('invert_value') ? min + (max - min) * 0.75 : min + (max - min) * 0.25 %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio3">75%</label>
            <input type="radio" id="<%= this.data.attr('wid') %>_radio4" name="<%= this.data.attr('wid') %>_radio" value="<%= !this.data.attr('invert_value') ? max : min                                           %>"/><label for="<%= this.data.attr('wid') %>_radio4"><%= _('open') %></label>
        </div>
        <br/>
        <div class="sliderJQUI" style="width: 90%" id="<%= this.data.attr('wid') %>_slider" data-oid="<%= this.data.attr('oid') %>" data-hm-wid="<%= this.data.attr('oid-working') %>" <%= (el) -> vis.binds.jqueryui.slider(el, {min: min, max: max, step: (max - min) / 100, inverted: this.data.attr('invert_value')}) %> />
        <br/>
        <%= vis.states.attr(this.data.oid + '.val') ? (((parseFloat(vis.states.attr(this.data.oid + '.val')) - min) / (max - min)) * 100).toFixed(0) : 0 %>%
        <%= (this.data.show_value === 'true' || this.data.show_value === true) ? '(' + Math.round(parseFloat(vis.states.attr(this.data.oid + '.val') * 100) / 100) + ' ' + this.data.attr('units') + ')' : '' %>
    </div>
    <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el, data, true) %> />
    <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
</div>
</script>

<script id="tplMfdCustom10"
         type="text/ejs"
         class="vis-tpl"
         data-vis-set="jqui-mfd"
         data-vis-type="state"
         data-vis-name="Custom10"
         data-vis-prev='<div id="prev_tplMfdCustom10" style="position: relative; text-align: initial;padding: 4px "><div data-oid="dev1" class="vis-widget_prev vis-widget ui-widget ui-button ui-corner-all ui-state-default" style="width: 70px; height: 70px;"><div class="vis-widget-prev-body"> <img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" width="100%" src="widgets/jqui-mfd/img/sani_valve_custom.svg"> </div></div></div>'
         data-vis-attrs="oid;min;max;asButton[true]/checkbox;invert_value/checkbox;show_active/checkbox;"
         data-vis-attrs0="group.images;iconValue0;icon0[widgets~jqui-mfd~img~sani_valve_0.svg]/image;iconColor0/color;iconValue1;icon1[widgets~jqui-mfd~img~sani_valve_10.svg]/image;iconColor1/color;iconValue2;icon2[widgets~jqui-mfd~img~sani_valve_20.svg]/image;iconColor2/color;iconValue3;icon3[widgets~jqui-mfd~img~sani_valve_30.svg]/image;iconColor3/color;iconValue4;icon4[widgets~jqui-mfd~img~sani_valve_40.svg]/image;iconColor4/color;iconValue5;icon5[widgets~jqui-mfd~img~sani_valve_50.svg]/image;iconColor5/color;iconValue6;icon6[widgets~jqui-mfd~img~sani_valve_60.svg]/image;iconColor6/color;iconValue7;icon7[widgets~jqui-mfd~img~sani_valve_70.svg]/image;iconColor7/color;iconValue8;icon8[widgets~jqui-mfd~img~sani_valve_80.svg]/image;iconColor8/color;iconValue9;icon9[widgets~jqui-mfd~img~sani_valve_90.svg]/image;iconColor9/color;iconValue10;icon10[widgets~jqui-mfd~img~sani_valve_100.svg]/image;iconColor10/color;"
         >
    <div data-oid="<%= this.data.attr('oid') %>" class="vis-widget vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute" <%= (el) -> this.data.attr('show_active') ? vis.binds.jqueryui.classes(el, true) : '' %>>
    <div class="vis-widget-body">
    <%
        var styles = '';
        if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
            styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
        }
        var max = (this.data.attr('max') !== undefined) ? this.data.attr('max') : 100;
        var min = (this.data.attr('min') !== undefined) ? this.data.attr('min') : 0;

        if (typeof max === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
        if (typeof min === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);

        var str = vis.states.attr(this.data.oid + '.val');
        var val = parseFloat(str);
        if (str === true  || str === 'true')  val = max;
        if (str === false || str === 'false') val = min;
 
        if (this.data.attr('invert_value')) val = max - val + min;

        var image = null;
        var imageColor = null;

        if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue0')) && this.data.attr('iconValue0') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor0')) ? this.data.attr('iconColor0') : this.data.attr('iconColor');
            image = this.data.attr('icon0');
        } else if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue1')) && this.data.attr('iconValue1') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor1')) ? this.data.attr('iconColor1') : this.data.attr('iconColor');
            image = this.data.attr('icon1');
        } else if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue2')) && this.data.attr('iconValue2') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor2')) ? this.data.attr('iconColor2') : this.data.attr('iconColor');
            image = this.data.attr('icon2');
        } else if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue3')) && this.data.attr('iconValue3') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor3')) ? this.data.attr('iconColor3') : this.data.attr('iconColor');
            image = this.data.attr('icon3');
        } else if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue4')) && this.data.attr('iconValue4') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor4')) ? this.data.attr('iconColor4') : this.data.attr('iconColor');
            image = this.data.attr('icon4');
        } else if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue5')) && this.data.attr('iconValue5') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor5')) ? this.data.attr('iconColor5') : this.data.attr('iconColor');
            image = this.data.attr('icon5');
        } else if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue6')) && this.data.attr('iconValue6') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor6')) ? this.data.attr('iconColor6') : this.data.attr('iconColor');
            image = this.data.attr('icon6');
        } else if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue7')) && this.data.attr('iconValue7') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor7')) ? this.data.attr('iconColor7') : this.data.attr('iconColor');
            image = this.data.attr('icon7');
        } else if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue8')) && this.data.attr('iconValue8') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor8')) ? this.data.attr('iconColor8') : this.data.attr('iconColor');
            image = this.data.attr('icon8');
        } else if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue9')) && this.data.attr('iconValue9') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor9')) ? this.data.attr('iconColor9') : this.data.attr('iconColor');
            image = this.data.attr('icon9');
        } else if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue10')) && this.data.attr('iconValue10') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor10')) ? this.data.attr('iconColor10') : this.data.attr('iconColor');
            image = this.data.attr('icon10');
        }

        if (!image && !imageColor) {
            if (val >= max) {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor10')) ? this.data.attr('iconColor10') : this.data.attr('iconColor');
                image = this.data.attr('icon10');
            } else if (val >= min + (max - min) * 0.9) {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor9')) ? this.data.attr('iconColor9') : this.data.attr('iconColor');
                image = this.data.attr('icon9');
            } else if (val >= min + (max - min) * 0.8) {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor8')) ? this.data.attr('iconColor8') : this.data.attr('iconColor');
                image = this.data.attr('icon8');
            } else if (val >= min + (max - min) * 0.7) {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor7')) ? this.data.attr('iconColor7') : this.data.attr('iconColor');
                image = this.data.attr('icon7');
            } else if (val >= min + (max - min) * 0.6) {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor6')) ? this.data.attr('iconColor6') : this.data.attr('iconColor');
                image = this.data.attr('icon6');
            } else if (val >= min + (max - min) * 0.5) {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor5')) ? this.data.attr('iconColor5') : this.data.attr('iconColor');
                image = this.data.attr('icon5');
            } else if (val >= min + (max - min) * 0.4) {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor4')) ? this.data.attr('iconColor4') : this.data.attr('iconColor');
                image = this.data.attr('icon4');
            } else if (val >= min + (max - min) * 0.3) {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor3')) ? this.data.attr('iconColor3') : this.data.attr('iconColor');
                image = this.data.attr('icon3');
            } else if (val >= min + (max - min) * 0.2) {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor2')) ? this.data.attr('iconColor2') : this.data.attr('iconColor');
                image = this.data.attr('icon2');
            } else if (val >= min + (max - min) * 0.1) {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor1')) ? this.data.attr('iconColor1') : this.data.attr('iconColor');
                image = this.data.attr('icon1');
            } else {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor0')) ? this.data.attr('iconColor0') : this.data.attr('iconColor');
                image = this.data.attr('icon0');
            }
        }

        if (vis.binds['jqui-mfd'].isNotEmpty(image)) {
            if (vis.binds['jqui-mfd'].isNotEmpty(imageColor)) {
            %>
                <img style="<%= styles %>" width="100%" src="<%= image %>" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, imageColor) %>/>
            <% } else { %>
                <img style="<%= styles %>" width="100%" src="<%= image %>" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% } 
        } 
    %>
    </div>
    </div>
</script>

<script id="tplMfdCustom10Dialog"
         type="text/ejs"
         class="vis-tpl"
         data-vis-set="jqui-mfd"
         data-vis-type="ctrl,dialog"
         data-vis-name="Custom10 + jqui Dialog"
         data-vis-prev='<div id="prev_tplMfdCustom10Dialog" style="position: relative; text-align: initial;padding: 4px "><div data-oid="dev1" class="vis-widget_prev vis-widget ui-widget ui-button ui-corner-all ui-state-default  ui-state-active" style="width: 70px; height: 70px;"><div class="vis-widget-prev-body"> <img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" width="100%" src="widgets/jqui-mfd/img/sani_valve_custom.svg"> </div></div></div>'
         data-vis-attrs="oid;oid-working;min;max;asButton[true]/checkbox;invert_value/checkbox;show_active/checkbox;"
         data-vis-attrs0="group.dialog;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width[440];dialog_height[200];dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit;show_value/checkbox;units;"
         data-vis-attrs1="group.images;iconValue0;icon0[widgets~jqui-mfd~img~sani_valve_0.svg]/image;iconColor0/color;iconValue1;icon1[widgets~jqui-mfd~img~sani_valve_10.svg]/image;iconColor1/color;iconValue2;icon2[widgets~jqui-mfd~img~sani_valve_20.svg]/image;iconColor2/color;iconValue3;icon3[widgets~jqui-mfd~img~sani_valve_30.svg]/image;iconColor3/color;iconValue4;icon4[widgets~jqui-mfd~img~sani_valve_40.svg]/image;iconColor4/color;iconValue5;icon5[widgets~jqui-mfd~img~sani_valve_50.svg]/image;iconColor5/color;iconValue6;icon6[widgets~jqui-mfd~img~sani_valve_60.svg]/image;iconColor6/color;iconValue7;icon7[widgets~jqui-mfd~img~sani_valve_70.svg]/image;iconColor7/color;iconValue8;icon8[widgets~jqui-mfd~img~sani_valve_80.svg]/image;iconColor8/color;iconValue9;icon9[widgets~jqui-mfd~img~sani_valve_90.svg]/image;iconColor9/color;iconValue10;icon10[widgets~jqui-mfd~img~sani_valve_100.svg]/image;iconColor10/color;"
         >
 <div data-oid="<%= this.data.attr('oid') %>" data-hm-wid="<%= this.data.attr('oid-working') %>" class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute" <%= (el) -> this.data.attr('show_active') ? vis.binds.jqueryui.classes(el, true) : '' %>>
    <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body" style="width:100%; height:100%">
    <%
        var styles = '';
        if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
            styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
        }
        var max = (this.data.attr('max') !== undefined) ? this.data.attr('max') : 100;
        var min = (this.data.attr('min') !== undefined) ? this.data.attr('min') : 0;

        if (typeof max === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
        if (typeof min === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);

        var str = vis.states.attr(this.data.oid + '.val');
        var val = parseFloat(str);
        if (str === true  || str === 'true')  val = max;
        if (str === false || str === 'false') val = min;
 
        if (this.data.attr('invert_value')) val = max - val + min;

        var image = null;
        var imageColor = null;

        if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue0')) && this.data.attr('iconValue0') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor0')) ? this.data.attr('iconColor0') : this.data.attr('iconColor');
            image = this.data.attr('icon0');
        } else if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue1')) && this.data.attr('iconValue1') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor1')) ? this.data.attr('iconColor1') : this.data.attr('iconColor');
            image = this.data.attr('icon1');
        } else if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue2')) && this.data.attr('iconValue2') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor2')) ? this.data.attr('iconColor2') : this.data.attr('iconColor');
            image = this.data.attr('icon2');
        } else if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue3')) && this.data.attr('iconValue3') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor3')) ? this.data.attr('iconColor3') : this.data.attr('iconColor');
            image = this.data.attr('icon3');
        } else if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue4')) && this.data.attr('iconValue4') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor4')) ? this.data.attr('iconColor4') : this.data.attr('iconColor');
            image = this.data.attr('icon4');
        } else if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue5')) && this.data.attr('iconValue5') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor5')) ? this.data.attr('iconColor5') : this.data.attr('iconColor');
            image = this.data.attr('icon5');
        } else if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue6')) && this.data.attr('iconValue6') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor6')) ? this.data.attr('iconColor6') : this.data.attr('iconColor');
            image = this.data.attr('icon6');
        } else if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue7')) && this.data.attr('iconValue7') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor7')) ? this.data.attr('iconColor7') : this.data.attr('iconColor');
            image = this.data.attr('icon7');
        } else if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue8')) && this.data.attr('iconValue8') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor8')) ? this.data.attr('iconColor8') : this.data.attr('iconColor');
            image = this.data.attr('icon8');
        } else if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue9')) && this.data.attr('iconValue9') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor9')) ? this.data.attr('iconColor9') : this.data.attr('iconColor');
            image = this.data.attr('icon9');
        } else if (vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconValue10')) && this.data.attr('iconValue10') == str) {
            imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor10')) ? this.data.attr('iconColor10') : this.data.attr('iconColor');
            image = this.data.attr('icon10');
        }

        if (!image && !imageColor) {
            if (val >= max) {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor10')) ? this.data.attr('iconColor10') : this.data.attr('iconColor');
                image = this.data.attr('icon10');
            } else if (val >= min + (max - min) * 0.9) {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor9')) ? this.data.attr('iconColor9') : this.data.attr('iconColor');
                image = this.data.attr('icon9');
            } else if (val >= min + (max - min) * 0.8) {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor8')) ? this.data.attr('iconColor8') : this.data.attr('iconColor');
                image = this.data.attr('icon8');
            } else if (val >= min + (max - min) * 0.7) {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor7')) ? this.data.attr('iconColor7') : this.data.attr('iconColor');
                image = this.data.attr('icon7');
            } else if (val >= min + (max - min) * 0.6) {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor6')) ? this.data.attr('iconColor6') : this.data.attr('iconColor');
                image = this.data.attr('icon6');
            } else if (val >= min + (max - min) * 0.5) {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor5')) ? this.data.attr('iconColor5') : this.data.attr('iconColor');
                image = this.data.attr('icon5');
            } else if (val >= min + (max - min) * 0.4) {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor4')) ? this.data.attr('iconColor4') : this.data.attr('iconColor');
                image = this.data.attr('icon4');
            } else if (val >= min + (max - min) * 0.3) {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor3')) ? this.data.attr('iconColor3') : this.data.attr('iconColor');
                image = this.data.attr('icon3');
            } else if (val >= min + (max - min) * 0.2) {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor2')) ? this.data.attr('iconColor2') : this.data.attr('iconColor');
                image = this.data.attr('icon2');
            } else if (val >= min + (max - min) * 0.1) {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor1')) ? this.data.attr('iconColor1') : this.data.attr('iconColor');
                image = this.data.attr('icon1');
            } else {
                imageColor = vis.binds['jqui-mfd'].isNotEmpty(this.data.attr('iconColor0')) ? this.data.attr('iconColor0') : this.data.attr('iconColor');
                image = this.data.attr('icon0');
            }
        }

        if (image) {
            if (imageColor) {
            %>
                <img style="<%= styles %>" width="100%" src="<%= image %>" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, imageColor) %>/>
            <% } else { %>
                <img style="<%= styles %>" width="100%" src="<%= image %>" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% } 
        } 
    %>
    </div>
    <div id="<%= this.data.attr('wid') %>_dialog" class="<%= this.data.attr('wid') %>_dialog vis-widget-dialog" title="<%== this.data.title || this.data.attr('oid') %>" style="padding-left: 20px;">
        <div id="<%= this.data.attr('wid') %>_radio"  class="<%= this.data.attr('wid') %>_radio" style="text-align: center" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
            <%
                var max = (this.data.attr('max') !== undefined) ? this.data.attr('max') : 100;
                var min = (this.data.attr('min') !== undefined) ? this.data.attr('min') : 0;

                if (typeof max === 'string' && parseFloat(max).toString() == max) max = parseFloat(max);
                if (typeof min === 'string' && parseFloat(min).toString() == min) min = parseFloat(min);
            %>
            <input type="radio" id="<%= this.data.attr('wid') %>_radio0" name="<%= this.data.attr('wid') %>_radio" value="<%= !this.data.attr('invert_value') ? min : max                                           %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio0"><%= _('closed') %></label>
            <input type="radio" id="<%= this.data.attr('wid') %>_radio1" name="<%= this.data.attr('wid') %>_radio" value="<%= !this.data.attr('invert_value') ? min + (max - min) * 0.25 : min + (max - min) * 0.75 %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio1">25%</label>
            <input type="radio" id="<%= this.data.attr('wid') %>_radio2" name="<%= this.data.attr('wid') %>_radio" value="<%=                                   min + (max - min) * 0.5                             %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio2">50%</label>
            <input type="radio" id="<%= this.data.attr('wid') %>_radio3" name="<%= this.data.attr('wid') %>_radio" value="<%= !this.data.attr('invert_value') ? min + (max - min) * 0.75 : min + (max - min) * 0.25 %>" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio3">75%</label>
            <input type="radio" id="<%= this.data.attr('wid') %>_radio4" name="<%= this.data.attr('wid') %>_radio" value="<%= !this.data.attr('invert_value') ? max : min                                           %>"/><label for="<%= this.data.attr('wid') %>_radio4"><%= _('open') %></label>
        </div>
        <br/>
        <div class="sliderJQUI" style="width: 90%" id="<%= this.data.attr('wid') %>_slider" data-oid="<%= this.data.attr('oid') %>" data-hm-wid="<%= this.data.attr('oid-working') %>" <%= (el) -> vis.binds.jqueryui.slider(el, {min: min, max: max, step: (max - min) / 100, inverted: this.data.attr('invert_value')}) %> />
        <br/>
        <%= vis.states.attr(this.data.oid + '.val') ? (((parseFloat(vis.states.attr(this.data.oid + '.val')) - min) / (max - min)) * 100).toFixed(0) : 0 %>%
        <%= (this.data.show_value === 'true' || this.data.show_value === true) ? '(' + Math.round(parseFloat(vis.states.attr(this.data.oid + '.val') * 100) / 100) + ' ' + this.data.attr('units') + ')' : '' %>
    </div>
    <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el, data, true) %> />
    <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
</div>
</script>

 <!--script id="tplMfdHueDimmerDialog"
         type="text/ejs"
         class="vis-tpl"
         data-vis-set="jqui-mfd"
         data-vis-name="hue_ctrl - jqui Dialog HUE_DIMMABLE_LIGHT"
         data-vis-attrs="oid;title;noHeader/checkbox;autoclose/checkbox;modal/checkbox;invert_icon/checkbox"
         >
     <%
     var styles = '';
     if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
         styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
     }

     if (!localData.metaObjects[this.data.oid] || (localData.metaObjects[this.data.oid].HssType != "HUE_DIMMABLE_PLUG-IN_UNIT" && localData.metaObjects[this.data.oid].HssType != "HUE_DIMMABLE_LIGHT")) {
         console.log("Widget "+this.data.attr('wid')+" error! ID has to be HUE_DIMMABLE_LIGHT/HUE_DIMMABLE_PLUG-IN_UNIT Channel!");
     }

     if (localData.metaObjects[this.data.oid] && localData.metaObjects[this.data.oid].DPs) {
         var hueIDs = {
             STATE: localData.metaObjects[this.data.oid].DPs.STATE || 'nothing_selected',
             LEVEL: localData.metaObjects[this.data.oid].DPs.LEVEL || 'nothing_selected',
         };
     } else {
         var hueIDs = {
             STATE: 'nothing_selected',
             LEVEL: 'nothing_selected',
         };
     }

     %>
     <div data-oid="<%= hueIDs.STATE %>" class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute" <%= (el) -> vis.binds.jqueryui.classes(el) %>>
     <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body" style="width:100%; height:100%" <%= (el) -> vis.preloadImages(['widgets/jqui-mfd/img/light_light_dim_100.png','widgets/jqui-mfd/img/light_light_dim_90.png','widgets/jqui-mfd/img/light_light_dim_80.png','widgets/jqui-mfd/img/light_light_dim_70.png','widgets/jqui-mfd/img/light_light_dim_60.png','widgets/jqui-mfd/img/light_light_dim_50.png','widgets/jqui-mfd/img/light_light_dim_40.png','widgets/jqui-mfd/img/light_light_dim_30.png','widgets/jqui-mfd/img/light_light_dim_20.png','widgets/jqui-mfd/img/light_light_dim_10.png','widgets/jqui-mfd/img/light_light_dim.png']); %>>
     <%
     var str = vis.states.attr(hueIDs.LEVEL + '.val');
     var val = (parseFloat(str) + 1) / 255;

     if (val == 1) {
     %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_100.png"/>
     <% } else if (val >= 0.9) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_90.png"/>
     <% } else if (val >= 0.8) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_80.png"/>
     <% } else if (val >= 0.7) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_70.png"/>
     <% } else if (val >= 0.6) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_60.png"/>
     <% } else if (val >= 0.5) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_50.png"/>
     <% } else if (val >= 0.4) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_40.png"/>
     <% } else if (val >= 0.3) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_30.png"/>
     <% } else if (val >= 0.2) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_20.png"/>
     <% } else if (val >= 0.1) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_10.png"/>
     <% } else if (val >= 0.01) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_00.png"/>
     <% } else { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim.png"/>
     <% } %>
     </div>
     <div id="<%= this.data.attr('wid') %>_dialog" class="vis-widget-dialog" title="<%== this.data.title || this.data.attr('oid') %>" style="padding-left:20px;">

         <br/>
         <span id="<%= this.data.attr('wid') %>_radio"  data-oid="<%= hueIDs.STATE %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
         <input type="radio" id="<%= this.data.attr('wid') %>_radio_off" name="<%= this.data.attr('wid') %>_radio" value="false" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio_off"><%= _('off') %></label>
         <input type="radio" id="<%= this.data.attr('wid') %>_radio_on" name="<%= this.data.attr('wid') %>_radio" value="true"/><label for="<%= this.data.attr('wid') %>_radio_on"><%= _('on') %></label>
         </span>



         <br/><br/>
         Helligkeit
         <div class="sliderJQUI" style="width:90%" id="<%= this.data.attr('wid') %>_slider" data-oid="<%= hueIDs.LEVEL %>" data-hm-wid="<%= this.data.attr('oid-working') %>" <%= (el) -> vis.binds.jqueryui.slider(el, {min:0,max:255,step:1}) %> />


     </div>
     <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el,{width:440,height:320,modal:data.attr('modal')},true) %> />
     <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
     </div>
 </script>

 <script id="tplMfdLivingColorDialog"
         type="text/ejs"
         class="vis-tpl"
         data-vis-set="jqui-mfd"
         data-vis-name="hue_ctrl - jqui Dialog HUE_COLOR_LIGHT"
         data-vis-attrs="oid;title;noHeader/checkbox;autoclose/checkbox;modal/checkbox;invert_icon/checkbox" >
     <%
     var styles = '';
     if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
         styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
     }

     if (!localData.metaObjects[this.data.oid] || localData.metaObjects[this.data.oid].HssType != "HUE_COLOR_LIGHT") {
         console.log("Widget "+this.data.attr('wid')+" error! ID has to be HUE_COLOR_LIGHT Channel!");
     }

     if (localData.metaObjects[this.data.oid] && localData.metaObjects[this.data.oid].DPs) {
         var hueIDs = {
             STATE: localData.metaObjects[this.data.oid].DPs.STATE || 'nothing_selected',
             LEVEL: localData.metaObjects[this.data.oid].DPs.LEVEL || 'nothing_selected',
             SAT:   localData.metaObjects[this.data.oid].DPs.SAT || 'nothing_selected',
             HUE:   localData.metaObjects[this.data.oid].DPs.HUE || 'nothing_selected',
         };
     } else {
         var hueIDs = {
             STATE: 'nothing_selected',
             LEVEL: 'nothing_selected',
             SAT:   'nothing_selected',
             HUE:   'nothing_selected',
         };
     }
     %>
     <div data-oid="<%= hueIDs.STATE %>" class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute" <%= (el) -> vis.binds.jqueryui.classes(el) %>>
     <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body" style="width:100%; height:100%" <%= (el) -> vis.preloadImages(['widgets/jqui-mfd/img/light_light_dim_100.png','widgets/jqui-mfd/img/light_light_dim_90.png','widgets/jqui-mfd/img/light_light_dim_80.png','widgets/jqui-mfd/img/light_light_dim_70.png','widgets/jqui-mfd/img/light_light_dim_60.png','widgets/jqui-mfd/img/light_light_dim_50.png','widgets/jqui-mfd/img/light_light_dim_40.png','widgets/jqui-mfd/img/light_light_dim_30.png','widgets/jqui-mfd/img/light_light_dim_20.png','widgets/jqui-mfd/img/light_light_dim_10.png','widgets/jqui-mfd/img/light_light_dim.png']); %>>
     <%
     var str = vis.states.attr(hueIDs.LEVEL + '.val');
     var val = (parseFloat(str) + 1) / 255;

     if (val == 1) {
     %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_100.png"/>
     <% } else if (val >= 0.9) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_90.png"/>
     <% } else if (val >= 0.8) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_80.png"/>
     <% } else if (val >= 0.7) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_70.png"/>
     <% } else if (val >= 0.6) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_60.png"/>
     <% } else if (val >= 0.5) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_50.png"/>
     <% } else if (val >= 0.4) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_40.png"/>
     <% } else if (val >= 0.3) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_30.png"/>
     <% } else if (val >= 0.2) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_20.png"/>
     <% } else if (val >= 0.1) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_10.png"/>
     <% } else if (val >= 0.01) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_00.png"/>
     <% } else { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim.png"/>
     <% } %>
     </div>
     <div id="<%= this.data.attr('wid') %>_dialog" class="vis-widget-dialog" title="<%== this.data.title || this.data.attr('oid') %>" style="padding-left:20px;">

         <br/>
         <span id="<%= this.data.attr('wid') %>_radio"  data-oid="<%= hueIDs.STATE %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
         <input type="radio" id="<%= this.data.attr('wid') %>_radio_off" name="<%= this.data.attr('wid') %>_radio" value="false" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio_off"><%= _('off') %></label>
         <input type="radio" id="<%= this.data.attr('wid') %>_radio_on" name="<%= this.data.attr('wid') %>_radio" value="true"/><label for="<%= this.data.attr('wid') %>_radio_on"><%= _('on') %></label>
         </span>



         <br/><br/>
         Helligkeit
         <div class="sliderJQUI" style="width:90%" id="<%= this.data.attr('wid') %>_slider" data-oid="<%= hueIDs.LEVEL %>" data-hm-wid="<%= this.data.attr('oid-working') %>" <%= (el) -> vis.binds.jqueryui.slider(el, {min:0,max:255,step:1}) %> />
         <br/>

         <br/>
         <div class="hue-mode-hue">
             <div class="sliderJQUI hue-slider-hue" style="width:90%" id="<%= this.data.attr('wid') %>_hue_hue_slider" data-oid="<%= hueIDs.HUE %>" data-hm-wid="<%= this.data.attr('oid-working') %>" <%= (el) -> vis.binds.jqueryui.slider(el, {min:0,max:'nothing_selected',step:1}) %> />
             <br/>
             Sättigung
             <div class="sliderJQUI hue-slider-sat" style="width:90%" id="<%= this.data.attr('wid') %>_hue_sat_slider" data-oid="<%= hueIDs.SAT %>" data-hm-wid="<%= this.data.attr('oid-working') %>" <%= (el) -> vis.binds.jqueryui.slider(el, {min:0,max:255,step:1}) %> />
         </div>

     </div>
     <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el,{width:440,height:320,modal:data.attr('modal')},true) %> />
     <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
     </div>
 </script>

 <script id="tplMfdHueDialog"
         type="text/ejs"
         class="vis-tpl"
         data-vis-set="jqui-mfd"
         data-vis-name="hue_ctrl - jqui Dialog HUE_EXTENDED_COLOR_LIGHT"
         data-vis-attrs="oid;title;noHeader/checkbox;autoclose/checkbox;modal/checkbox;invert_icon/checkbox"
         >
     <%
     var styles = '';
     if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
         styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
     }

     if (!localData.metaObjects[this.data.oid] || localData.metaObjects[this.data.oid].HssType != "HUE_EXTENDED_COLOR_LIGHT") {
         console.log("Widget "+this.data.attr('wid')+" error! ID has to be HUE_EXTENDED_COLOR_LIGHT Channel!");
     }

     if (localData.metaObjects[this.data.oid] && localData.metaObjects[this.data.oid].DPs) {
         var hueIDs = {
             STATE: localData.metaObjects[this.data.oid].DPs.STATE || 'nothing_selected',
             LEVEL: localData.metaObjects[this.data.oid].DPs.LEVEL || 'nothing_selected',
             COLORMODE: localData.metaObjects[this.data.oid].DPs.COLORMODE || 'nothing_selected',
             CT: localData.metaObjects[this.data.oid].DPs.CT || 'nothing_selected',
             SAT: localData.metaObjects[this.data.oid].DPs.SAT || 'nothing_selected',
             HUE: localData.metaObjects[this.data.oid].DPs.HUE || 'nothing_selected',
         };
     } else {
         var hueIDs = {
             STATE: 'nothing_selected',
             LEVEL: 'nothing_selected',
             COLORMODE: 'nothing_selected',
             CT: 'nothing_selected',
             SAT: 'nothing_selected',
             HUE: 'nothing_selected'
         };
     }
     %>
     <div data-oid="<%= hueIDs.STATE %>" class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute" <%= (el) -> vis.binds.jqueryui.classes(el) %>>
     <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body" style="width:100%; height:100%" <%= (el) -> vis.preloadImages(['widgets/jqui-mfd/img/light_light_dim_100.png','widgets/jqui-mfd/img/light_light_dim_90.png','widgets/jqui-mfd/img/light_light_dim_80.png','widgets/jqui-mfd/img/light_light_dim_70.png','widgets/jqui-mfd/img/light_light_dim_60.png','widgets/jqui-mfd/img/light_light_dim_50.png','widgets/jqui-mfd/img/light_light_dim_40.png','widgets/jqui-mfd/img/light_light_dim_30.png','widgets/jqui-mfd/img/light_light_dim_20.png','widgets/jqui-mfd/img/light_light_dim_10.png','widgets/jqui-mfd/img/light_light_dim.png']); %>>
     <%
     var str = vis.states.attr(hueIDs.LEVEL + '.val');
     var val = (parseFloat(str) + 1) / 255;

     if (val == 1) {
     %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_100.png"/>
     <% } else if (val >= 0.9) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_90.png"/>
     <% } else if (val >= 0.8) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_80.png"/>
     <% } else if (val >= 0.7) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_70.png"/>
     <% } else if (val >= 0.6) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_60.png"/>
     <% } else if (val >= 0.5) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_50.png"/>
     <% } else if (val >= 0.4) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_40.png"/>
     <% } else if (val >= 0.3) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_30.png"/>
     <% } else if (val >= 0.2) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_20.png"/>
     <% } else if (val >= 0.1) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_10.png"/>
     <% } else if (val >= 0.01) { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_00.png"/>
     <% } else { %>
     <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim.png"/>
     <% } %>
     </div>
     <div id="<%= this.data.attr('wid') %>_dialog" class="vis-widget-dialog" title="<%== this.data.title || this.data.attr('oid') %>" style="padding-left:20px;">

         <br/>
         <span id="<%= this.data.attr('wid') %>_radio"  data-oid="<%= hueIDs.STATE %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
             <input type="radio" id="<%= this.data.attr('wid') %>_radio_off" name="<%= this.data.attr('wid') %>_radio" value="false" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio_off"><%= _('off') %></label>
             <input type="radio" id="<%= this.data.attr('wid') %>_radio_on" name="<%= this.data.attr('wid') %>_radio" value="true"/><label for="<%= this.data.attr('wid') %>_radio_on"><%= _('on') %></label>
         </span>

         <span style="padding-left: 25px" id="<%= this.data.attr('wid') %>_radio_cm"  data-oid="<%= hueIDs.COLORMODE %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
             <input type="radio" id="<%= this.data.attr('wid') %>_radio_cm_ct" name="<%= this.data.attr('wid') %>_radio_cm" value="ct" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio_cm_ct">weiß</label>
             <input type="radio" id="<%= this.data.attr('wid') %>_radio_cm_hs" name="<%= this.data.attr('wid') %>_radio_cm" value="hs"/><label for="<%= this.data.attr('wid') %>_radio_cm_hs">farbe</label>
         </span>

         <br/><br/>
         Helligkeit
         <div class="sliderJQUI" style="width:90%" id="<%= this.data.attr('wid') %>_slider" data-oid="<%= hueIDs.LEVEL %>" data-hm-wid="<%= this.data.attr('oid-working') %>" <%= (el) -> vis.binds.jqueryui.slider(el, {min:0,max:255,step:1}) %> />
         <br/>

         <br/>
         <div class="hue-mode-ct">
             <div class="sliderJQUI hue-slider-ct" style="width:90%" id="<%= this.data.attr('wid') %>_hue_ct_slider" data-oid="<%= hueIDs.CT %>" data-hm-wid="<%= this.data.attr('oid-working') %>" <%= (el) -> vis.binds.jqueryui.slider(el, {min:153,max:500,step:1}) %> />
         </div>
         <div class="hue-mode-hue">
             <div class="sliderJQUI hue-slider-hue" style="width:90%" id="<%= this.data.attr('wid') %>_hue_hue_slider" data-oid="<%= hueIDs.HUE %>" data-hm-wid="<%= this.data.attr('oid-working') %>" <%= (el) -> vis.binds.jqueryui.slider(el, {min:0,max:'nothing_selected',step:1}) %> />
             <br/>
             Sättigung
             <div class="sliderJQUI hue-slider-sat" style="width:90%" id="<%= this.data.attr('wid') %>_hue_sat_slider" data-oid="<%= hueIDs.SAT %>" data-hm-wid="<%= this.data.attr('oid-working') %>" <%= (el) -> vis.binds.jqueryui.slider(el, {min:0,max:255,step:1}) %> />
         </div>

     </div>
     <div class="pupup-helper" <%= (el) -> vis.binds.jqueryui.hueColormode(el, hueIDs.COLORMODE) %> />
     <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el,{width:440,height:320,modal:data.attr('modal')},true) %> />
     <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
     </div>
 </script-->

<script id="tplMfdCamSnapshot"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui-mfd"
        data-vis-type="static,camera,dialog"
        data-vis-prev='<div id="prev_tplMfdCamSnapshot" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default " style="width: 70px; height: 70px;"> <div class="vis-widget-prev-body"> <img src="widgets/jqui-mfd/img/it_camera.png" style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1); vertical-align:middle;height:100%;"></div></div></div>'
        data-vis-name="Cam/Snapshot - Dialog"
        data-vis-attrs="alt;text;asButton[true]/checkbox;iconColor/color;"
        data-vis-attrs0="group.icon;icon/image;invert_icon/checkbox;icon_interval;"
        data-vis-attrs1="group.dialog;url;interval[2000];title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width[640];dialog_height[480];dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit;"
        >
    <%
        var styles = '';
        if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
            styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
        }

    %>
    <div class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%== this.data.attr('class') %>" style="width: 76px; height: 76px;" id="<%= this.data.attr('wid') %>" <%= (el) -> this.data.attr('asButton') ? vis.binds.jqueryui.classes(el) : '' %>>
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body">
            <% if (this.data.attr('iconColor')) { %>
                <img src="<%= this.data.attr('icon') ? this.data.attr('icon') : 'widgets/jqui-mfd/img/it_camera.svg' %>" style="<%= styles %> vertical-align:middle;height:100%;" alt="<%== this.data.attr('alt') %>" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, this.data.attr('iconColor')) %>/>
            <% } else { %>
                <img src="<%= this.data.attr('icon') ? this.data.attr('icon') : 'widgets/jqui-mfd/img/it_camera.png' %>" style="<%= styles %> vertical-align:middle;height:100%;" alt="<%== this.data.attr('alt') %>" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% } %>
            <div <%= (el) -> vis.binds.basic.imgRefresh(el, {src: data.attr('icon'), refreshInterval: data.attr('icon_interval')}, this.view) %>></div>
            <%= this.data.attr('text') %>
        </div>
        <div style="overflow-y: hidden !important;" id="<%= this.data.attr('wid') %>_dialog" class="<%= this.data.attr('wid') %>_dialog vis-widget-dialog" title="<%== this.data.attr('title') %>">
            <img id="<%= this.data.wid %>_img" alt="<%= this.data.text %>" style="width:<%= this.data.dialog_width %>px; height:<%= this.data.dialog_height %>px; border:none;" src="<%= this.data.url %>"/>
            <div <%= (el) -> vis.binds.basic.imgRefresh(el, {src: data.attr('url'), refreshInterval: data.attr('interval')}, this.view) %>></div>
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el, data, true, true) %> />
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>

<script id="tplValMfdCamSnapshot"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui-mfd"
        data-vis-type="val,camera,dialog"
        data-vis-prev='<div id="prev_tplValMfdCamSnapshot" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default ui-state-active" style="width: 70px; height: 70px;"> <div class="vis-widget-prev-body"> <img src="widgets/jqui-mfd/img/it_camera.png" style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1); vertical-align:middle;height:100%;"></div></div></div>'
        data-vis-name="Cam/Snapshot - Dialog"
        data-vis-attrs="oid;alt;text;asButton[true]/checkbox;iconColor/color;"
        data-vis-attrs0="group.icon;icon/image;invert_icon/checkbox;icon_interval;"
        data-vis-attrs1="group.dialog;url;interval[2000];title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width[640];dialog_height[480];dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit;"
        >
    <%
        var styles = '';
        if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
            styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
        }
    %>
    <div class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%== this.data.attr('class') %>" style="width: 76px; height: 76px;" id="<%= this.data.attr('wid') %>" <%= (el) -> this.data.attr('asButton') ? vis.binds.jqueryui.classes(el) : '' %>>
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body">
           <% if (this.data.attr('iconColor')) { %>
                <img src="<%= this.data.attr('icon') ? this.data.attr('icon') : 'widgets/jqui-mfd/img/it_camera.svg' %>" style="<%= styles %> vertical-align:middle;height:100%;" alt="<%== this.data.attr('alt') %>" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, this.data.attr('iconColor')) %>/>
            <% } else { %>
                <img src="<%= this.data.attr('icon') ? this.data.attr('icon') : 'widgets/jqui-mfd/img/it_camera.png' %>" style="<%= styles %> vertical-align:middle;height:100%;" alt="<%== this.data.attr('alt') %>" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% } %>
            <div <%= (el) -> vis.binds.basic.imgRefresh(el, {src: data.attr('icon'), refreshInterval: data.attr('icon_interval')}, this.view) %>></div>
            <%= this.data.attr('text') %>
        </div>
        <div style="overflow-y: hidden !important;" id="<%= this.data.attr('wid') %>_dialog" class="<%= this.data.attr('wid') %>_dialog vis-widget-dialog" title="<%== this.data.attr('title') %>">
            <img id="<%= this.data.wid %>_img" alt="<%= this.data.text %>" style="width:<%= this.data.dialog_width %>px; height:<%= this.data.dialog_height %>px; border:none;" src="<%= vis.states.attr(this.data.oid + '.val' )  %>"/>
            <div <%= (el) -> vis.binds.basic.imgRefresh(el, {src: vis.states.attr(data.oid + '.val'), refreshInterval: data.attr('interval')}, this.view) %>></div>
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el, data, true, true) %> />
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>

<script id="tplMfdCamMjpg"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui-mfd"
        data-vis-prev='<div id="prev_tplMfdCamMjpg" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default" style="width: 70px; height: 70px;"> <div class="vis-widget-prev-body"> <img src="widgets/jqui-mfd/img/it_camera.png" style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1); vertical-align:middle;height:100%;"></div></div></div>'
        data-vis-type="static,camera,dialog"
        data-vis-name="Cam/Video (img) - Dialog"
        data-vis-attrs="alt;text;asButton[true]/checkbox;iconColor/color;"
        data-vis-attrs0="group.icon;icon/image;invert_icon/checkbox;icon_interval;"
        data-vis-attrs1="group.dialog;url;title;noHeader/checkbox;modal/checkbox;dialog_width[640];dialog_height[480];dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit;">
    <%
        var styles = '';
        if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
            styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
        }
        var html = '<img id="' + this.data.wid + '_img" alt="' + this.data.text + '" style="width:' + this.data.dialog_width + 'px; height:' + this.data.dialog_height + 'px; border:none;" src="' + this.data.url + '"/>';
    %>
    <div class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%== this.data.attr('class') %>" style="width: 76px; height: 76px;" id="<%= this.data.attr('wid') %>" <%= (el) -> this.data.attr('asButton') ? vis.binds.jqueryui.classes(el) : '' %>>
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body">
           <% if (this.data.attr('iconColor')) { %>
                <img src="<%= this.data.attr('icon') ? this.data.attr('icon') : 'widgets/jqui-mfd/img/it_camera.svg' %>" style="<%= styles %> vertical-align:middle;height:100%;" alt="<%== this.data.attr('alt') %>" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, this.data.attr('iconColor')) %>/>
            <% } else { %>
                <img src="<%= this.data.attr('icon') ? this.data.attr('icon') : 'widgets/jqui-mfd/img/it_camera.png' %>" style="<%= styles %> vertical-align:middle;height:100%;" alt="<%== this.data.attr('alt') %>" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% } %>
            <div <%= (el) -> vis.binds.basic.imgRefresh(el, {src: data.attr('icon'), refreshInterval: data.attr('icon_interval')}, this.view) %>></div>
            <%= this.data.attr('text') %>
        </div>
        <div>
            <div style="overflow-y: hidden !important;" id="<%= this.data.attr('wid') %>_dialog" class="<%= this.data.attr('wid') %>_dialog vis-widget-dialog" title="<%== this.data.attr('title') %>">
            </div>
            <div <%= (el) -> vis.binds.basic.imgRefresh(el, {src: data.attr('url'), refreshOnWakeUp: true}, this.view) %>>
            </div>
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el, data, false, false, html) %> />
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>

<script id="tplValMfdCamMjpg"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui-mfd"
        data-vis-type="val,camera,dialog"
        data-vis-prev='<div id="prev_tplValMfdCamMjpg" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default ui-state-active" style="width: 70px; height: 70px;"> <div class="vis-widget-prev-body"> <img src="widgets/jqui-mfd/img/it_camera.png" style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1); vertical-align:middle;height:100%;"></div></div></div>'
        data-vis-name="Cam/Video (img) - Dialog"
        data-vis-attrs="oid;alt;asButton[true]/checkbox;iconColor/color;"
        data-vis-attrs0="group.icon;icon/image;invert_icon/checkbox;icon_interval;"
        data-vis-attrs1="group.dialog;url;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width[640];dialog_height[480];dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit;"
        >
    <%
        var styles = '';
        if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
            styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
        }
        var html = '<img id="' + this.data.wid + '_img" alt="' + this.data.text + '" style="width:' + this.data.dialog_width + 'px; height:' + this.data.dialog_height + 'px; border:none;" src="' + vis.states.attr(this.data.oid + '.val' ) + '"/>';
    %>
    <div class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%== this.data.attr('class') %>" style="width: 76px; height: 76px;" id="<%= this.data.attr('wid') %>" <%= (el) -> this.data.attr('asButton') ? vis.binds.jqueryui.classes(el) : '' %>>
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body">
           <% if (this.data.attr('iconColor')) { %>
                <img src="<%= this.data.attr('icon') ? this.data.attr('icon') : 'widgets/jqui-mfd/img/it_camera.svg' %>" style="<%= styles %> vertical-align:middle;height:100%;" alt="<%== this.data.attr('alt') %>" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, this.data.attr('iconColor')) %>/>
            <% } else { %>
                <img src="<%= this.data.attr('icon') ? this.data.attr('icon') : 'widgets/jqui-mfd/img/it_camera.png' %>" style="<%= styles %> vertical-align:middle;height:100%;" alt="<%== this.data.attr('alt') %>" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% } %>
            <div <%= (el) -> vis.binds.basic.imgRefresh(el, {src: data.attr('icon'), refreshInterval: data.attr('icon_interval')}, this.view) %>></div>
            <%= this.data.attr('text') %>
        </div>
        <div>
            <div style="overflow-y: hidden !important;" id="<%= this.data.attr('wid') %>_dialog" class="<%= this.data.attr('wid') %>_dialog vis-widget-dialog" title="<%== this.data.attr('title') %>">
            </div>
            <div <%= (el) -> vis.binds.basic.imgRefresh(el, {src: data.attr('url'), refreshOnWakeUp: true}, this.view) %>>
            </div>
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el, data, false, false, html) %> />
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>

<script id="tplMfdCamVideo"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui-mfd"
        data-vis-prev='<div id="prev_tplMfdCamVideo" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default" style="width: 70px; height: 70px;"> <div class="vis-widget-prev-body"> <img src="widgets/jqui-mfd/img/it_camera.png" style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1); vertical-align:middle;height:100%;"></div></div></div>'
        data-vis-type="static,camera,dialog"
        data-vis-name="Cam/Video (html5) - Dialog"
        data-vis-attrs="alt;text;asButton[true]/checkbox;iconColor/color;use_object/checkbox;"
        data-vis-attrs0="group.icon;icon/image;invert_icon/checkbox;icon_interval;"
        data-vis-attrs1="group.dialog;src_url;poster_url;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width[640];dialog_height[480];dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit;"
        >
    <%
        var styles = '';
        if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
            styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
        }
        var html = '<' + ((this.data.use_object === 'true' || this.data.use_object === true) ? 'object' : 'video') + ' id="' + this.data.wid + '_video" style="width:' + this.data.dialog_width + 'px; height:' + this.data.dialog_height + 'px; border:none;" src="' + this.data.src_url + '" poster="' + this.data.poster_url + '" autoplay="autoplay"></' + ((this.data.use_object === 'true' || this.data.use_object === true) ? 'object' : 'video') + '>';
    %>
    <div class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%== this.data.attr('class') %>" style="width: 76px; height: 76px;" id="<%= this.data.attr('wid') %>" <%= (el) -> this.data.attr('asButton') ? vis.binds.jqueryui.classes(el) : '' %>>
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body">
           <% if (this.data.attr('iconColor')) { %>
                <img src="<%= this.data.attr('icon') ? this.data.attr('icon') : 'widgets/jqui-mfd/img/it_camera.svg' %>" style="<%= styles %> vertical-align:middle;height:100%;" alt="<%== this.data.attr('alt') %>" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, this.data.attr('iconColor')) %>/>
            <% } else { %>
                <img src="<%= this.data.attr('icon') ? this.data.attr('icon') : 'widgets/jqui-mfd/img/it_camera.png' %>" style="<%= styles %> vertical-align:middle;height:100%;" alt="<%== this.data.attr('alt') %>" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% } %>
            <div <%= (el) -> vis.binds.basic.imgRefresh(el, {src: data.attr('icon'), refreshInterval: data.attr('icon_interval')}, this.view) %>></div>
            <%= this.data.attr('text') %>
        </div>
        <div style="overflow-y: hidden !important;" id="<%= this.data.attr('wid') %>_dialog" class="<%= this.data.attr('wid') %>_dialog vis-widget-dialog" title="<%== this.data.attr('title') %>">
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el, data, false, false, html) %> />
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>

<script id="tplValMfdCamVideo"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui-mfd"
        data-vis-type="val,camera,dialog"
        data-vis-prev='<div id="prev_tplValMfdCamVideo" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default ui-state-active" style="width: 70px; height: 70px;"> <div class="vis-widget-prev-body"> <img src="widgets/jqui-mfd/img/it_camera.png" style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1); vertical-align:middle;height:100%;"></div></div></div>'
        data-vis-name="Cam/Video (html5) - Dialog"
        data-vis-attrs="oid;alt;asButton[true]/checkbox;iconColor/color;use_object/checkbox;"
        data-vis-attrs0="group.icon;icon/image;invert_icon/checkbox;icon_interval;"
        data-vis-attrs1="group.dialog;poster_url;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width[640];dialog_height[480];dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit;"
        >
    <%
        var styles = '';
        if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
            styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
        }
        var html = '<' + ((this.data.use_object === 'true' || this.data.use_object === true) ? 'object' : 'video') + ' id="' + this.data.wid + '_video" style="width:' + this.data.dialog_width + 'px; height:' + this.data.dialog_height + 'px; border:none;" src="' + vis.states.attr(this.data.oid + '.val' ) + '" poster="' + this.data.poster_url + '" autoplay="autoplay"></' + ((this.data.use_object === 'true' || this.data.use_object === true) ? 'object' : 'video') + '>';
    %>
    <div class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%== this.data.attr('class') %>" style="width: 76px; height: 76px;" id="<%= this.data.attr('wid') %>" <%= (el) -> this.data.attr('asButton') ? vis.binds.jqueryui.classes(el) : '' %>>
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body">
           <% if (this.data.attr('iconColor')) { %>
                <img src="<%= this.data.attr('icon') ? this.data.attr('icon') : 'widgets/jqui-mfd/img/it_camera.svg' %>" style="<%= styles %> vertical-align:middle;height:100%;" alt="<%== this.data.attr('alt') %>" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, this.data.attr('iconColor')) %>/>
            <% } else { %>
                <img src="<%= this.data.attr('icon') ? this.data.attr('icon') : 'widgets/jqui-mfd/img/it_camera.png' %>" style="<%= styles %> vertical-align:middle;height:100%;" alt="<%== this.data.attr('alt') %>" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% } %>
            <div <%= (el) -> vis.binds.basic.imgRefresh(el, {src: data.attr('icon'), refreshInterval: data.attr('icon_interval')}, this.view) %>></div>
            <%= this.data.attr('text') %>
        </div>
        <div style="overflow-y: hidden !important;" id="<%= this.data.attr('wid') %>_dialog" class="<%= this.data.attr('wid') %>_dialog vis-widget-dialog" title="<%== this.data.attr('title') %>">
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el, data, false, false, html) %> />
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>

<script id="tplMfdCamVideoObject"
    type="text/ejs"
    class="vis-tpl"
    data-vis-set="jqui-mfd"
    data-vis-prev='<div id="prev_tplMfdCamVideoObject" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default" style="width: 70px; height: 70px;"> <div class="vis-widget-prev-body"> <img src="widgets/jqui-mfd/img/it_camera.png" style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1); vertical-align:middle;height:100%;"></div></div></div>'
    data-vis-type="static,camera,dialog"
    data-vis-name="Cam/Video (Object) - Dialog"
    data-vis-attrs="alt;text;asButton[true]/checkbox;iconColor/color;"
    data-vis-attrs0="group.icon;icon/image;invert_icon/checkbox;icon_interval;"
    data-vis-attrs1="group.dialog;src_url;qtsrc_url;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width[640];dialog_height[480];dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit;type_application[video~quicktime]/auto,video~mpeg,video~mp4,video~ogg,video~quicktime,video~webm,video~x-ms-wmv,video~x-flv;plugin;autoplay[true]"
    >
    <%
        var styles = '';
        if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
            styles = 'filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);';
        }
        var html = '<object id="' + this.data.wid + '_video" width="' + this.data.dialog_width + 'px" height="'+ this.data.dialog_height + 'px"><embed type="' +this.data.type_application +'"  width="' + this.data.dialog_width + 'px" height="'+ this.data.dialog_height + 'px" src="' + this.data.src_url + '" qtsrc="' + this.data.qtsrc_url + '" autoplay="'+ this.data.autoplay + '" enablejavasript="true" href="javaScript:void(0)" plugin="'+ this.data.plugin + '" ></object>';
    %>
    <div class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%== this.data.attr('class') %>" style="width: 76px; height: 76px;" id="<%= this.data.attr('wid') %>" <%= (el) -> this.data.attr('asButton') ? vis.binds.jqueryui.classes(el) : '' %>>
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body">
           <% if (this.data.attr('iconColor')) { %>
                <img src="<%= this.data.attr('icon') ? this.data.attr('icon') : 'widgets/jqui-mfd/img/it_camera.svg' %>" style="<%= styles %> vertical-align:middle;height:100%;" alt="<%== this.data.attr('alt') %>" <%= (el) -> vis.binds.jqueryui.setSvgColor(el, this.data.attr('iconColor')) %>/>
            <% } else { %>
                <img src="<%= this.data.attr('icon') ? this.data.attr('icon') : 'widgets/jqui-mfd/img/it_camera.png' %>" style="<%= styles %> vertical-align:middle;height:100%;" alt="<%== this.data.attr('alt') %>" <%= (el) -> vis.binds['jqui-mfd'].removeSvg(this.data.attr('wid')) %>/>
            <% } %>
            <div <%= (el) -> vis.binds.basic.imgRefresh(el, {src: data.attr('icon'), refreshInterval: data.attr('icon_interval')}, this.view) %>></div>
            <%= this.data.attr('text') %>
        </div>
        <div style="overflow-y: hidden !important;" id="<%= this.data.attr('wid') %>_dialog" class="<%= this.data.attr('wid') %>_dialog vis-widget-dialog" title="<%== this.data.attr('title') %>">
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el, data, false, false, html) %> />
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>

<!-- --------------jqui-mfd.html--- END -->
<!-- --------------jqui.html--- START -->
<link rel="stylesheet" href="lib/css/jquery-ui-timepicker-addon-1.6.3.css" />
<script type="text/javascript" src="lib/js/jquery-ui-timepicker-addon-1.6.3.js"></script>
<style>
    #ui-datepicker-div {
        z-index: 999 !important;
    }
</style>
<script type="text/javascript">
    'use strict';

    if (vis.editMode) {
        $.extend(systemDictionary, {
            "group_dialog":     {"en": 'Dialog',            "de": "Dialog",                 "ru": "Диалог"},
            "buttontext":       {"en": "Button text",       "de": "Knopftext",              "ru": "Надпись на кнопке"},
            "href":             {"en": "Link",              "de": "Link",                   "ru": "Ссылка"},
            "href_tooltip":     {"en": "Like 'http://google.com'", "de": "Wie 'http://google.com'", "ru": "Например 'http://google.com'"},
            "target":           {"en": "target",            "de": "target",                 "ru": "target"},
            "dialog_height":    {"en": "Dialog height",     "de": "Dialoghöhe",             "ru": "Высота окна"},
            "dialog_width":     {"en": "Dialog width",      "de": "Dialogbreite",           "ru": "Ширина окна"},
            "alt":              {"en": "Tooltip (alt)",     "de": "Tooltip (alt)",          "ru": "Всплывающая подсказка (alt)"},
            "text":             {"en": "Text",              "de": "Text",                   "ru": "Текст"},
            "invert_icon":      {"en": "Invert image",      "de": "Invertiere das Bild",    "ru": "Инвертировать картинку"},
            "html_dialog":      {"en": "HTML in dialog",    "de": "HTML im Dialog",         "ru": "HTML в диалоговом окне"},
            "preload":          {"en": "Prerender dialog",  "de": "Prerender Dialog",       "ru": "Рендер содержания в начале"},
            "closeOnClick":     {"en": "Close by click on dialog",  "de": "Anklicken zum Schliessen",       "ru": "Закрыть по нажатию в любом месте"},
            "preload_tooltip":  {
                "en": "If true, the content of dialog will be created at start of view.\x0AIf false, the content will be created during opening of dialog.\x0AWebcams or dynamic content require 'prerender'=false",
                "de": "Falls true, wird Inhalt vom Dialog sofort am Anfang gerendert.\x0AFalls false, erst beim Anzeigen vom Dialog.\x0AWebcams oder dynamischer Inhalt müssen prerender auf false haben",
                "ru": "Если да, то рендер содержания будет в самом начале.\x0AЕсли нет, то при показе диалога.\x0AWebCams или динамическое содержание требуют значение false."
            },
            "persistent":       {"en": "Persistent",        "de": "Dauernd",                "ru": "Существует постоянно"},
            "persistent_tooltip":  {
                "en": "If true, the dialog will be created at start and can\x0Abe shown by external command 'dialogOpen'.",
                "de": "Falls true, wird der Dialog sofort am Anfang erzeugtx0Aund kann mit dem Befehl 'dialogOpen' angezeigt werden.",
                "ru": "Если да, то диалог будет создан в самом начале и\x0Aможет быть вызван внешней командой 'dialogOpen'."
            },
            "src_true":         {"en": "Icon by ON",         "de": "Icon bei AN",           "ru": "Иконка при ВКЛ"},
            "alt_true":         {"en": "Tooltip by ON",      "de": "Tooltip bei AN",        "ru": "Подсказка при ВКЛ"},
            "src_false":        {"en": "Icon by OFF",        "de": "Icon bei AUS",          "ru": "Иконка при ВЫКЛ"},
            "alt_false":        {"en": "Tooltip by OFF",     "de": "Tooltip bei AUS",       "ru": "Подсказка при ВЫКЛ"},
            "timeOnly":         {"en": "Time only",          "de": "Nur Zeit",              "ru": "Только время"},
            "hideSeconds":      {"en": "Hide seconds",       "de": "Keine Sekunden",        "ru": "спрятать секунды"},
            "stepMinute":       {"en": "Step size minutes",  "de": "Schrittweite Minuten",  "ru": "размер шага минуты"},
            "showGrid":         {"en": "Show grid",          "de": "Zeige Raster",          "ru": "показать сетку"},
            "inverted":         {"en": "Inverted value",     "de": "Wert invertiert",       "ru": "Иневртировать значение"},
            "submitmethod":     {"en": "Submit method",      "de": "Sendemethode",          "ru": "Метод"},
            "click_id":         {"en": "Control ID",         "de": "Steuer-ID",             "ru": "Контроль-ID"},
            "click_value":      {"en": "Control value",      "de": "Steuerwert",            "ru": "Контроль-значение"},
            "false_text":       {"en": "Text inactive",      "de": "Inaktiv-Text",          "ru": "Неактивный текст"},
            "true_text":        {"en": "Text active",        "de": "Aktiv-Text",            "ru": "Активный текст"},
            "false_src":        {"en": "Icon inactive",      "de": "Inaktiv-Bild",          "ru": "Неактивная картинка"},
            "true_src":         {"en": "Icon active",        "de": "Aktiv-Bild",            "ru": "Активная картинка"},
            "false_alt":        {"en": "Tooltip inactive",   "de": "Inaktiv-Tooltip",       "ru": "Неактивная подсказка"},
            "true_alt":         {"en": "Tooltip active",     "de": "Aktiv-Tooltip",         "ru": "Активная подсказка"},
            "dialog_top":       {"en": "Top",                "de": "Position oben",         "ru": "Позиция сверху"},
            "dialog_left":      {"en": "Left",               "de": "Position links",        "ru": "Позиция слева"},
            "overflowX":        {"en": "Overflow X",         "de": "Overflow X",            "ru": "Overflow X"},
            "overflowY":        {"en": "Overflow Y",         "de": "Overflow Y",            "ru": "Overflow Y"},
            "noHeader":         {"en": "Hide header",        "de": "Kopfzeile verbergen",   "ru": "Скрыть заголовок"},
            "setId":            {"en": "Set Object ID",      "de": "Setze Objekt-ID",       "ru": "Записать в Объект с ID"},
            "setId_tooltip":    {
                "en": "By opening of dialog the Object ID\x0Awill be set with given value.",
                "de": "Beim Öffnen des Dialogs wird die Object ID\x0Amit dem eingegebenen Wert gesetzt.",
                "ru": "При открытии диалога в объект с этим ID будет записано значение"
            },
            "setValue":         {"en": "Set value",          "de": "Setze Wert",            "ru": "Записываемое значение"},
            "oid-2":            {"en": "OID Range max.",     "de": "OID Bereich max.",      "ru": "ID Объекта макс"},
            "oid-2-working":    {"en": "OID Working max.",   "de": "OID Working max.",      "ru": "ID working макс"},
            "asString":         {"en": "As string",          "de": "Als String",            "ru": "Строковое значение"},
            "values":           {"en": "Values",             "de": "Werte",                 "ru": "Значения"},
            "values_tooltip":   {
                "en": "Values divided by semicolon:\x0A0;1;2",
                "de": "Werte sind mit Semikolon getrennt:\x0A0;1;2",
                "ru": "Значения разделены точкой с запятой:\x0A0;1;2"
            },
            "texts":            {"en": "Texts",             "de": "Texte",                  "ru": "Тексты"},
            "height":           {"en": "Height",            "de": "Höhe",                   "ru": "Высота"},
            "no_style":         {"en": "No jQuery style",   "de": "Ohne jQuery Stil",       "ru": "Без стиля jQuery"},
            "Password":         {"en": "Password",          "de": "Kennwort",               "ru": "Пароль"},
            "imageHeight":      {"en": "Image height %",    "de": "Bildhöhe in %",          "ru": "Высота иконки в %"},
            "autoclose":        {"en": "Auto close (ms)",   "de": "Auto-Zu (ms)",           "ru": "Автозакрытие (мс)"},
            "modal":            {"en": "Modal",             "de": "Modal",                  "ru": "Модальное"},
            "texts_tooltip":   {
                "en": "Texts divided by semicolon:\x0AOn;Off;Auto",
                "de": "Texte sind mit Semikolon getrennt:\x0AAn;Aus;Auto",
                "ru": "Тексты разделены точкой с запятой:\x0AВкл;Выкл;Авто"
            }
        });
    }
    $.extend(systemDictionary, {
        "Password": {"en": "Password", "de": "Kennwort", "ru": "Пароль"}
    });

    vis.navChangeCallbacks.push(function (view) {
        $('.jqui-nav-state').each(function () {
            var $this = $(this);
            if ($this.attr('data-vis-nav') === view) {
                $this.removeClass('ui-state-default');
                $this.addClass('ui-state-active');
            } else {
                $this.addClass('ui-state-default');
                $this.removeClass('ui-state-active');
            }
        });
    });

    vis.binds.jqueryui = {
        navigationActive: function (el, nav_view) {
            var $this = $(el);
            if (window.location.hash.slice(1) === nav_view) {
                $this.removeClass('ui-state-default').addClass('ui-state-active');
            }
        },
        months: {
            "en": ['January', 'February', 'March', 'April',  'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
            "de": ['Januar',  'Februar',  'März',  'April',  'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'],
            "ru": ['Январь',  'Февраль',  'Март',  'Апрель', 'Май', 'Июнь', 'Июль', 'Август', 'Сентябрь',  'Октябрь', 'Ноябрь',   'Декабрь']
        },
        shortMonths: {
            "en": ['Jan', 'Feb', 'Mar',  'Apr', 'May', 'Jun',  'Jul',  'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
            "de": ['Jan', 'Feb', 'Mär',  'Apr', 'Mai', 'Jun',  'Jul',  'Aug', 'Sep', 'Okt', 'Nov', 'Dez'],
            "ru": ['Янв', 'Фев', 'Март', 'Апр', 'Май', 'Июня', 'Июля', 'Авг', 'Сен', 'Окт', 'Ноя', 'Дек']
        },
        weekDays: {
            "en": ['Sunday',      'Monday',      'Tuesday',  'Wednesday', 'Thursday',   'Friday',  'Saturday'],
            "de": ['Sonntag',     'Montag',      'Dienstag', 'Mittwoch',  'Donnerstag', 'Freitag', 'Samstag'],
            "ru": ['Воскресение', 'Понедельник', 'Вторник',  'Среда',     'Четверг',    'Пятница', 'Суббота']
        },
        shortWeekDays: {
            "en": ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'],
            "de": ["So", "Mo", "Di", "Mi", "Do", "Fr", "Sa"],
            "ru": ['Вс', 'Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб']
        },
        currentText: {
            "en": 'Now',
            "de": 'Jetzt',
            "ru": 'Сейчас'
        },
        closeText: {
            "en": 'Close',
            "de": 'Schließen',
            "ru": 'Закрыть'
        },
        timeText: {
            "en": 'Time',
            "de": 'Zeit',
            "ru": 'Время'
        },
        hourText: {
            "en": 'Hour',
            "de": 'Std',
            "ru": 'Час'
        },
        minuteText: {
            "en": 'Min',
            "de": 'Min',
            "ru": 'Мин'
        },
        secondText: {
            "en": 'Sec',
            "de": 'Sek',
            "ru": 'Сек'
        },
        timeOnlyTitle: {
            "en": 'Choose Time',
            "de": 'Zeit auswählen',
            "ru": 'Установите время'
        },
        activeHelper: function ($this, val, min, max, value, reverse) {
            if (val === true  || val === 'true')  val = max;
            if (val === false || val === 'false') val = min;

            if (max === undefined || max === '' || max === null) {
                max = 1;
                min = 0;
                val = (val === 'false' || val === false || val === 0 || val === '0' || val === '' || val === null || val === undefined) ? min : max;
            }

            if (reverse) {
                if (val == max) {
                    val = min;
                } else {
                    val = max;
                }
            }

            if (value === undefined && val > min && val !== true) {
                val = parseFloat(val) || 0;
            }

            if ((value === undefined && val > min) || (value !== undefined && val == value)) {
                $this.addClass('ui-state-active');
            } else {
                $this.removeClass('ui-state-active');
            }
        },
        active: function (el, reverse, _value) {
            var $this = $(el);
            var oid = $this.data('oid');
            var max = $this.data('max') || 1;
            var min = $this.data('min') || 0;

            function onChange(e, newVal) {
                vis.binds.jqueryui.activeHelper($this, newVal, min, max, _value, reverse);
            }

            if (oid) {
                // remember all ids, that bound
                $this.parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);

                vis.states.bind(oid + '.val', onChange);
                vis.binds.jqueryui.activeHelper($this, vis.states.attr(oid + '.val'), min, max, _value, reverse);
            }
        },
        classes: function (el, reverse, _value) {
            var $this = $(el);
            if (!$this.data('no-style')) {
                $this.hover(function () {
                    $this.addClass('ui-state-hover');
                }, function () {
                    $this.removeClass('ui-state-hover');
                });
            } else {
                $this.removeClass('ui-widget ui-corner-all ui-state-default');
            }

            $this.css({position: 'absolute'});
            vis.binds.jqueryui.active(el, reverse, _value);
        },
        dialog: function (el, options, persistent, preload, html, closeOnClick) {
            var $dlg = $(el).parent().find('div.vis-widget-dialog');
            $dlg.data('preload', (!preload || preload === 'false') && !$dlg.html().replace(/\s/g, ''));
            $('[aria-describedby="' + $dlg.attr('id') + '"]').remove();

            options.width     = options.width  || options.dialog_width;
            options.height    = options.height || options.dialog_height;
            options.top       = options.top    || options.dialog_top;
            options.left      = options.left   || options.dialog_left;
            options.minHeight = options.height;
            options.minWidth  = options.width;

            // Show dialog in edit mode too
            if (1 || !vis.editMode) {
                $(el).parent().find('div.vis-widget-body').on('click touchend', function (event) {
                    event.stopPropagation();
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    if ($dlg.data('preload')) $dlg.html(html);

                    if (persistent) {
                        if (options.setId) vis.setValue(options.setId, options.setValue);
                        $dlg.dialog('open');
                        $dlg.parent().css('z-index', 998);
                        $dlg.parent().find('.ui-widget-header button .ui-button-text').html('');
                        if (options.minHeight)   $dlg.css('min-height', options.minHeight);
                        if (options.minWidth)    $dlg.css('min-width', options.minWidth);
                        if (options.top  || options.top  === 0 || options.top  === '0') $dlg.parent().css('top',  options.top);
                        if (options.left || options.left === 0 || options.left === '0') $dlg.parent().css('left', options.left);
                        if (options.overflowX) $dlg.css('overflow-x', options.overflowX);
                        if (options.overflowY) $dlg.css('overflow-y', options.overflowY);
                        if (options.noHeader) {
                            $dlg.parent().find('.ui-dialog-titlebar').css({background: 'rgba(0,0,0,0)', border: 0, color: 'rgba(0,0,0,0)'});
                            $dlg.parent().find('.ui-dialog-title').html('&nbsp;');
                        }
                        $dlg.parent().find('.ui-state-focus').blur();
                    } else {
                        $dlg.dialog($.extend({
                            autoOpen: true,
                            open: function () {
                                $(this).parent().find('.ui-widget-header button .ui-button-text').html('');
                                if (options.setId) vis.setValue(options.setId, options.setValue);
                                $(this).parent().css('z-index', 998);
                                if (options.minHeight)   $(this).css('min-height', options.minHeight);
                                if (options.minWidth)    $(this).css('min-width', options.minWidth);
                                if (options.top  || options.top  === 0 || options.top  === '0') $(this).parent().css('top',  options.top);
                                if (options.left || options.left === 0 || options.left === '0') $(this).parent().css('left', options.left);
                                if (options.overflowX) $(this).css('overflow-x', options.overflowX);
                                if (options.overflowY) $(this).css('overflow-y', options.overflowY);
                                if (options.noHeader) {
                                    $dlg.parent().find('.ui-dialog-titlebar').css({background: 'rgba(0,0,0,0)', border: 0, color: 'rgba(0,0,0,0)'});
                                    $dlg.parent().find('.ui-dialog-title').html('&nbsp;');
                                }
                                $(this).parent().find('.ui-state-focus').blur();
                                //touchscreen fix
                                var $closeButton = $(this).parent().find('button.ui-dialog-titlebar-close');
                                $closeButton.off('touchend').on('touchend', function (event) {
                                    event.stopPropagation();
                                    $dlg.dialog('close');
                                    return false;
                                });
                            },
                            close: function () {
                                if ($dlg.data('timer')) { clearTimeout($dlg.data('timer')); $dlg.data('timer', null)};
                                $dlg.dialog('destroy');
                                // Destroy content if not preloaded
                                if ($dlg.data('preload')) $dlg.html('');
                            }
                        }, options));

                        $dlg.data('inited', true);

                        if (closeOnClick) {
                            $dlg.off('click touchstart touchend').on('click touchend', function (event) {
                                event.stopPropagation();
                                $dlg.dialog('close');
                                return false;
                            });
                        }
                    }
                    return false;
                });
            }
            if (persistent) {
                $dlg.dialog($.extend({
                    autoOpen: false,
                    open: function () {
                        $dlg.parent().css({'z-index': 1000});
                        if ($dlg.data('preload')) $dlg.html(html);
                        //touchscreen fix
                        var $closeButton = $(this).parent().find('button.ui-dialog-titlebar-close');
                        $closeButton.off('touchend').on('touchend', function (event) {
                            event.stopPropagation();
                            $dlg.dialog('close');
                            return false;
                        });
                    },
                    close: function () {
                        if ($dlg.data('timer')) {
                            clearTimeout($dlg.data('timer'));
                            $dlg.data('timer', null);
                        }
                        // Destroy content if not preloaded
                        if ($dlg.data('preload')) $dlg.html('');
                    }
                }, options));

                $dlg.data('inited', true);

                if (closeOnClick) {
                    $dlg.off('click touchstart touchend').on('click touchend', function (event) {
                        event.stopPropagation();
                        $dlg.dialog('close');
                        return false;
                    });
                }
            }
        },
        dialogContainer: function (el, options, persistent, preload) {
            var $dlg = $(el).parent().find('div.vis-widget-dialog');

            var id = $(el).parent().attr('id');
            if (id && id.match(/_removed$/)) {
                return;
            }

            if (!$dlg.length) {
                setTimeout(function () {
                    vis.binds.jqueryui.dialogContainer(el, options, persistent, preload);
                }, 200);
                return;
            }

            options.width     = options.dialog_width;
            options.height    = options.dialog_height;
            options.top       = options.dialog_top;
            options.left      = options.dialog_left;
            options.minHeight = options.height;
            options.minWidth  = options.width;

            $dlg.dialog($.extend({
                autoOpen: false,
                open: function () {
                    $(this).parent().find('.ui-widget-header button .ui-button-text').html('');
                    $(this).parent().css('z-index', 998);
                    //touchscreen fix
                    $dlg.find('.vis-view-container').each(function () {
                        var cview = $(this).attr('data-vis-contains');
                        if (!vis.views[cview]) {
                            $(this).append('error: view not found.');
                            return false;
                        } else if (cview === vis.activeView) {
                            $(this).append('error: view container recursion.');
                            return false;
                        }
                        var $this = this;
                        vis.renderView(cview, cview, false, function (_view) {
                            $('#visview_' + _view)
                                    .appendTo($this)
                                    .show();
                        });
                    });

                    if (options.setId) vis.setValue(options.setId, options.setValue);
                    var $id =  $(this);
                    if (options.minHeight)   $id.css('min-height', options.minHeight);
                    if (options.minWidth)    $id.css('min-width',  options.minWidth);
                    if (options.top  || options.top  === 0 || options.top  === '0') $id.parent().css('top',  options.top);
                    if (options.left || options.left === 0 || options.left === '0') $id.parent().css('left', options.left);
                    if (options.overflowX) $id.css('overflow-x', options.overflowX);
                    if (options.overflowY) $id.css('overflow-y', options.overflowY);
                    if (options.noHeader) {
                        $id.parent().find('.ui-dialog-titlebar').css({background: 'rgba(0,0,0,0)', border: 0, color: 'rgba(0,0,0,0)'});
                        $id.parent().find('.ui-dialog-title').html('&nbsp;');
                    }
                    $id.parent().find('.ui-state-focus').blur();

                    var $closeButton = $(this).parent().find('button.ui-dialog-titlebar-close');
                    $closeButton.off('touchend').on('touchend', function (event) {
                        event.stopPropagation();
                        $dlg.dialog('close');
                        var $view = $dlg.find('.vis-view');
                        if (!$view.data('persistent')) {
                            vis.destroyView($view.data('view'), $view.data('view'));
                        }
                        return false;
                    });
                },
                close: function () {
                    if ($dlg.data('timer')) {
                        clearTimeout($dlg.data('timer'));
                        $dlg.data('timer', null);
                    }
                    vis.destroyUnusedViews();
                }
            }, options));

            if (persistent) $dlg.find('.vis-view-container').data('persistent', persistent);

            if (!vis.editMode) {
                $(el).parent().find('div.vis-widget-body').on('click touchend', function (event) {
                    event.stopPropagation();
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    var $id =  $('#' + $(this).parent().attr('id') + '_dialog');
                    $id.dialog('open');
                    return false;
                });
            } else {
                $(el).parent().find('div.vis-widget-body').show();
            }
        },
        dialogAutoClose: function (el, timeout) {
            if (timeout === true || timeout === 'true') timeout = 10000;
            if (timeout === null || timeout === undefined || timeout === '') return;
            timeout = parseInt(timeout, 10);
            if (timeout < 60) {
                // may be this is seconds
                timeout *= 1000;
            }
            if (!timeout) timeout = 1000;

            var $dialog = $('#' + $(el).parent().attr('id') + '_dialog');

            var id = $(el).parent().attr('id');
            if (id && id.match(/_removed$/)) {
                return;
            }

            if (!$dialog.length) {
                setTimeout(function () {
                    vis.binds.jqueryui.dialogAutoClose(el, timeout);
                }, 200);
                return;
            }

            $dialog.on('dialogopen', function () {
                $dialog.find('input').on('click', function () {
                    var timer = $dialog.data('timer');
                    if (timer) clearTimeout(timer);
                    $dialog.data('timer', setTimeout(function () {
                        $dialog.data('timer', null);
                        $dialog.dialog('close');
                    }, timeout));
                });
                $dialog.data('timer', setTimeout(function () {
                    $dialog.data('timer', null);
                    $dialog.dialog('close');
                }, timeout));
            });
        },
        dialogClose: function (el, options) {
            if (!$(el).data('no-style')) {
                setTimeout(function () {
                    $(el).button({
                        icons: {
                            primary: options.iconClass ? 'ui-icon-' + options.iconClass : null
                        }
                    });
                }, 0);
            }
            $(el).click(function () {
                if (options.dlgName) {
                    $('#' + options.dlgName + '_dialog').dialog('close');
                } else {
                    var $parent = $(this).parent().parent().parent();
                    var $dlg = $parent.find('.vis-widget-dialog');
                    if ($dlg.length) {
                        $dlg.dialog('close');
                        return;
                    }
                    $parent = $parent.parent();
                    $dlg = $parent.find('.vis-widget-dialog');
                    if ($dlg.length) {
                        $dlg.dialog('close');
                        return;
                    }
                    $parent = $parent.parent();
                    $dlg = $parent.find('.vis-widget-dialog');
                    if ($dlg.length) {
                        $dlg.dialog('close');
                        return;
                    }
                    $parent = $parent.parent();
                    $dlg = $parent.find('.vis-widget-dialog');
                    if ($dlg.length) {
                        $dlg.dialog('close');
                        return;
                    }
                }
            });
        },
        input: function (el, options, asString) {
            var $this  = $(el);
            var oid    = $this.attr('data-oid');
            var digits = options;
            asString = asString === 'true' || asString === true;
            if (!$this.data('no-style')) {
                $this.button().addClass('ui-state-default');
            } else {
                $this.removeClass('ui-widget ui-corner-all ui-state-default');
            }
            $this.css({
                'font':       'inherit',
                //'color' :   'inherit',
                'text-align': 'left',
                'outline':    'none',
                'cursor':     'text',
                height:       '50%'
            }).change(function () {
                vis.setValue(oid, $(this).val());
            });

            function onChange(e, newVal) {
                if (!asString && digits && digits !== '') {
                    newVal = parseFloat(newVal).toFixed(digits);
                }

                $this.val(newVal);
            }
            var val = '';
            if (oid) {
                vis.states.bind(oid + '.val', onChange);
                // remember all ids, that bound
                $this.parent().parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);

                val = vis.states[oid + '.val'];
                if (!asString && digits && digits !== '') {
                    val = parseFloat(vis.states[oid + '.val']).toFixed(digits);
                }
            }
            $this.val(val);
        },
        inputDate: function (el, options) {
            var $this = $(el);
            var oid = $this.attr('data-oid');
            var datepickerOptions = $.extend(true, {
                dateFormat:      'yy-mm-dd',
                monthNamesShort: vis.binds.jqueryui.shortMonths[vis.language],
                monthNames:      vis.binds.jqueryui.months[vis.language],
                dayNamesMin:     vis.binds.jqueryui.shortWeekDays[vis.language],
                showAnim:        'fadeIn',
                firstDay: 1,
                currentText:     vis.binds.jqueryui.currentText[vis.language],
                closeText:       vis.binds.jqueryui.closeText[vis.language]

            }, options);

            $this.addClass('ui-widget ui-button ui-corner-all ui-state-default')
                    .css({
                        font:       'inherit',
                        //'color' :   'inherit',
                        'text-align': 'left',
                        outline:    'none',
                        cursor:     'text',
                        height:     '95%'
                    });

            if (!vis.editMode) $this.datepicker(datepickerOptions);

            function onChange(e, newVal) {
                $this.val(newVal);
            }

            if (oid) {
                $this.change(function () {
                    vis.setValue(oid, $(this).val());
                });

                vis.states.bind(oid + '.val', onChange);

                // remember all ids, that bound
                $this.parent().parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);

                $this.val(vis.states.attr(oid + '.val'));
            }
        },
        inputDatetime: function (el, options) {
            var $this = $(el);
            var oid = $this.attr('data-oid');
            var timeFormat = options.showSecond ? 'HH:mm:ss' : 'HH:mm';
            var hourGrid = options.showGrid ? 6 : 0;
            var minuteGrid = options.showGrid ? options.stepMinute : 0;
            if (minuteGrid < 10) {minuteGrid = 10;}
            var secondGrid = options.showGrid ? 15 : 0;
            var timepickerOptions = $.extend(true, {
                dateFormat:      'yy-mm-dd',
                monthNamesShort: vis.binds.jqueryui.shortMonths[vis.language],
                monthNames:      vis.binds.jqueryui.months[vis.language],
                dayNamesMin:     vis.binds.jqueryui.shortWeekDays[vis.language],
                showAnim:        'fadeIn',
                firstDay:        1,
                timeText:        vis.binds.jqueryui.timeText[vis.language],
                hourText:        vis.binds.jqueryui.hourText[vis.language],
                minuteText:      vis.binds.jqueryui.minuteText[vis.language],
                secondText:      vis.binds.jqueryui.secondText[vis.language],
                currentText:     vis.binds.jqueryui.currentText[vis.language],
                closeText:       vis.binds.jqueryui.closeText[vis.language],
                timeOnlyTitle:   vis.binds.jqueryui.timeOnlyTitle[vis.language],
                minuteGrid:      minuteGrid,
                hourGrid:        hourGrid,
                secondGrid:      secondGrid,
                timeOnly:        false,
                showSecond:      true,
                timeFormat:      timeFormat,
                pickerTimeFormat: timeFormat
            }, options);
            $this.addClass('ui-state-default')
                    .css({
                        font:       'inherit',
                        //color:    'inherit',
                        'text-align': 'left',
                        outline:    'none',
                        cursor:     'text',
                        height:     '95%'
                    });
            // Store options
            $this[0].__options = options;

            if (!vis.editMode) {
                $this.datetimepicker(timepickerOptions).button();
            } else {
                $this.addClass('ui-widget ui-button ui-corner-all');
            }


            function onChange(e, newVal) {
                $this.val(newVal);
            }

            if (oid) {
                $this.change(function () {
                    var $this = $(this);
                    var val = $this.val();
                    /*if ($this[0].__options && !$this[0].__options.showSecond) {
                     var vals = val.split(':');
                     if (vals.length === 3) {
                     val = vals[0] + ":" + vals[1];
                     }
                     }*/
                    vis.setValue(oid, val);
                });
                vis.states.bind(oid + '.val', onChange);
                // remember all ids, that bound
                $this.parent().parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);

                $this.val(vis.states.attr(oid + '.val'));
            }
        },
        inputset: function (el, options, asString) {
            var digits    = options;
            var $this     = $(el);
            var input     = '#' + $this.attr('id').slice(0, -3) + 'input';
            var noJsStyle = $(el).data('no-style');
            var oid = $this.attr('data-oid');
            asString = asString === 'true' || asString === true;
            if (!noJsStyle) $this.button();

            $this.css({'padding-left': 5, 'padding-right': 5});

            if (!vis.editMode) {
                $this.on('click touchstart', function () {
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    vis.setValue(oid, $(input).val());
                });

                // send text on enter
                setTimeout(function () {
                    $(input).keydown(function (e) {
                        if (e.keyCode === 13) vis.setValue(oid, $(this).val());
                    });
                }, 100);
            }

            if (!noJsStyle) $this.prev().button();

            $this.prev().addClass('ui-state-default')
                    .css({
                        font:            'inherit',
                        'padding-left':  5,
                        'padding-right': 5,
                        //'color' :   'inherit',
                        'text-align':   'left',
                        outline:        'none',
                        cursor:         'text',
                        height:         '95%'
                    });

            function onChange(e, newVal) {
                if (!asString && digits && digits !== '') {
                    newVal = parseFloat(newVal).toFixed(digits);
                }
                $(input).val(newVal);
            }

            if (oid) {
                vis.states.bind(oid + '.val', onChange);
                // remember all ids, that bound
                $this.parent().parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);

                var newVal = vis.states[oid + '.val'];
                if (!asString && digits && digits !== '') newVal = parseFloat(newVal).toFixed(digits);
                $(input).val(newVal);
            }
        },
        multiselect: function (el, options, isOpen) {
            var $this = $(el);
            var oid = $this.attr('data-oid');
            var noJsStyle = $this.attr('data-no-style');
            if (oid) $this.val(vis.states[oid + '.val']);

            if (noJsStyle !== true && noJsStyle !== 'true') {
                $this.multiselect($.extend({
                    minWidth:         $this.parent().parent().width() - 7,
                    multiple:         false,
                    header:           false,
                    noneSelectedText: false,
                    selectedList:     1
                }, options)).change(function () {
                    var val = $this.val();
                    if (parseFloat(val).toString() == val) val = parseFloat(val);
                    if (val === 'true')  val = true;
                    if (val === 'false') val = false;
                    if (!vis.editMode) vis.setValue(oid, val);
                });
            } else {
                $this.change(function () {
                    var val = $this.val();
                    if (parseFloat(val).toString() == val) val = parseFloat(val);
                    if (val === 'true') val = true;
                    if (val === 'false') val = false;
                    if (!vis.editMode) vis.setValue(oid, val);
                });
            }

            $this.val(vis.states[oid + '.val']);
            $this.prop('disabled', vis.editMode);
            if (noJsStyle !== true && noJsStyle !== 'true') {
                $this.multiselect('refresh');
            }
            var id =  $this.attr('id');

            function onChange(e, newVal) {
                var $select = $('#' + id);
                $select.val(newVal);
                if (noJsStyle !== true && noJsStyle !== 'true') {
                    $select.multiselect('refresh');
                }
            }

            if (oid) {
                vis.states.bind(oid + '.val', onChange);
                // remember all ids, that bound
                $this.parent().parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);
            }

            if (vis.editMode) {
                if (noJsStyle !== true && noJsStyle !== 'true' && isOpen) {
                    $this.multiselect('open');
                }

                vis.bindWidgetClick($this.attr('data-view'), $this.attr('id').replace('_multiselect', ''));
                $this.parent().parent().resize(function () {
                    if (noJsStyle !== true && noJsStyle !== 'true') {
                        $('#' + id).multiselect('option', 'minWidth', $(this).width() - 7);
                    }
                }).data('destroy', function (id, $widget) {
                    $widget.off('resize');
                });
            }
        },
        slider: function (el, options) {
            var $this       = $(el);
            var oid         = $this.attr('data-oid');
            var oid2        = $this.attr('data-oid2');
            var oid_val     = 0;
            var oid2_val    = 0;
            var wid         = $this.attr('data-oid-working');
            var wid2        = $this.attr('data-oid2-working');

            var settings    = $.extend({
                range:  !!oid2,
                min:    0,
                max:    100,
                step:   1,
                value:  parseFloat(vis.states.attr(oid + '.val')),
                slide:  function (e, ui) {
                    if (options.submitmethod !== 'stop') {
                      // Slider -> Observable
                      if (oid2) {
                        if (options.inverted) {
                          ui.values[0] = (settings.max - ui.values[0]) + settings.min;
                          ui.values[1] = (settings.max - ui.values[1]) + settings.min;
                        }

                        oid && vis.setValue(oid, ui.values[0]); //.toFixed(6));
                        vis.setValue(oid2, ui.values[1]); //.toFixed(6));
                      } else if (oid) {
                        if (options.inverted) ui.value = (settings.max - ui.value) + settings.min;
                        vis.setValue(oid, ui.value); //.toFixed(6));
                      }
                    }

                },
                stop: function (e, ui) {
                  if (options.submitmethod === 'stop') {
                    if (oid2) {
                      if (options.inverted) {
                        ui.values[0] = (settings.max - ui.values[0]) + settings.min;
                        ui.values[1] = (settings.max - ui.values[1]) + settings.min;
                      }

                      oid && vis.setValue(oid, ui.values[0]); //.toFixed(6));
                      vis.setValue(oid2, ui.values[1]); //.toFixed(6));
                    } else if (oid) {
                      if (options.inverted) ui.value = (settings.max - ui.value) + settings.min;
                      vis.setValue(oid, ui.value); //.toFixed(6));
                    }
                  }
                }
            }, options);

            settings.inverted = (settings.inverted === 'true' || settings.inverted === true);

            if (isNaN(settings.value)) settings.value = 0;
            if (isNaN(settings.min))   settings.min = 0;
            if (isNaN(settings.max))   settings.max = 100;
            if (isNaN(settings.step))  settings.step = (settings.max - settings.min) / 100;

            settings.min = parseFloat(settings.min);
            settings.max = parseFloat(settings.max);
            settings.value = parseFloat(settings.value);

            if (settings.inverted) settings.value = (settings.max - settings.value) + settings.min;

            $this.slider(settings);

            function onChange(e, newVal) {
                // console.log('slider newVal=' + JSON.stringify(newVal));
                // If device not in working state
                if (e.type === oid + '.val') {
                    if (!vis.states.attr(wid + '.val')) {
                        if (settings.inverted) {
                            oid_val = (settings.max - parseFloat(newVal)) + settings.min;
                        } else {
                            oid_val = parseFloat(newVal);
                        }
                        if ($this.slider('instance')) {
                            if (oid2) {
                                $this.slider('values', [oid_val, oid2_val]);
                            } else {
                                $this.slider('value', oid_val);
                            }
                        }
                    }
                } else if (e.type === oid2 + '.val'){
                    // console.log('slider newVal=' + JSON.stringify(newVal));
                    // If device not in working state
                    if (!vis.states.attr(wid2 + '.val')) {
                        oid2_val = parseFloat(newVal);
                        if (settings.inverted) {
                            oid2_val = (settings.max - parseFloat(newVal)) + settings.min;
                        } else {
                            oid2_val = parseFloat(newVal);
                        }
                        if ($this.slider('instance')) {
                            $this.slider('values', [oid_val, oid2_val]);
                        }
                    }
                }
            }
            var bound = [];
            if (oid) {
                vis.states.bind(oid + '.val', onChange);
                bound.push(oid + '.val');
            }

            if (oid2) {
                vis.states.bind(oid2 + '.val', onChange);
                bound.push(oid2 + '.val');

                oid_val  = vis.states.attr(oid + '.val');
                oid2_val = vis.states.attr(oid2 + '.val');

                if (settings.inverted) {
                    oid_val  = (settings.max - oid_val)  + settings.min;
                    oid2_val = (settings.max - oid2_val) + settings.min;
                }
                $this.slider('values', [oid_val, oid2_val]);
            }

            if (bound.length) {
                // remember all ids, that bound
                $this.parent().parent()
                    .data('bound', bound)
                    // remember bind handler
                    .data('bindHandler', onChange);
            }
        },
        button: function (el, value) {
            if ($(el).data('no-style')) return;

            setTimeout(function () {
                $(el).button();
            }, 0);
        },
        buttonDialog: function (el) {
            if ($(el).data('no-style')) return;
            setTimeout(function () {
                $(el).button();
            }, 0);
        },
        buttonLink: function (el, href) {
            if (!$(el).data('no-style')) {
                setTimeout(function () {
                    $(el).button();
                }, 0);
            }
            $(el).click(function () {
                if (!vis.editMode && href) window.location.href = href;
            });
        },
        buttonLinkBlank: function (el, href) {
            if (!$(el).data('no-style')) {
                setTimeout(function () {
                    $(el).button();
                }, 0);
            }
            $(el).click(function () {
                if (!vis.editMode && href) window.open(href);
            });
        },
        radio: function (el, options, process) {
            var $this    = $(el);
            var id = $this.parent().parent().attr('id');
            if (id && id.match(/_removed$/)) {
                return;
            }

            if (!process) {
                setTimeout(function () {
                    vis.binds.jqueryui.radio(el, process, true);
                }, 50);
                return;
            }
            var settings = $.extend({}, options);
            var oid      = $this.attr('data-oid');

            function onChange(e, newVal) {
                $this.find('input').removeAttr('checked');
                if (newVal === true || newVal === 'true') {
                    newVal = 1;
                } else
                if (newVal === false || newVal === 'false') {
                    newVal = 0;
                }
                $this.find('input').prop('checked', false);
                $this.find('input[value="' + newVal + '"]').prop('checked', true);
                $this.find('input').each(function () {
                    if ($(this).button('instance')) $(this).button('refresh');
                });
            }

            // Observable -> Buttonset
            if (oid) {
                vis.states.bind(oid + '.val', onChange);

                // remember all ids, that bound
                $this.parent().parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);

                var val = vis.states.attr(oid + '.val');

                if (val === true  || val === 'true')  {
                    val = 1;
                }
                if (val === false || val === 'false') {
                    val = 0;
                }

                setTimeout(function () {
                    //console.log(val + ' ' + $this.find('input[value="' + val + '"]').length);
                    $this.find('input').prop('checked', false);
                    $this.find('input[value="' + val + '"]').prop('checked', true);
                    $this.buttonset(settings);

                    $this.find('input').each(function () {
                        if ($this.button('instance')) {
                            $(this).button('refresh');
                        }
                    });

                    if (!vis.editMode) {
                        // Buttonset -> Observable
                        $this.find('input').on('click touchstart', function () {
                            // Protect against two events
                            if (vis.detectBounce(this)) return;

                            var val = $(this).val();
                            var f = parseFloat(val);
                            if (f.toString() === val.toString()) {
                                vis.setValue(oid, f);
                            } else {
                                vis.setValue(oid, val);
                            }
                        });
                    }
                }, 50);
            }

        },
        iconHttpGet: function (el, url) {
            if (vis.editMode) return;

            var $this = $(el).parent();
            $this.on('click touchstart', function (e) {
                // Protect against two events
                if (vis.detectBounce(this)) return;

                vis.conn.httpGet(url);
                e.preventDefault();
            });
        },
        hueColormode: function (el, oid) {
            var $hue = $(el).parent().find('.hue-mode-hue');
            var $ct  = $(el).parent().find('.hue-mode-ct');

            function onChange(e, newVal) {
                if (newVal === 'ct') {
                    $hue.hide();
                    $ct.show();
                } else {
                    $ct.hide();
                    $hue.show();
                }
            }

            if (oid) {
                if (vis.states.attr(oid + '.val') === 'ct') {
                    $hue.hide();
                    $ct.show();
                } else {
                    $ct.hide();
                    $hue.show();
                }
                vis.states.bind(oid + '.val', onChange);

                // remember all ids, that bound
                $(el).parent().parent()
                    .data('bound', [oid + '.val'])
                    // remember bind handler
                    .data('bindHandler', onChange);
            } else {
                $ct.hide();
                $hue.show();
            }
        },
        _disable: function () {
            $('.vis-view-container').find('.ui-slider').each(function () {
                if ($(this).slider('instance')) {
                    $(this).slider('disable').removeClass('ui-state-disabled');
                }
            });

            setTimeout(function () {
                $('.vis-view-container').find('select[id$="_multiselect"]').each(function () {
                    if ($(this).css('display') === 'none') {
                        $(this).multiselect('disable').next().removeClass('ui-state-disabled').unbind('click touchstart', false);
                    }
                });
            }, 200);

            setTimeout(function () {
                $('.vis-view-container').find('a[href]').each(function () {
                    $(this).on('click touchstart', function (e) {});
                });
            }, 200);
        },
        itoggle: function (el) {
            var $this = $(el).parent();
            var oid = $this.parent().attr('data-oid');
            if (oid) {
                oid += '.val';
            }
            var val = vis.states.attr(oid);
            var activeVal = $this.parent().data('val');
            if (activeVal === '' || activeVal === undefined) activeVal = null;

            if (activeVal !== null) {
                if (val === null || val === undefined) val = '';
                if (activeVal.toString() === val.toString()) {
                    $this.find('.imgToggleFalse').hide();
                    $this.find('.imgToggleTrue').show();
                }
            } else {
                if (val === 'false') val = false;
                if (val === 'true')  val = true;

                if (typeof val === 'string') {
                    var f = parseFloat(val);
                    if (f == val) {
                        val = f;
                    } else {
                        val = val !== '';
                    }
                }
                if (val > 0) {
                    $this.find('.imgToggleFalse').hide();
                    $this.find('.imgToggleTrue').show();
                }
            }

            function onChange (e, val) {
                if (activeVal !== null) {
                    if (activeVal.toString() === val.toString()) {
                        $this.find('.imgToggleFalse').hide();
                        $this.find('.imgToggleTrue').show();
                    } else {
                        $this.find('.imgToggleTrue').hide();
                        $this.find('.imgToggleFalse').show();
                    }
                } else {
                    if (val === true || val === 'true' || parseFloat(val) > 0) {
                        $this.find('.imgToggleFalse').hide();
                        $this.find('.imgToggleTrue').show();
                    } else {
                        $this.find('.imgToggleTrue').hide();
                        $this.find('.imgToggleFalse').show();
                    }
                }
            }
            if (oid) {
                vis.states.bind(oid, onChange);
                    // remember all ids, that bound
                $this.parent()
                    .data('bound', [oid])
                    // remember bind handler
                    .data('bindHandler', onChange);
            }
        },
        calcValue: function (value, min, max) {
            if (!min) min = 0;
            if (max === null || max === undefined || max === '') max = 100;
            min   = parseFloat(min);
            max   = parseFloat(max);
            value = parseFloat(value);
            return min + value * (max - min);
        },
        calcImage: function (val, min, max, invert) {
            max = (max !== undefined) ? max : 100;
            min = (min !== undefined) ? min : 0;

            val = parseFloat(val);
            if (invert) val = max - val + min;
            var image = '';
            if (val >= max) {
                image = 10;
            } else if (val >= min + (max - min) * 0.9) {
                image = 9;
            } else if (val >= min + (max - min) * 0.8) {
                image = 8;
            } else if (val >= min + (max - min) * 0.7) {
                image = 7;
            } else if (val >= min + (max - min) * 0.6) {
                image = 6;
            } else if (val >= min + (max - min) * 0.5) {
                image = 5;
            } else if (val >= min + (max - min) * 0.4) {
                image = 4;
            } else if (val >= min + (max - min) * 0.3) {
                image = 3;
            } else if (val >= min + (max - min) * 0.2) {
                image = 2;
            } else if (val >= min + (max - min) * 0.1) {
                image = 1;
            } else {
                image = 0;
            }
            return image;
        },
        setSvgColor: function (el, color) {
            setTimeout(function () {
                el.parent().find('svg').remove();
                var $that = el;
                var imgURL = $that.attr('src');
                $.get(imgURL, function (data) {
                    // Get the SVG tag, ignore the rest
                    var $svg = $(data).find('svg');

                    // Remove any invalid XML tags as per http://validator.w3.org
                    $svg = $svg.removeAttr('xmlns:a');
                    $svg = $svg.attr('width',  '100%');
                    $svg = $svg.attr('height', '100%');
                    $svg.find('*').each(function () {
                        var style = $(this).attr('style');
                        if (style) {
                            style = style.replace(/#FFFFFF/g, color);
                            $(this).attr('style', style);
                        }
                    });

                    // Replace image with new SVG
                    $that.replaceWith($svg);
                }, 'xml');
            }, 0);
        },
        navigationPw: function (el, data) {
            var $this = $(el);
            if (!$this.data('no-style')) {
                setTimeout(function () {
                    $($this).button();
                }, 100);
            }

            $($this).click(function () {
                $('body').append('<div id="NavPwDialog" style="text-align: center"><input  type="password"  id="inp_NavPw"><input style="width: 100px; margin-top: 20px" id="btn_navPwOk" value="' + _('Ok') + '"><input id="btn_navPwcancel" value="' + _('Cancel') + '" style="width: 100px; margin-top: 20px"></div>');

                $('#inp_NavPw').change(function () {
                    check_pw();
                });
                $('#btn_navPwOk').button().click(function () {
                    check_pw();
                });

                function check_pw() {
                    var $inputPass = $('#inp_NavPw');
                    if (data._data.Password === $inputPass.val()) {
                        $('#NavPwDialog').remove();
                        vis.changeView(data.attr('nav_view'), data.attr('nav_view'), {
                                    effect: data.attr('hide_effect'),
                                    options: {},
                                    duration: data.attr('hide_duration')
                                }, {
                                    effect: data.attr('show_effect'),
                                    options: {},
                                    duration: data.attr('show_duration')
                                },
                                data.attr('sync'));
                    } else {
                        $inputPass.val('');
                        var bg = $inputPass.data('bg');
                        if (!bg) {
                            bg = $inputPass.css('background-color');
                            $inputPass.data('bg', bg);
                        }
                        $inputPass.css('background-color', '#FF0000').animate({'background-color': bg}, 500);
                    }
                }

                $('#btn_navPwcancel').button().click(function () {
                    $('#NavPwDialog').remove();
                });

                $('#NavPwDialog').dialog({
                    title: _('Password'),
                    modal: true
                });
            })
        }
    };
</script>

<script id="tplJquiButtonLink"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiButtonLink" style=" position: relative; text-align: initial;"><div class="vis-widget_prev ui-selectee ui-selected" style="height: 30px"> <div class="vis-widget-prev-body"> <input type="button" value=" Button " class="ui-button ui-widget ui-state-default ui-corner-all" role="button"> </div> </div>'
        data-vis-set="jqui"
        data-vis-type="static"
        data-vis-name="Button Link"
        data-vis-attrs="buttontext[Text];href;html_prepend/html;html_append/html;padding[5]/slider,0,100,1;no_style/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" >
            <%== this.data.attr('html_prepend') %>
            <button style="width: 100%; height: 100%" data-no-style="<%= this.data.attr('no_style') %>" data-vis-link="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.jqueryui.buttonLink(el, data.attr('href')); %> style="padding: <%= this.data.attr('padding') %>px"><%== this.data.attr('buttontext') %></button>
            <%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplJquiButtonLinkBlank"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiButtonLinkBlank" style=" position: relative; text-align: initial;padding: 4px;height: 30px"><div  style="height: 30px" class="vis-widget_prev ui-selectee ui-selected ui-draggable-handle" data-vis-resizable="{"disabled":true, "handles":"e"}"> <div class="vis-widget-prev-body"> <input type="button" value=" Link " data-vis-link="" class="ui-button ui-widget ui-state-default ui-corner-all" role="button"> </div> </div>'
        data-vis-set="jqui"
        data-vis-type="static"
        data-vis-name="Button Link _blank"
        data-vis-attrs="buttontext[Text];href;html_prepend/html;html_append/html;padding[5]/slider,0,100,1;no_style/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" >
        <div class="vis-widget-body" >
            <%== this.data.attr('html_prepend') %>
            <button style="width: 100%; height: 100%" data-no-style="<%= this.data.attr('no_style') %>" data-vis-link="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.jqueryui.buttonLinkBlank(el, data.attr('href')); %> style="padding: <%= this.data.attr('padding') %>px"><%== this.data.attr('buttontext') %></button>
            <%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplIconLink"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<div id="prev_tplIconLink" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default " style="width: 119px; height: 30px;"> <div class="vis-widget-prev-body"> <a class="widget-link" href="" target="" style="white-space:no-wrap; text-decoration: none; text-align: left; width:100%;height:100%;"> <img src="widgets/jqui/img/internet-web-browser-2.png" style=" vertical-align: middle; height: 100%;" alt=""> Icon link </a> </div> </div></div>'
        data-vis-type="static"
        data-vis-name="Icon link"
        data-vis-attrs="src/image;imageHeight/slider,0,200,1;href;target/auto,,_blank,_self,_parent,_top;alt;text;invert_icon/checkbox">
    <%
    var styles = '';
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>
    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 76px; height: 32px;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.jqueryui.classes(el) %>>
        <div class="vis-widget-body">
            <a class="widget-link" href="<%== this.data.attr('href') %>" target="<%== this.data.attr('target') %>" style="white-space:no-wrap; text-decoration: none; text-align: left; width:100%; height:100%;">
                <img <%= this.data.attr('src') ? 'src="' +  this.data.attr('src') + '"' : '' %> style="<%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('alt') %>" />
                <%== this.data.attr('text') %>
            </a>
        </div>
    </div>
</script>

<script id="tplIconHttpGet"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<div id="prev_tplIconHttpGet" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default " style="width: 97px; height: 38px; " > <div class="vis-widget-prev-body"> <a class="widget-link" style="white-space:no-wrap; text-decoration:none;text-align:left;width:100%;height:100%;"><img style="vertical-align:middle;height:100%;">URL GET</a></div></div></div>'
        data-vis-type="static"
        data-vis-name="Icon HTTP GET"
        data-vis-attrs="url;src/image;imageHeight/slider,0,200,1;alt;text">
    <%
    var styles = '';
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
    styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>
    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 76px; height: 76px;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.jqueryui.classes(el) %>>
        <div class="vis-widget-body">
            <img <%= this.data.attr('src') ? 'src="' +  this.data.attr('src') + '"' : '' %> style="<%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('alt') %>" /><%== this.data.attr('text') %>
            <div <%= (el) -> vis.binds.jqueryui.iconHttpGet(el, data.attr('url')) %> />
        </div>
    </div>
</script>

<script id="tplJquiDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-type="static,dialog"
        data-vis-prev='<img src="widgets/jqui/img/Prev_JquiDialog.png"></img>'
        data-vis-name="HTML - Dialog"
        data-vis-attrs="html/text;setId/id;setValue;"
        data-vis-attrs0="group.dialog;html_dialog/text;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width;dialog_height;persistent/checkbox;preload/checkbox;closeOnClick/checkbox;dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 200px; height: 130px; border: 1px solid #000; background: #fff; cursor: pointer" id="<%= this.data.attr('wid') %>" data-no-style="<%= this.data.attr('no_style') %>" >
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body">
            <%== this.data.attr('html') %>
        </div>
        <div id="<%= this.data.attr('wid') %>_dialog" class="vis-widget-dialog" title="<%= this.data.attr('title') %>">
            <%== this.data.attr('preload') ? this.data.attr('html_dialog') : '' %>
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el, data, data.attr('persistent'), data.attr('preload'), data.attr('html_dialog'), data.attr('closeOnClick')) %> />
    </div>
</script>

<script id="tplJquiIconDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<img src="widgets/jqui/img/Prev_JquiIconDialog.png"></img>'
        data-vis-type="static,dialog"
        data-vis-name="Icon - Dialog"
        data-vis-attrs="src/image;imageHeight/slider,0,200,1;alt;text;invert_icon/checkbox;setId/id;setValue;"
        data-vis-attrs0="group.dialog;html_dialog/text;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width;dialog_height;persistent/checkbox;preload/checkbox;closeOnClick/checkbox;dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit">
    <%
    var styles = '';
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>
    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 76px; height: 76px; cursor: pointer" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.jqueryui.classes(el) %>>
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body">
            <img <%= this.data.attr('src') ? 'src="' +  this.data.attr('src') + '"' : '' %> style="<%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('alt') %>" /><%== this.data.attr('text') %>
        </div>
        <div id="<%= this.data.attr('wid') %>_dialog" class="vis-widget-dialog" title="<%= this.data.attr('title') %>">
            <%== this.data.attr('preload') ? this.data.attr('html_dialog') : '' %>
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el, data, data.attr('persistent'), data.attr('preload'), data.attr('html_dialog'), data.attr('closeOnClick')) %> />
    </div>
</script>

<script id="tplContainerDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<img src="widgets/jqui/img/Prev_ContainerDialog.png"></img>'
        data-vis-type="container,dialog"
        data-vis-name="container - HTML - view in jqui Dialog"
        data-vis-attrs="html/text;contains_view/views;setId/id;setValue;"
        data-vis-attrs0="group.dialog;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width;dialog_height;dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 200px; height: 130px; border: 1px solid #000; background: #fff; cursor: pointer" id="<%= this.data.attr('wid') %>">
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body">
            <%== this.data.attr('html') %>
        </div>
        <div id="<%= this.data.attr('wid') %>_dialog" style="display: none" class="vis-widget-dialog" title="<%= this.data.attr('title') %>">
            <div data-vis-contains="<%= this.data.attr('contains_view') %>" class="vis-widget-body vis-view-container"></div>
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogContainer(el, data) %> />
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>

<script id="tplContainerDialogExternal"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-type="container,dialog"
        data-vis-prev='<img src="widgets/jqui/img/Prev_ContainerDialogExternal.png"></img>'
        data-vis-name="container - ext cmd - view in jqui Dialog"
        data-vis-attrs="html/text;contains_view/views;setId/id;setValue;"
        data-vis-attrs0="group.dialog;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width;dialog_height;dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 194px; height: 68px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="display:none; width: 190px; height: 64px; background-color: #333; color: #eee; cursor: pointer; border: 2px dashed red; opacity:0.8;">
            <b>External Container Dialog</b><br/>
            view: <%= this.data.attr('contains_view') %><br/>
            id: <%= this.data.attr('wid') %>
        </div>
        <div id="<%= this.data.attr('wid') %>_dialog" style="display:none" class="vis-widget-dialog" title="<%= this.data.attr('title') %>">
            <div data-vis-contains="<%= this.data.attr('contains_view') %>" class="vis-widget-body vis-view-container">
            </div>
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogContainer(el, data) %> />
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>

<script id="tplContainerIconDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-type="container,dialog"
        data-vis-set="jqui"
        data-vis-prev='<img src="widgets/jqui/img/Prev_ContainerIconDialog.png"></img>'
        data-vis-name="container - Icon - view in jqui Dialog"
        data-vis-attrs="src/image;imageHeight/slider,0,200,1;alt;text;setId/id;setValue;"
        data-vis-attrs0="group.dialog;contains_view/views;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width;dialog_height;invert_icon/checkbox;dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit">
    <%
    var styles = '';
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>

    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 76px; height: 76px; cursor: pointer" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.jqueryui.classes(el) %>>
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body">
            <img <%= this.data.attr('src') ? 'src="' +  this.data.attr('src') + '"' : '' %> style="<%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('alt') %>" /><%== this.data.attr('text') %>
        </div>
        <div id="<%= this.data.attr('wid') %>_dialog" style="display:none" class="vis-widget-dialog" title="<%= this.data.attr('title') %>">
            <div data-vis-contains="<%= this.data.attr('contains_view') %>" class="vis-widget-body vis-view-container"></div>
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogContainer(el, data) %> />
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>

<script id="tplContainerButtonDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-type="container,dialog"
        data-vis-prev='<img src="widgets/jqui/img/Prev_ContainerButtonDialog.png"></img>'
        data-vis-name="container - Button - view in jqui Dialog"
        data-vis-attrs="html_prepend/text;html_append/text;buttontext[Text];setId/id;setValue;no_style/checkbox;"
        data-vis-attrs0="group.dialog;contains_view/views;title;noHeader/checkbox;autoclose/slider,0,30000,100;modal/checkbox;dialog_width;dialog_height;padding[5]/slider,0,100,1;dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>">
        <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body">
            <%== this.data.attr('html_prepend') %>
            <button id="<%= this.data.attr('wid') %>_button" name="<%= this.data.attr('wid') %>_button" data-no-style="<%= this.data.attr('no_style') %>" data-oid="<%= this.data.attr('oid') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.jqueryui.buttonDialog(el); %> style="padding: <%= this.data.attr('padding') %>px"><%== this.data.attr('buttontext') %></button>
            <%== this.data.attr('html_append') %>
        </div>
        <div id="<%= this.data.attr('wid') %>_dialog" style="display:none" class="vis-widget-dialog" title="<%= this.data.attr('title') %>">
            <div data-vis-contains="<%= this.data.attr('contains_view') %>" class="vis-widget-body vis-view-container"></div>
        </div>
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogContainer(el, data) %> />
        <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>

<script id="tplJquiButtonDialogClose"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiButtonDialogClose" style=" position: relative; text-align: initial;padding: 4px;height: 30px"><div class="vis-widget_prev ui-selectee ui-draggable-handle "> <div class="vis-widget-prev-body"> <input type="button" value=" Dialog close " class="ui-button ui-widget ui-state-default ui-corner-all" role="button"> </div> '
        data-vis-set="jqui"
        data-vis-type="dialog"
        data-vis-name="Button dialog close"
        data-vis-attrs="html_prepend/text;html_append/text;buttontext[Close];iconClass[close];dlgName;hide_effect;hide_duration;show_effect;show_duration;no_style/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <%== this.data.attr('html_prepend') %>
            <button style="width:100%; height:100%" data-no-style="<%= this.data.attr('no_style') %>" <%= (el) -> vis.binds.jqueryui.dialogClose(el, {hideOptions: {effect: data.attr('hide_effect'), options:{}, duration: data.attr('hide_duration')}, iconClass: data.attr('iconClass'), dlgName: data.attr('dlgName')}) %>><%== this.data.attr('buttontext') %></button>
            <%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplJquiButtonNav"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiButtonNav" style=" position: relative; text-align: initial;padding: 4px;height: 30px"><div class="vis-widget_prev ui-selectee ui-draggable-handle " style="left: 167px; top: 129px;" > <div class="vis-widget-prev-body"> <input type="button" value=" Nav Button " class="ui-button ui-widget ui-state-default ui-corner-all" role="button"> </div> '
        data-vis-set="jqui"
        data-vis-type="navigation"
        data-vis-name="Button"
        data-vis-attrs="html_prepend/text;html_append/text;buttontext[Text];nav_view;hide_effect;hide_duration;show_effect;show_duration;no_style/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <%== this.data.attr('html_prepend') %>
            <button style="width:100%; height:100%" data-no-style="<%= this.data.attr('no_style') %>" <%= (el) -> vis.binds.jqueryui.button(el); vis.binds.jqueryui.navigationActive(el, data.attr('nav_view')); vis.binds.basic.navigation(el, {nav_view:data.attr('nav_view'),hideOptions:{effect:data.attr('hide_effect'),options:{},duration:data.attr('hide_duration')},showOptions:{effect:data.attr('show_effect'),options:{},duration:data.attr('show_duration')}}) %> ><%== this.data.attr('buttontext') %></button>
            <%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplJquiIconNav"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<div id="prev_tplJquiIconNav" style="position: relative; text-align: initial;padding: 4px "><div data-vis-nav="" class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default jqui-nav-state " style="width: 100px; height: 28px;"> <div class="vis-widget-prev-body"> <img src="/vis/widgets/jqui/img/internet-web-browser-2.png" style="vertical-align:middle;height:100%;">&nbsp;Nav</div></div></div>'
        data-vis-name="navigation - Icon"
        data-vis-attrs="src/image;imageHeight/slider,0,200,1;alt;text;nav_view;hide_effect;hide_duration;show_effect;show_duration">
    <div data-vis-nav="<%= this.data.attr('nav_view') %>" class="vis-widget ui-widget ui-button ui-corner-all ui-state-default jqui-nav-state <%== this.data.attr('class') %>" style="width: 76px; height: 76px;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.jqueryui.classes(el); vis.binds.jqueryui.navigationActive(el, data.attr('nav_view')); vis.binds.basic.navigation(el, {nav_view: data.attr('nav_view'), hideOptions: {effect: data.attr('hide_effect'), options: {}, duration: data.attr('hide_duration')}, showOptions: {effect: data.attr('show_effect'), options: {}, duration: data.attr('show_duration')}}) %>>
        <div class="vis-widget-body">
            <img <%= this.data.attr('src') ? 'src="' +  this.data.attr('src') + '"' : '' %> style="vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('alt') %>" /><%== this.data.attr('text') %>

        </div>
    </div>
</script>

<script id="tplJquiNavPw"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<div id="prev_tplJquiNavPw" style=" position: relative; text-align: initial;padding: 4px " class="wid_prev_content"><div class="vis-widget_prev ui-selectee ui-draggable-handle " style="top: 445px; left: 314px; width: 116px; height: 35px;"> <div class="vis-widget-prev-body" style="text-align: center"> <label style=" display: none;">Input</label><input type="text" value="Nav button Pw" size="10" data-o="" class="ui-button ui-widget ui-state-default ui-corner-all" role="button" style="height: 20px;font-family: inherit; font-size: inherit; font-style: inherit; font-variant: inherit; font-weight: inherit; line-height: inherit; text-align: left; outline: none; cursor: text;"> </div> </div></div>'
        data-vis-name="navigation - Pw"
        data-vis-attrs="buttontext[Text];Password;nav_view;hide_effect;hide_duration;show_effect;show_duration;sync/checkbox;no_style/checkbox">
       <div class="vis-widget <%== this.data.attr('class') %>" style="width:76px;height:30px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <button style="width:100%; height:100%" data-no-style="<%= this.data.attr('no_style') %>" <%= (el) -> vis.binds.jqueryui.navigationPw(el, data)%> ><%== this.data.attr('buttontext') %></button>
        </div>
    </div>
</script>

<script id="tplJquiInput"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiInput" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-selectee ui-draggable-handle " style="top: 445px; left: 314px; width: 116px; height: 30px;" > <div class="vis-widget-prev-body" style="text-align: center"> <label style=" display: none;">Input</label><input type="text" value=" Input" size="10" data-o class="ui-button ui-widget ui-state-default ui-corner-all" role="button" style="font-family: inherit; font-size: inherit; font-style: inherit; font-variant: inherit; font-weight: inherit; line-height: inherit; text-align: left; outline: none; cursor: text;"> </div> '
        data-vis-set="jqui"
        data-vis-type="ctrl"
        data-vis-name="Input"
        data-vis-attrs="label[Input];oid;asString/checkbox;digits[0]/slider,0,10,1;size[10]/slider,10,100,1">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:275px;height:44px;" id="<%= this.data.attr('wid') %>" data-no-style="<%= this.data.attr('no_style') %>" >
        <div class="vis-widget-body">
            <label for="<%= this.data.attr('wid') %>_input"><%= ((this.data.attr('label') === undefined || this.data.attr('label') === null) ? '' : this.data.attr('label')) %></label>
            <input type="text" name="<%= this.data.attr('wid') %>_input" id="<%= this.data.attr('wid') %>_input" value="" size="<%= this.data.attr('size') %>" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.jqueryui.input(el, data.digits, data.asString); %> />
        </div>
    </div>
</script>

<script id="tplJquiBool"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-type="ctrl"
        data-vis-prev='<div id="prev_tplJquiBool" style="position: relative; text-align: initial;padding: 4px "><div class="ui-widget ui-corner-all ui-state-default vis-widget_prev " style="width: 79px; height: 25px;"> <div class="vis-widget-prev-body" style="text-align: center;padding-top: 5px;"> true/false</div> </div></div>'
        data-vis-name="Html Bool"
        data-vis-attrs="oid;html_true;html_false">

    <div class="ui-widget ui-corner-all ui-state-default vis-widget <%== this.data.attr('class') %>" style="width:76px; height:76px" id="<%= this.data.attr('wid') %>"  data-no-style="<%= this.data.attr('no_style') %>"  data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.toggle(el); vis.binds.jqueryui.classes(el) %>>
        <div class="vis-widget-body">
            <div>
                <% if (vis.binds.basic.isFalse(vis.states.attr(this.data.oid + '.val'))) { %>
                    <%== this.data.attr('html_false') %>
                <% } else { %>
                    <%== this.data.attr('html_true') %>
                <% } %>
            </div>
        </div>
    </div>
</script>

<script id="tplJquiToogle"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiToogle" style="position: relative; text-align: initial;padding: 4px "><div class="ui-widget ui-corner-all ui-state-default vis-widget_prev" style="width: 90px; height: 19px; padding: 10px;"> <div class="vis-widget-prev-body"><label>&nbsp;Toggle&nbsp;</label><img class="imgToggleFalse" src="/vis/icon/add.png" style=" vertical-align:middle; height:100%"></div></div></div>'
        data-vis-set="jqui"
        data-vis-type="ctrl,state"
        data-vis-name="Icon Toggle"
        data-vis-attrs="label;oid;src_true/image;imageHeight/slider,0,200,1;alt_true;src_false/image;alt_false;invert_icon/checkbox">

    <div class="ui-widget ui-corner-all ui-state-default vis-widget <%== this.data.attr('class') %>" style="width:76px; height:76px" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.toggle(el); vis.binds.jqueryui.classes(el) %> >
        <div class="vis-widget-body">
            <%
            var styles = '';
            if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
                styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
            }
            %>
            <label style="margin: 0" for="<%= this.data.attr('wid') %>_input"><%== this.data.attr('label') %></label>
            <img class="imgToggleFalse" <%= this.data.attr('src_false') ? 'src="' +  this.data.attr('src_false') + '"' : '' %> style="<%= styles %> vertical-align: middle; height:<%= this.data.attr('imageHeight') || 100 %>%"               alt="<%== this.data.attr('alt_false') %>" />
            <img class="imgToggleTrue"  <%= this.data.attr('src_true')  ? 'src="' +  this.data.attr('src_true')  + '"' : '' %> style="<%= styles %> vertical-align: middle; height:<%= this.data.attr('imageHeight') || 100 %>%; display:none" alt="<%== this.data.attr('alt_true')  %>" />
            <div <%= (el) -> vis.binds.jqueryui.itoggle(el) %>></div>
        </div>
    </div>
</script>

<script id="tplJquiInputDate"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<div id="prev_tplJquiInputDate" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev " style="width: 110px; height: 25px; overflow: visible; "> <div class="vis-widget-prev-body"> <input type="text" value="2015-09-20" size="10" class="ui-widget ui-button ui-corner-all ui-state-default" style="font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; text-align: left; outline: none; cursor: text;text-align:center;"></div> </div></div>'
        data-vis-name="ctrl - Input Date"
        data-vis-attrs="oid/id;size[10]/slider,1,50,1">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:200px;height:40px;overflow: visible;text-align:center;" id="<%= this.data.attr('wid') %>">
        <% if (vis.editMode) { %>
			<div class="editmode-helper" />
		<% } %>
        <div class="vis-widget-body">
            <input type="text"  style="text-align:center;padding-left: 5px" name="<%= this.data.attr('wid') %>_input" id="<%= this.data.attr('wid') %>_input" value="" size="<%= this.data.attr('size') %>" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.jqueryui.inputDate(el); %> />
        </div>
    </div>
</script>

<script id="tplJquiInputDatetime"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<div id="prev_tplJquiInputDatetime" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev " style="width: 110px; height: 39px; overflow: visible; text-align: center;"> <div class="vis-widget-prev-body"> <input type="text" style="text-align: left; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; outline: none; cursor: text; " value="18:00:00" size="5" class="ui-state-default ui-widget ui-button ui-corner-all"> </div> </div></div>'
        data-vis-name="ctrl - Input Datetime"
        data-vis-attrs="oid;size/slider,1,50,1;timeOnly/checkbox;hideSeconds/checkbox;stepMinute/slider,1,30,1;showGrid/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:200px;height:40px;overflow: visible;text-align:center;" id="<%= this.data.attr('wid') %>">
        <% if (vis.editMode) { %>
			<div class="editmode-helper" />
		<% } %>
        <div class="vis-widget-body">
            <input type="text" style="text-align: center; padding-left: 5px" name="<%= this.data.attr('wid') %>_input" id="<%= this.data.attr('wid') %>_input" value="" size="<%= this.data.attr('size') %>" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.jqueryui.inputDatetime(el, {timeOnly: data.attr('timeOnly'), showSecond: !data.attr('hideSeconds'), stepMinute: data.attr('stepMinute'), showGrid: data.attr('showGrid')}); %> />
        </div>
    </div>
</script>

<script id="tplJquiInputSet"
        type="text/ejs" class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<div id="prev_tplJquiInputSet" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev " style="width: 90px; height: 32px; overflow: visible;"> <div class="vis-widget-prev-body"> <label></label> <input type="text" value="Input" size="2" style="font-size: inherit; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; line-height: inherit; font-family: inherit; padding-left: 5px; padding-right: 5px; text-align: left; outline: none; cursor: text;height:14px" class="ui-button ui-widget ui-state-default ui-corner-all" role="button"> <input type="button" style="padding-left: 5px; padding-right: 5px;" value="Set" class="ui-button ui-widget ui-state-default ui-corner-all" role="button"> </div> </div></div>'
        data-vis-name="ctrl - Input + Set-Button"
        data-vis-attrs="title;buttontext[Text];oid;unit;asString/checkbox;digits/slider,0,10,1;size/slider,1,50,1">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:300px;height:44px;overflow:visible" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <label for="<%= this.data.attr('wid') %>_input"><%== this.data.attr('title') %></label>
            <input type="text" name="<%= this.data.attr('wid') %>_input" id="<%= this.data.attr('wid') %>_input" data-no-style="<%= this.data.attr('no_style') %>" size="<%= this.data.attr('size') %>" style="font-size: 1.1em !important; padding: 0 0; "/>
            <%== this.data.attr('unit') %>
            <input type="button" style="height: 100%" data-oid="<%= this.data.attr('oid') %>" name="<%= this.data.attr('wid') %>_set" id="<%= this.data.attr('wid') %>_set" value="<%== this.data.attr('buttontext') %>"  data-no-style="<%= this.data.attr('no_style') %>" <%= (el) -> vis.binds.jqueryui.inputset(el, data.digits, data.asString); %>/>
        </div>
    </div>
</script>

<script id="tplJquiButtonState"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiButtonState" style=" position: relative; text-align: initial;padding: 4px; height: 30px "><div style="left: 384px; top: 470px;" class="vis-widget_prev ui-selectee ui-draggable-handle" data-vis-resizable="{"disabled":true, "handles":"e"}"> <div class="vis-widget-prev-body"> <input type="button" value=" Button " data-o data-val="" class="ui-button ui-widget ui-state-default ui-corner-all" role="button"> </div> </div>'
        data-vis-set="jqui"
        data-vis-type="ctrl"
        data-vis-name="Button State"
        data-vis-attrs="oid;html_prepend/html;html_append/html;buttontext[Text];value;no_style/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" >
            <%== this.data.attr('html_prepend') %>
            <button style="width:100%; height:100%" data-oid="<%= this.data.attr('oid') %>"  data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.jqueryui.button(el, data.value); vis.binds.basic.state(el); %>><%== this.data.attr('buttontext') %></button>
            <%== this.data.attr('html_append') %>
        </div>
    </div>
</script>

<script id="tplJquiRadio"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiRadio" style=" position: relative; text-align: initial;padding: 4px;height: 30px"><div style="top: 243px; left: 348px; font-size: 9px;" class="vis-widget_prev ui-selectee ui-selected ui-draggable-handle" data-vis-resizable="{"disabled":true, "handles":""}"> <div class="vis-widget-prev-body"> <div data-o class="ui-buttonset"> <input type="radio" value="0" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only ui-corner-left" role="button" aria-pressed="false"><span class="ui-button-text">OFF</span></label> <input type="radio" value="1" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only ui-corner-right ui-state-active" role="button" aria-pressed="true"><span class="ui-button-text">ON</span></label> </div> </div> </div>'
        data-vis-set="jqui"
        data-vis-type="ctrl"
        data-vis-name="Radiobuttons on/off"
        data-vis-attrs="off_text[OFF];on_text[ON];oid;padding[5]/slider,0,100,1">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" data-vis-resizable='{"disabled":true, "handles":""}' >
        <div class="vis-widget-body" >
            <div id="<%= this.data.attr('wid') %>_radio" data-oid="<%= this.data.attr('oid') %>" style="display: flex" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
                <input type="radio" id="<%= this.data.attr('wid') %>_radio0" name="<%= this.data.attr('wid') %>_radio" value="0" checked='checked'/><label for="<%= this.data.attr('wid') %>_radio0" style="padding: <%= this.data.attr('padding') %>px"><%= this.data.off_text %></label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio1" name="<%= this.data.attr('wid') %>_radio" value="1"/><label for="<%= this.data.attr('wid') %>_radio1" style="padding: <%= this.data.attr('padding') %>px"><%= this.data.on_text %></label>
            </div>
        </div>
    </div>
</script>

<script id="tplJquiRadioList"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiRadioList" style=" position: relative; text-align: initial;padding: 4px "><div style="font-size: 8px;overflow:visible;height:20px" class="vis-widget_prev ui-selectee ui-selected ui-draggable-handle"> <div class="vis-widget-prev-body"> <div data-o class="ui-buttonset"> <input type="radio" value="0" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only ui-corner-left" role="button" aria-pressed="false"><span class="ui-button-text">OFF</span></label> <input type="radio" value="1" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only ui-corner-right" role="button" aria-pressed="false"><span class="ui-button-text">AUTO</span></label> </div> </div> </div>'
        data-vis-set="jqui"
        data-vis-type="ctrl"
        data-vis-name="Radiobuttons ValueList"
        data-vis-attrs="oid;values[0§1§2];texts[OFF§ON§AUTO]">
    <div style=" width:250px; height:41px;overflow: visible" class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" data-vis-resizable='{"disabled":true, "handles":""}' >
        <div class="vis-widget-body" >
            <table id="<%= this.data.attr('wid') %>_radio" data-oid="<%= this.data.attr('oid') %>" style="display: flex" <%= (el) -> setTimeout(function () {vis.binds.jqueryui.radio(el)}, 100) %> class="vis-no-spaces"><tr class="vis-no-spaces">
                <%
                var values = (data.attr('values') ? data.attr('values').split(';') : []);
                var texts  = (data.attr('texts') ? data.attr('texts').split(';'): []);
                var wid = data.attr('wid');
                for (var val in values) {
                %>
                    <td class="vis-no-spaces"><input type="radio" id="<%= wid %>_radio<%= val %>" name="<%= wid %>_radio" value="<%== values[val] %>" /><label style="float: left" for="<%= wid %>_radio<%= val %>"><%= texts[val] %></label></td>
                <%
                }
                %>
            </tr></table>
        </div>
    </div>
</script>

<script id="tplJquiSelectList"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiSelectList" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-selectee ui-draggable-handle" data-vis-resizable="{"disabled":true, "handles":""}" style="left: 336px; top: 323px;"> <div class="vis-widget-prev-body"> <select data-o disabled="" style="display: none;"> <option value="0">OFF</option> <option value="1">ON</option> <option value="2">AUTO</option> </select><button type="button" class="ui-multiselect ui-widget ui-state-default ui-corner-all" aria-haspopup="true" style="width: 86px;"><span class="ui-icon ui-icon-triangle-2-n-s"></span><span>OFF</span></button> </div> </div>'
        data-vis-set="jqui"
        data-vis-type="ctrl"
        data-vis-name="Select ValueList"
        data-vis-attrs="oid;values[0§1§2]/text;texts[OFF§ON§AUTO]/text;height[100]/slider,15,500,1;open/checkbox;no_style/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" >
        <div class="vis-widget-body" >
            <select id="<%= this.data.attr('wid') %>_multiselect" data-no-style="<%= this.data.attr('no_style') %>" data-oid="<%= this.data.attr('oid') %>" data-view="<%= this.view %>" <%= (el) -> setTimeout(function (el_) { vis.binds.jqueryui.multiselect(el_, {height: (data.height || 220)}, data.open)}, 250, el); %> >
            <%
				var values = (data.attr('values') ? data.attr('values').split(';') : []);
				var texts  = (data.attr('texts')  ? data.attr('texts').split(';')  : []);
				for (var val in values) {
					%>
					<option value="<%= values[val] %>"><%= texts[val] %></option>
					<%
				}
            %>
            </select >
        </div>
    </div>
</script>

<script id="tplJquiRadioSteps"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiRadioSteps" style="zoom: 0.99; position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-selectee ui-draggable-handle" data-vis-resizable="{"disabled":true, "handles":"e"}" style="left: 85px; top: 258px; font-size: 5px;"> <div class="vis-widget-prev-body"> <div data-o class="ui-buttonset"> <input type="radio" value="0" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only ui-corner-left" role="button" aria-pressed="false"><span class="ui-button-text">aus</span></label> <input type="radio" value="0.25" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only" role="button" aria-pressed="false"><span class="ui-button-text">25%</span></label> <input type="radio" value="0.5" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only" role="button" aria-pressed="false"><span class="ui-button-text">50%</span></label> <input type="radio" value="0.75" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only ui-state-active" role="button" aria-pressed="true"><span class="ui-button-text">75%</span></label> <input type="radio" value="1" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only ui-corner-right" role="button" aria-pressed="false"><span class="ui-button-text">100%</span></label> </div> </div> </div>'
        data-vis-set="jqui"
        data-vis-type="ctrl"
        data-vis-name="Radiobuttons 25%"
        data-vis-attrs="oid;min;max">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" data-vis-resizable='{"disabled": true, "handles": "e"}' >
        <div class="vis-widget-body" >
            <div id="<%= this.data.attr('wid') %>_radio"  data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
                <input type="radio" id="<%= this.data.attr('wid') %>_radio0" name="<%= this.data.attr('wid') %>_radio" value="<%= vis.binds.jqueryui.calcValue(0,    this.data.attr('min'), this.data.attr('max')) %>" checked='checked'/><label for="<%= this.data.attr('wid') %>_radio0">aus</label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio1" name="<%= this.data.attr('wid') %>_radio" value="<%= vis.binds.jqueryui.calcValue(0.25, this.data.attr('min'), this.data.attr('max')) %>" checked='checked'/><label for="<%= this.data.attr('wid') %>_radio1">25%</label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio2" name="<%= this.data.attr('wid') %>_radio" value="<%= vis.binds.jqueryui.calcValue(0.5,  this.data.attr('min'), this.data.attr('max')) %>" checked='checked'/><label for="<%= this.data.attr('wid') %>_radio2">50%</label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio3" name="<%= this.data.attr('wid') %>_radio" value="<%= vis.binds.jqueryui.calcValue(0.75, this.data.attr('min'), this.data.attr('max')) %>" checked='checked'/><label for="<%= this.data.attr('wid') %>_radio3">75%</label>
                <input type="radio" id="<%= this.data.attr('wid') %>_radio4" name="<%= this.data.attr('wid') %>_radio" value="<%= vis.binds.jqueryui.calcValue(1,    this.data.attr('min'), this.data.attr('max')) %>"/><label for="<%= this.data.attr('wid') %>_radio4">100%</label>
            </div>
        </div>
    </div>
</script>

<script id="tplJquiSliderVertical"
        type="text/ejs"
        data-vis-attrs="oid;oid-2;oid-working;oid-2-working;min;max;step;inverted/checkbox;submitmethod/nselect,scroll,stop"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiSliderVertical" style="position: relative; text-align: initial;padding: 4px;overflow:visible;height:50px"><div class="vis-widget_prev " style="width: 23px; height: 30px; overflow: visible !important;"> <div class="vis-widget-prev-body " style="width: 100%; padding: 4px; "> <div class="sliderJQUI ui-slider ui-slider-vertical ui-widget ui-widget-content ui-corner-all" id="19vlqqb6r_slider" data-oid="nothing_selected" data-oid-working="" style="height:100%"><span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0" style="bottom: 0%;"></span></div></div> </div></div>'
        data-vis-set="jqui"
        data-vis-type="ctrl"
        data-vis-name="Slider vertical">
    <div id="<%= this.data.attr('wid') %>" data-vis-resizable='{"minWidth":23, "maxWidth":23}' class="vis-widget" style="width:23px; height:160px; overflow:visible !important;">
        <div class="vis-widget-body <%== this.data.attr('class') %>" style="width: 100%; padding: 4px; ">
            <div class="sliderJQUI" id="<%= this.data.attr('wid') %>_slider" data-oid="<%= this.data.attr('oid') %>" data-oid2="<%= this.data.attr('oid-2') %>" data-oid-working="<%= this.data.attr('oid-working') %>"  data-oid2-working="<%= this.data.attr('oid-2-working') %>"<%= (el) -> vis.binds.jqueryui.slider(el, {min: parseFloat(data.min), max: parseFloat(data.max), step: parseFloat(data.step), orientation:"vertical", inverted: data.inverted, submitmethod: data.submitmethod}) %> style="height:100%"/></div>
        </div>
    </div>
</script>

<script id="tplJquiSlider"
        type="text/ejs"
        data-vis-attrs="oid;oid-2;oid-working;oid-2-working;min;max;step;inverted/checkbox;submitmethod/nselect,scroll,stop"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiSlider" style="position: relative; text-align: initial;padding: 4px;overflow:visible"><div class="vis-widget_prev " style="width: 80px; overflow: visible !important; left: 475px; top: 188px; position: absolute; height: 23px;"> <div class="vis-widget-prev-body " style="padding: 4px;"> <div class="sliderJQUI ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="19vlqppi9_slider" data-oid="nothing_selected" data-oid-working=""><span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0" style="left: 0%;"></span></div></div> </div></div>'
        data-vis-set="jqui"
        data-vis-type="ctrl"
        data-vis-name="Slider horizontal">
    <div id="<%= this.data.attr('wid') %>" data-vis-resizable='{"minHeight":23, "maxHeight":23}' class="vis-widget" style="height:23; width:160px; overflow:visible !important;">
        <div class="vis-widget-body <%== this.data.attr('class') %>" style="padding: 4px;">
            <div class="sliderJQUI" id="<%= this.data.attr('wid') %>_slider" data-oid="<%= this.data.attr('oid') %>" data-oid2="<%= this.data.attr('oid-2') %>" data-oid-working="<%= this.data.attr('oid-working') %>"  data-oid2-working="<%= this.data.attr('oid-2-working') %>"<%= (el) -> vis.binds.jqueryui.slider(el, {min:parseFloat(data.min),max:parseFloat(data.max),step:parseFloat(data.step), inverted: data.inverted, submitmethod: data.submitmethod}) %> /></div>
        </div>
    </div>
</script>

<script id="tplIconState"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplIconState" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default " style="width: 122.4px; height: 32.4px; position: absolute; left: 237px; top: 201px;" id="19vlr5eto" data-oid="dev1" data-val="value"> <div class="vis-widget-prev-body"> <img src="/vis/widgets/jqui/img/internet-web-browser-2.png" style=" vertical-align:middle;height:100%;" alt="">set value </div> </div></div>'
        data-vis-set="jqui"
        data-vis-name="ctrl - Icon State"
        data-vis-attrs="oid;value;text;src/image;imageHeight/slider,0,200,1;alt;invert_icon/checkbox">
    <%
    var styles = '';
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>
    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 100px; height: 35px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.basic.state(el); vis.binds.jqueryui.classes(el, null, data.value) %>>
        <div class="vis-widget-body">
            <img <%= this.data.attr('src') ? 'src="' +  this.data.attr('src') + '"' : '' %> style="<%= styles %> vertical-align: middle; height:<%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('alt') %>" /><%== this.data.attr('text') %>
        </div>
    </div>
</script>

<script id="tplIconStateBool"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<div id="prev_tplIconStateBool" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default " style="width: 100px; height: 25px;" > <div class="vis-widget-prev-body"> <img class="tplImgFalse" src="/vis/img/bulb_on.png" style=" vertical-align:middle;height:100%;" alt="">set value </div> </div></div>'
        data-vis-name="ctrl - Icon State / val - Icon Bool"
        data-vis-attrs="oid;click_id/id;click_value;false_text;true_text;false_src/image;true_src/image;imageHeight/slider,0,200,1;false_alt;true_alt;invert_icon/checkbox">
    <%
    var styles = '';
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>
    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 100px; height: 35px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" data-val="<%= this.data.attr('click_value') %>" <%= (el) -> vis.binds.basic.state(el, this.data.attr('click_id')); vis.binds.jqueryui.classes(el, null, data.click_value) %>>
        <div class="vis-widget-body">
            <img class="imgToggleFalse" <%= this.data.attr('false_src') ? 'src="' +  this.data.attr('false_src') + '"' : '' %> style="               <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('false_alt') %>"/ ><span class="imgToggleFalse"><%= this.data.attr('false_text') %></span>
            <img class="imgToggleTrue"  <%= this.data.attr('true_src')  ? 'src="' +  this.data.attr('true_src')  + '"' : '' %> style="display: none; <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('true_alt')  %>" /><span class="imgToggleTrue" style="display: none"><%= this.data.attr('true_text')  %></span>
            <div <%= (el) -> vis.binds.jqueryui.itoggle(el) %>></div>
        </div>
    </div>
</script>

<script id="tplIconStatePushButton"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="jqui"
        data-vis-prev='<div id="prev_tplIconStateBool" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default " style="width: 100px; height: 25px;" > <div class="vis-widget-prev-body"> <img class="tplImgFalse" src="/vis/img/bulb_on.png" style=" vertical-align:middle;height:100%;" alt="">set value </div> </div></div>'
        data-vis-name="ctrl - Icon PushButton / val - Icon Bool"
        data-vis-attrs="oid;click_id/id;false_text;true_text;false_src/image;true_src/image;imageHeight/slider,0,200,1;false_alt;true_alt;invert_icon/checkbox">
    <%
    var styles = '';
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>
    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 100px; height: 35px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.pushbutton(el, this.data.attr('click_id')); vis.binds.jqueryui.classes(el, null, data.click_value) %>>
        <div class="vis-widget-body">
            <img class="imgToggleFalse" <%= this.data.attr('false_src') ? 'src="' +  this.data.attr('false_src') + '"' : '' %> style="               <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('false_alt') %>"/ ><span class="imgToggleFalse"><%= this.data.attr('false_text') %></span>
            <img class="imgToggleTrue"  <%= this.data.attr('true_src')  ? 'src="' +  this.data.attr('true_src')  + '"' : '' %> style="display: none; <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('true_alt')  %>" /><span class="imgToggleTrue" style="display: none"><%= this.data.attr('true_text')  %></span>
            <div <%= (el) -> vis.binds.jqueryui.itoggle(el) %>></div>
        </div>
    </div>
</script>

<script id="tplIconInc"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplIconInc" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default ui-state-active " style="width: 44px; height: 20px;" data-vis-step="1" data-val=""> <div class="vis-widget-prev-body"> <img style=" vertical-align:middle;height:100%;">+1 </div> </div></div>'
        data-vis-set="jqui"
        data-vis-name="ctrl - Icon Increment"
        data-vis-attrs="oid;step[1];minmax[100];text[+1];src/image;imageHeight/slider,0,200,1;alt;repeat_delay[800];repeat_interval[800];invert_icon/checkbox">
    <%
    var styles = '';
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>
    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 100px; height: 35px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" data-vis-step="<%= this.data.attr('step') %>" data-val="<%= this.data.attr('active_value') %>" <%= (el) -> vis.binds.basic.increment(el,data.minmax,data.repeat_delay,data.repeat_interval); vis.binds.jqueryui.classes(el, null, data.minmax) %>>
        <div class="vis-widget-body">
            <img <%= this.data.attr('src') ? 'src="' +  this.data.attr('src') + '"' : '' %> style="<%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('alt') %>" /><%== this.data.attr('text') %>
        </div>
    </div>
</script>

<!-- --------------jqui.html--- END -->
<!-- --------------justgage.html--- START -->
<!--
    ioBroker.vis justgage Widget-Set

    version: "1.0.2"

    Copyright 10.2015-2019 Pmant<patrickmo@gmx.de>
-->
<link rel="stylesheet" href="widgets/justgage/css/style.css" />
<script type="text/javascript" src="widgets/justgage/js/justgage.js"></script>

<script type="text/javascript" src="widgets/justgage/lib/js/raphael-2.1.4.min.js"></script>
<script type="text/javascript" src="widgets/justgage/lib/js/justgage.js"></script>

<script id="tplJustgageJustGage"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJustgageJustGage" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev " style="overflow: visible; width: 119px; height: 80px; left: 620px; top: 68px; position: absolute;" ><svg height="100%" version="1.1" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="overflow: hidden; position: relative; left: -0.600037px; top: -0.800003px;"><desc style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Created with Raphaël 2.1.4</desc><defs style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><filter id="inner-shadow-1ablvv55d"><feOffset dx="0" dy="3"></feOffset><feGaussianBlur result="offset-blur" stdDeviation="5"></feGaussianBlur><feComposite operator="out" in="SourceGraphic" in2="offset-blur" result="inverse"></feComposite><feFlood flood-color="black" flood-opacity="0.2" result="color"></feFlood><feComposite operator="in" in="color" in2="inverse" result="shadow"></feComposite><feComposite operator="over" in="shadow" in2="SourceGraphic"></feComposite></filter></defs><path fill="#ebebeb" stroke="none" d="M34.5,64L19.5,64A40,40,0,0,1,99.5,64L84.5,64A25,25,0,0,0,34.5,64Z" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" filter="url(#inner-shadow-1ablvv55d)"></path><path fill="#008821" stroke="none" d="M34.5,64L19.5,64A40,40,0,0,1,47.13932022500211,25.957739348193854L51.77457514062632,40.22358709262116A25,25,0,0,0,34.5,64Z" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" filter="url(#inner-shadow-1ablvv55d)"></path><text x="59.5" y="12.5" text-anchor="middle" font-family="sans-serif" font-size="10px" stroke="none" fill="#999999" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: sans-serif; font-size: 10px; font-weight: bold; fill-opacity: 1;" font-weight="bold" fill-opacity="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="0"></tspan></text><text x="59.5" y="62.74509803921569" text-anchor="middle" font-family="Arial" font-size="12px" stroke="none" fill="#010101" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: Arial; font-size: 12px; font-weight: bold; fill-opacity: 1;" font-weight="bold" fill-opacity="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="0">40</tspan></text><text x="59.5" y="73.89894419306185" text-anchor="middle" font-family="Arial" font-size="10px" stroke="none" fill="#b3b3b3" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: Arial; font-size: 10px; font-weight: normal; fill-opacity: 1;" font-weight="normal" fill-opacity="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="0"></tspan></text><text x="27" y="73.89894419306185" text-anchor="middle" font-family="Arial" font-size="10px" stroke="none" fill="#b3b3b3" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: Arial; font-size: 10px; font-weight: normal; fill-opacity: 1;" font-weight="normal" fill-opacity="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="0">0</tspan></text><text x="92" y="73.89894419306185" text-anchor="middle" font-family="Arial" font-size="10px" stroke="none" fill="#b3b3b3" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: Arial; font-size: 10px; font-weight: normal; fill-opacity: 1;" font-weight="normal" fill-opacity="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="0">100</tspan></text></svg> </div></div>'
        data-vis-attrs="oid/id/changedId;"
        data-vis-attrs0="min_oid/id;mid_oid/id;max_oid/id;"
        data-vis-attrs1="group.value;hideValue/checkbox;digits/number,0,10,1;is_comma/checkbox;is_tdp[false]/checkbox;factor[1];unit;valueFontColor/color;valueFontFamily/fontname;valueOffsetY/number;"
        data-vis-attrs2="group.title1;title;titleFontColor/color;titleFontFamily/fontname;titleBelow/checkbox;titleOffsetY/number;"
        data-vis-attrs3="group.label;hideMinMax/checkbox;label_oid/id;labelFontColor/color;labelFontFamily/fontname;labelOffsetY/number;"
        data-vis-attrs4="group.pointer;pointer/checkbox;pointerMid/checkbox;pointerColor/color;pointerOptions/text;"
        data-vis-attrs5="group.shadow;hideInnerShadow/checkbox;shadowOpacity;shadowSize/number;shadowVerticalOffset/number;"
        data-vis-attrs6="group.layout;donut/checkbox;donutStartAngle/number,0,359,1;fullBri/checkbox;gaugeColor/color;color1/color;color2/color;color3/color;balance1[50]/slider,1,99,1;balance2[50]/slider,1,99,1;noGradient/checkbox;sector1/number;sector2/number;gaugeWidthScale/number,0,200,1;"
        data-vis-set="justgage"
        data-vis-type="val"
        data-vis-update-style="true"
        data-vis-name="justGage">
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 300px; height: 250px" id="<%= this.data.attr('wid') %>">
            <% vis.binds.justgage.createJustGage(this.data.wid, this.view, this.data, this.style); %>
    </div>
</script>

<script id="tplJustgageValueColored"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div><span style="color:blue">15</span> <span style="color:green">20</span> <span style="color:red">25</span></div>'
        data-vis-attrs="oid/id/changedId;min_oid/id;mid_oid/id;max_oid/id;"
        data-vis-attrs0="group.value;digits/number,0,10,1;is_comma/checkbox;is_tdp[false]/checkbox;factor[1];unit;"
        data-vis-attrs1="group.text;html_prepend/html;html_append_singular/html;html_append_plural/html;"
        data-vis-attrs2="group.color;changeBgColor/checkbox;fullBri/checkbox;color1/color;color2/color;color3/color;balance1[50]/slider,1,99,1;balance2[50]/slider,1,99,1;"
        data-vis-set="justgage"
        data-vis-type="val"
        data-vis-update-style="true"
        data-vis-name="Colored">
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 100px; height: 30px" id="<%= this.data.attr('wid') %>">
        <% vis.binds.justgage.createValueColored(this.data.wid, this.view, this.data, this.style); %>
    </div>
</script>

<script id="tplJustgageIndicatorColored"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div><span style="color:blue">↓</span> <span style="color:green">→</span> <span style="color:red">↑</span></div>'
        data-vis-attrs="oid/id/changedId;min_oid/id;mid_oid/id;max_oid/id;"
        data-vis-attrs0="group.value;equalAfter[0]/number;up/html;equal/html;down/html;"
        data-vis-attrs1="group.color;changeBgColor/checkbox;fullBri/checkbox;color1/color;color2/color;color3/color;balance1[50]/slider,1,99,1;balance2[50]/slider,1,99,1;"
        data-vis-set="justgage"
        data-vis-type="val"
        data-vis-update-style="true"
        data-vis-name="Indicator">
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 50px; height: 30px" id="<%= this.data.attr('wid') %>">
        <% vis.binds.justgage.createIndicatorColored(this.data.wid, this.view, this.data, this.style); %>
    </div>
</script>

<script id="tplJustgageValueIndicatorColored"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div><span style="color:blue">15↑</span> <span style="color:green">20→</span> <span style="color:red">25↓</span></div>'
        data-vis-attrs="oid/id/changedId;min_oid/id;mid_oid/id;max_oid/id;"
        data-vis-attrs0="group.value;digits/number,0,10,1;is_comma/checkbox;is_tdp[false]/checkbox;factor=[1];unit;"
        data-vis-attrs1="group.text;html_prepend/html;html_append_singular/html;html_append_plural/html;"
        data-vis-attrs2="group.indicator;equalAfter[0]/number;up/html;equal/html;down/html;"
        data-vis-attrs3="group.color;changeBgColor/checkbox;fullBri/checkbox;color1/color;color2/color;color3/color;balance1[50]/slider,1,99,1;balance2[50]/slider,1,99,1;"
        data-vis-set="justgage"
        data-vis-type="val"
        data-vis-update-style="true"
        data-vis-name="Value & Indicator">
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 50px; height: 30px" id="<%= this.data.attr('wid') %>">
        <%
            vis.binds.justgage.createValueColored(this.data.wid, this.view, this.data, this.style, true);
        %>
    </div>
</script>






<!-- --------------justgage.html--- END -->
<!-- --------------keyboard.html--- START -->
<!--
    ioBroker.vis iobroker.vis-keyboard Widget-Set

    version: "0.0.2"

    Copyright 10.2015-2016 Steffen Schorling<steffen.schorling@googlemail.com>
-->
<link rel="stylesheet" type="text/css" href="widgets/keyboard/css/keyboard-previewkeyset.min.css"/>
<link rel="stylesheet" type="text/css" href="widgets/keyboard/css/keyboard.min.css"/>

<script type="text/javascript"          src="widgets/keyboard/js/jquery.keyboard.min.js"></script>
<script type="text/javascript"          src="widgets/keyboard/languages/de.min.js"></script>
<script type="text/javascript"          src="widgets/keyboard/languages/ru.min.js"></script>
<script type="text/javascript"          src="widgets/keyboard/layouts/german.min.js"></script>
<script type="text/javascript"          src="widgets/keyboard/layouts/russian.min.js"></script>
<script type="text/javascript"          src="widgets/keyboard/js/keyboard.js"></script>

<script id="tplKeyboardAll"
		type="text/ejs"
		class="vis-tpl"
		data-vis-prev='<img src="widgets/keyboard/img/prev_vkb.png"></img>'
		data-vis-set="keyboard"
		data-vis-type="keyboard"
		data-vis-name="Virtual Keyboard"
		data-vis-attrs="layout/select,german,english,russian">
    <div class="vis-widget <%== this.data.attr('class') %>" style=" width: 190px; height: 22px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.keyboard.all(el, data, this.view) %>>
			<div style="border: 1px solid red; background: #ffffff">Virtual Keyboard for view <%= this.view %></div>
        </div>
    </div>
</script>

<script id="tplKeyboardWidget"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/keyboard/img/prev_vkb.png"></img>'
        data-vis-set="keyboard"
        data-vis-type="keyboard"
        data-vis-name="Keyboard for Widget"
        data-vis-attrs="wname/widget;layout/select,de,english,ru,numpad">
    <div class="vis-widget <%== this.data.attr('class') %>" style=" width: 220px; height: 22px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.keyboard.one(el, data, this.view) %>>
			<div style="border: 1px solid blue; background: #ffffff">Virtual Keyboard for <%= this.data.attr('wname') %></div>
        </div>
    </div>
</script>















<!-- --------------keyboard.html--- END -->
<!-- --------------kodi.html--- START -->
<!--
    ioBroker.iobroker.kodi Widget-Set
    version: "2.0.0"
    Copyright 10.2015-2020 instalator<vvvalt@mail.ru>
-->

<link rel="stylesheet" href="widgets/kodi/css/style.css"/>
<script type="text/javascript" src="widgets/kodi/js/kodi.js"></script>


<script id="tplkodiProgressBar"
        type="text/ejs" 
        class="vis-tpl"
        data-vis-prev='<img style="width:110px; height:10px" src="widgets/kodi/img/w_icon/progress.png"></img>'
        data-vis-attrs="oid_seek/id/;"
        data-vis-set="kodi"
        data-vis-type="val"
        data-vis-name="Progress Bar">
	<div class="vis-widget <%== this.data.attr('class') %>" style="width:200px; height:20px; overflow: initial" id="<%= this.data.attr('wid') %>" >
       <% vis.binds.kodi.Progress(this.data.wid, this.view, this.data, this.style);%>
	</div>


</script>

<script id="tplkodiPlaylist"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img style="width:110px; height:90px" src="widgets/kodi/img/w_icon/playlist.png"></img>'
        data-vis-attrs="oid_playlist/id/onPlaylistBrowserChanged;oid_position/id;oid_server/id/;"
        data-vis-set="kodi"
        data-vis-type="val"
        data-vis-name="KODI Playlist">
	<div class="vis-widget <%== this.data.attr('class') %>" style="width:500px; height:240px" id="<%= this.data.attr('wid') %>" >
			<div id="kodiplaylist">
				<ul id="playListContainer">
				</ul>
			</div>
       <% vis.binds.kodi.Playlist(this.data.wid, this.view, this.data, this.style);%>
	</div>
</script>

<script id="tplkodiThumbnail"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img style="width:110px; height:110px" src="widgets/kodi/img/defaultplaylist.png"></img>'
        data-vis-attrs="oid_thumbnail/id/onThumbnailBrowserChanged;oid_type/id/;oid_server/id/;"
        data-vis-set="kodi"
        data-vis-type="val"
        data-vis-name="KODI Thumbnail">
	<div class="vis-widget <%== this.data.attr('class') %>" style="width:110px; height:110px" id="<%= this.data.attr('wid') %>" >
			<ul class="kodicover">
				<li class="cover"></li>
				</ul>
       <% vis.binds.kodi.Thumbnail(this.data.wid, this.view, this.data, this.style);%>
	</div>
</script>

<script id="tplkodiCodec"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img style="width:100px; height:50px" src="widgets/kodi/img/w_icon/codec.png"></img>'
        data-vis-attrs="oid_codec/id/;"
        data-vis-set="kodi"
        data-vis-type="val"
        data-vis-name="KODI codec info">
	<div class="vis-widget <%== this.data.attr('class') %>" style="width:100px; height:50px" id="<%= this.data.attr('wid') %>" >
				<ul class="kodiinfo">
					<li class="codec"></li>
				</ul>
       <% vis.binds.kodi.CodecInfo(this.data.wid, this.view, this.data, this.style);%>
	</div>


</script>

<script id="tplkodiAspect"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img style="width:67px; height:50px" src="widgets/kodi/img/w_icon/aspect.png"></img>'
        data-vis-attrs="oid_aspect/id/;"
        data-vis-set="kodi"
        data-vis-type="val"
        data-vis-name="KODI AspectRatio info">
	<div class="vis-widget <%== this.data.attr('class') %>" style="width:70px; height:50px" id="<%= this.data.attr('wid') %>" >
				<ul class="kodiinfo">
					<li class="aspect"></li>
				</ul>
       <% vis.binds.kodi.AspectInfo(this.data.wid, this.view, this.data, this.style);%>
	</div>


</script>

<script id="tplkodiResolut"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img style="width:67px; height:50px" src="widgets/kodi/img/w_icon/resolution.png"></img>'
        data-vis-attrs="oid_resolut/id/;"
        data-vis-set="kodi"
        data-vis-type="val"
        data-vis-name="KODI Video Resolution info">
	<div class="vis-widget <%== this.data.attr('class') %>" style="width:70px; height:50px" id="<%= this.data.attr('wid') %>" >
				<ul class="kodiinfo">
					<li class="resolut"></li>
				</ul>
       <% vis.binds.kodi.ResolutInfo(this.data.wid, this.view, this.data, this.style);%>
	</div>


</script>

<script id="tplkodiChannel"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img style="width:64px; height:50px" src="widgets/kodi/img/w_icon/channel.png"></img>'
        data-vis-attrs="oid_channel/id/;"
        data-vis-set="kodi"
        data-vis-type="val"
        data-vis-name="KODI Audio Channel info">
	<div class="vis-widget <%== this.data.attr('class') %>" style="width:70px; height:50px" id="<%= this.data.attr('wid') %>" >
				<ul class="kodiinfo">
					<li class="channel"></li>
				</ul>
       <% vis.binds.kodi.ChannelInfo(this.data.wid, this.view, this.data, this.style);%>
	</div>


</script>

<script id="tplkodiVideoCodec"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img style="width:100px; height:50px" src="widgets/kodi/img/w_icon/video_codec.png"></img>'
        data-vis-attrs="oid_videocodec/id/;"
        data-vis-set="kodi"
        data-vis-type="val"
        data-vis-name="KODI VideoCodec info">
	<div class="vis-widget <%== this.data.attr('class') %>" style="width:100px; height:50px" id="<%= this.data.attr('wid') %>" >
				<ul class="kodiinfo">
					<li class="videocodec"></li>
				</ul>
       <% vis.binds.kodi.VideoCodec(this.data.wid, this.view, this.data, this.style);%>
	</div>



</script>

<script id="tplkodiButton"
        type="text/ejs" 
        class="vis-tpl"
        data-vis-prev='<img style="width:110px; height:20px" src="widgets/kodi/img/w_icon/button.png"></img>'
        data-vis-attrs="oid_play/id/onKodiButtonBrowserChanged;oid_speed/id;oid_prev/id;oid_next/id;oid_stop/id;oid_mute/id;oid_rpt/id;oid_shf/id;oid_seek/id;"
        data-vis-set="kodi"
        data-vis-type="val"
        data-vis-name="KODI Button">
	<div class="vis-widget <%== this.data.attr('class') %>" style="width:400px; height:50px" id="<%= this.data.attr('wid') %>" >
				<ul id="kodicontrols">
					<li class="prev"></li>
					<li class="rewind"></li>
					<li class="playpause"></li>
					<li class="stop"></li>
					<li class="forward"></li>
					<li class="next"></li>
					<li class="repeat"></li>
					<li class="shuffle"></li>
				</ul> 
       <% vis.binds.kodi.Button(this.data.wid, this.view, this.data, this.style);%>
	</div>
</script>



<!-- --------------kodi.html--- END -->
<!-- --------------lcars.html--- START -->
<!--

    ioBroker.vis lcars Widget-Set

    version: "1.0.4"

    2013-2017 hobbyquaker, bluefox

    TODO - Slider Widgets
    TODO - Bar Widgets
    TODO - 4way Controller Widget
-->
<link rel="stylesheet" type="text/css" href="widgets/lcars/css/lcars.css" />
<script type="text/javascript" src="widgets/lcars/js/jquery.lcars.js"></script>
<script type="text/javascript">

    "use strict";

    // Add words for lcars
    if (vis.editMode) {
        $.extend(systemDictionary, {
            "lcars_color":    {"en": "Color",             "de": "Farbe",                  "ru": "Цвет"},
            "edge_type":      {"en": "Edge type",         "de": "Bordertyp",              "ru": "Тип кромки"},
            "edge_direction": {"en": "Edge position",     "de": "Borderposition",         "ru": "Позиция"},
            "color_default":  {"en": "Dafault color",     "de": "Farbe",                  "ru": "Цвет по умолчанию"},
            "color_active":   {"en": "Active link color", "de": "Farbe von aktivem Link", "ru": "Цвет активной ссылки"},
            "line_height":    {"en": "Line height",       "de": "Linienhöche",            "ru": "Ширина линии"},
            "tl":             {"en": "Top left",          "de": "Oben links",             "ru": "Сверху слева"},
            "tr":             {"en": "Top right",         "de": "Oben rechts",            "ru": "Сверху справа"},
            "br":             {"en": "Bottom right",      "de": "Unten rechst",           "ru": "Снизу справа"},
            "bl":             {"en": "Bottom left",       "de": "Unten links",            "ru": "Снизу слева"},
            "frame_type":     {"en": "Type",              "de": "Typ",                    "ru": "Тип"},
            "frame_direction": {"en": "Direction",        "de": "Richtung",               "ru": "Расположение"},
            "speed":          {"en": "Speed",             "de": "Geschwindigkeit",        "ru": "Скорость"},
            "rows":           {"en": "Rows",              "de": "Zeilen",                 "ru": "Строк"},
            "cols":           {"en": "Columns",           "de": "Spalten",                "ru": "Колонок"},
            "r":              {"en": "Right",             "de": "Rechst",                 "ru": "Справа"},
            "l":              {"en": "Left",              "de": "Links",                  "ru": "Cлева"},
            "rounded":        {"en": "Rounded",           "de": "Abgerundet",             "ru": "Закругления"},
            "subtitle":       {"en": "Subtitle",          "de": "Untertitel",             "ru": "Подзаголовок"},
            "subtitle_show":  {"en": "Show",              "de": "Zeige",                  "ru": "Показать"},
            "subtitle_color": {"en": "subtitle_color",    "de": "Farbe",                  "ru": "Цвет"},
            "minmax":         {"en": "Mininum or maximum","de": "Mininum oder Maximum",   "ru": "Минимум или максимум"},
            "repeat_delay":   {"en": "Repeat delay",      "de": "Widerholungs- Verzögerung", "ru": "Задержка перед повтором"},
            "repeat_interval": {"en": "Repeat interval",  "de": "Widerholungs- Interval", "ru": "Интервал повтора"},
            "none":           {"en": "none",              "de": "keins",                  "ru": "нигде"},
            "both":           {"en": "both",              "de": "beide",                  "ru": "оба"},
            "group_title":    {"en": "Title",             "de": "Titel",                  "ru": "Заголовок"},
            "step_tooltip":     {
                "en": "Can be positive or negative",
                "de": "Kann positiv oder negativ sein",
                "ru": "Может быть положительным или отрицательным"
            },
            "minmax_tooltip":     {
                "en": "If 'step' is positiv, the value is interpreted as maximum\x0Aif 'step' is negativ, then as minimum",
                "de": "Falls 'Schritt' positiv ist, dann hier wird Maximum eingegeben\x0AFalls 'Schritt' negativ ist, dann Mimimum",
                "ru": "Если 'шаг' положительный, то значение интепретируется как максимум\x0Aесли 'шаг' отрицательный, то как минимум"
            },
            "title_oid": {"en": "Object ID", "de": "Objekt ID", "ru": "ID Объекта"},
            "title_oid_tooltip": {
                "en": "You can enter here text as '(TEXT)'\x0Ato not read the value from variable\x0Aand to just show the specified text.",
                "de": "Man kann auch text in Klammern eingeben '(TEXT)'\x0Aum einfach Text und nicht\x0Adas Variablewert anzuzeigen.",
                "ru": "Можно ввести текст, как '(TEXT)'\x0Aдля того, что бы показать заданное слово,\x0Aа не значение переменной"
            },
            "title_prepend": {"en": "Prepend text", "de": "Präfix", "ru": "Префикс"},
            "title_append_singular": {"en": "Append if singular", "de": "Suffix singulär", "ru": "Суффикс единств. число"},
            "title_append_plural": {"en": "Append if plural", "de": "Suffix plüral", "ru": "Суффикс множ. число"},
            "title_digits": {"en": "Digits after comma", "de": "Nachkomma- Stellen", "ru": "Чисел после запятой"},
            "title_digits_tooltip": {
                "en": "Clear value to '' to disable the rounding.",
                "de": "Lösche das Wert zu '' um Rundung zu deaktivieren.",
                "ru": "Удалите значение полностью, что бы деактивировать округление"
            },

            "group_subtitle": {"en": "Subtitle", "de": "Untertitel", "ru": "Подзаголо́вок"},
            "subtitle_oid": {"en": "Object ID", "de": "Objekt ID", "ru": "ID Объекта"},
            "subtitle_oid_tooltip": {
                "en": "You can enter here text as '(TEXT)'\x0Ato not read the value from variable\x0Aand to just show the specified text.",
                "de": "Man kann auch text in Klammern eingeben '(TEXT)'\x0Aum einfach Text und nicht\x0Adas Variablewert anzuzeigen.",
                "ru": "Можно ввести текст, как '(TEXT)'\x0Aдля того, что бы показать заданное слово,\x0Aа не значение переменной"
            },
            "subtitle_prepend": {"en": "Prepend text", "de": "Präfix", "ru": "Префикс"},
            "subtitle_append_singular": {"en": "Append if singular", "de": "Suffix singulär", "ru": "Суффикс единств. число"},
            "subtitle_append_plural": {"en": "Append if plural", "de": "Suffix plüral", "ru": "Суффикс множ. число"},
            "subtitle_digits": {"en": "Digits after comma", "de": "Nachkomma- Stellen", "ru": "Чисел после запятой"},
            "subtitle_digits_tooltip": {
                "en": "Clear value to '' to disable the rounding.",
                "de": "Lösche das Wert zu '' um Rundung zu deaktivieren.",
                "ru": "Удалите значение полностью, что бы деактивировать округление"
            }
        });

        vis.addFont('lcars_font');
    }
    
    vis.binds.lcars = {
        version: "1.0.4",
        showVersion: function () {
            if (vis.binds.lcars.version) {
                console.log('Version lcars: ' + vis.binds.lcars.version);
                vis.binds.lcars.version = null;
            }
        },
        color: function (name) {
            switch (name) {
                case 'orange':
                    return '#ff9900';
                    break;
                case 'purple':
                    return '#cc99cc';
                    break;
                case 'blue':
                    return '#9999ff';
                    break;
                case 'lightBlue':
                    return '#9999cc';
                    break;
                case 'red':
                    return '#cc0000';
                    break;
                case 'lightRed':
                    return '#cc6666';
                    break;
                case 'tan':
                    return '#ff9966';
                    break;
                case 'lightTan':
                    return '#ffcc99';
                    break;
                case 'pink':
                    return '#cc6699';
                    break;
                case 'white':
                    return '#ccccff';
                    break;
                default:
                    return '#ffffff';

            }
        },
        _oid: function (options, bound, onChange) {
            if (typeof bound === 'function') {
                onChange = bound;
                bound = null;
            }
            // title and subtitle can be {oid: a, prepend: b, append_singular: c, append_plural: d, digits: 0}
            var val = '';
            if (!options.oid) {
                // val = '';
            } else if (options.oid && (options.oid[0] === '(' || options.oid[0] === '[' || options.oid[0] === '{')) {
                // Process it as text
                val = options.oid.substring(1);
                if (val[val.length - 1] === ')' || val[val.length - 1] === ']' || val[val.length - 1] === '}') val = val.substring(0, val.length - 1);
            } else {
                // get actual value and
                val = (vis.states[options.oid + '.val'] !== undefined) ? vis.states[options.oid + '.val'] : 0;
                if (val === 'true' || val === true) val = 1;

                if (options.digits !== null && options.digits !== undefined && options.digits !== '') {
                    val = parseFloat(val).toFixed(parseInt(options.digits, 10));
                }

                if (options.append_singular || options.append_plural) {
                    if (val == 1) {
                        if (options.append_singular !== undefined) val += options.append_singular;
                    } else {
                        if (options.append_plural !== undefined) val += options.append_plural;
                    }
                }
                if (options.prepend !== undefined) val = options.prepend + val;

                // Subscribe
                if (onChange) {
                    if (bound) bound.push(options.oid + '.val');
                    vis.states.bind(options.oid + '.val', onChange);
                }
            }
            return val;
        },
        viewSelected: function (widgetID, view, newView, attr, isCss) {
            var changed = [];
            if (!vis.views[view].widgets[widgetID].data.html ||
                vis.views[vis.views[view].widgets[widgetID].data.html]) {
                changed.push('html');
                vis.views[view].widgets[widgetID].data.html = newView;
                vis.widgets[widgetID].data.html = newView;
            }
            return changed.length ? changed : null;
        },
        button: function (wid, view, el, options, id, val, color_active, title, subtitle) {
            var $div = $('#' + wid);
            if (!$div.length) {
                setTimeout(function () {
                    vis.binds.lcars.button(wid, view, el, options, id, val, color_active, title, subtitle);
                }, 100);
                return;
            }
            // title and subtitle can be {oid: a, prepend: b, append_singular: c, append_plural: d, digits: 0}
            var $this = $div.find('.vis-widget-lcars-span');

            var bound = [];
            function onChange(e, newVal /* , oldVal */) {
                if (subtitle && typeof subtitle === 'object' && (subtitle.oid + '.val') === e.type) {
                    $this.find('._subtitle').html(vis.binds.lcars._oid(subtitle));
                } else if (title && typeof title === 'object' && (title.oid + '.val') === e.type) {
                    $this.data('title', vis.binds.lcars._oid(title));
                    $this.find('._title').html($this.data('title'));
                } else {
                    if (newVal === 'true' || newVal === true) newVal = 1;
                    if (val == newVal) {
                        $this.css('background-color', vis.binds.lcars.color(color_active));
                        $this.find('.B_titleL').css('color', vis.binds.lcars.color(color_active));
                    } else {
                        $this.css('background-color', vis.binds.lcars.color(options.color));
                        $this.find('.B_titleL').css('color', vis.binds.lcars.color(options.color));
                    }
                }
            }

            // process subtitle
            if (typeof subtitle === 'object') {
                if (subtitle.oid) bound.push(subtitle.oid + '.val');
                // TODO: bug by every change of some parameter new bind will be created!! In Edit mode can be the problem.
                options.subTitle.text = vis.binds.lcars._oid(subtitle, bound, onChange);
            }

            $this.lcarsButton(options);

            if (id && val !== undefined) {
                var newVal = (vis.states[id + '.val'] !== undefined) ? vis.states[id + '.val'] : 0;
                if (newVal === 'true' || newVal === true) newVal = 1;

                if (val == newVal) {
                    $this.css('background-color', vis.binds.lcars.color(color_active));
                    $this.find('.B_titleL').css('color', vis.binds.lcars.color(color_active));
                }
                bound.push(id + '.val');
                vis.states.bind(id + '.val', onChange);
            }

            var _title;
            try {
                _title = JSON.parse(JSON.stringify(title));
            } catch (e) {
                _title = null;
            }
            // process title
            if (title && typeof title === 'object') {
                if (title.oid) bound.push(title.oid + '.val');
                _title = vis.binds.lcars._oid(title, bound, onChange);
            }

            $this.data('title', _title);
            $this.find('._title').html(_title);

            if (vis.editMode) {
                $this.parent().resize(function () {
                    var t = $this.data('timer');
                    if (t) clearTimeout(t);

                    $this.data('timer', setTimeout(function () {
                        clearTimeout($this.data('timer'));
                        $this.data('timer', null);
                        $this.width($this.parent().width() - 52);
                    }, 100));
                });
            }
            if (bound.length) {
                // remember all ids, that bound
                $div.data('bound', bound);
                // remember bind handler
                $div.data('bindHandler', onChange);
            }
        },
        warpcoreInterval: {},
        warpcore: function (el, speed, wid) {
            var d = 114;
            var i = 0;
            var $this = $(el).prev();

            if (vis.binds.lcars.warpcoreInterval[wid]) {
                clearInterval(vis.binds.lcars.warpcoreInterval[wid]);
            }
            vis.binds.lcars.warpcoreInterval[wid] = _setInterval(function (_this) {
                i += 1;
                if (i > 4) i = 0;
                _this.css('background-position', -d * i);
            },speed, $this);

        },
        warpcoreVal: function (el, id, min, max, wid) {
            var d = 114;
            var i = 0;
            var minSpeed = 800;
            var maxSpeed = 50;
            var valRange = parseFloat(min) - parseFloat(max);
            var spdRange = minSpeed - maxSpeed;
            var val = parseFloat(vis.states.attr(id + '.val'));
            var speed = parseInt(minSpeed + ((spdRange / valRange) * val), 10);
            if (isNaN(speed))     speed = minSpeed;
            if (speed < maxSpeed) speed = maxSpeed;

            var $this = $(el).prev();
            if (vis.binds.lcars.warpcoreInterval[wid]) {
                clearInterval(vis.binds.lcars.warpcoreInterval[wid]);
            }
            vis.binds.lcars.warpcoreInterval[wid] = _setInterval(function (_this) {
                i += 1;
                if (i > 4) i = 0;
                _this.css('background-position', -d * i);
            }, speed, $this);

            vis.states.bind(id + '.val', function (e, newVal /* , oldVal */) {
                var speed = parseInt(minSpeed + ((spdRange / valRange) * parseFloat(newVal)), 10);
                if (isNaN(speed))     speed = minSpeed;
                if (speed < maxSpeed) speed = maxSpeed;

                if (vis.binds.lcars.warpcoreInterval[wid]) {
                    clearInterval(vis.binds.lcars.warpcoreInterval[wid]);
                }
                vis.binds.lcars.warpcoreInterval[wid] = _setInterval(function (_this) {
                    i += 1;
                    if (i > 4) i = 0;
                    _this.css('background-position', -d * i);
                }, speed, $this);
            });

        },
        dnaInterval: {},
        dna: function (el, oid, speed, wid, min, max) {
            var i = 0;
            var $this = $(el).prev();
            if (vis.binds.lcars.dnaInterval[wid]) {
                clearInterval(vis.binds.lcars.dnaInterval[wid]);
            }
            var val = 1;
            if (oid) {
                val = vis.states.attr(oid + '.val') || 0;
                val = parseFloat(val);
                if (min < max) {
                    if (val < min) val = min;
                    if (val > max) val = max;
                    val = (val - min) / (max - min);
                } else {
                    if (val > min) val = min;
                    if (val < max) val = max;
                    val = (val - min) / (max - min);
                }
                if (val < 0) val = -val;
            }

            vis.binds.lcars.dnaInterval[wid] = _setInterval(function (_this) {
                i++;
                if (i > 283) i = 0;
                _this.css('background-position', i);
            }, val * speed, $this);

        },
        randomNumber: function () {
            return ('00' + parseInt((Math.random() * 1000), 10)).slice(-3);
        },
        randomInterval: {},
        random: function (el, rows, cols, speed, wid) {
            var $this = $(el).prev();
            var $table = $this.find('table');
            if (vis.binds.lcars.randomInterval[wid]) {
                clearInterval(vis.binds.lcars.randomInterval[wid]);
            }
            vis.binds.lcars.randomInterval[wid] = _setInterval(function (_table) {
                if (_table.find('tr').length >= rows) {
                    _table.html('');
                }
                var colsHtml = '';
                for (var j = 0; j < cols; j++) {
                    colsHtml += vis.binds.lcars.randomNumber() + '</td><td>';
                }
                _table.append('<tr><td>' + colsHtml + '</td></tr>');

            }, speed, $table);
        },
        nav: function (el, nav_view, color_normal, color_active) {
            var $this = $(el).prev();

            if (vis.activeView === nav_view) $this.css('background-color', vis.binds.lcars.color(color_active));

            if (!vis.editMode) {
                $this.on('click touchstart', function (e) {
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    vis.changeView(nav_view);
                    e.preventDefault();
                    return false;
                });
            }

            $(window).on('viewChanged', function (newView) {
                if (vis.activeView === nav_view) {
                    $this.css('background-color', vis.binds.lcars.color(color_active));
                } else {
                    $this.css('background-color', vis.binds.lcars.color(color_normal));
                }
            });
        }
    };

    vis.binds.lcars.showVersion();
</script>

<!--script id="tplLcarsSidePanel"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="lcars"
        data-vis-type="navigation"
        data-vis-name="Side-Panel"
        data-vis-attrs="html"
        >
    <div class="vis-widget vis-lcars <%== this.data.attr('class') %>" style="width: 88px; height: 550px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <ul id="side-panel" class="side-panel">
                <li style="height: 74px; background-color: rgb(153, 153, 255);"><div style="line-height: 128px;"><span style="padding-right:2px"><a href="index.html">Test1</a></span></div></li>
                <li style="height: 74px; background-color: rgb(204, 153, 204);"><span style="padding-right:2px"><a href="css.html">Test2</a></span></li>
                <li style="height: 74px; background-color: rgb(153, 153, 255);"><span style="padding-right:2px"><a href="debug.html">Test3</a></span></li>
                <li style="height: 74px; background-color: rgb(204, 153, 204);"><span style="padding-right:2px"><a href="mobile.html">Test4</a></span></li>
                <li style="height: 74px; background-color: rgb(153, 153, 255);"><span style="padding-right:2px">Test5</span></li><li style="height: 218px; border-bottom-style: none; background-color: rgb(204, 153, 204);"><span style="padding-right:2px">781</span></li>
            </ul>
        </div>
    </div>
</script-->

<script id="tplLcarsHtmlNav"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="lcars"
        data-vis-type="navigation"
        data-vis-name="HTML"
        data-vis-prev='<div id="prev_tplLcarsHtmlNav" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev" style="width: 116px; height: 35px; font-family: lcars_font; font-size: 30px; text-align: right; position: absolute;"><div class="vis-widget-prev-body" style="background-color: rgb(255, 153, 0);"> <span style="padding-right:4px">Link </span></div></div></div>'
        data-vis-attrs="html;nav_view/views/viewSelected;color_default[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white;color_active[purple]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 88px; height: 74px; font-family: lcars_font; font-size: 30px; text-align: right; " id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="cursor: pointer; background-color: <%= vis.binds.lcars.color(data.attr('color_default')) %>">
            <span style="padding-right:4px"><%== this.data.attr('html') %></a>
        </div>
        <div <%= (el) -> vis.binds.lcars.nav(el, data.attr('nav_view'), data.attr('color_default'), data.attr("color_active")) %>></div>
    </div>
</script>

<script id="tplLcarsHTML"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="lcars"
        data-vis-type="static"
        data-vis-prev='<div id="prev_tplLcarsHTML" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-draggable-handle " style="font-family: lcars_font; letter-spacing: 1px; font-size: 30px; width: 93px; height: 33px; padding: 0px; margin: 0px; position: absolute;" > <div class="vis-widget-prev-body" style="padding: 0px; margin: 0px; color: rgb(255, 153, 0);"> HTML Text </div> </div></div>'
        data-vis-name="Text/HTML"
        data-vis-attrs="html;lcars_color[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="font-family: lcars_font; letter-spacing: 1px; font-size: 30px; width: 260px; height: 32px;padding:0;margin:0" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="padding:0;margin:0;color: <%= vis.binds.lcars.color(this.data.attr('lcars_color')) %>">
            <%== this.data.attr('html') %>
        </div>
    </div>
</script>

<script id="tplLcarsLine"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="lcars"
        data-vis-name="Line"
        data-vis-type="static"
        data-vis-prev='<div id="prev_tplLcarsLine" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-draggable-handle" style="width: 69px; height: 13px; padding: 0px; margin: 0px; position: absolute;" > <div class="vis-widget-prev-body" style="padding: 0px; margin: 0px; background-color: rgb(255, 153, 0);"> </div> </div></div>'
        data-vis-attrs="lcars_color[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 195px; height: 25px; padding: 0; margin: 0" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="padding:0;margin:0;background-color: <%= vis.binds.lcars.color(this.data.attr('lcars_color')) %>">
        </div>
    </div>
</script>

<script id="tplLcarsLineTop"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="lcars"
        data-vis-prev='<img src="widgets/lcars/img/Prev_Top.png"></img>'
        data-vis-type="static"
        data-vis-name="Line-Top"
        data-vis-attrs="lcars_color[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white;line_height[3]/slider,1,40,1"
        >
    <div class="vis-widget vis-lcars <%== this.data.attr('class') %>" style="width: 400px; height: 25px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div class="line-top" style="background-color:<%= vis.binds.lcars.color(this.data.attr('lcars_color')) %>;margin-bottom:-3px;"></div>
        </div>
    </div>
</script>

<script id="tplLcarsLineBottom"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="lcars"
        data-vis-type="static"
        data-vis-name="Line-Bottom"
        data-vis-prev='<img src="widgets/lcars/img/Prev_Bottom.png"></img>'
        data-vis-attrs="lcars_color[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white;line_height[3]/slider,1,40,1"
        >
    <div class="vis-widget vis-lcars <%== this.data.attr('class') %>" style="width: 400px; height: 25px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div class="line-bottom" style="background-color:<%= vis.binds.lcars.color(this.data.attr('lcars_color')) %>;margin-bottom:-3px;"></div>
        </div>
    </div>
</script>

<script id="tplLcarsEdge"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="lcars"
        data-vis-type="static"
        data-vis-prev='<div id="prev_tplLcarsEdge" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-lcars ui-selectee ui-draggable-handle " style="width: 93px; height: 33px; padding: 0px; margin: 0px; position: absolute;" > <div class="vis-widget-prev-body" style="padding: 0px; margin: 0px; background-color: rgb(255, 153, 0);"> <img width="100%" height="100%" style="padding:0;margin:0;border:none;" src="widgets/lcars/img/edge2-tl.png"> </div> </div></div>'
        data-vis-name="Edge"
        data-vis-attrs="edge_type[1]/nselect,1,2;edge_direction[tl]/select,tl,tr,br,bl;lcars_color[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white"
        >
    <div class="vis-widget vis-lcars <%== this.data.attr('class') %>" style="width: 195px; height: 83px;padding:0;margin:0" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="padding:0;margin:0;background-color: <%= vis.binds.lcars.color(this.data.attr('lcars_color')) %>">
            <img width="100%" height="100%" style="padding:0;margin:0;border:none;" src="widgets/lcars/img/edge<%= this.data.attr('edge_type') %>-<%= this.data.attr('edge_direction') %>.png">
        </div>
    </div>
</script>

<script id="tplLcarsEnd"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="lcars"
        data-vis-type="static"
        data-vis-prev='<div id="prev_tplLcarsEdge" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-lcars ui-selectee ui-draggable-handle " style="width: 93px; height: 25px; padding: 0px; margin: 0px; font-size: 1px" > <div class="vis-widget-prev-body" style="padding: 0px; margin: 0px; background-color: rgb(255, 153, 0); text-align: right"> <img height="100%" style="padding:0;margin:0;border:none;" src="widgets/lcars/img/end-r.png"> </div> </div></div>'
        data-vis-name="End"
        data-vis-attrs="frame_direction[r]/select,r,l;lcars_color[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white"
        >
    <div class="vis-widget vis-lcars <%== this.data.attr('class') %>" style="width: 50px; height: 25px;padding:0;margin:0" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="padding:0; margin:0; font-size: 1px; background-color: <%= vis.binds.lcars.color(this.data.attr('lcars_color')) %>; text-align: <%= (this.data.attr('frame_direction') == 'r' ? 'right' : 'left') %>">
            <img height="100%" style="padding: 0; margin: 0; border: none;" src="widgets/lcars/img/end-<%= this.data.attr('frame_direction') %>.png">
         </div>
    </div>
</script>

<script id="tplLcarsFrame"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="lcars"
        data-vis-type="static"
        data-vis-name="Frame"
        data-vis-prev='<div id="prev_tplLcarsFrame" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-lcars ui-draggable-handle " style="width: 33px; height: 95px; padding: 0px; margin: 0px; position: absolute;" > <div class="vis-widget-prev-body" style="padding:0;margin:0"> <img width="100%" height="100%" style="padding:0;margin:0;border:none;" src="widgets/lcars/img/frame1-r.png"> </div> </div></div>'
        data-vis-attrs="frame_type[1]/nselect,1,2;frame_direction[r]/select,r,l"
        >
    <div class="vis-widget vis-lcars <%== this.data.attr('class') %>" style="width: 32px; height: 215px;padding:0;margin:0" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="padding:0;margin:0">
            <img width="100%" height="100%" style="padding:0;margin:0;border:none;" <%= (this.data.attr('frame_type') && this.data.attr('frame_direction') ? 'src="widgets/lcars/img/frame' + this.data.attr('frame_type') +'-' + this.data.attr('frame_direction') + '.png"' : '') %>>
        </div>
    </div>
</script>

<script id="tplLcarsUfpLogo"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="lcars"
        data-vis-type="static"
        data-vis-name="UFP Logo"
        data-vis-prev='<div id="prev_tplLcarsUfpLogo" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-draggable-handle " style="width: 93px; height: 70px; padding: 0px; margin: 0px; position: absolute;" > <div class="vis-widget-prev-body"> <img width="100%" src="widgets/lcars/img/ufp.png"> </div> </div></div>'
        data-vis-attrs=""
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 531px; height: 409px;padding:0;margin:0" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <img width="100%" src="widgets/lcars/img/ufp.png"/>
        </div>
    </div>
</script>

<script id="tplLcarsSfLogo"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="lcars"
        data-vis-type="static"
        data-vis-prev='<div id="prev_tplLcarsSfLogo" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-draggable-handle " style="width: 73px; height: 77px; padding: 0px; margin: 0px; position: absolute;" > <div class="vis-widget-prev-body" style="background-color: rgb(255, 153, 0);"> <img width="100%" src="widgets/lcars/img/starfleet.png"> </div> </div></div>'
        data-vis-name="Starfleet Logo"
        data-vis-attrs="lcars_color[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 161px; height: 171px ;padding:0;margin:0" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="background-color: <%= vis.binds.lcars.color(this.data.attr('lcars_color')) %>">
            <img width="100%" src="widgets/lcars/img/starfleet.png"/>
        </div>
    </div>
</script>

<script id="tplLcarsDna"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="lcars"
        data-vis-type="static"
        data-vis-prev='<div id="prev_tplLcarsDna" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-lcars ui-draggable-handle " style="width: 87px; height: 43px; padding: 0px; margin: 0px; position: absolute;" > <div class="vis-widget-prev-body" style="padding:0;margin:0"> <div style="width: 100%; height: 100%; background-image: url(widgets/lcars/img/dna.png); background-position: 208px 50%;"></div>  </div> </div></div>'
        data-vis-name="DNA"
        data-vis-attrs="oid;speed[50];min[0];max[100]"
        >
    <div class="vis-widget vis-lcars <%== this.data.attr('class') %>" style="width: 560px; height: 48px;padding:0;margin:0" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="padding:0;margin:0">
            <div style="width:100%;height:100%;background-image: url('widgets/lcars/img/dna.png')"></div>
            <div <%= (el) -> vis.binds.lcars.dna(el, data.attr('oid'), data.attr('speed'), data.attr('wid'), data.attr('min'), data.attr('max')) %>></div>
        </div>
    </div>
</script>

<script id="tplLcarsRandom"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="lcars"
        data-vis-type="static"
        data-vis-name="Random Numbers"
        data-vis-prev='<div id="prev_tplLcarsRandom" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-draggable-handle " style="font-family: lcars_font; letter-spacing: 1px; font-size: 30px; width: 87px; height: 78px; padding: 0px; margin: 0px" > <div class="vis-widget-prev-body" style="padding: 0px; margin: 0px; color: rgb(255, 153, 0);"> <table style="width:100%"> <tbody><tr><td>592</td><td>248</td><td></td></tr><tr><td>653</td><td>211</td><td></td></tr></tbody></table> </div>  </div></div>'
        data-vis-attrs="rows[6];cols[4];speed[1000];lcars_color[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="font-family: lcars_font; letter-spacing: 1px; font-size: 30px; width: 260px; height: 32px;padding:0;margin:0" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="padding:0;margin:0;color: <%= vis.binds.lcars.color(this.data.attr('lcars_color')) %>">
            <table style="width:100%">

            </table>
        </div>
        <div <%= (el) -> vis.binds.lcars.random(el, data.attr('rows'), data.attr('cols'), data.attr('speed'), data.attr('wid')) %>></div>
    </div>
</script>

<script id="tplLcarsWarpcoreFix"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="lcars"
        data-vis-type="static"
        data-vis-name="Warpcore"
        data-vis-prev='<img src="widgets/lcars/img/Prev_Warpcore.png"></img>'
        data-vis-attrs="speed[500]/slider,20,800,1"
        >
    <div class="vis-widget vis-lcars <%== this.data.attr('class') %>" style="width: 114px; height: 317px;padding:0;margin:0" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="padding:0;margin:0">
            <div style="width:100%;height:100%;background-image: url('widgets/lcars/img/warpcore.png')"></div>
            <div <%= (el) -> vis.binds.lcars.warpcore(el, data.attr('speed'), data.attr('wid')) %>></div>
        </div>
    </div>
</script>

<script id="tplLcarsWarpcore"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="lcars"
        data-vis-type="val"
        data-vis-name="Warpcore"
        data-vis-prev='<img src="widgets/lcars/img/Prev_Warpcore.png"></img>'
        data-vis-attrs="oid;min[0];max[1]"
        >
    <div class="vis-widget vis-lcars <%== this.data.attr('class') %>" style="width: 114px; height: 317px;padding:0;margin:0" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="padding:0;margin:0">
            <div style="width:100%; height:100%; background-repeat: no-repeat; background-image: url('widgets/lcars/img/warpcore.png')"></div>
            <div <%= (el) -> vis.binds.lcars.warpcoreVal(el, data.attr('oid'), data.attr('min'), data.attr('max'), data.attr('wid')) %>></div>
        </div>
    </div>
</script>

<script id="tplLcarsButton"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="lcars"
        data-vis-type="ctrl"
        data-vis-name="Button State"
        data-vis-prev='<div id="prev_tplLcarsButton" style="text-align: initial;padding: 4px"><div class="vis-widget_prev vis-lcars ui-draggable-handle " style="width: 132px; height: 46px; position: absolute;"> <div class="vis-widget-prev-body"> <span class="button RR L" style="width: 70px; background-color: rgb(255, 153, 0);"><span style="">state</span></span> </div> </div></div>'
        data-vis-attrs="oid;value;title;rounded[both]/select,both,left,right,none;color_default[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white;color_active[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white;"
        data-vis-attrs0="group.subtitle;subtitle[state];subtitle_show/select,none,left,right;subtitle_color/nselect,,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white"
        >
    <div class="vis-widget vis-lcars <%== this.data.attr('class') %>" style="width: 150px; height: 45px" id="<%= this.data.attr('wid') %>"  data-oid="<%= this.data.attr('oid') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.basic.state(el) %> >
        <div class="vis-widget-body">
            <span class="vis-widget-lcars-span" style="width: calc(100% - 50px)" <%= (el) -> vis.binds.lcars.button(this.data.wid, this.view, el, {rounded: data.attr('rounded'), blank: data.attr('blank'), extended: true, color: data.attr('color_default'), subTitle: {direction: data.attr('subtitle_show'), text: data.attr('subtitle'), color: data.attr('subtitle_color')}, length: data.attr('width')}, data.attr('oid'), data.attr('value'), data.attr('color_active'), this.data.attr('title')) %>><span class="_title"></span></span>
        </div>
    </div>
</script>

<script id="tplLcarsButtonInc"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="lcars"
        data-vis-type="ctrl"
        data-vis-name="Button Increment"
        data-vis-prev='<div id="prev_tplLcarsButtonInc" style="text-align: initial;padding: 4px"><div class="vis-widget_prev vis-lcars" style="width: 132px; height: 46px; position: absolute;"> <div class="vis-widget-prev-body"> <span class="button RR L" style="width: 70px; background-color: rgb(255, 153, 0);"><span>increment</span></span> </div> </div></div>'
        data-vis-attrs="oid;step[1];minmax[100];repeat_delay[800];repeat_interval[800];title;rounded/select,both,left,right,none;"
        data-vis-attrs0="color_default[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white;color_active[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white;"
        data-vis-attrs1="group.subtitle;subtitle[increment];subtitle_show/select,none,left,right;subtitle_color/nselect,,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white"
        >
    <div class="vis-widget vis-lcars <%== this.data.attr('class') %>" style="width: 150px; height: 45px" id="<%= this.data.attr('wid') %>" data-vis-step="<%= this.data.attr('step') %>" data-oid="<%= this.data.attr('oid') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.basic.increment(el, data.attr('minmax'), data.attr('repeat_delay'), data.attr('repeat_interval')) %>>
        <div class="vis-widget-body">
            <span class="vis-widget-lcars-span" style="width: calc(100% - 50px)" <%= (el) -> vis.binds.lcars.button(this.data.wid, this.view, el, {rounded: data.attr('rounded'), blank: data.attr('blank'), extended: true, color: data.attr('color_default'), subTitle: {direction: data.attr('subtitle_show'), text: data.attr('subtitle'), color: data.attr('subtitle_color')}}, data.attr('oid'), data.attr('minmax'), data.attr('color_active'), this.data.attr('title')) %>><span class="_title"></span></span>
        </div>
    </div>
</script>

<script id="tplLcarsButtonToggle"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="lcars"
        data-vis-type="ctrl"
        data-vis-name="Button Toggle"
        data-vis-prev='<div id="prev_tplLcarsButtonToggle" style="position: relative; text-align: initial;padding: 4px"><div class="vis-widget_prev vis-lcars" style="width: 132px; height: 46px;"> <div class="vis-widget-prev-body"> <span class="button RR L" style="width: 70px; background-color: rgb(255, 153, 0);"><span>toggle</span></span> </div> </div></div>'
        data-vis-attrs="oid;title;rounded/select,both,left,right,none;color_default[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white;color_active[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white;"
        data-vis-attrs0="group.subtitle;subtitle[toggle];subtitle_show/select,none,left,right;subtitle_color/nselect,,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white"
        >
    <div class="vis-widget vis-lcars <%== this.data.attr('class') %>" style="width: 150px; height: 45px" id="<%= this.data.attr('wid') %>" data-vis-step="<%= this.data.attr('step') %>" data-oid="<%= this.data.attr('oid') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.basic.toggle(el) %>>
        <div class="vis-widget-body">
            <span class="vis-widget-lcars-span" style="width: calc(100% - 50px)" <%= (el) -> vis.binds.lcars.button(this.data.wid, this.view, el, {rounded: data.attr('rounded'), blank: data.attr('blank'), extended: true, color: data.attr('color_default'), subTitle: {direction: data.attr('subtitle_show'), text: data.attr('subtitle'), color:data.attr('subtitle_color')}}, data.attr('oid'), 1, data.attr('color_active'), this.data.attr('title')) %>><span class="_title"></span></span>
        </div>
    </div>
</script>

<script id="tplLcarsButtonVal"
    type="text/ejs"
    class="vis-tpl"
    data-vis-set="lcars"
    data-vis-type="ctrl,val"
    data-vis-name="Button State"
    data-vis-prev='<div id="prev_tplLcarsButtonVal" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-lcars" style="width: 132px; height: 50px"> <div class="vis-widget-prev-body"> <span class="button RR L" style="width: 80px; background-color: rgb(255, 153, 0);"><span class="B_titleL _subtitle" style="color:#cc99cc">25.0</span><span class="_title">state</span></span> </div> </div></div>'
    data-vis-attrs="oid;value;title;rounded[both]/select,both,left,right,none;color_default[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white;color_active[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white;"
    data-vis-attrs0="color_default[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white;"
    data-vis-attrs1="color_active[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white;"
    data-vis-attrs2="rounded/select,both,left,right,none;"
    data-vis-attrs3="group.title;title_oid[(state)]/id;title_prepend;title_append_singular;title_append_plural;title_digits;"
    data-vis-attrs4="group.subtitle;subtitle_oid[(25.0)]/id;subtitle_prepend;subtitle_append_singular;subtitle_append_plural;subtitle_digits;subtitle_show[left]/select,none,left,right;subtitle_color/nselect,,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white"
    >
    <div class="vis-widget vis-lcars <%== this.data.attr('class') %>" style="width: 150px; height: 45px;" id="<%= this.data.attr('wid') %>"  data-oid="<%= this.data.attr('oid') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.basic.state(el) %> >
        <div class="vis-widget-body">
            <span class="vis-widget-lcars-span" style="width: calc(100% - 50px)" <%= (el) -> vis.binds.lcars.button(this.data.wid, this.view, el, {rounded: data.attr('rounded'), blank: data.attr('blank'), extended:true, color: data.attr('color_default'), subTitle: {direction: data.attr('subtitle_show'), text: data.attr('subtitle'), color: data.attr('subtitle_color')}}, data.attr('oid'), data.attr('value'), data.attr('color_active'), {oid: data.attr('title_oid'), prepend: data.attr('title_prepend'), append_singular: data.attr('title_append_singular'),append_plural: data.attr('title_append_plural'), digits: data.attr('title_digits')}, {oid: data.attr('subtitle_oid'), prepend: data.attr('subtitle_prepend'), append_singular: data.attr('subtitle_append_singular'), append_plural: data.attr('subtitle_append_plural'), digits: data.attr('subtitle_digits')}) %>><span class="_title"></span></span>
        </div>
    </div>
</script>

<script id="tplLcarsButtonIncVal" 
    type="text/ejs"
    class="vis-tpl"
    data-vis-set="lcars"
    data-vis-type="ctrl,val"
    data-vis-name="Button Increment"
    data-vis-prev='<div id="tplLcarsButtonIncVal" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-lcars" style="width: 132px; height: 50px"> <div class="vis-widget-prev-body"> <span class="button RR L" style="width: 80px; background-color: rgb(255, 153, 0);"><span class="B_titleL _subtitle" style="color:#cc99cc">25.0</span><span class="_title">inc</span></span> </div> </div></div>'
    data-vis-attrs="oid;step[1];minmax[100];repeat_delay[800];repeat_interval[800];"
    data-vis-attrs0="color_default[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white;"
    data-vis-attrs1="color_active[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white;"
    data-vis-attrs2="rounded/select,both,left,right,none;"
    data-vis-attrs3="group.title;title_oid[(inc)]/id;title_prepend;title_append_singular;title_append_plural;title_digits;"
    data-vis-attrs4="group.subtitle;subtitle_oid[(25.0)]/id;subtitle_prepend;subtitle_append_singular;subtitle_append_plural;subtitle_digits;subtitle_show[left]/select,none,left,right;subtitle_color/nselect,,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white"
    >
    <div class="vis-widget vis-lcars <%== this.data.attr('class') %>" style="width: 150px; height: 45px;" id="<%= this.data.attr('wid') %>" data-vis-step="<%= this.data.attr('step') %>" data-oid="<%= this.data.attr('oid') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.basic.increment(el, data.attr('minmax'), data.attr('repeat_delay'), data.attr('repeat_interval')) %>>
        <div class="vis-widget-body">
            <span class="vis-widget-lcars-span" style="width: calc(100% - 50px)" <%= (el) -> vis.binds.lcars.button(this.data.wid, this.view, el, {rounded: data.attr('rounded'),blank:data.attr('blank'),extended:true,color:data.attr('color_default'),subTitle:{direction:data.attr('subtitle_show'),text:data.attr('subtitle'), color: data.attr('subtitle_color')}}, data.attr('oid'), data.attr('minmax'), data.attr('color_active'), {oid: data.attr('title_oid'), prepend: data.attr('title_prepend'), append_singular: data.attr('title_append_singular'),append_plural: data.attr('title_append_plural'), digits: data.attr('title_digits')}, {oid: data.attr('subtitle_oid'), prepend: data.attr('subtitle_prepend'), append_singular: data.attr('subtitle_append_singular'), append_plural: data.attr('subtitle_append_plural'), digits: data.attr('subtitle_digits')}) %>><span class="_title"></span></span>
        </div>
    </div>
</script>

<script id="tplLcarsButtonToggleVal"
    type="text/ejs"
    class="vis-tpl"
    data-vis-set="lcars"
    data-vis-type="ctrl,val"
    data-vis-name="Button Toggle"
    data-vis-prev='<div id="tplLcarsButtonToggleVal" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-lcars" style="width: 132px; height: 50px"> <div class="vis-widget-prev-body"> <span class="button RR L" style="width: 80px; background-color: rgb(255, 153, 0);"><span class="B_titleL _subtitle" style="color:#cc99cc">0</span><span class="_title">toggle</span></span> </div> </div></div>'
    data-vis-attrs="oid;"
    data-vis-attrs0="color_default[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white;"
    data-vis-attrs1="color_active[orange]/nselect,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white;"
    data-vis-attrs2="rounded/select,both,left,right,none;"
    data-vis-attrs3="group.title;title_oid[(toggle)]/id;title_prepend;title_append_singular;title_append_plural;title_digits;"
    data-vis-attrs4="group.subtitle;subtitle_oid[(0)]/id;subtitle_prepend;subtitle_append_singular;subtitle_append_plural;subtitle_digits;subtitle_show[left]/select,none,left,right;subtitle_color/nselect,,orange,purple,blue,lightBlue,red,lightRed,tan,lightTan,pink,white"
    >
    <div class="vis-widget vis-lcars <%== this.data.attr('class') %>" style="width: 150px; height: 45px;;" id="<%= this.data.attr('wid') %>" data-vis-step="<%= this.data.attr('step') %>" data-oid="<%= this.data.attr('oid') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.basic.toggle(el) %>>
        <div class="vis-widget-body">
            <span class="vis-widget-lcars-span" style="width: calc(100% - 50px)" <%= (el) -> vis.binds.lcars.button(this.data.wid, this.view, el, {rounded: data.attr('rounded'), blank: data.attr('blank'), extended: true, color: data.attr('color_default'), subTitle: {direction: data.attr('subtitle_show'), text: data.attr('subtitle'), color: data.attr('subtitle_color')}}, data.attr('oid'), 1, data.attr('color_active'), {oid: data.attr('title_oid'), prepend: data.attr('title_prepend'), append_singular: data.attr('title_append_singular'), append_plural: data.attr('title_append_plural'), digits: data.attr('title_digits')}, {oid: data.attr('subtitle_oid'), prepend: data.attr('subtitle_prepend'), append_singular: data.attr('subtitle_append_singular'), append_plural: data.attr('subtitle_append_plural'), digits: data.attr('subtitle_digits')}) %>><span class="_title"></span></span>
        </div>
    </div>
</script>

<!-- --------------lcars.html--- END -->
<!-- --------------map.html--- START -->
<!--
    ioBroker.vis map widgets

    version: "1.0.3"

    Copyright 2016-2020 bluefox<dogafox@gmail.com>

-->
<script type="text/javascript">
    'use strict';
    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {
            "Get the Google API Key": {                      "en": "Get the Google API Key",                          "de": "Google API Schlüssel Bekommen",                   "ru": "Получить Google API ключ",                        "pt": "Obter a chave da API do Google",                  "nl": "Download de Google API Key",                      "fr": "Obtenir la clé de l'API Google",                  "it": "Ottieni la chiave dell'API di Google",            "es": "Obtener la clave API de Google",                  "pl": "Uzyskaj klucz Google API"},
            "Google Map API key:": {                         "en": "Google Map API key:",                             "de": "Google Map API Schlüssel:",                       "ru": "Google Map API ключ",                             "pt": "Tecla Google Map API:",                           "nl": "Google Map API-sleutel:",                         "fr": "Clé de l'API Google Map:",                        "it": "Chiave API Mappa Google:",                        "es": "Clave de la API de Google Map:",                  "pl": "Klucz API Map Google:"},
            "HYBRID": {                                      "en": "Hybrid",                                          "de": "Hybrid",                                          "ru": "Гибридная",                                       "pt": "Híbrido",                                         "nl": "Hybride",                                         "fr": "Hybride",                                         "it": "Ibrido",                                          "es": "Híbrido",                                         "pl": "Hybrydowy"},
            "Maps Widgets settings": {                       "en": "High quality Widgets settings",                   "de": "High quality Widgets Einstellungen",              "ru": "Настройки High quality Widgets",                  "pt": "Configurações de Widgets de alta qualidade",      "nl": "Hoge kwaliteit Widgets-instellingen",             "fr": "Paramètres Widgets de haute qualité",             "it": "Impostazioni widget di alta qualità",             "es": "Ajustes de widgets de alta calidad",              "pl": "Wysokiej jakości ustawienia widgetów"},
            "No API key": {                                  "en": "No API key",                                      "de": "Kein API Schlüssel",                              "ru": "Нет API ключа",                                   "pt": "Nenhuma chave da API",                            "nl": "Geen API-sleutel",                                "fr": "Aucune clé API",                                  "it": "Nessuna chiave API",                              "es": "Sin clave de API",                                "pl": "Brak klucza API"},
            "ROADMAP": {                                     "en": "Roadmap",                                         "de": "Straßenkarte ",                                   "ru": "Дороги",                                          "pt": "Roteiro",                                         "nl": "roadmap",                                         "fr": "Feuille de route",                                "it": "Roadmap",                                         "es": "Mapa vial",                                       "pl": "Mapa drogowa"},
            "SATELLITE": {                                   "en": "Satellite",                                       "de": "Satellit",                                        "ru": "Спутник",                                         "pt": "Satélite",                                        "nl": "Satelliet",                                       "fr": "Satellite",                                       "it": "Satellitare",                                     "es": "Satélite",                                        "pl": "Satelita"},
            "TERRAIN": {                                     "en": "Terrain",                                         "de": "Gelände",                                         "ru": "Местность",                                       "pt": "Terreno",                                         "nl": "Terrein",                                         "fr": "Terrain",                                         "it": "Terreno",                                         "es": "Terreno",                                         "pl": "Teren"},
            "apiKey": {                                      "en": "Google API Key",                                  "de": "Google API Schlüssel",                            "ru": "Google API ключ",                                 "pt": "Chave da API do Google",                          "nl": "Google API Key",                                  "fr": "Clé de l'API Google",                             "it": "Chiave API di Google",                            "es": "Clave de API de Google",                          "pl": "Klucz Google API"},
            "apiKey_tooltip": {                              "en": "Just write one space to get API from settings",   "de": "Einfach Leerzeihen eingeben um die Einstellungen aus dem Adapter zu übernehmen", "ru": "Просто введите пробел, что бы перенять ключ из настроек драйвера", "pt": "Basta escrever um espaço para obter API das configurações", "nl": "Schrijf gewoon een spatie om API uit instellingen te halen", "fr": "Il suffit d'écrire un espace pour obtenir l'API des paramètres", "it": "Basta scrivere uno spazio per ottenere API dalle impostazioni", "es": "Solo escribe un espacio para obtener la API de la configuración", "pl": "Wystarczy napisać jedną spację, aby pobrać interfejs API z ustawień"},
            "group_markers": {                               "en": "Markers",                                         "de": "Markers",                                         "ru": "Маркеры",                                         "pt": "Marcadores",                                      "nl": "markers",                                         "fr": "Marqueurs",                                       "it": "marcatori",                                       "es": "Marcadores",                                      "pl": "Markery"},
            "hideControls": {                                "en": "Hide controls",                                   "de": "Keine Bedienelemente",                            "ru": "Скрыть управление",                               "pt": "Ocultar controles",                               "nl": "Verberg besturingselementen",                     "fr": "Masquer les contrôles",                           "it": "Nascondi i controlli",                            "es": "Ocultar controles",                               "pl": "Ukryj formanty"},
            "mCount": {                                      "en": "Number of markers",                               "de": "Anzahl Markers",                                  "ru": "Количество маркеров",                             "pt": "Número de marcadores",                            "nl": "Aantal markeringen",                              "fr": "Nombre de marqueurs",                             "it": "Numero di marcatori",                             "es": "Cantidad de marcadores",                          "pl": "Liczba markerów"},
            "map": {                                         "en": "map",                                             "de": "Karte",                                           "ru": "карта",                                           "pt": "mapa",                                            "nl": "kaart",                                           "fr": "carte",                                           "it": "carta geografica",                                "es": "mapa",                                            "pl": "mapa"},
            "mapTypeId": {                                   "en": "Map type",                                        "de": "Kertentyp",                                       "ru": "Тип карты",                                       "pt": "Tipo de mapa",                                    "nl": "Kaartsoort",                                      "fr": "Type de carte",                                   "it": "Tipo di mappa",                                   "es": "Tipo de mapa",                                    "pl": "Typ mapy"},
            "markersHeight": {                               "en": "Height",                                          "de": "Höche",                                           "ru": "Высота",                                          "pt": "Altura",                                          "nl": "Hoogte",                                          "fr": "la taille",                                       "it": "Altezza",                                         "es": "Altura",                                          "pl": "Wysokość"},
            "markersImage": {                                "en": "Icon URL",                                        "de": "Bild URL",                                        "ru": "URL картинки",                                    "pt": "URL do ícone",                                    "nl": "Pictogram URL",                                   "fr": "URL de l'icône",                                  "it": "Icona URL",                                       "es": "Ícono URL",                                       "pl": "URL ikony"},
            "markersLabel": {                                "en": "Letter",                                          "de": "Buchstabe",                                       "ru": "Буква или число",                                 "pt": "Carta",                                           "nl": "Brief",                                           "fr": "Lettre",                                          "it": "Lettera",                                         "es": "Carta",                                           "pl": "List"},
            "markersLabel_tooltip": {                        "en": "Only first letter or digit",                      "de": "Nur ein Symbol",                                  "ru": "Только один символ",                              "pt": "Apenas a primeira letra ou dígito",               "nl": "Alleen eerste letter of cijfer",                  "fr": "Seulement la première lettre ou le chiffre",      "it": "Solo prima lettera o cifra",                      "es": "Solo la primera letra o dígito",                  "pl": "Tylko pierwsza litera lub cyfra"},
            "markersLat-oid": {                              "en": "Latitude ID",                                     "de": "Breitengrad ID",                                  "ru": "ID широты",                                       "pt": "Identificação da Latitude",                       "nl": "Latitude ID",                                     "fr": "Latitude ID",                                     "it": "Latitude ID",                                     "es": "Latitud ID",                                      "pl": "Identyfikator Latitude"},
            "markersLon-oid": {                              "en": "Longitude ID",                                    "de": "Längengrad ID",                                   "ru": "ID долготы",                                      "pt": "ID de Longitude",                                 "nl": "Lengtegraad-ID",                                  "fr": "Longitude ID",                                    "it": "ID longitudine",                                  "es": "ID de longitud",                                  "pl": "ID długości"},
            "markersOffsetX": {                              "en": "Offset X",                                        "de": "Offset X",                                        "ru": "Сдвиг по X",                                      "pt": "Offset X",                                        "nl": "Offset X",                                        "fr": "Décalage X",                                      "it": "Offset X",                                        "es": "Desplazamiento X",                                "pl": "Przesunięcie X"},
            "markersOffsetY": {                              "en": "Offset Y",                                        "de": "Offset Y",                                        "ru": "Сдвиг по Y",                                      "pt": "Offset Y",                                        "nl": "Offset Y",                                        "fr": "Offset Y",                                        "it": "Offset Y",                                        "es": "Desplazamiento Y",                                "pl": "Przesunięcie Y"},
            "markersOpacity": {                              "en": "Opacity",                                         "de": "Durchsichtigkeit",                                "ru": "Прозрачность",                                    "pt": "Opacidade",                                       "nl": "ondoorzichtigheid",                               "fr": "Opacité",                                         "it": "Opacità",                                         "es": "Opacidad",                                        "pl": "Nieprzezroczystość"},
            "markersSwap": {                                 "en": "Swap Latitude and Longitude",                     "de": "Tausche Längengrad mit Breitengrad",              "ru": "Поменять местами широту и долготу",               "pt": "Trocar Latitude e Longitude",                     "nl": "Swap Latitude and Longitude",                     "fr": "Échanger la latitude et la longitude",            "it": "Scambia latitudine e longitudine",                "es": "Intercambiar latitud y longitud",                 "pl": "Zamień szerokość i długość geograficzną"},
            "markersText": {                                 "en": "Tooltip",                                         "de": "Tooltip",                                         "ru": "Подсказка",                                       "pt": "Tooltip",                                         "nl": "tooltip",                                         "fr": "Info-bulle",                                      "it": "tooltip",                                         "es": "Información sobre herramientas",                  "pl": "Etykietka"},
            "markersWidth": {                                "en": "Width",                                           "de": "Breite",                                          "ru": "Ширина",                                          "pt": "Largura",                                         "nl": "Breedte",                                         "fr": "Largeur",                                         "it": "Larghezza",                                       "es": "Anchura",                                         "pl": "Szerokość"},
            "markersView": {                                 "en": "View",                                            "de": "View",                                            "ru": "Страница",                                        "pt": "View",                                            "nl": "View",                                            "fr": "View",                                            "it": "View",                                            "es": "View",                                            "pl": "View"},
            "markersUrl": {                                  "en": "URL",                                             "de": "URL",                                             "ru": "URL",                                             "pt": "URL",                                             "nl": "URL",                                             "fr": "URL",                                             "it": "URL",                                             "es": "URL",                                             "pl": "URL"},
            "maxZoom": {                                     "en": "Max zoom level",                                  "de": "Max Zoom",                                        "ru": "Уровень зума",                                    "pt": "Nível de zoom máximo",                            "nl": "Max zoomniveau",                                  "fr": "Niveau de zoom maximum",                          "it": "Max livello di zoom",                             "es": "Nivel de zoom máximo",                            "pl": "Maksymalny poziom zbliżenia"},
            "noZoomAndPan": {                                "en": "No zoom",                                         "de": "Kein Zoom",                                       "ru": "Без зума",                                        "pt": "Sem zoom",                                        "nl": "Niet zoomen",                                     "fr": "Pas de zoom",                                     "it": "Nessun zoom",                                     "es": "Sin zoom",                                        "pl": "Bez powiększenia"},
            "showTraffic": {                                 "en": "Show traffic",                                    "de": "Verkehrsinformation",                             "ru": "Загруженность дорог",                             "pt": "Mostrar tráfego",                                 "nl": "Toon verkeer",                                    "fr": "Afficher le trafic",                              "it": "Mostra traffico",                                 "es": "Mostrar tráfico",                                 "pl": "Pokaż ruch"}
        });
    }

    vis.binds.map = {
        version: "1.0.3",
        showVersion: function () {
            if (vis.binds.map.version) {
                console.log('Version vis-map: ' + vis.binds.map.version);
                vis.binds.map.version = null;
            }
        },
        updateWidgets: [],
        updateIntervalTimer: null,
        isLonLatIsOID: function (value) {
            if (typeof value !== 'string') return false;
            if (!value) return false;
            if (value[0] === '-') return false;
            if (value[0] >= '0' && value[0] <= '9') return false;
            return true;
        },
        osm: {
            loaded: false,
            fromProjection: null,
            toProjection: null,
            getMarkers: function (markers) {
                var result = new OpenLayers.Layer.Markers('Markers');
                var list = [];

                for (var m = 0; m < markers.length; m++) {
                    var width  = parseFloat(markers[m].width  || 25);
                    var height = parseFloat(markers[m].height || 25);
                    var size   = new OpenLayers.Size(width, height);
                    var url    = markers[m].image || 'widgets/map/img/pin.png';
                    var opacity = (markers[m].opacity === '' || markers[m].opacity === null || markers[m].opacity === undefined) ? 1 : parseFloat(markers[m].opacity);
                    var offsetX = (markers[m].offsetX === '' || markers[m].offsetX === null || markers[m].offsetX === undefined) ? -(size.w/2) : (-1) * parseFloat(markers[m].offsetX);
                    var offsetY = (markers[m].offsetY === '' || markers[m].offsetY === null || markers[m].offsetY === undefined) ? -size.h : (-1) * parseFloat(markers[m].offsetY);
                    var offset = new OpenLayers.Pixel(offsetX, offsetY);

                    var icon   = new OpenLayers.Icon(url, size, offset);
                    var marker;
                    if (vis.binds.map.isLonLatIsOID(markers[m].lon) && vis.binds.map.isLonLatIsOID(markers[m].lat)) {
                        marker = new OpenLayers.Marker(vis.binds.map.osm.text2position(vis.states[markers[m].lon + '.val'] + ';' + vis.states[markers[m].lat + '.val'], markers[m].swap), icon);
                    } else if (vis.binds.map.isLonLatIsOID(markers[m].lon)) {
                        marker = new OpenLayers.Marker(vis.binds.map.osm.text2position(vis.states[markers[m].lon + '.val'], markers[m].swap), icon);
                    } else {
                        marker = new OpenLayers.Marker(vis.binds.map.osm.text2position(markers[m].lon.toString() + (markers[m].lat ? ';' + markers[m].lat : ''), markers[m].swap), icon);
                    }
                    opacity = parseFloat(opacity);

                    if (opacity === 0) marker.display(opacity !== 0);
                    if (opacity !== 1 && opacity !== 0) marker.setOpacity(opacity);

                    if (markers[m].url || markers[m].view) {
                        (function (mm) {
                            marker.events.register('mousedown', marker.feature, function() {
                                if (markers[mm].view) {
                                    vis.changeView(markers[mm].view, markers[mm].view);
                                } else {
                                    document.location = markers[mm].url;
                                }
                            });
                        })(m);
                    }


                    list.push(marker);
                    result.addMarker(marker);
                }

                return {layer: result, list: list};
            },
            setCenter: function (map, markers, maxZoom) {
                if (markers && markers.markers.length) {
                    var bound = markers.getDataExtent();
                    var zoom = Math.min(map.getZoomForExtent(bound), maxZoom === undefined ? 30 : parseFloat(maxZoom));
                    map.setCenter(bound.getCenterLonLat(), zoom);
                } else {
                    map.setCenter(vis.binds.map.osm.text2position('5.55;6.66'), parseFloat(maxZoom));
                }
            },
            text2position: function (text, isSwap) {
                var parts = (text ||'').toString().split(';');
                if (parts.length < 2) parts = (text ||'').split(',');
                if (parts.length < 2) return null;
                var lon = parseFloat(parts[0].replace(',', '.').trim());
                var lat = parseFloat(parts[1].replace(',', '.').trim());
                if (isSwap) {
                    return new OpenLayers.LonLat(lat, lon).transform(vis.binds.map.osm.fromProjection, vis.binds.map.osm.toProjection);
                } else {
                    return new OpenLayers.LonLat(lon, lat).transform(vis.binds.map.osm.fromProjection, vis.binds.map.osm.toProjection);
                }
            },
            showMap: function (divName, markerList, maxZoom) {
                var map = new OpenLayers.Map(divName);
                var mapnik = new OpenLayers.Layer.OSM();
                // Fix Cross Origin problem on safari
                mapnik.tileOptions.crossOriginKeyword = null;
                map.addLayer(mapnik);

                var oObj = vis.binds.map.osm.getMarkers(markerList);
                map.addLayer(oObj.layer);

                vis.binds.map.osm.setCenter(map, oObj.layer, maxZoom);
                $('.olControlAttribution').hide();
                var $div = $('#' + divName);
                $div.css('border-radius', $div.parent().css('border-radius')).css('overflow', 'hidden');

                return {map: map, markers: oObj.list, layer: oObj.layer};
            },
            update: function ($div) {
                var obj     = $div.data('object');
                var markers = $div.data('markers');
                var zoom    = $div.data('zoom');

                for (var m = 0; m < markers.length; m++) {
                    if (vis.binds.map.isLonLatIsOID(markers[m].lon) && vis.binds.map.isLonLatIsOID(markers[m].lat)) {
                        obj.markers[m].lonlat = vis.binds.map.osm.text2position(vis.states[markers[m].lon + '.val'] + ';' + vis.states[markers[m].lat + '.val'], markers[m].swap);
                        obj.layer.removeMarker(obj.markers[m]);
                        obj.layer.addMarker(obj.markers[m]);
                    } else if (vis.binds.map.isLonLatIsOID(markers[m].lon)) {
                        obj.markers[m].lonlat = vis.binds.map.osm.text2position(vis.states[markers[m].lon + '.val'], markers[m].swap);
                        obj.layer.removeMarker(obj.markers[m]);
                        obj.layer.addMarker(obj.markers[m]);
                    }
                }
                vis.binds.map.osm.setCenter(obj.map, obj.layer, zoom);
            },
            init: function (wid, view, data, style) {
                var $div = $('#' + wid);
                if (!$div.length) {
                    setTimeout(function () {
                        vis.binds.map.osm.init(wid, view, data, style);
                    }, 100);
                    return;
                }

                if (!$('#osm_map').length) {
                    var script = document.createElement('script');
                    if (window.location.protocol === 'file:') {
                        script.src = 'https://cdnjs.cloudflare.com/ajax/libs/openlayers/2.13.1/OpenLayers.js';
                    } else {
                        script.src = '//cdnjs.cloudflare.com/ajax/libs/openlayers/2.13.1/OpenLayers.js';
                    }
                    script.id = 'osm_map';
                    document.head.appendChild(script);
                    $('#osm_map').load(function () {
                        vis.binds.map.osm.loaded = true;
                        vis.binds.map.osm.init(wid, view, data, style);
                    });
                    return;
                } else if (!vis.binds.map.osm.loaded) {
                    $('#osm_map').load(function () {
                        vis.binds.map.osm.init(wid, view, data, style);
                    });
                    return;
                }
                if (!vis.binds.map.osm.fromProjection) vis.binds.map.osm.fromProjection = new OpenLayers.Projection('EPSG:4326');   // Transform from WGS 1984
                if (!vis.binds.map.osm.toProjection)   vis.binds.map.osm.toProjection   = new OpenLayers.Projection('EPSG:900913'); // to Spherical Mercator Projection

                var $map = $div.find('.vis-widget-body');

                var markers = [];

                data.mCount = parseInt(data.mCount, 10) || 1;
                var u;
                for (u = 1; u <= data.mCount; u++) {
                    if (data['markersLon-oid' + u]) {
                        var marker = {
                            lon:        data['markersLon-oid'   + u] || '',
                            lat:        data['markersLat-oid'   + u] || '',
                            image:      data['markersImage'     + u],
                            width:      data['markersWidth'     + u],
                            height:     data['markersHeight'    + u],
                            offsetX:    data['markersOffsetY'   + u],
                            offsetY:    data['markersOffsetX'   + u],
                            opacity:    data['markersOpacity'   + u],
                            text:       data['markersText'      + u] || undefined,
                            label:      data['markersLabel'     + u] || undefined,
                            view:       data['markersView'      + u] || undefined,
                            url:        data['markersUrl'       + u] || undefined,
                            swap:       data['markersSwap'      + u] === true || data['markersSwap'      + u] === 'true'
                        };

                        markers.push(marker);
                    }
                }

                $map.data('object',  vis.binds.map.osm.showMap('map_' + data.wid, markers, parseInt(data.maxZoom, 10) || 20));
                $map.data('markers', markers);
                $map.data('zoom',    parseInt(data.maxZoom, 10) || 20);
                if (data.hideControls) $map.find('.olControlZoom').hide();

                function onChange() {
                    vis.binds.map.osm.update($map);
                }
                var bound = [];

                for (u = 1; u <= data.mCount; u++) {
                    if (vis.binds.map.isLonLatIsOID(data['markersLon-oid' + u])) {
                        vis.states.bind(data['markersLon-oid' + u] + '.val', onChange);
                        bound.push(data['markersLon-oid' + u] + '.val');
                    }
                    if (vis.binds.map.isLonLatIsOID(data['markersLat-oid' + u])) {
                        vis.states.bind(data['markersLat-oid' + u] + '.val', onChange);
                        bound.push(data['markersLat-oid' + u] + '.val');
                    }
                }

                if (bound.length) {
                    // remember all ids, that bound
                    $div.data('bound', bound);
                    // remember bind handler
                    $div.data('bindHandler', onChange);
                }
            }
        },
        googleMap: {
            loaded: false,
            text2position: function (text, isSwap) {
                var parts = (text || '').toString().split(';');
                if (parts.length < 2) parts = (text || '').split(',');
                if (parts.length < 2) return null;
                var lon = parseFloat(parts[0].replace(',', '.').trim());
                var lat = parseFloat(parts[1].replace(',', '.').trim());
                if (isSwap) {
                    return new google.maps.LatLng(lon, lat);
                } else {
                    return new google.maps.LatLng(lat, lon);
                }
            },
            setCenter: function (map, oMarkers, maxZoom) {
                var bounds = new google.maps.LatLngBounds();
                for (var m = 0; m < oMarkers.length; m++) {
                    bounds.extend(oMarkers[m].getPosition());
                }
                if (oMarkers.length > 1) {
                    map.fitBounds(bounds);
                } else if (oMarkers.length) {
                    map.panTo(oMarkers[0].getPosition());
                }

                var listener = google.maps.event.addListener(map, 'idle', function() {
                    if (map.getZoom() > maxZoom) map.setZoom(maxZoom);
                    google.maps.event.removeListener(listener);
                });
            },
            setMarkers: function (map, markers) {
                var result = [];
                for (var m = 0; m < markers.length; m++) {
                    var width  = parseFloat(markers[m].width  || 100);
                    var height = parseFloat(markers[m].height || 25);
                    var opacity = (markers[m].opacity === '' || markers[m].opacity === null || markers[m].opacity === undefined) ? 1 : parseFloat(markers[m].opacity);
                    var offsetX = (markers[m].offsetX === '' || markers[m].offsetX === null || markers[m].offsetX === undefined) ? null : parseFloat(markers[m].offsetX);
                    var offsetY = (markers[m].offsetY === '' || markers[m].offsetY === null || markers[m].offsetY === undefined) ? null : parseFloat(markers[m].offsetY);

                    var image = markers[m].image ? {
                        url: 		markers[m].image.indexOf('/') === -1 ? '//maps.gstatic.com/mapfiles/markers2/' + markers[m].image : markers[m].image,
                        origin:     new google.maps.Point(0, 0),
                        scaledSize: new google.maps.Size(width, height) // scaled size

                    } : undefined;

                    if (image && offsetX !== null && offsetY !== null) image.anchor = new google.maps.Point(offsetY, offsetX);

                    var position;

                    if (vis.binds.map.isLonLatIsOID(markers[m].lon) && vis.binds.map.isLonLatIsOID(markers[m].lat)) {
                        position = vis.binds.map.googleMap.text2position(vis.states[markers[m].lon + '.val'] + ';' + vis.states[markers[m].lat + '.val'], markers[m].swap);
                    } else if (vis.binds.map.isLonLatIsOID(markers[m].lon)) {
                        position = vis.binds.map.googleMap.text2position(vis.states[markers[m].lon + '.val'], markers[m].swap);
                    } else {
                        position = vis.binds.map.googleMap.text2position(markers[m].lon.toString() + (markers[m].lat ? ';' + markers[m].lat : ''), markers[m].swap);
                    }
                    var marker = new google.maps.Marker({
                        position:   position,
                        icon: 		image,
                        label: 		markers[m].label || undefined,
                        map:        map,
                        title:      markers[m].text || undefined
                    });
                    if (opacity !== 1) {
                        marker.setOpacity(opacity);
                    }

                    if (markers[m].url || markers[m].view) {
                        (function (mm) {
                            marker.addListener('click', function() {
                                if (markers[mm].view) {
                                    vis.changeView(markers[mm].view, markers[mm].view);
                                } else {
                                    document.location = markers[mm].url;
                                }
                            });
                        })(m);
                    }
                    result.push(marker);
                }
                return result;
            },
            showMap: function (divElem, markerList, maxZoom, options) {
                options = options || {};
                options.mapTypeId = options.mapTypeId || google.maps.MapTypeId.ROADMAP;

                var map = new google.maps.Map(divElem, {
                    zoom: 			        maxZoom,
                    center: 		        new google.maps.LatLng(52.52, 13.41),
                    mapTypeId: 	            options.mapTypeId,
                    disableDefaultUI:       !!options.hideControls,
                    scrollwheel:            !options.noZoomAndPan,
                    disableDoubleClickZoom: !!options.noZoomAndPan,
                    panControl:             !options.noZoomAndPan
                });

                var $div = $(divElem);
                $div.css('border-radius', $div.parent().css('border-radius'));


                var markers = vis.binds.map.googleMap.setMarkers(map, markerList);
                vis.binds.map.googleMap.setCenter(map, markers, maxZoom);

                if (options.showTraffic) {
                    var trafficLayer = new google.maps.TrafficLayer();
                    trafficLayer.setMap(map);
                }
                return {map: map, markers: markers};
            },
            update: function ($div) {
                var obj     = $div.data('object');
                var markers = $div.data('markers');
                var maxZoom = $div.data('zoom');

                for (var m = 0; m < markers.length; m++) {
                    if (vis.binds.map.isLonLatIsOID(markers[m].lon) && vis.binds.map.isLonLatIsOID(markers[m].lat)) {
                        obj.markers[m].setPosition(vis.binds.map.googleMap.text2position(vis.states[markers[m].lon + '.val'] + ';' + vis.states[markers[m].lat + '.val'], markers[m].swap));
                    } else if (vis.binds.map.isLonLatIsOID(markers[m].lon)) {
                        obj.markers[m].setPosition(vis.binds.map.googleMap.text2position(vis.states[markers[m].lon + '.val'], markers[m].swap));
                    }
                }

                vis.binds.map.googleMap.setCenter(obj.map, obj.markers, maxZoom);
            },
            init: function (wid, view, data, style) {
                var $div = $('#' + wid);
                if (!$div.length) {
                    setTimeout(function () {
                        vis.binds.map.googleMap.init(wid, view, data, style);
                    }, 100);
                    return;
                }
                var $map = $div.find('.vis-widget-body');
                if (!data.apiKey) {
                    $map.append(_('No API key'));
                    return;
                }

                if (!$('#google_map').length) {
                    var script = document.createElement('script');
                    script.src = 'https://maps.googleapis.com/maps/api/js?key=' + data.apiKey + '&signed_in=false';
                    script.id = 'google_map';
                    document.head.appendChild(script);
                    $('#google_map').load(function () {
                        vis.binds.map.googleMap.loaded = true;
                        vis.binds.map.googleMap.init(wid, view, data, style);
                    });
                    return;
                } else if (!vis.binds.map.googleMap.loaded) {
                    $('#google_map').load(function () {
                        vis.binds.map.googleMap.init(wid, view, data, style);
                    });
                    return;
                }

                var options = {
                    mapTypeId:      google.maps.MapTypeId[data.mapTypeId || 'ROADMAP'],
                    hideControls:   data.hideControls || false,
                    noZoomAndPan:   data.noZoomAndPan || false,
                    showTraffic:    data.showTraffic === 'true' || data.showTraffic === true
                };
                var markers = [];

                for (var u = 1; u <= data.mCount; u++) {
                    if (data['markersLon-oid' + u]) {
                        var marker = {
                            lon:        data['markersLon-oid'   + u] || '',
                            lat:        data['markersLat-oid'   + u] || '',
                            image:      data['markersImage'     + u],
                            width:      data['markersWidth'     + u],
                            height:     data['markersHeight'    + u],
                            offsetX:    data['markersOffsetY'   + u],
                            offsetY:    data['markersOffsetX'   + u],
                            opacity:    data['markersOpacity'   + u],
                            text:       data['markersText'      + u] || undefined,
                            label:      data['markersLabel'     + u] || undefined,
                            view:       data['markersView'      + u] || undefined,
                            url:        data['markersUrl'       + u] || undefined,
                            swap:       data['markersSwap'      + u] === true || data['markersSwap'      + u] === 'true'
                        };
                        markers.push(marker);
                    }
                }

                $map.data('markers', markers);
                $map.data('zoom',    parseInt(data.maxZoom, 10) || 20);
                $map.data('object', vis.binds.map.googleMap.showMap($map[0], markers, parseInt(data.maxZoom, 10) || 20, options));

                function onChange() {
                    vis.binds.map.googleMap.update($map);
                }
                var bound = [];
                for (u = 1; u <= data.mCount; u++) {
                    if (vis.binds.map.isLonLatIsOID(data['markersLon-oid' + u])) {
                        vis.states.bind(data['markersLon-oid' + u] + '.val', onChange);
                        bound.push(data['markersLon-oid' + u] + '.val');
                    }
                    if (vis.binds.map.isLonLatIsOID(data['markersLat-oid' + u])) {
                        vis.states.bind(data['markersLat-oid' + u] + '.val', onChange);
                        bound.push(data['markersLat-oid' + u] + '.val');
                    }
                }
                if (bound.length) {
                    // remember all ids, that bound
                    $div.data('bound', bound);
                    // remember bind handler
                    $div.data('bindHandler', onChange);
                }
            }
        }
    };

    if (vis.editMode) {
        // find automatically google map api key
        vis.binds.map.onIdChanged = function (widgetID, view, newId, fields) {
            var changed = [];
            var key = vis.views[view].widgets[widgetID].data.apiKey;
            if (!key.trim()) {
                var obj = vis.objects['system.adapter.vis-map.0'];
                if (obj && obj.native && obj.native.googleApiKey) {
                    vis.views[view].widgets[widgetID].data.apiKey = obj.native.googleApiKey;
                    changed.push('apiKey');
                }
            }
            return changed.length ? changed : null;
        };
    }

    vis.binds.map.showVersion();
</script>
<style>
    a[href^="http://maps.google.com/maps"]{display: none !important}
    a[href^="https://maps.google.com/maps"]{display: none !important}

    .gmnoprint a, .gmnoprint span, .gm-style-cc {
        display: none;
    }
    .gmnoprint div {
        background: none !important;
    }
</style>

<script id="tplOsm"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="map"
        data-vis-name="Open Street Map"
        data-vis-type="map"
        data-vis-update-style="true"
        data-vis-prev='<img src="widgets/map/img/Prev_tplOsm.png"></img>'
        data-vis-attrs="mCount[1]/number,1,20,1;maxZoom[14]/slider,0,18,1;hideControls/checkbox;"
        data-vis-attrs0="group.markers/byindex;markersLon-oid(1-mCount)/id,gps;markersLat-oid(1-mCount)/id,gps;markersSwap(1-mCount)/checkbox;markersImage(1-mCount)/image;markersWidth(1-mCount)/slider,1,100,1;markersHeight(1-mCount)/slider,1,100,1;markersOffsetX(1-mCount)/slider,1,100,1;markersOffsetY(1-mCount)/slider,1,100,1;markersOpacity(1-mCount)/slider,0,1,0.05;markersView(1-mCount)/views;markersUrl(1-mCount)/text;"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow: hidden; width: 200px; height: 200px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" id="map_<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.map.osm.init(this.data.wid, this.view, this.data, this.style) %> style="position: relative;"></div>
    </div>
</script>

<script id="tplGoogleMap"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="map"
        data-vis-name="Google Map"
        data-vis-type="map"
        data-vis-update-style="true"
        data-vis-prev='<img src="widgets/map/img/Prev_tplGoogleMap.png"></img>'
        data-vis-attrs="mCount[1]/number,1,20,1;maxZoom[14]/slider,0,30,1;mapTypeId/select,ROADMAP,SATELLITE,HYBRID,TERRAIN;hideControls/checkbox;noZoomAndPan/checkbox;apiKey//onIdChanged;showTraffic/checkbox;"
        data-vis-attrs0="group.markers/byindex;markersLon-oid(1-mCount)/id,gps;markersLat-oid(1-mCount)/id,gps;markersSwap(1-mCount)/checkbox;markersImage(1-mCount)/image;markersWidth(1-mCount)/slider,1,100,1;markersHeight(1-mCount)/slider,1,100,1;markersOffsetX(1-mCount)/slider,1,100,1;markersOffsetY(1-mCount)/slider,1,100,1;markersText(1-mCount);markersLabel(1-mCount);markersOpacity(1-mCount)/slider,0,1,0.05;markersView(1-mCount)/views;markersUrl(1-mCount)/text;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow: hidden; width: 200px; height: 200px; background-color: none !important" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.map.googleMap.init(this.data.wid, this.view, this.data, this.style) %>></div>
    </div>
</script>

<!-- --------------map.html--- END -->
<!-- --------------material-webfont.html--- START -->
<!--
    ioBroker.vis material-webfont Widget-Set

    version: "0.0.1"

    Copyright 2019 om2804 om2804@mail.ru
-->
<!-- here you can include so many css as you want -->
<link rel="stylesheet" href="widgets/material-webfont/css/materialdesignicons.css" />

<script>
     vis.addFont("Material-Design-Icons");
</script>
<!-- --------------material-webfont.html--- END -->
<!-- --------------material.html--- START -->
<!--
    ioBroker.vis material Widget-Set
    version: "0.1.3"
    Copyright 2018 nisiode<nisio.air@mail.com>
-->

<!-- here you can include so many css as you want -->
<link rel="stylesheet" href="widgets/material/css/material.css" />
<link rel="stylesheet" href="widgets/material/css/style.css" />
<!-- here you can include so many js-files as you want -->
<script type="text/javascript" src="widgets/material/js/material.js"></script>

<script id="tplMaListDoor"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMaListWindow" style="position: relative; text-align: initial;padding: 4px ">
				<div class="vis-widget_prev " style="width: 100px; height: 100px; padding:2px; background-color: #212121" > 
						<img src="widgets/material/img/fts_door.png" style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id;title/text;subtitle/text;"
        data-vis-set="material"
        data-vis-type="val"
        data-vis-name="ListDoor">
    <div class="vis-widget <%== this.data.attr('class') %> md-list" id="<%= this.data.attr('wid') %>" >
		<div class="vis-widget-body" >
			<div class="md-list-icon">
				<img src="widgets/material/img/fts_door.png">
			</div>
			<div class="md-list-desc">
				<div class="md-list-title mdui-title" >
					<%= this.data.attr('title') %>
				</div>
				<div class="md-list-subtitle mdui-subtitle">
					<%= this.data.attr('subtitle') %>
				</div>
			</div>
			<div class="md-list-value mdui-value"></div>
		</div>
	</div>
	<% vis.binds.material.tplMdListDoor(this.data.wid, this.view, this.data);  %>
</script>

<script id="tplMaListWindow"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMaListWindow" style="position: relative; text-align: initial;padding: 4px ">
			<div class="vis-widget_prev " style="width: 100px; height: 100px; padding:2px; background-color: #212121" > 
					<img src="widgets/material/img/fts_window_2w.png" style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id;title/text;subtitle/text;"
        data-vis-set="material"
        data-vis-type="val"
        data-vis-name="ListWindow">
		<div class="vis-widget <%== this.data.attr('class') %> md-list" id="<%= this.data.attr('wid') %>" >
			<div class="vis-widget-body" >
				<div class="md-list-icon">
					<img src="widgets/material/img/fts_window_2w.png">
				</div>
				<div class="md-list-desc">
					<div class="md-list-title mdui-title" >
						<%= this.data.attr('title') %>
					</div>
					<div class="md-list-subtitle mdui-subtitle">
						<%= this.data.attr('subtitle') %>
					</div>
				</div>
				<div class="md-list-value mdui-value"></div>
			</div>
		</div>
		<% vis.binds.material.tplMdListWindow(this.data.wid, this.view, this.data);  %>
</script>

<script id="tplMaListTemp"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMaListTemp" style="position: relative; text-align: initial;padding: 4px ">
				<div class="vis-widget_prev " style="width: 100px; height: 100px; padding:2px; background-color: #212121" > 
					<img src="widgets/material/img/temp_temperature.png" style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id;title/text;subtitle/text;"
        data-vis-set="material"
        data-vis-type="val"
        data-vis-name="ListTemp">
		<div class="vis-widget <%== this.data.attr('class') %> md-list" id="<%= this.data.attr('wid') %>" >
			<div class="vis-widget-body" >
				<div class="md-list-icon">
					<img src="widgets/material/img/temp_temperature.png">
				</div>
				<div class="md-list-desc">
					<div class="md-list-title mdui-title" >
						<%= this.data.attr('title') %>
					</div>
					<div class="md-list-subtitle mdui-subtitle">
						<%= this.data.attr('subtitle') %>
					</div>
				</div>
				<div class="md-list-value mdui-value"></div>
			</div>
		</div>
		<% vis.binds.material.tplMdListTemp(this.data.wid, this.view, this.data);  %>
</script>

<script id="tplMaListLight"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMaListLight" style="position: relative; text-align: initial;padding: 4px ">
				<div class="vis-widget_prev " style="width: 100px; height: 100px; padding:2px; background-color: #212121" > 
					<img src="widgets/material/img/light_light_dim_100.png" style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id;title/text;subtitle/text;"
        data-vis-set="material"
        data-vis-type="val"
        data-vis-name="ListLight">
		<div class="vis-widget <%== this.data.attr('class') %> md-list" id="<%= this.data.attr('wid') %>" >
			<div class="vis-widget-body" >
				<div class="md-list-icon">
					<img src="widgets/material/img/light_light_dim_100.png">
				</div>
				<div class="md-list-desc">
					<div class="md-list-title mdui-title" >
						<%= this.data.attr('title') %>
					</div>
					<div class="md-list-subtitle mdui-subtitle">
						<%= this.data.attr('subtitle') %>
					</div>
				</div>
				<div class="md-list-value" >
					<div class="mdui-switch" >
						<input type="checkbox" name="<%= this.data.attr('wid') %>_checkbox" id="<%= this.data.attr('wid') %>_checkbox" data-oid="<%= this.data.attr('oid') %>" />
						<label for="<%= this.data.attr('wid') %>_checkbox"><label>
					</div>
				</div>
			</div>
		</div>
		<% vis.binds.material.tplMdListLight(this.data.wid, this.view, this.data);  %>
</script>

<script id="tplMaListLightDim"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMaListLightDim" style="position: relative; text-align: initial;padding: 4px ">
				<div class="vis-widget_prev " style="width: 100px; height: 100px; padding:2px; background-color: #212121" > 
					<img src="widgets/material/img/light_light_dim_100.png" style="width: 100px; height: 100px;"></div></div>'
        data-vis-attrs="oid/id;title/text;subtitle/text;"
        data-vis-set="material"
        data-vis-type="val"
        data-vis-name="ListLightDim">
		<div class="vis-widget <%== this.data.attr('class') %> md-list" id="<%= this.data.attr('wid') %>" >
			<div class="vis-widget-body" >
				<div class="md-list-icon">
					<img src="widgets/material/img/light_light_dim_100.png">
				</div>
				<div class="md-list-desc">
					<div class="md-list-title mdui-title" >
						<%= this.data.attr('title') %>
					</div>
					<div class="md-list-subtitle mdui-subtitle">
						<%= this.data.attr('subtitle') %>
					</div>
				</div>
				<div class="md-list-value" >
					<div class="mdui-slider" >
						<div class="sliderJQUI" id="<%= this.data.attr('wid') %>_slider" data-oid="<%= this.data.attr('oid') %>" data-oid2="<%= this.data.attr('oid-2') %>" data-oid-working="<%= this.data.attr('oid-working') %>"  data-oid2-working="<%= this.data.attr('oid-2-working') %>"<%= (el) -> vis.binds.jqueryui.slider(el, {min:0,max:100,step:1,inverted:false}) %> /></div>
					</div>
				</div>
			</div>
		</div>
		<% vis.binds.material.tplMdListLightDim(this.data.wid, this.view, this.data);  %>
</script>
<!-- --------------material.html--- END -->
<!-- --------------materialdesign.html--- START -->
<!--
    ioBroker.vis vis-materialdesign Widget-Set
    
    Copyright 2019 Scrounger scrounger@gmx.net
-->

<!-- Vuetify API container init -->
<v-app id="materialdesign-vuetify-container" data-app="true" />

<!-- CSS: API libs -->
<link rel="stylesheet" href="widgets/materialdesign/lib/fonts/material-icons/material-icons.css" />
<link rel="stylesheet" href="widgets/materialdesign/lib/fonts/material-design-icons/materialdesignicons.min.css" />
<link rel="stylesheet" href="widgets/materialdesign/lib.min.css" />


<!-- CSS: Material Design -->
<link rel="stylesheet" href="widgets/materialdesign/css/widgets.min.css" />

<!-- JS: API libs -->
<script type="text/javascript" src="widgets/materialdesign/lib/raw/moment-with-locales.min.js"></script>
<script type="text/javascript" src="widgets/materialdesign/lib/raw/round-slider.js"></script>
<script type="text/javascript" src="widgets/materialdesign/lib.min.js"></script>

<!-- Sentry integration -->
<script src="widgets/materialdesign/lib/raw/sentry/bundle.min.js" integrity="sha384-wF7Jc4ZlWVxe/L8Ji3hOIBeTgo/HwFuaeEfjGmS3EXAG7Y+7Kjjr91gJpJtr+PAT" crossorigin="anonymous"></script>
<script src="widgets/materialdesign/lib/raw/sentry/captureconsole.min.js"></script>
<script src="widgets/materialdesign/lib/raw/sentry/dedupe.min.js"></script>


<!-- JS: Material Design -->
<script type="text/javascript" src="widgets/materialdesign/js/materialdesign.js"></script>
<script type="text/javascript" src="widgets/materialdesign/js/widgets.min.js"></script>

<!-- the full description of format in data-vis-attrs can be found here:
    https://github.com/ioBroker/ioBroker.vis/blob/master/www/js/visEditInspect.js#L39

    ----------------------------------------------------------
    Mandatory XML attributes:
        id="tplVis-materialdesignWIDGETNAME"
        type="text/ejs"
        class="vis-tpl"

        "type" and "class" are always the same. "id" is unique and must start with "tplSETNAME" and ends with widget name. Use camel-case for it.

    ----------------------------------------------------------
    data-vis-attrs - divided with semicolon the list of attributes, like attr1/id;attr2/color
        Full format of one attribute is: attr_name(start-end)[default_value]/type,idFilter/onChangeFunc
            attr_name - the name of the attribute, e.g. "myID"
            start-end - creates automatically attributes from attr_namestart to attr_nameend, like "myID(1-3)" creates myID1, myID2, myID3
            default_value - by creation of widget this attribute will be filled with this value, e.g. "myID[#001122]/color"
            type - some predefined types have edit helpers, else it will be shown as text field

                Type format:
                      id - Object ID Dialog
                      checkbox
                      image - image
                      number,min,max,step - non-float number. min,max,step are optional
                      color - color picker
                      views - Name of the view
                      effect - jquery UI show/hide effects
                      eff_opt - additional option to effect slide (up, down, left, right)
                      fontName - Font name
                      slider,min,max,step - Default step is ((max - min) / 100)
                      select,value1,value2,... - dropdown select
                      nselect,value1,value2,... - same as select, but without translation of items
                      style,fileFilter,nameFilter,attrFilter
                      custom,functionName,options,... - custom editor - functionName is starting from vis.binds.[widgetset.funct]. E.g. custom/timeAndWeather.editWeather,short
                      group.name - define new or old group. All following attributes belongs to new group till new group.xyz
                      group.name/byindex - like group, but all following attributes will be grouped by ID. Like group.windows/byindex;slide(1-4)/id;slide_type(1-4)/select,open,closed  Following groups will be created Windows1(slide1,slide_type1), Windows2(slide2,slide_type2), Windows3(slide3,slide_type3), Windows4(slide4,slide_type4)
                      text - dialog box with html editor
                      html - dialog box with html editor

                If type is "id", you can define filer for "Select ID Dialog", like "myID/id,level.temperature".
                Additionally you can define callback(onChangeFunc), which will be called if this attribute was changed by user for different purposes: validate entry, fill other attributes, ...

        You can define additional data-vis-attrs line: data-vis-attrs0, data-vis-attrs1. Anyway data-vis-attrs must be there. You may not skip numbers.
        E.g. in "data-vis-attrs="A;" data-vis-attrs1="B" attribute B will be not parsed.

    --------------------------------------------------------
    data-vis-type
        Help information for user. Used for search.
        You can define more than one type divided by comma.
        There are following common types, but you can use your own specific types:
            ctrl   - widget that can write some Object IDs
            val    - widget that shows some information from Object IDs
            static - widget do not read information from Object IDs or URL
            button - button widget
            dimmer - dimmer widget
            weather - weather widget
            ...

    --------------------------------------------------------
    data-vis-set
        Name of the widget set. Must be equal to the name of this HTML file

    --------------------------------------------------------
    data-vis-prev
        Html code used as preview of this widget. If widget is complex you can just use image as preview:
        data-vis-prev='<img src="widgets/hqwidgets/img/prev/Prev_tplVis-materialdesignShowInstance.png"></img>'
        Of course the image must exist.

    --------------------------------------------------------
    data-vis-name
        Readable name of widget shown in vis editor.

    --------------------------------------------------------
    data-vis-beta="true"
        Shows "BETA" symbol in vis editor by preview

    --------------------------------------------------------
    data-vis-update-style="true"
        Call redraw of widget if some of the CSS styles in editor for this widget was changed

    You can read about Magic tags here: http://canjs.com/guides/EJS.html
    Following magic tags are exist:
        <% %> - execute javascript
        <%= %> - place escaped result to HTML document
        <%== %> - place unescaped result to HTML document

    You can do "if" conditions and "for" cycles.

-->

<script id="tplVis-materialdesign-Button-Navigation-vertical"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_button_navigation_vertical.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="navigation"
        data-vis-name="Button Navigation vertical"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,buttons;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;buttonStyle[raised]/select,text,raised,unelevated,outlined;nav_view;buttontext/html;colorPress/color;vibrateOnMobilDevices[50]/number;"
        data-vis-attrs0="group.icon;image/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageColor/color;iconPosition[top]/select,top,bottom;iconHeight/slider,0,200,1;">
        
        <%
            let init = vis.binds.materialdesign.button.initializeVerticalButton(data);
        %>

        <div class="vis-widget materialdesign-widget materialdesign-button <%== init.style %> <%== this.data.attr('class') %>" style="width: 150px; height: 100px; padding: 0px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.materialdesign.button.handleNavigation(el, data); vis.binds.materialdesign.addRippleEffect(el, data) %>>
            <%== init.button %>
        </div>
</script>

<script id="tplVis-materialdesign-Button-Link-vertical"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_button_link_vertical.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="static"
        data-vis-name="Button Link vertical"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,buttons;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;buttonStyle[raised]/select,text,raised,unelevated,outlined;href/url;openNewWindow/checkbox;buttontext/html;colorPress/color;vibrateOnMobilDevices[50]/number;exportData/custom,materialdesign.viseditor.exportData,buttonLink_vertical;"
        data-vis-attrs0="group.icon;image/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageColor/color;iconPosition[top]/select,top,bottom;iconHeight/slider,0,200,1;">

        <%
            let init = vis.binds.materialdesign.button.initializeVerticalButton(data);
        %>

        <div class="vis-widget materialdesign-widget materialdesign-button <%== init.style %> <%== this.data.attr('class') %>" style="width: 150px; height: 100px; padding: 0px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" data-vis-link="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.materialdesign.button.handleLink(el, data); vis.binds.materialdesign.addRippleEffect(el, data) %>>
            <%== init.button %>
        </div>
</script>

<script id="tplVis-materialdesign-Button-State-vertical"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_button_state_vertical.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="ctrl"
        data-vis-name="Button State vertical"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,buttons;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;buttonStyle[raised]/select,text,raised,unelevated,outlined;value;buttontext/html;colorPress/color;vibrateOnMobilDevices[50]/number;exportData/custom,materialdesign.viseditor.exportData,buttonState_vertical;"
        data-vis-attrs0="group.icon;image/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageColor/color;iconPosition[top]/select,top,bottom;iconHeight/slider,0,200,1;"
        data-vis-attrs1="group.lock;lockEnabled/checkbox;autoLockAfter[10]/number;lockIcon/custom,materialdesign.viseditor.materialDesignIcons;lockIconTop[5]/slider,0,100,1;lockIconLeft[5]/slider,0,100,1;lockIconSize/number;lockIconColor/color;lockFilterGrayscale[30]/slider,0,100,1;">
        
        <%
            let init = vis.binds.materialdesign.button.initializeVerticalButton(data);
        %>

        <div class="vis-widget materialdesign-widget materialdesign-button <%== init.style %> <%== this.data.attr('class') %>" style="width: 150px; height: 100px; padding: 0px;" id="<%= this.data.attr('wid') %>" isLocked="<%== myMdwHelper.getBooleanFromData(this.data.attr('lockEnabled'), false) %>" <%= (el) -> vis.binds.materialdesign.button.handleState(el, data); vis.binds.materialdesign.addRippleEffect(el, data) %>>
            <%== init.button %>
        </div>
</script>

<script id="tplVis-materialdesign-Button-State-Multi-vertical"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_button_state_vertical.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="ctrl"
        data-vis-name="Button State Multi vertical"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,buttons;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;countOids[1]/number;buttonStyle[raised]/select,text,raised,unelevated,outlined;buttontext/html;colorPress/color;vibrateOnMobilDevices[50]/number;"
        data-vis-attrs0="group.buttonOids/byindex;oid(0-countOids);value(0-countOids);delayInMs(0-countOids)[0]/number;"
        data-vis-attrs1="group.icon;image/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageColor/color;iconPosition[top]/select,top,bottom;iconHeight/slider,0,200,1;"
        data-vis-attrs2="group.lock;lockEnabled/checkbox;autoLockAfter[10]/number;lockIcon/custom,materialdesign.viseditor.materialDesignIcons;lockIconTop[5]/slider,0,100,1;lockIconLeft[5]/slider,0,100,1;lockIconSize/number;lockIconColor/color;lockFilterGrayscale[30]/slider,0,100,1;">
        
        <%
            let init = vis.binds.materialdesign.button.initializeVerticalButton(data);
        %>

        <div class="vis-widget materialdesign-widget materialdesign-button <%== init.style %> <%== this.data.attr('class') %>" style="width: 150px; height: 100px; padding: 0px;" id="<%= this.data.attr('wid') %>" isLocked="<%== myMdwHelper.getBooleanFromData(this.data.attr('lockEnabled'), false) %>" <%= (el) -> vis.binds.materialdesign.button.handleState(el, data, true); vis.binds.materialdesign.addRippleEffect(el, data) %>>
            <%== init.button %>
        </div>
</script>

<script id="tplVis-materialdesign-Button-Adition-vertical"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_button_adition_vertical.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="ctrl"
        data-vis-name="Button Addition vertical"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,buttons;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;buttonStyle[raised]/select,text,raised,unelevated,outlined;value;minmax;buttontext/html;colorPress/color;vibrateOnMobilDevices[50]/number;"
        data-vis-attrs0="group.icon;image/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageColor/color;iconPosition[top]/select,top,bottom;iconHeight/slider,0,200,1;">
        
        <%
            let init = vis.binds.materialdesign.button.initializeVerticalButton(data);
        %>

        <div class="vis-widget materialdesign-widget materialdesign-button <%== init.style %> <%== this.data.attr('class') %>" style="width: 150px; height: 100px; padding: 0px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.materialdesign.button.handleAddition(el, data); vis.binds.materialdesign.addRippleEffect(el, data) %>>
            <%== init.button %>
        </div>
</script>

<script id="tplVis-materialdesign-Button-Toggle-vertical"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_button_toggle_vertical.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="ctrl,state,val,bool"
        data-vis-name="Button Toggle vertical"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,buttons;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;buttonStyle[raised]/select,text,raised,unelevated,outlined;readOnly/checkbox;toggleType[boolean]/select,boolean,value;pushButton/checkbox;valueOff;valueOn;stateIfNotTrueValue[on]/select,on,off;vibrateOnMobilDevices[50]/number;exportData/custom,materialdesign.viseditor.exportData,buttonToggle_vertical;"
        data-vis-attrs0="group.label;buttontext/html;labelTrue/html;labelColorFalse/color;labelColorTrue/color;"
        data-vis-attrs1="group.icon;image/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageColor/color;imageTrue/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageTrueColor/color;iconPosition[top]/select,top,bottom;iconHeight/slider,0,200,1;"
        data-vis-attrs2="group.color;colorBgFalse/color;colorBgTrue/color;colorPress/color;"
        data-vis-attrs3="group.lock;lockEnabled/checkbox;autoLockAfter[10]/number;lockIcon/custom,materialdesign.viseditor.materialDesignIcons;lockIconTop[5]/slider,0,100,1;lockIconLeft[5]/slider,0,100,1;lockIconSize/number;lockIconColor/color;lockFilterGrayscale[30]/slider,0,100,1;">
        <%
            let init = vis.binds.materialdesign.button.initializeVerticalButton(data);
        %> 
        
        <div class="vis-widget materialdesign-widget materialdesign-button <%== init.style %> <%== this.data.attr('class') %>" style="width: 150px; height: 100px; padding: 0px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.materialdesign.addRippleEffect(el, data) %> isLocked="<%== myMdwHelper.getBooleanFromData(this.data.attr('lockEnabled'), false) %>" >
            <%== init.button %>
            <div <%= (el) -> vis.binds.materialdesign.button.handleToggle(el, this.data) %>></div>
        </div>
</script>


<script id="tplVis-materialdesign-Button-Navigation"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_button_navigation.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="navigation"
        data-vis-name="Button Navigation"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,buttons;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;buttonStyle[raised]/select,text,raised,unelevated,outlined;nav_view;buttontext/html;colorPress/color;labelWidth/slider,0,100,1;vibrateOnMobilDevices[50]/number;"
        data-vis-attrs0="group.icon;image/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageColor/color;iconPosition[left]/select,left,right;iconHeight/slider,0,200,1;">
        
        <%
            let init = vis.binds.materialdesign.button.initializeButton(data);
        %>

        <div class="vis-widget materialdesign-widget materialdesign-button <%== init.style %> <%== this.data.attr('class') %>" style="width: 100px; height: 30px; padding: 0px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.materialdesign.button.handleNavigation(el, data); vis.binds.materialdesign.addRippleEffect(el, data) %>>
            <%== init.button %>
        </div>
</script>


<script id="tplVis-materialdesign-Button-Link"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_button_link.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="static"
        data-vis-name="Button Link"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,buttons;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;buttonStyle[raised]/select,text,raised,unelevated,outlined;href/url;openNewWindow/checkbox;buttontext/html;colorPress/color;labelWidth/slider,0,100,1;vibrateOnMobilDevices[50]/number;exportData/custom,materialdesign.viseditor.exportData,buttonLink;"
        data-vis-attrs0="group.icon;image/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageColor/color;iconPosition[left]/select,left,right;iconHeight/slider,0,200,1;">

        <%
            let init = vis.binds.materialdesign.button.initializeButton(data);
        %>

        <div class="vis-widget materialdesign-widget materialdesign-button <%== init.style %> <%== this.data.attr('class') %>" style="width: 100px; height: 30px; padding: 0px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" data-vis-link="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.materialdesign.button.handleLink(el, data); vis.binds.materialdesign.addRippleEffect(el, data) %>>
            <%== init.button %>
        </div>
</script>

<script id="tplVis-materialdesign-Button-State"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_button_state.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="ctrl"
        data-vis-name="Button State"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,buttons;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;buttonStyle[raised]/select,text,raised,unelevated,outlined;value;buttontext/html;colorPress/color;labelWidth/slider,0,100,1;vibrateOnMobilDevices[50]/number;exportData/custom,materialdesign.viseditor.exportData,buttonState;"
        data-vis-attrs0="group.icon;image/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageColor/color;iconPosition[left]/select,left,right;iconHeight/slider,0,200,1;"
        data-vis-attrs1="group.lock;lockEnabled/checkbox;autoLockAfter[10]/number;lockIcon/custom,materialdesign.viseditor.materialDesignIcons;lockIconSize/number;lockIconColor/color;lockFilterGrayscale[30]/slider,0,100,1;">
        
        <%
            let init = vis.binds.materialdesign.button.initializeButton(data);
        %>

        <div class="vis-widget materialdesign-widget materialdesign-button <%== init.style %> <%== this.data.attr('class') %>" style="width: 100px; height: 30px; padding: 0px;" id="<%= this.data.attr('wid') %>" isLocked="<%== myMdwHelper.getBooleanFromData(this.data.attr('lockEnabled'), false) %>" <%= (el) -> vis.binds.materialdesign.button.handleState(el, data); vis.binds.materialdesign.addRippleEffect(el, data) %>>
            <%== init.button %>
        </div>
</script>

<script id="tplVis-materialdesign-Button-State-Multi"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_button_state.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="ctrl"
        data-vis-name="Button State Multi"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,buttons;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;countOids[1]/number;buttonStyle[raised]/select,text,raised,unelevated,outlined;buttontext/html;colorPress/color;labelWidth/slider,0,100,1;vibrateOnMobilDevices[50]/number;"
        data-vis-attrs0="group.buttonOids/byindex;oid(0-countOids);value(0-countOids);delayInMs(0-countOids)[0]/number;"
        data-vis-attrs1="group.icon;image/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageColor/color;iconPosition[left]/select,left,right;iconHeight/slider,0,200,1;"
        data-vis-attrs2="group.lock;lockEnabled/checkbox;autoLockAfter[10]/number;lockIcon/custom,materialdesign.viseditor.materialDesignIcons;lockIconSize/number;lockIconColor/color;lockFilterGrayscale[30]/slider,0,100,1;">
        
        <%
            let init = vis.binds.materialdesign.button.initializeButton(data);
        %>

        <div class="vis-widget materialdesign-widget materialdesign-button <%== init.style %> <%== this.data.attr('class') %>" style="width: 100px; height: 30px; padding: 0px;" id="<%= this.data.attr('wid') %>" isLocked="<%== myMdwHelper.getBooleanFromData(this.data.attr('lockEnabled'), false) %>" <%= (el) -> vis.binds.materialdesign.button.handleState(el, data, true); vis.binds.materialdesign.addRippleEffect(el, data) %>>
            <%== init.button %>
        </div>
</script>

<script id="tplVis-materialdesign-Button-Adition"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_button_adition.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="ctrl"
        data-vis-name="Button Addition"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,buttons;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;buttonStyle[raised]/select,text,raised,unelevated,outlined;value;minmax;buttontext/html;colorPress/color;labelWidth/slider,0,100,1;vibrateOnMobilDevices[50]/number;"
        data-vis-attrs0="group.icon;image/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageColor/color;iconPosition[left]/select,left,right;iconHeight/slider,0,200,1;">
        
        <%
            let init = vis.binds.materialdesign.button.initializeButton(data);
        %>

        <div class="vis-widget materialdesign-widget materialdesign-button <%== init.style %> <%== this.data.attr('class') %>" style="width: 100px; height: 30px; padding: 0px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.materialdesign.button.handleAddition(el, data); vis.binds.materialdesign.addRippleEffect(el, data) %>>
            <%== init.button %>
        </div>
</script>

<script id="tplVis-materialdesign-Button-Toggle"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_button_toggle.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="ctrl,state,val,bool"
        data-vis-name="Button Toggle"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,buttons;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;buttonStyle[raised]/select,text,raised,unelevated,outlined;readOnly/checkbox;toggleType[boolean]/select,boolean,value;pushButton/checkbox;valueOff;valueOn;stateIfNotTrueValue[on]/select,on,off;vibrateOnMobilDevices[50]/number;exportData/custom,materialdesign.viseditor.exportData,buttonToggle;"
        data-vis-attrs0="group.label;buttontext/html;labelTrue/html;labelColorFalse/color;labelColorTrue/color;labelWidth/slider,0,100,1;"
        data-vis-attrs1="group.icon;image/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageColor/color;imageTrue/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageTrueColor/color;iconPosition[left]/select,left,right;iconHeight/slider,0,200,1;"
        data-vis-attrs2="group.color;colorBgFalse/color;colorBgTrue/color;colorPress/color;"
        data-vis-attrs3="group.lock;lockEnabled/checkbox;autoLockAfter[10]/number;lockIcon/custom,materialdesign.viseditor.materialDesignIcons;lockIconSize/number;lockIconColor/color;lockFilterGrayscale[30]/slider,0,100,1;">

        <%
            let init = vis.binds.materialdesign.button.initializeButton(data);
        %> 
        
        <div class="vis-widget materialdesign-widget materialdesign-button <%== init.style %> <%== this.data.attr('class') %>" style="width: 100px; height: 30px; padding: 0px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.materialdesign.addRippleEffect(el, data) %> isLocked="<%== myMdwHelper.getBooleanFromData(this.data.attr('lockEnabled'), false) %>" >
            <%== init.button %>
            <div <%= (el) -> vis.binds.materialdesign.button.handleToggle(el, this.data) %>></div>
        </div>
</script>

<script id="tplVis-materialdesign-Icon-Button-Navigation"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_icon_button_navigation.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="navigation"
        data-vis-name="Icon Button Navigation"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,buttons;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;nav_view;vibrateOnMobilDevices[50]/number;"
        data-vis-attrs0="group.icon;image/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageColor/color;iconHeight/slider,0,200,1;"
        data-vis-attrs1="group.color;colorPress/color">

        <%
            let init = vis.binds.materialdesign.button.initializeButton(data, true);
        %>

        <div class="vis-widget materialdesign-widget materialdesign-icon-button <%== this.data.attr('class') %>" style="width: 48px; height: 48px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.materialdesign.button.handleNavigation(el, data); vis.binds.materialdesign.addRippleEffect(el, data, true) %>>
            <%== init.button %>
        </div>
</script>


<script id="tplVis-materialdesign-Icon-Button-Link"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_icon_button_link.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="static"
        data-vis-name="Icon Button Link"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,buttons;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;href/url;openNewWindow/checkbox;vibrateOnMobilDevices[50]/number;exportData/custom,materialdesign.viseditor.exportData,buttonLink_icon;"
        data-vis-attrs0="group.icon;image/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageColor/color;iconHeight/slider,0,200,1;"
        data-vis-attrs1="group.color;colorPress/color">

        <%
            let init = vis.binds.materialdesign.button.initializeButton(data, true);
        %>

        <div class="vis-widget materialdesign-widget materialdesign-icon-button <%== this.data.attr('class') %>" style="width: 48px; height: 48px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.materialdesign.button.handleLink(el, data); vis.binds.materialdesign.addRippleEffect(el, data, true) %>>
            <%== init.button %>
        </div>
</script>

<script id="tplVis-materialdesign-Icon-Button-State"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_icon_button_state.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="ctrl"
        data-vis-name="Icon Button State"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,buttons;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;value;vibrateOnMobilDevices[50]/number;exportData/custom,materialdesign.viseditor.exportData,buttonState_icon;"
        data-vis-attrs0="group.icon;image/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageColor/color;iconHeight/slider,0,200,1;"
        data-vis-attrs1="group.color;colorPress/color;"
        data-vis-attrs2="group.lock;lockEnabled/checkbox;autoLockAfter[10]/number;lockIcon/custom,materialdesign.viseditor.materialDesignIcons;lockIconTop[45]/slider,0,100,1;lockIconLeft[55]/slider,0,100,1;lockIconSize[20]/number;lockIconColor[red]/color;lockIconBackground/color;lockBackgroundSizeFactor[1]/number,1,10,0.1;lockFilterGrayscale[30]/slider,0,100,1;">

        <%
            let init = vis.binds.materialdesign.button.initializeButton(data, true);
        %>

        <div class="vis-widget materialdesign-widget materialdesign-icon-button <%== this.data.attr('class') %>" style="width: 48px; height: 48px;" id="<%= this.data.attr('wid') %>" isLocked="<%== myMdwHelper.getBooleanFromData(this.data.attr('lockEnabled'), false) %>" <%= (el) -> vis.binds.materialdesign.button.handleState(el, data); vis.binds.materialdesign.addRippleEffect(el, data, true) %>>
            <%== init.button %>
        </div>        
</script>

<script id="tplVis-materialdesign-Icon-Button-State-Multi"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_icon_button_state.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="ctrl"
        data-vis-name="Icon Button State Multi"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,buttons;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;countOids[1]/number;vibrateOnMobilDevices[50]/number;"
        data-vis-attrs0="group.buttonOids/byindex;oid(0-countOids);value(0-countOids);delayInMs(0-countOids)[0]/number;"
        data-vis-attrs1="group.icon;image/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageColor/color;iconHeight/slider,0,200,1;"
        data-vis-attrs2="group.color;colorPress/color;"
        data-vis-attrs3="group.lock;lockEnabled/checkbox;autoLockAfter[10]/number;lockIcon/custom,materialdesign.viseditor.materialDesignIcons;lockIconTop[45]/slider,0,100,1;lockIconLeft[55]/slider,0,100,1;lockIconSize[20]/number;lockIconColor[red]/color;lockIconBackground/color;lockBackgroundSizeFactor[1]/number,1,10,0.1;lockFilterGrayscale[30]/slider,0,100,1;">

        <%
            let init = vis.binds.materialdesign.button.initializeButton(data, true);
        %>

        <div class="vis-widget materialdesign-widget materialdesign-icon-button <%== this.data.attr('class') %>" style="width: 48px; height: 48px;" id="<%= this.data.attr('wid') %>" isLocked="<%== myMdwHelper.getBooleanFromData(this.data.attr('lockEnabled'), false) %>" <%= (el) -> vis.binds.materialdesign.button.handleState(el, data, true); vis.binds.materialdesign.addRippleEffect(el, data, true) %>>
            <%== init.button %>
        </div>        
</script>

<script id="tplVis-materialdesign-Icon-Button-Adition"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_icon_button_adition.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="ctrl"
        data-vis-name="Icon Button Addition"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,buttons;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;value;minmax;vibrateOnMobilDevices[50]/number;"
        data-vis-attrs0="group.icon;image/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageColor/color;iconHeight/slider,0,200,1;"
        data-vis-attrs1="group.color;colorPress/color">

        <%
            let init = vis.binds.materialdesign.button.initializeButton(data, true);
        %>

        <div class="vis-widget materialdesign-widget materialdesign-icon-button <%== this.data.attr('class') %>" style="width: 48px; height: 48px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.materialdesign.button.handleAddition(el, data); vis.binds.materialdesign.addRippleEffect(el, data, true) %>>
            <%== init.button %>
        </div>        
</script>

<script id="tplVis-materialdesign-Icon-Button-Toggle"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_icon_button_toggle.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="ctrl,state,val,bool"
        data-vis-name="Icon Button Toggle"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,buttons;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;readOnly/checkbox;toggleType[boolean]/select,boolean,value;pushButton/checkbox;valueOff;valueOn;stateIfNotTrueValue[on]/select,on,off;vibrateOnMobilDevices[50]/number;exportData/custom,materialdesign.viseditor.exportData,buttonToggle_icon;"
        data-vis-attrs0="group.icon;image/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageColor/color;imageTrue/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageTrueColor/color;iconHeight/slider,0,200,1;"
        data-vis-attrs1="group.color;colorBgFalse/color;colorBgTrue/color;colorPress/color;"
        data-vis-attrs2="group.lock;lockEnabled/checkbox;autoLockAfter[10]/number;lockIcon/custom,materialdesign.viseditor.materialDesignIcons;lockIconTop[45]/slider,0,100,1;lockIconLeft[55]/slider,0,100,1;lockIconSize[20]/number;lockIconColor[red]/color;lockIconBackground/color;lockBackgroundSizeFactor[1]/number,1,10,0.1;lockFilterGrayscale[30]/slider,0,100,1;">

        <%
            let init = vis.binds.materialdesign.button.initializeButton(data, true);
        %>

        <div class="vis-widget materialdesign-widget materialdesign-icon-button <%== this.data.attr('class') %>" style="width: 48px; height: 48px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %> <%= (el) -> vis.binds.materialdesign.button.handleLink(el, data); vis.binds.materialdesign.addRippleEffect(el, data, true) %>" isLocked="<%== myMdwHelper.getBooleanFromData(this.data.attr('lockEnabled'), false) %>" >
            <%== init.button %>
            <div <%= (el) -> vis.binds.materialdesign.button.handleToggle(el, this.data) %>></div>
        </div>
</script>

<script id="tplVis-materialdesign-Input"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_input.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="ctrl"
        data-vis-name="Input"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,input;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;inputType[text]/select,text,number,date,time,mask;inputMask;inputMaxLength/number;exportData/custom,materialdesign.viseditor.exportData,textfield;"
        data-vis-attrs0="group.inputLayout;inputLayout[regular]/select,regular,solo,solo-rounded,solo-shaped,filled,filled-rounded,filled-shaped,outlined,outlined-rounded,outlined-shaped;inputLayoutBackgroundColor/color;inputLayoutBackgroundColorHover/color;inputLayoutBackgroundColorSelected/color;inputLayoutBorderColor/color;inputLayoutBorderColorHover/color;inputLayoutBorderColorSelected/color;inputTextFontFamily/fontname;inputTextFontSize/number;inputTextColor/color;"
        data-vis-attrs1="group.inputLabel;inputLabelText;inputLabelColor/color;inputLabelColorSelected/color;inputLabelFontFamily/fontname;inputLabelFontSize/number,0,24,1;inputTranslateX/number;inputTranslateY/number;"
        data-vis-attrs2="group.inputAppendix;inputPrefix;inputSuffix;inputAppendixColor/color;inputAppendixFontSize/number;inputAppendixFontFamily/fontname;"
        data-vis-attrs3="group.inputSubText;showInputMessageAlways[true]/checkbox;inputMessage;inputMessageFontFamily/fontname;inputMessageFontSize/number;inputMessageColor/color;"
        data-vis-attrs4="group.counter;showInputCounter[true]/checkbox;inputCounterColor/color;inputCounterFontSize/number;inputCounterFontFamily/fontname;"
        data-vis-attrs5="group.icons;clearIconShow[true]/checkbox;clearIcon/custom,materialdesign.viseditor.materialDesignIcons;clearIconSize/number;clearIconColor/color;prepandIcon/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;prepandIconSize/number;prepandIconColor/color;prepandInnerIcon/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;prepandInnerIconSize/number;prepandInnerIconColor/color;appendIcon/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;appendIconSize/number;appendIconColor/color;appendOuterIcon/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;appendOuterIconSize/number;appendOuterIconColor/color;">
        
        <div class="vis-widget materialdesign-widget materialdesign-input <%== this.data.attr('class') %>" style="width: 150px; height: 38px; overflow: visible;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.materialdesign.textfield(el, data) %>> 
        
        </div>
</script>

<script id="tplVis-materialdesign-Autocomplete"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_autocomplete.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="ctrl"
        data-vis-name="Autocomplete"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,autocomplete;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,input;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;inputMode[write]/select,write,select;inputType[text]/select,text,date,time;vibrateOnMobilDevices[50]/number;exportData/custom,materialdesign.viseditor.exportData,autocomplete;"
        data-vis-attrs0="group.inputLayout;inputLayout[regular]/select,regular,solo,solo-rounded,solo-shaped,filled,filled-rounded,filled-shaped,outlined,outlined-rounded,outlined-shaped;inputLayoutBackgroundColor/color;inputLayoutBackgroundColorHover/color;inputLayoutBackgroundColorSelected/color;inputLayoutBorderColor/color;inputLayoutBorderColorHover/color;inputLayoutBorderColorSelected/color;inputTextFontFamily/fontname;inputTextFontSize/number;inputTextColor/color;"
        data-vis-attrs1="group.inputLabel;inputLabelText;inputLabelColor/color;inputLabelColorSelected/color;inputLabelFontFamily/fontname;inputLabelFontSize/number,0,24,1;inputTranslateX/number;inputTranslateY/number;"
        data-vis-attrs2="group.inputAppendix;inputPrefix;inputSuffix;inputAppendixColor/color;inputAppendixFontSize/number;inputAppendixFontFamily/fontname;"
        data-vis-attrs3="group.inputSubText;showInputMessageAlways[true]/checkbox;inputMessage;inputMessageFontFamily/fontname;inputMessageFontSize/number;inputMessageColor/color;"
        data-vis-attrs4="group.counter;showInputCounter[true]/checkbox;inputCounterColor/color;inputCounterFontSize/number;inputCounterFontFamily/fontname;"
        data-vis-attrs5="group.icons;clearIconShow[true]/checkbox;clearIcon/custom,materialdesign.viseditor.materialDesignIcons;clearIconSize/number;clearIconColor/color;collapseIcon/custom,materialdesign.viseditor.materialDesignIcons;collapseIconSize/number;collapseIconColor/color;prepandIcon/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;prepandIconSize/number;prepandIconColor/color;prepandInnerIcon/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;prepandInnerIconSize/number;prepandInnerIconColor/color;appendOuterIcon/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;appendOuterIconSize/number;appendOuterIconColor/color;"
        data-vis-attrs6="group.listData;listDataMethod[inputPerEditor]/select,inputPerEditor,jsonStringObject,multistatesObject,valueList;countSelectItems[1]/number;jsonStringObject/html;valueList/html;valueListLabels/html;valueListIcons/html;"
        data-vis-attrs7="group.autoCompleteListLayout;listPosition[auto]/select,auto,top,bottom;listPositionOffset[true]/checkbox;listItemHeight/number;listItemBackgroundColor/color;listItemBackgroundHoverColor/color;listItemBackgroundSelectedColor/color;listItemRippleEffectColor/color;showSelectedIcon[prepend-inner]/select,no,prepend,prepend-inner,append-outer;listIconSize/number;listIconColor/color;listIconHoverColor/color;listIconSelectedColor/color;listItemFontSize/number;listItemFont/fontname;listItemFontColor/color;listItemFontHoverColor/color;listItemFontSelectedColor/color;listItemSubFontSize/number;listItemSubFont/fontname;listItemSubFontColor/color;listItemSubFontHoverColor/color;listItemSubFontSelectedColor/color;showValue[true]/checkbox;listItemValueFontSize/number;listItemValueFont/fontname;listItemValueFontColor/color;listItemValueFontHoverColor/color;listItemValueFontSelectedColor/color;"
        data-vis-attrs8="group.menuItems/byindex;value(0-countSelectItems);label(0-countSelectItems);subLabel(0-countSelectItems);listIcon(0-countSelectItems)/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;listIconColor(0-countSelectItems)/color;">
        
        <div class="vis-widget materialdesign-widget materialdesign-autocomplete <%== this.data.attr('class') %>" style="width: 150px; height: 38px; overflow: visible;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.materialdesign.autocomplete(el, data) %>> 
        
        </div>
</script>

<script id="tplVis-materialdesign-Select"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_autocomplete.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="ctrl"
        data-vis-name="Select"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,select;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,input;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;inputType[text]/select,text,date,time;vibrateOnMobilDevices[50]/number;exportData/custom,materialdesign.viseditor.exportData,select;"
        data-vis-attrs0="group.inputLayout;inputLayout[regular]/select,regular,solo,solo-rounded,solo-shaped,filled,filled-rounded,filled-shaped,outlined,outlined-rounded,outlined-shaped;inputLayoutBackgroundColor/color;inputLayoutBackgroundColorHover/color;inputLayoutBackgroundColorSelected/color;inputLayoutBorderColor/color;inputLayoutBorderColorHover/color;inputLayoutBorderColorSelected/color;inputTextFontFamily/fontname;inputTextFontSize/number;inputTextColor/color;"
        data-vis-attrs1="group.inputLabel;inputLabelText;inputLabelColor/color;inputLabelColorSelected/color;inputLabelFontFamily/fontname;inputLabelFontSize/number,0,24,1;inputTranslateX/number;inputTranslateY/number;"
        data-vis-attrs2="group.inputAppendix;inputPrefix;inputSuffix;inputAppendixColor/color;inputAppendixFontSize/number;inputAppendixFontFamily/fontname;"
        data-vis-attrs3="group.inputSubText;showInputMessageAlways[true]/checkbox;inputMessage;inputMessageFontFamily/fontname;inputMessageFontSize/number;inputMessageColor/color;"
        data-vis-attrs4="group.counter;showInputCounter[true]/checkbox;inputCounterColor/color;inputCounterFontSize/number;inputCounterFontFamily/fontname;"
        data-vis-attrs5="group.icons;clearIconShow[true]/checkbox;clearIcon/custom,materialdesign.viseditor.materialDesignIcons;clearIconSize/number;clearIconColor/color;collapseIcon/custom,materialdesign.viseditor.materialDesignIcons;collapseIconSize/number;collapseIconColor/color;prepandIcon/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;prepandIconSize/number;prepandIconColor/color;prepandInnerIcon/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;prepandInnerIconSize/number;prepandInnerIconColor/color;appendOuterIcon/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;appendOuterIconSize/number;appendOuterIconColor/color;"
        data-vis-attrs6="group.listData;listDataMethod[inputPerEditor]/select,inputPerEditor,jsonStringObject,multistatesObject,valueList;countSelectItems[1]/number;jsonStringObject/html;valueList/html;valueListLabels/html;valueListIcons/html;"
        data-vis-attrs7="group.selectListLayout;listPosition[auto]/select,auto,top,bottom;listPositionOffset/checkbox;listItemHeight/number;listItemBackgroundColor/color;listItemBackgroundHoverColor/color;listItemBackgroundSelectedColor/color;listItemRippleEffectColor/color;showSelectedIcon[prepend-inner]/select,no,prepend,prepend-inner,append-outer;listIconSize/number;listIconColor/color;listIconHoverColor/color;listIconSelectedColor/color;listItemFontSize/number;listItemFont/fontname;listItemFontColor/color;listItemFontHoverColor/color;listItemFontSelectedColor/color;listItemSubFontSize/number;listItemSubFont/fontname;listItemSubFontColor/color;listItemSubFontHoverColor/color;listItemSubFontSelectedColor/color;showValue[true]/checkbox;listItemValueFontSize/number;listItemValueFont/fontname;listItemValueFontColor/color;listItemValueFontHoverColor/color;listItemValueFontSelectedColor/color;"
        data-vis-attrs8="group.menuItems/byindex;value(0-countSelectItems);label(0-countSelectItems);subLabel(0-countSelectItems);listIcon(0-countSelectItems)/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;listIconColor(0-countSelectItems)/color;">
        
        <div class="vis-widget materialdesign-widget materialdesign-select <%== this.data.attr('class') %>" style="width: 150px; height: 38px; overflow: visible;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.materialdesign.select(el, data) %>> 
        
        </div>
</script>

<script id="tplVis-materialdesign-Switch"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_switch.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="ctrl,bool,val"
        data-vis-name="Switch"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,switch;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,checkboxSwitch;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;readOnly/checkbox;toggleType[boolean]/select,boolean,value;valueOff;valueOn;stateIfNotTrueValue[on]/select,on,off;vibrateOnMobilDevices[50]/number;exportData/custom,materialdesign.viseditor.exportData,switch;"
        data-vis-attrs0="group.label;labelFalse/html;labelTrue/html;labelPosition[left]/select,left,right;labelClickActive[true]/checkbox;"
        data-vis-attrs1="group.color;colorSwitchThumb/color;colorSwitchTrack/color;colorSwitchTrue/color;colorSwitchHover/color;labelColorFalse/color;labelColorTrue/color;"
        data-vis-attrs2="group.lock;lockEnabled/checkbox;autoLockAfter[10]/number;lockIcon/custom,materialdesign.viseditor.materialDesignIcons;lockIconTop[5]/slider,0,100,1;lockIconLeft[5]/slider,0,100,1;lockIconSize/number;lockIconColor/color;lockFilterGrayscale[30]/slider,0,100,1;">
        
        <%
            let init = vis.binds.materialdesign.switch.initialize(data);
        %>

        <div class="vis-widget materialdesign-widget mdc-form-field <%== init.labelPosition %> materialdesign-switch <%== this.data.attr('class') %>" style="width:80px; height:50px; overflow: visible !important;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" isLocked="<%== myMdwHelper.getBooleanFromData(this.data.attr('lockEnabled'), false) %>" <%= (el) -> vis.binds.materialdesign.switch.handle(el, data) %>>
            <%== init.myswitch %>
        </div>
</script>

<script id="tplVis-materialdesign-CheckBox"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_checkbox.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="ctrl,bool,val"
        data-vis-name="Checkbox"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,checkbox;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,checkboxSwitch;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;readOnly/checkbox;toggleType[boolean]/select,boolean,value;valueOff;valueOn;stateIfNotTrueValue[on]/select,on,off;vibrateOnMobilDevices[50]/number;exportData/custom,materialdesign.viseditor.exportData,checkbox;"
        data-vis-attrs0="group.label;labelFalse/html;labelTrue/html;labelPosition[left]/select,left,right;labelClickActive[true]/checkbox;"
        data-vis-attrs1="group.color;colorCheckBox/color;labelColorFalse/color;labelColorTrue/color;"
        data-vis-attrs2="group.lock;lockEnabled/checkbox;autoLockAfter[10]/number;lockIcon/custom,materialdesign.viseditor.materialDesignIcons;lockIconTop[5]/slider,0,100,1;lockIconLeft[5]/slider,0,100,1;lockIconSize/number;lockIconColor/color;lockFilterGrayscale[30]/slider,0,100,1;">

        <%
            let init = vis.binds.materialdesign.checkbox.initialize(data);
        %>


        <div class="vis-widget materialdesign-widget mdc-form-field <%== init.labelPosition %> materialdesign-checkbox <%== this.data.attr('class') %>" style="width:80px; height:50px; overflow: visible !important;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" isLocked="<%== myMdwHelper.getBooleanFromData(this.data.attr('lockEnabled'), false) %>" <%= (el) -> vis.binds.materialdesign.checkbox.handle(el, data) %>>
            <%== init.checkbox %>
        </div>
</script>

<script id="tplVis-materialdesign-Vuetify-Slider"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_slider.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="ctrl,slider,dimmer"
        data-vis-name="Slider"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,slider;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,slider;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;oid-working;orientation[horizontal]/select,horizontal,vertical;reverseSlider/checkbox;knobSize[knobSmall]/select,knobSmall,knobMedium,knobBig;readOnly/checkbox;min;max;step[1];vibrateOnMobilDevices[50]/number;exportData/custom,materialdesign.viseditor.exportData,slider;"
        data-vis-attrs0="group.tickLayout;showTicks[no]/select,no,yes,always;tickSize/number;tickLabels;tickColorBefore/color;tickColorAfter/color;"
        data-vis-attrs1="group.color;colorBeforeThumb/color;colorThumb/color;colorAfterThumb/color;"
        data-vis-attrs2="group.label;prepandText;prepandTextWidth/number;prepandTextColor/color;prepandTextFontSize/number;prepandTextFontFamily/fontname;showValueLabel[true]/checkbox;valueLabelStyle[sliderValue]/select,sliderPercent,sliderValue;valueLabelUnit;valueLabelMin/html;valueLabelMax/html;valueLessThan/number;textForValueLessThan/html;valueGreaterThan/number;textForValueGreaterThan/html;valueLabelWidth[50]/slider,0,200,1;"
        data-vis-attrs3="group.thumbLabelLayout;showThumbLabel[no]/select,no,yes,always;thumbSize/number;thumbBackgroundColor/color;thumbFontColor/color;thumbFontSize/number;thumbFontFamily/fontname;useLabelRules/checkbox;">

        <div class="vis-widget materialdesign-widget materialdesign-slider-vertical <%== this.data.attr('class') %>" style="width: 150px; height: 150px; overflow:visible !important; display: flex; align-items: center;" id="<%= this.data.attr('wid') %>" data-oid-working="<%= this.data.attr('oid-working') %>" <%= (el) -> vis.binds.materialdesign.slider.vuetifySlider(el, data) %>>

        </div>

        
</script>

<script id="tplVis-materialdesign-Slider-Round"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_round_slider.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="ctrl,slider,dimmer"
        data-vis-name="Slider Round"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,slider;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,slider;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;oid-working;min;max;step[1];readOnly/checkbox;startAngle[135]/slider,0,360,1;arcLength[270]/slider,0,360,1;sliderWidth/number;handleSize/number;handleZoom[1.5]/slider,0,10,0.1;rtl/checkbox;vibrateOnMobilDevices[50]/number;exportData/custom,materialdesign.viseditor.exportData,slider_round;"
        data-vis-attrs0="group.color;colorSliderBg/color;colorBeforeThumb/color;colorThumb/color;colorAfterThumb/color;valueLabelColor/color;"
        data-vis-attrs1="group.label;showValueLabel[true]/checkbox;valueLabelVerticalPosition/slider,0,100,1;valueLabelStyle[sliderValue]/select,sliderPercent,sliderValue;valueLabelUnit;valueLabelMin/html;valueLabelMax/html;valueLessThan/number;textForValueLessThan/html;valueGreaterThan/number;textForValueGreaterThan/html;">
        
        <div class="vis-widget materialdesign-widget materialdesign-slider-round <%== this.data.attr('class') %>" style="width: 400px; height: 250px;" id="<%= this.data.attr('wid') %>" data-oid-working="<%= this.data.attr('oid-working') %>" <%= (el) -> vis.binds.materialdesign.roundslider(el, data) %>>

        </div>
</script>

<script id="tplVis-materialdesign-Progress"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplVis-materialdesign-Progress" style="position: relative; text-align: initial; padding: 4px "><div class="vis-widget_prev materialdesign-progress vis-tpl-materialdesign-Progress " style="width: 100px; height: 21px; left: 45px; top: 298px; color: rgb(0, 0, 0); text-align: center; font-size: small; position: absolute; z-index: 700;" data-tmodified="true" data-zmodified="true"> <div class="materialdesign vis-widget-prev-body" style="display: flex; justify-content: center; align-items: center;"> <div role="progressbar" class="mdc-linear-progress" style="text-align: left;" data-oid="info.0.sysinfo.cpu.currentLoad.currentload"> <div class="mdc-linear-progress__buffering-dots"></div> <div class="mdc-linear-progress__buffer"></div> <div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar" style="transform: scaleX(0.15);"> <span class="mdc-linear-progress__bar-inner"></span> </div> <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar"> <span class="mdc-linear-progress__bar-inner"></span> </div> </div> <div style="min-width: 7%; position: absolute; width: 100%;"> <label class="labelValue" style=""> 15 % </label> </div> </div> <div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-w" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-nw" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-ne" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-sw" style="z-index: 90;"></div></div></div>'
        data-vis-set="materialdesign"
        data-vis-type="val,progress"
        data-vis-name="Progress"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,progress;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,progress;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;min;max;reverse/checkbox;exportData/custom,materialdesign.viseditor.exportData,progress;"
        data-vis-attrs0="group.layout;progressRounded[true]/checkbox;progressStriped/checkbox;progressStripedColor/color;"
        data-vis-attrs1="group.color;colorProgressBackground/color;colorProgress/color;colorOneCondition;colorOne/color;colorTwoCondition;colorTwo/color;"
        data-vis-attrs2="group.label;showValueLabel[true]/checkbox;valueLabelStyle[progressPercent]/select,progressPercent,progressValue,progressCustom;valueLabelUnit;valueMaxDecimals/number;valueLabelCustom/html;textColor/color;textFontSize/number;textFontFamily/fontname;textAlign[end]/select,start,center,end;">

        <div class="vis-widget materialdesign-widget materialdesign-progress <%== this.data.attr('class') %>" style="width: 180px; height: 50px;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.materialdesign.progress.linear(el, data) %>>

        </div>
</script>

<script id="tplVis-materialdesign-Progress-Circular"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplVis-materialdesign-Progress-Circular" style="position: relative; text-align: initial; padding: 4px "><div class="vis-widget_prev materialdesign-widget materialdesign-progress vis-tpl-materialdesign-Progress Circular " style="width: 110px; height: 63px; left: 500px; top: 110px; text-align: center; font-size: 14px; font-weight: bold; position: absolute;" > <div class="materialdesign-vuetify-progress-circular" style="width: 100%; height: 100%; display: flex; justify-content: center;"><div role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="74" class="v-progress-circular" style="height: 60px; width: 60px;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="21.428571428571427 21.428571428571427 42.857142857142854 42.857142857142854" style="transform: rotate(90deg);"><circle fill="transparent" cx="42.857142857142854" cy="42.857142857142854" r="20" stroke-width="2.8571428571428568" stroke-dasharray="125.664" stroke-dashoffset="0" class="v-progress-circular__underlay"></circle><circle fill="transparent" cx="42.857142857142854" cy="42.857142857142854" r="20" stroke-width="2.8571428571428568" stroke-dasharray="125.664" stroke-dashoffset="32.67256359733385px" class="v-progress-circular__overlay"></circle></svg><div class="v-progress-circular__info"><div class="materialdesign-vuetify-progress-circular-value-label">74 %</div></div></div></div><div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-w" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-nw" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-ne" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-sw" style="z-index: 90;"></div></div></div>'
        data-vis-set="materialdesign"
        data-vis-type="val,progress"
        data-vis-name="Progress Circular"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,progress;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,progress;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;min;max;exportData/custom,materialdesign.viseditor.exportData,progress_circular;"
        data-vis-attrs0="group.layout;progressCircularSize/number;progressCircularWidth/number;progressCircularRotate/number;"
        data-vis-attrs1="group.color;colorProgressBackground/color;colorProgress/color;innerColor/color;colorOneCondition/number;colorOne/color;colorTwoCondition/number;colorTwo/color;"
        data-vis-attrs2="group.label;showValueLabel[true]/checkbox;valueLabelStyle[progressPercent]/select,progressPercent,progressValue,progressCustom;valueLabelUnit;valueMaxDecimals/number;valueLabelCustom/html;textColor/color;textFontSize/number;textFontFamily/fontname;">

        <div class="vis-widget materialdesign-widget materialdesign-progress <%== this.data.attr('class') %>" style="width: 70px; height: 70px;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.materialdesign.progress.circular(el, data) %>>

        </div>
</script>

<script id="tplVis-materialdesign-Card"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplVis-materialdesign-Card" style="position: relative; text-align: initial; padding: 4px "><div class="vis-widget_prev materialdesign-html-card mdc-card vis-tpl-materialdesign-HTML Card " style="width: 100px; height: 131px; left: 562px; top: 439px; font-size: xx-large; position: absolute; z-index: 700;" data-tmodified="true" data-zmodified="true"> <div class="mdc-card__media mdc-card__media--16-9" style="background-image: url(/vis/widgets/materialdesign/img/preview.jpg);"></div><div class="materialdesign-html-card card-title-section" style=""><div class="materialdesign-html-card card-title mdc-typography mdc-typography--headline6" style="">Title</div><div class="materialdesign-html-card card-subtitle mdc-typography mdc-typography--subtitle2" style="">Subtitle</div></div><div class="materialdesign-html-card card-text-section"><div class=".materialdesign-html-card mdc-typography mdc-typography--body2"></div></div> <div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-w" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-nw" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-ne" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-sw" style="z-index: 90;"></div></div></div>'
        data-vis-set="materialdesign"
        data-vis-type="static"
        data-vis-name="HTML Card"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,card;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;title/html;titleLayout[headline6]/auto,headline1,headline2,headline3,headline4,headline5,headline6,subtitle1,subtitle2,body1,body2,caption,button,overline,xx-small,x-small,small,medium,large,x-large,xx-large,smaller,larger;subtitle/html;subtitleLayout[subtitle2]/auto,headline1,headline2,headline3,headline4,headline5,headline6,subtitle1,subtitle2,body1,body2,caption,button,overline,xx-small,x-small,small,medium,large,x-large,xx-large,smaller,larger;html/text;textFontSize/auto,headline1,headline2,headline3,headline4,headline5,headline6,subtitle1,subtitle2,body1,body2,caption,button,overline,xx-small,x-small,small,medium,large,x-large,xx-large,smaller,larger;image/image;cardLayout[Basic]/select,Basic,BasicHeader,BasicHeaderOverlay,Horizontal;cardStyle[default]/select,default,outlined;labelTextHeight/number;labelSubTextHeight/number;"
        data-vis-attrs0="group.color;colorBackground/color;colorTitleSectionBackground/color;colorTextSectionBackground/color;colorTitle/color;colorSubtitle/color;">
        
        <%
            let initCard = vis.binds.materialdesign.card.initialize(data);
        %>

        <div class="vis-widget materialdesign-widget materialdesign-html-card mdc-card <%= initCard.style %> <%== this.data.attr('class') %>" style="width: 200px; height: 130px;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.materialdesign.card.handler(el, data) %>>
            <%== initCard.card %>
        </div>
</script>

<script id="tplVis-materialdesign-TopAppBar-Navigation"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_top_app_bar_nav_drawer.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="stateful,container,view"
        data-vis-name="Top App Bar Navigation Drawer"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,topAppBar;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,topAppBar;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;showIndexNum/checkbox;navItemCount[1]/number;group.submenus;manual_subMenus/custom,materialdesign.viseditor.manualLink,topAppBarSubMenu;submenuCounts_(0-navItemCount)[0]/number;"
        data-vis-attrs0="group.topAppBarLayout;topAppBarLayout[standard]/select,standard,dense,short;titleTopAppBar[Material Design Widgets]/html;colorTopAppBarTitle/color;colorTopAppBarBackground/color;showSelectedItemAsTitle/checkbox;topAppBarZ_index[998]/number;vibrateTopAppBarOnMobilDevices[50]/number;"
        data-vis-attrs1="group.drawerLayout;drawerLayout[modal]/select,modal,permanent;drawerItemLayout[standard]/select,standard,backdrop;listItemDividerStyle[standard]/select,standard,padded,inset;drawerWidth/number;z_index[1000]/number;showHeader[true]/checkbox;headerLabel[<h4 class='mdc-drawer__title'>Material Design Widgets</h4><h6 class='mdc-drawer__subtitle'>by Scrounger</h6>]/html;showLabels[true]/checkbox;drawerIconHeight/number;listItemAlignment[left]/select,left,center,right;listItemTextSize/auto,headline1,headline2,headline3,headline4,headline5,headline6,subtitle1,subtitle2,body1,body2,caption,button,overline,xx-small,x-small,small,medium,large,x-large,xx-large,smaller,larger;listItemHeaderTextSize/auto,headline1,headline2,headline3,headline4,headline5,headline6,subtitle1,subtitle2,body1,body2,caption,button,overline,xx-small,x-small,small,medium,large,x-large,xx-large,smaller,larger;backdropLabelBackgroundHeight[30]/slider,0,100,1;vibrateDrawerOnMobilDevices[0]/number;"
        data-vis-attrs2="group.drawerColors;colorDrawerBackground/color;colorDrawerItemBackground/color;colorDrawerHeaderBackground/color;colorListItemHover/color;colorListItemSelected/color;colorListItemText/color;colorListItemTextSelected/color;colorListItemHeaders/color;colorListItemDivider/color;colorSubItemToggleIcon/color;colorDrawerbackdropLabelBackground/color;colorDrawerbackdropLabelBackgroundActive/color;"
        data-vis-attrs3="group.drawerSubItemsLayout;drawerSubItemLayout[standard]/select,standard,backdrop;drawerSubItemIconHeight/number;listSubItemAlignment[left]/select,left,center,right;listSubItemTextSize/auto,headline1,headline2,headline3,headline4,headline5,headline6,subtitle1,subtitle2,body1,body2,caption,button,overline,xx-small,x-small,small,medium,large,x-large,xx-large,smaller,larger;showSubItemsLabels[true]/checkbox;backdropSubLabelBackgroundHeight/slider,0,100,1;"
        data-vis-attrs4="group.drawerSubItemsColors;colorDrawerSubBackground/color;colorDrawerSubItemBackground/color;colorListSubItemHover/color;colorListSubItemSelected/color;colorListSubItemText/color;colorListSubItemTextSelected/color;colorDrawerbackdropSubLabelBackground/color;colorDrawerbackdropSubLabelBackgroundActive/color;"
        data-vis-attrs5="group.drawerItems/byindex;labels(0-navItemCount)/html;headers(0-navItemCount)/html;dividers(0-navItemCount)/checkbox;iconDrawer(0-navItemCount)[/vis/widgets/materialdesign/img/IoBroker_Logo.png]/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;iconDrawerColor(0-navItemCount)/color;">
        
        <%
            let initDrawer = vis.binds.materialdesign.topappbarnav.initializeDrawer(data);
            let initTopAppBar = vis.binds.materialdesign.topappbarnav.initializeTopAppBar(data);
        %>

        <div class="vis-widget materialdesign-widget materialdesign-topAppBar-with-Drawer <%== this.data.attr('class') %>" style="width:400px; height: 270px;" id="<%= this.data.attr('wid') %>">
            <div class="drawer-frame-root">
                <aside class="mdc-drawer <%= initDrawer.drawerLayout %>" <%== initDrawer.drawerStyle %> <%= (el) -> vis.binds.materialdesign.topappbarnav.handler(el, data) %>>
                    <%== initDrawer.drawerHeader %>
                    <div class="mdc-drawer__content">
                        <nav class="mdc-list">
                            <%== initDrawer.drawerItemList %>
                        </nav>
                    </div>
                </aside>
                <%== initDrawer.drawerModalScrim %>
                <div class="drawer-frame-app-content">
                    <header class="mdc-top-app-bar drawer-top-app-bar <%== initTopAppBar.headerLayout %>" <%== initTopAppBar.headerStyle %>>
                        <div class="mdc-top-app-bar__row" style="color: <%= this.data.colorTopAppBarTitle %>">
                            <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start">
                                <%== initTopAppBar.headerButtonShow %>
                                <span class="mdc-top-app-bar__title"><%= this.data.titleTopAppBar %></span></section>
                        </div>
                    </header>
                    <div class="mdc-top-app-bar-content <%= initTopAppBar.contentLayout %>">
                    </div>
                </div>
            </div>
        </div>
</script>

<script id="tplVis-materialdesign-List"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_list.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="val,ctrl,state,navigation,static,bool"
        data-vis-name="List"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,list;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,list;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;vibrateOnMobilDevices[50]/number;"
        data-vis-attrs0="group.listLayout;listType[text]/select,text,buttonState,buttonToggle,buttonToggle_readonly,buttonNav,buttonLink,switch,switch_readonly,checkbox,checkbox_readonly;listItemDividerStyle[standard]/select,standard,padded,inset;listLayout[standard]/select,standard,card,cardOutlined;vibrateOnMobilDevices[50]/number;"
        data-vis-attrs1="group.listItemData;listItemDataMethod[inputPerEditor]/select,inputPerEditor,jsonStringObject;countListItems[1]/number;jsonStringObject/html;"
        data-vis-attrs2="group.listItemLayout;listItemHeight/number;listImageHeight/number;listItemAlignment[left]/select,left,center,right;distanceBetweenTextAndImage/number;rightTextWidth/number;listItemBackground/color;listItemBackgroundActive/color;colorSwitchThumb/color;colorSwitchTrack/color;colorSwitchTrue/color;colorSwitchHover/color;colorCheckBox/color;colorListItemHover/color;colorListItemSelected/color;colorListItemText/color;colorListItemTextSecondary/color;colorListItemTextRight/color;colorListItemTextSecondaryRight/color;colorListItemHeaders/color;colorListItemDivider/color;listItemTextSize/auto,headline1,headline2,headline3,headline4,headline5,headline6,subtitle1,subtitle2,body1,body2,caption,button,overline,xx-small,x-small,small,medium,large,x-large,xx-large,smaller,larger;listItemSubTextSize/auto,headline1,headline2,headline3,headline4,headline5,headline6,subtitle1,subtitle2,body1,body2,caption,button,overline,xx-small,x-small,small,medium,large,x-large,xx-large,smaller,larger;listItemTextRightSize/auto,headline1,headline2,headline3,headline4,headline5,headline6,subtitle1,subtitle2,body1,body2,caption,button,overline,xx-small,x-small,small,medium,large,x-large,xx-large,smaller,larger;listItemSubTextRightSize/auto,headline1,headline2,headline3,headline4,headline5,headline6,subtitle1,subtitle2,body1,body2,caption,button,overline,xx-small,x-small,small,medium,large,x-large,xx-large,smaller,larger;listItemHeaderTextSize/auto,headline1,headline2,headline3,headline4,headline5,headline6,subtitle1,subtitle2,body1,body2,caption,button,overline,xx-small,x-small,small,medium,large,x-large,xx-large,smaller,larger;"
        data-vis-attrs3="group.rows/byindex;oid(0-countListItems);groupHeader(0-countListItems)/html;listImage(0-countListItems)/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;listImageColor(0-countListItems)/color;listImageActive(0-countListItems)/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;listImageActiveColor(0-countListItems)/color;label(0-countListItems)/html;subLabel(0-countListItems)/html;rightLabel(0-countListItems)/html;rightSubLabel(0-countListItems)/html;dividers(0-countListItems)/checkbox;listTypeButtonStateValue(0-countListItems);listTypeButtonNav(0-countListItems)/views;listTypeButtonLink(0-countListItems)/url;">
       
        <div class="vis-widget materialdesign-widget materialdesign-list" style="width:400px; height: 270px;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.materialdesign.list(el, data) %>>

        </div>
</script>

<script id="tplVis-materialdesign-Icon-List"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_iconlist.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="val,ctrl,state,navigation,static,bool"
        data-vis-name="Icon List"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,iconList;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,iconList;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;wrapItems[true]/checkbox;maxItemsperRow/number;itemGaps/number;vibrateOnMobilDevices[50]/number;"
        data-vis-attrs0="group.listItemLayout;listLayout[standard]/select,standard,card,cardOutlined;itemBackgroundColor/color;itemLayout[vertical]/select,vertical,horizontal;iconItemMinWidth/number;iconHeight/number;horizontalIconContainerWidth/number;verticalIconContainerHeight/number;buttonLayout[round]/select,round,square,full;buttonHeight/number;buttonColorPress/color;labelFontSize/number;labelFontFamily/fontname;labelFontColor/color;subLabelFontSize/number;subLabelFontFamily/fontname;subLabelFontColor/color;valueFontSize/number;valueFontFamily/fontname;valueFontColor/color;"
        data-vis-attrs1="group.listItemCardBackground;cardUse/checkbox;title/html;titleLayout[headline6]/auto,headline1,headline2,headline3,headline4,headline5,headline6,subtitle1,subtitle2,body1,body2,caption,button,overline,xx-small,x-small,small,medium,large,x-large,xx-large,smaller,larger;colorBackground/color;colorTitleSectionBackground/color;colorTitle/color;"
        data-vis-attrs2="group.lock;autoLockAfter[10]/number;lockIcon/custom,materialdesign.viseditor.materialDesignIcons;lockIconTop[5]/slider,0,100,1;lockIconLeft[5]/slider,0,100,1;lockIconSize/number;lockIconColor/color;lockFilterGrayscale[30]/slider,0,100,1;lockApplyOnlyOnImage[true]/checkbox;"
        data-vis-attrs3="group.listItemData;listItemDataMethod[inputPerEditor]/select,inputPerEditor,jsonStringObject;countListItems[1]/number;json_string_oid/id;"
        data-vis-attrs4="group.rows/byindex;listType(0-countListItems)[text]/select,text,buttonState,buttonToggle,buttonToggleValueTrue,buttonToggleValueFalse,buttonNav,buttonLink;oid(0-countListItems);listTypeButtonStateValue(0-countListItems);typeButtonToggleValueTrue(0-countListItems);typeButtonToggleValueFalse(0-countListItems);listTypeButtonNav(0-countListItems)/views;listTypeButtonLink(0-countListItems)/url;lockEnabled(0-countListItems)/checkbox;itemBackgroundColor(0-countListItems)/color;label(0-countListItems)/html;subLabel(0-countListItems)/html;showValueLabel(0-countListItems)[true]/checkbox;valueAppendix(0-countListItems)/html;buttonBgColor(0-countListItems)/color;buttonBgColorActive(0-countListItems)/color;listImage(0-countListItems)/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;listImageColor(0-countListItems)/color;listImageActive(0-countListItems)/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;listImageActiveColor(0-countListItems)/color;statusBarColor(0-countListItems)/color;">

        <div class="vis-widget materialdesign-widget materialdesign-icon-list <%== this.data.attr('class') %>" style="width:400px; height: 270px;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.materialdesign.iconlist(el, data) %>>

        </div>
</script>

<script id="tplVis-materialdesign-Chart-Bar"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/bar_chart.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="state,chart"
        data-vis-name="Bar Chart"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,barChart;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;chartDataMethod[inputPerEditor]/select,inputPerEditor,jsonStringObject;dataCount[1]/number;oid;chartType[vertical]/select,vertical,horizontal;chartPaddingTop/number;chartPaddingLeft/number;chartPaddingRight/number;chartPaddingBottom/number;"
        data-vis-attrs0="group.chartLayout;backgroundColor/color;chartAreaBackgroundColor/color;disableHoverEffects/checkbox;axisValueMin/number;axisValueMax/number;axisValueStepSize/number;axisValueMinDigits/number;axisValueMaxDigits/number;axisValueAppendText;axisLabelAutoSkip/checkbox;axisMaxLabel/number;animationDuration/number;"
        data-vis-attrs1="group.oids;oid(0-dataCount);"
        data-vis-attrs2="group.barLayout;barLabelText;colorScheme/custom,materialdesign.colorScheme.editorSelector;globalColor/color;hoverColor/color;hoverBorderColor/color;hoverBorderWidth;barWidth/slider,0,100,1;"
        data-vis-attrs3="group.layoutForData/byindex;dataColor(0-dataCount)/color;label(0-dataCount);valueText(0-dataCount);valueTextColor(0-dataCount)/color;labelValueAppend(0-dataCount);tooltipTitle(0-dataCount);tooltipText(0-dataCount);"
        data-vis-attrs4="group.barValuesLayout;showValues[showValuesOn]/select,showValuesOn,showValuesOff,showValuesAuto;valuesSteps/number;valuesMinDecimals/number;valuesMaxDecimals/number;valuesAppendText;valuesFontColor/color;valuesFontFamily/fontname;valuesFontSize/number;valuesPositionAnchor[end]/select,center,start,end;valuesPositionAlign[top]/select,center,start,end,right,bottom,left,top;valuesPositionOffset/number;valuesTextAlign[center]/select,start,center,end,left,right;valuesRotation/slider,0,360,1;"
        data-vis-attrs5="group.yAxisLayout;yAxisPosition[left]/select,left,right;yAxisTitle;yAxisTitleColor/color;yAxisTitleFontFamily/fontname;yAxisTitleFontSize/number;yAxisValueLabelColor/color;yAxisValueFontFamily/fontname;yAxisValueFontSize/number;yAxisValueDistanceToAxis[10]/slider,0,100,1;yAxisShowAxis[true]/checkbox;yAxisShowAxisLabels[true]/checkbox;yAxisShowGridLines[true]/checkbox;yAxisGridLinesColor/color;yAxisGridLinesWitdh;yAxisShowTicks[true]/checkbox;yAxisTickLength/slider,0,100,1;yAxisZeroLineWidth/number,0,100,0.1;yAxisZeroLineColor/color;"
        data-vis-attrs6="group.xAxisLayout;xAxisPosition[bottom]/select,top,bottom;xAxisTitle;xAxisTitleColor/color;xAxisTitleFontFamily/fontname;xAxisTitleFontSize/number;xAxisValueLabelColor/color;xAxisValueFontFamily/fontname;xAxisValueFontSize/number;xAxisValueDistanceToAxis[0]/slider,0,100,1;xAxisShowAxis[true]/checkbox;xAxisShowAxisLabels[true]/checkbox;xAxisShowGridLines[true]/checkbox;xAxisGridLinesColor/color;xAxisGridLinesWitdh;xAxisOffsetGridLines/checkbox;xAxisShowTicks[true]/checkbox;xAxisTickLength/slider,0,100,1;xAxisZeroLineWidth/number,0,100,0.1;xAxisZeroLineColor/color;xAxisMinRotation[0]/slider,0,360,1;xAxisMaxRotation[0]/slider,0,360,1;"
        data-vis-attrs7="group.legendLayout;showLegend/checkbox;legendPosition[right]/select,top,left,bottom,right;legendFontColor/color;legendFontFamily/fontname;legendFontSize/number;legendBoxWidth/slider,0,100,1;legendPointStyle[true]/checkbox;legendPadding/number;"
        data-vis-attrs8="group.tooltipLayout;showTooltip[true]/checkbox;tooltipBackgroundColor/color;tooltipArrowSize/number;tooltipDistanceToBar/number;tooltipBoxRadius/number;tooltipShowColorBox[true]/checkbox;tooltipXpadding/number;tooltipYpadding/number;tooltipTitleFontColor/color;tooltipTitleFontFamily/fontname;tooltipTitleFontSize/number;tooltipTitleMarginBottom/number;tooltipBodyFontColor/color;tooltipBodyFontFamily/fontname;tooltipBodyFontSize/number;tooltipBodyAppend;tooltipValueMinDecimals/number;tooltipValueMaxDecimals/number;">        

        <div class="vis-widget materialdesign-widget materialdesign-chart <%== this.data.attr('class') %>" style="width:400px; height: 270px; background-color: <%= this.data.attr('backgroundColor')%>" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.materialdesign.chart.bar(el, data) %>>
            <canvas class="materialdesign-chart-container"></canvas>
        </div>
</script>

<script id="tplVis-materialdesign-Chart-Line-History"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_line_history_chart.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="state,chart,history"
        data-vis-name="Line History Chart"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,lineHistoryChart;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,lineHistoryChart;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;historyAdapterInstance/history;dataCount[1]/number;aggregate[average]/select,minmax,min,max,average,total;maxDataPoints/number;minTimeInterval/number;timeIntervalToShow[10 minutes]/select,30 seconds,1 minute,2 minutes,5 minutes,10 minutes,30 minutes,1 hour,2 hours,4 hours,8 hours,12 hours,1 day,2 days,3 days,7 days,14 days,1 month,2 months,3 months,6 months,1 year,2 years;time_interval_oid/id;refreshMethod[timeInterval]/select,realtime,timeInterval,byObject;refreshTimeInterval[1 minute]/select,30 seconds,1 minute,2 minutes,5 minutes,10 minutes,30 minutes,1 hour,2 hours,4 hours,8 hours,12 hours,1 day;manualRefreshTrigger/id;chartTimeout[2]/number,0,60,1;mdwDebug/checkbox;"
        data-vis-attrs0="group.chartLayout;backgroundColor/color;chartAreaBackgroundColor/color;disableHoverEffects/checkbox;animationDuration/number;chartPaddingTop/number;chartPaddingLeft/number;chartPaddingRight/number;chartPaddingBottom/number;"
        data-vis-attrs1="group.oids;oid(0-dataCount)/hid/onHidChanged;multiply(0-dataCount);"
        data-vis-attrs2="group.commonYAxis;commonYAxis(0-dataCount)/number;"
        data-vis-attrs3="group.lineLayout;colorScheme/custom,materialdesign.colorScheme.editorSelector;globalColor/color;pointStyle[circle]/select,circle,cross,crossRot,dash,line,rect,rectRounded,rectRot,star,triangle;pointSize/number;pointSizeHover/number;"
        data-vis-attrs4="group.legendLayout;showLegend[true]/checkbox;legendPosition[right]/select,top,left,bottom,right;legendFontColor/color;legendFontFamily/fontname;legendFontSize/number;legendBoxWidth/slider,0,100,1;legendPointStyle[true]/checkbox;legendPadding/number;"
        data-vis-attrs5="group.tooltipLayout;showTooltip[true]/checkbox;tooltipTimeFormats[{&quot;millisecond&quot;:&quot;lll:ss&quot;,&quot;second&quot;:&quot;lll:ss&quot;,&quot;minute&quot;:&quot;lll&quot;,&quot;hour&quot;:&quot;lll&quot;,&quot;day&quot;:&quot;lll&quot;,&quot;week&quot;:&quot;lll&quot;,&quot;month&quot;:&quot;lll&quot;,&quot;quarter&quot;:&quot;lll&quot;,&quot;year&quot;:&quot;lll&quot;}]/html;tooltipBackgroundColor/color;tooltipArrowSize/number;tooltipDistanceToBar/number;tooltipBoxRadius/number;tooltipShowColorBox[true]/checkbox;tooltipXpadding/number;tooltipYpadding/number;tooltipTitleFontColor/color;tooltipTitleFontFamily/fontname;tooltipTitleFontSize/number;tooltipTitleMarginBottom/number;tooltipBodyFontColor/color;tooltipBodyFontFamily/fontname;tooltipBodyFontSize/number;tooltipBodyAppend;tooltipValueMinDecimals/number;tooltipValueMaxDecimals/number;"
        data-vis-attrs6="group.layoutForData/byindex;lineSpanGaps(0-dataCount)[true]/checkbox;steppedLine(0-dataCount)/checkbox;lineTension(0-dataCount)/slider,0,1,0.1;lineThikness(0-dataCount)/number;dataColor(0-dataCount)/color;useFillColor(0-dataCount)/checkbox;fillColor(0-dataCount)/color;pointHoverColor(0-dataCount)/color;legendText(0-dataCount);"
        data-vis-attrs7="group.xAxisLayout;xAxisPosition[bottom]/select,top,bottom;xAxisMaxLabel/number;xAxisBounds[dataSet]/select,dataSet,axisTicks;xAxisTimeFormats[{&quot;millisecond&quot;:&quot;H:mm:ss.SSS&quot;,&quot;second&quot;:&quot;H:mm:ss&quot;,&quot;minute&quot;:&quot;H:mm&quot;,&quot;hour&quot;:&quot;H&quot;,&quot;day&quot;:&quot;ddd DD.&quot;,&quot;week&quot;:&quot;ll&quot;,&quot;month&quot;:&quot;MMM YYYY&quot;,&quot;quarter&quot;:&quot;[Q]Q - YYYY&quot;,&quot;year&quot;:&quot;YYYY&quot;}]/html;xAxisTitle;xAxisTitleColor/color;xAxisTitleFontFamily/fontname;xAxisTitleFontSize/number;xAxisValueLabelColor/color;xAxisValueFontFamily/fontname;xAxisValueFontSize/number;xAxisValueDistanceToAxis[0]/slider,0,100,1;xAxisShowAxis[true]/checkbox;xAxisShowAxisLabels[true]/checkbox;xAxisShowGridLines[true]/checkbox;xAxisGridLinesColor/color;xAxisGridLinesWitdh;xAxisOffsetGridLines/checkbox;xAxisShowTicks[true]/checkbox;xAxisTickLength/slider,0,100,1;axisValueAppendText;xAxisZeroLineWidth/number,0,100,0.1;xAxisZeroLineColor/color;xAxisMinRotation[0]/slider,0,360,1;xAxisMaxRotation[0]/slider,0,360,1;"
        data-vis-attrs8="group.yAxisLayout;yAxisTitleColor/color;yAxisTitleFontFamily/fontname;yAxisTitleFontSize/number;yAxisValueLabelColor/color;yAxisValueFontFamily/fontname;yAxisValueFontSize/number;yAxisValueDistanceToAxis[10]/slider,0,100,1;"
        data-vis-attrs9="group.yAxisLayoutForData/byindex;showYAxis(0-dataCount)[true]/checkbox;yAxisPosition(0-dataCount)[left]/select,left,right;yAxisTitle(0-dataCount);yAxisValueColor(0-dataCount)/color;yAxisMinValue(0-dataCount)/number;yAxisMaxValue(0-dataCount)/number;yAxisStep(0-dataCount)/number;yAxisValueMinDigits(0-dataCount)/number;yAxisValueMaxDigits(0-dataCount)/number;yAxisMaxLabel(0-dataCount)/number;yAxisTitle(0-dataCount);yAxisValueAppendText(0-dataCount);yAxisShowGridLines(0-dataCount)[true]/checkbox;yAxisShowTicks(0-dataCount)[true]/checkbox;yAxisShowAxisBorder(0-dataCount)[true]/checkbox;yAxisGridLinesColor(0-dataCount)/color;yAxisGridLinesWitdh(0-dataCount);yAxisTickLength(0-dataCount)/slider,0,100,1;yAxisZeroLineWidth(0-dataCount)/number,0,100,0.1;yAxisZeroLineColor(0-dataCount)/color;"
        data-vis-attrs10="group.lineValuesLayout/byindex;showValues(0-dataCount)[showValuesOn]/select,showValuesOn,showValuesOff,showValuesAuto;valuesSteps(0-dataCount)/number;valuesMinDecimals(0-dataCount)/number;valuesMaxDecimals(0-dataCount)/number;valuesAppendText(0-dataCount);valuesFontColor(0-dataCount)/color;valuesFontFamily(0-dataCount)/fontname;valuesFontSize(0-dataCount)/number;valuesPositionAnchor(0-dataCount)[end]/select,center,start,end;valuesPositionAlign(0-dataCount)[top]/select,center,start,end,right,bottom,left,top;valuesPositionOffset(0-dataCount)/number;valuesTextAlign(0-dataCount)[center]/select,start,center,end,left,right;valuesRotation(0-dataCount)/slider,0,360,1;">
         <!-- TODO: data-vis-attrs11="group.valueTextColors;valueTextColor(0-dataCount)/color;group.labelValuesAppend;labelValueAppend(0-dataCount);"> -->

        <div class="vis-widget materialdesign-widget materialdesign-chart <%== this.data.attr('class') %>" style="width:400px; height: 270px; background-color: <%= this.data.attr('backgroundColor')%>" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.materialdesign.chart.lineHistory(el, data) %>>
            <div class="material-progress-circular-container">
                <progress class="material-progress-circular"/>
            </div>
            <canvas class="materialdesign-chart-container"></canvas>
        </div>
</script>


<script id="tplVis-materialdesign-Chart-JSON"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_json_chart.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="state,chart"
        data-vis-name="JSON Chart"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,jsonChart;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,jsonChart;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;chartType[bar]/select,bar,line;mdwDebug/checkbox;"
        data-vis-attrs0="group.chartLayout;backgroundColor/color;chartAreaBackgroundColor/color;colorScheme/custom,materialdesign.colorScheme.editorSelector;globalColor/color;disableHoverEffects/checkbox;chartPaddingTop/number;chartPaddingLeft/number;chartPaddingRight/number;chartPaddingBottom/number;animationDuration/number;"
        data-vis-attrs1="group.barLayout;barWidth/slider,0,100,1;"
        data-vis-attrs2="group.legendLayout;showLegend[true]/checkbox;legendPosition[right]/select,top,left,bottom,right;legendFontColor/color;legendFontFamily/fontname;legendFontSize/number;legendBoxWidth/slider,0,100,1;legendPointStyle[true]/checkbox;legendPadding/number;"
        data-vis-attrs3="group.tooltipLayout;showTooltip[true]/checkbox;tooltipMode[nearest]/select,nearest,point,index,dataset;tooltipBackgroundColor/color;tooltipArrowSize/number;tooltipDistanceToBar/number;tooltipBoxRadius/number;tooltipShowColorBox[true]/checkbox;tooltipXpadding/number;tooltipYpadding/number;tooltipTitleFontColor/color;tooltipTitleFontFamily/fontname;tooltipTitleFontSize/number;tooltipTitleMarginBottom/number;tooltipBodyFontColor/color;tooltipBodyFontFamily/fontname;tooltipBodyFontSize/number;tooltipBodyAppend;tooltipValueMinDecimals/number;tooltipValueMaxDecimals/number;"
        data-vis-attrs4="group.xAxisLayout;xAxisPosition[bottom]/select,top,bottom;xAxisMaxLabel/number;xAxisTitle;xAxisTitleColor/color;xAxisTitleFontFamily/fontname;xAxisTitleFontSize/number;xAxisValueLabelColor/color;xAxisValueFontFamily/fontname;xAxisValueFontSize/number;axisLabelAutoSkip/checkbox;xAxisValueDistanceToAxis[0]/slider,0,100,1;xAxisShowAxis[true]/checkbox;xAxisShowAxisLabels[true]/checkbox;xAxisShowGridLines[true]/checkbox;xAxisGridLinesColor/color;xAxisGridLinesWitdh;xAxisOffsetGridLines/checkbox;xAxisShowTicks[true]/checkbox;xAxisTickLength/slider,0,100,1;xAxisZeroLineWidth/number,0,100,0.1;xAxisZeroLineColor/color;xAxisMinRotation[0]/slider,0,360,1;xAxisMaxRotation[0]/slider,0,360,1;"
        data-vis-attrs5="group.yAxisLayout;yAxisTitleColor/color;yAxisTitleFontFamily/fontname;yAxisTitleFontSize/number;yAxisValueLabelColor/color;yAxisValueFontFamily/fontname;yAxisValueFontSize/number;yAxisValueDistanceToAxis[10]/slider,0,100,1;">

        <div class="vis-widget materialdesign-widget materialdesign-chart <%== this.data.attr('class') %>" style="width:400px; height: 270px; background-color: <%= this.data.attr('backgroundColor')%>" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.materialdesign.chart.json(el, data) %>>
            <div class="material-progress-circular-container">
                <progress class="material-progress-circular"/>
            </div>
            <canvas class="materialdesign-chart-container"></canvas>
        </div>
</script>

<script id="tplVis-materialdesign-Chart-Pie"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/pie_chart.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="state,chart"
        data-vis-name="Pie Chart"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,pieChart;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;chartDataMethod[inputPerEditor]/select,inputPerEditor,jsonStringObject;dataCount[1]/number;oid;chartType[pie]/select,pie,doughnut;doughnutCutOut/number,0,100,1;chartPaddingTop/number;chartPaddingLeft/number;chartPaddingRight/number;chartPaddingBottom/number;"
        data-vis-attrs0="group.chartLayout;backgroundColor/color;chartAreaBackgroundColor/color;disableHoverEffects/checkbox;animationDuration/number;"
        data-vis-attrs1="group.oids;oid(0-dataCount);"
        data-vis-attrs2="group.pieLayout;colorScheme/custom,materialdesign.colorScheme.editorSelector;globalColor/color;hoverColor/color;borderColor/color;hoverBorderColor/color;borderWidth;hoverBorderWidth;"
        data-vis-attrs3="group.layoutForData/byindex;dataColor(0-dataCount)/color;label(0-dataCount);valueTextColor(0-dataCount)/color;labelValueAppend(0-dataCount);tooltipTitle(0-dataCount);tooltipText(0-dataCount);"
        data-vis-attrs4="group.pieValuesLayout;showValues[showValuesOn]/select,showValuesOn,showValuesOff,showValuesAuto;valuesSteps/number;valuesMinDecimals/number;valuesMaxDecimals/number;valuesAppendText;valuesFontColor/color;valuesFontFamily/fontname;valuesFontSize/number;valuesPositionAnchor[center]/select,center,start,end;valuesPositionAlign[end]/select,center,start,end,right,bottom,left,top;valuesPositionOffset/number;valuesTextAlign[center]/select,start,center,end,left,right;valuesRotation/slider,0,360,1;"
        data-vis-attrs5="group.legendLayout;showLegend/checkbox;legendPosition[right]/select,top,left,bottom,right;legendFontColor/color;legendFontFamily/fontname;legendFontSize/number;legendBoxWidth/slider,0,100,1;legendPointStyle[true]/checkbox;legendPadding/number;"
        data-vis-attrs6="group.tooltipLayout;showTooltip[true]/checkbox;tooltipBackgroundColor/color;tooltipArrowSize/number;tooltipDistanceToBar/number;tooltipBoxRadius/number;tooltipShowColorBox[true]/checkbox;tooltipXpadding/number;tooltipYpadding/number;tooltipTitleFontColor/color;tooltipTitleFontFamily/fontname;tooltipTitleFontSize/number;tooltipTitleMarginBottom/number;tooltipBodyFontColor/color;tooltipBodyFontFamily/fontname;tooltipBodyFontSize/number;tooltipBodyAppend;tooltipValueMinDecimals/number;tooltipValueMaxDecimals/number;">

        <div class="vis-widget materialdesign-widget materialdesign-chart <%== this.data.attr('class') %>" style="width:400px; height: 270px; background-color: <%= this.data.attr('backgroundColor')%>" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.materialdesign.chart.pie(el, data) %>>
            <canvas class="materialdesign-chart-container"></canvas>
        </div>
</script>

<script id="tplVis-materialdesign-ColorScheme-Preview"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_color_schemes.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="static"
        data-vis-name="Preview Color Schemes"
        data-vis-update-style="true">

        <%
            let preview = vis.binds.materialdesign.colorScheme.preview(data);
        %>

        <div class="vis-widget materialdesign-widget materialdesign-colorscheme mdc-card <%== this.data.attr('class') %>" style="width: 620px; height: 300px; left: 333px; top: 497px; padding: 16px; overflow-y: auto; background: white" id="<%= this.data.attr('wid') %>">
            <span class="mdc-typography--headline6" style="color: #44739e; margin-bottom: 16px;">Material Design Widgets Color Schemes Preview</span>
            <div>   
                <%== preview %>
            </div>
        </div>
</script> 

<script id="tplVis-materialdesign-Vuetify-Dialog-View"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_dialog_view.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="dialog,stateful,container,view"
        data-vis-name="Dialog View"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,dialogView;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,dialogView;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;showDialogMethod[button]/select,button,datapoint;showDialogOid/id;contains_view/views;fullscreenResolutionLower[360]/number;vibrateOnMobilDevices[50]/number;"
        data-vis-attrs0="group.buttonLayout;buttonStyle[raised]/select,text,raised,unelevated,outlined,icon;buttontext/html;colorPress/color;labelWidth/slider,0,100,1;image/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageColor/color;iconPosition[left]/select,left,right;iconHeight/slider,0,200,1;"
        data-vis-attrs1="group.layoutDialog;dialogMaxWidth;viewHeight/number;closingClickOutside[true]/checkbox;viewDistanceToBorder/number;backgroundColor/color;headerHeight/number;headerBackgroundColor/color;footerHeight/number;footerBackgroundColor/color;showDivider/checkbox;dividerColor/color;overlayColor/color;overlayOpacity/slider,0,1,0.1;"
        data-vis-attrs2="group.layoutTitle;showTitle[true]/checkbox;title/html;titleFontSize/number;titleFont/fontname;titleColor/color;"
        data-vis-attrs3="group.layoutdialogCloseButton;buttonPosition[flex-end]/select,flex-start,center,flex-end;buttonSize[medium]/select,small,medium,large;buttonFullWidth/checkbox;buttonText;buttonFontSize/number;buttonFont/fontname;buttonFontColor/color;fullscreenCloseIcon/custom,materialdesign.viseditor.materialDesignIcons;fullscreenCloseIconColor/color;pressColor/color;">
        
        <%
            let init = {button: '', style: ''};
            if (this.data.showDialogMethod === 'button') {
                if (this.data.buttonStyle === 'icon') {
                    init = vis.binds.materialdesign.button.initializeButton(data, true);
                    init.style = 'materialdesign-icon-button ' + init.style; 
                } else {
                    init = vis.binds.materialdesign.button.initializeButton(data);
                    init.style = 'materialdesign-button ' + init.style; 
                }
            } else {
                if (vis.editMode) {
                    init.button = _('dialogUsingDatapoint');
                }
            }
        %>
        
        <div class="vis-widget materialdesign-widget materialdesign-vuetify-dialog <%== init.style %> <%== this.data.attr('class') %>" style="width: 100px; height: 30px; padding: 0px;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.materialdesign.dialog.vue(el, data) %>>
            <%== init.button %>
        </div>
</script>

<script id="tplVis-materialdesign-Vuetify-Dialog-iFrame"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_dialog_view.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="dialog,stateful,container,view"
        data-vis-name="Dialog iFrame"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,dialogView;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,dialogView;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;showDialogMethod[button]/select,button,datapoint;showDialogOid/id;fullscreenResolutionLower[360]/number;vibrateOnMobilDevices[50]/number;"
        data-vis-attrs0="group.iFrame;src;refreshInterval[0]/slider,0,180000,100;noSandbox/checkbox;refreshOnWakeUp/checkbox;refreshOnViewChange/checkbox;refreshWithNoQuery/checkbox;scrollX/checkbox;scrollY/checkbox;seamless[true]/checkbox;"
        data-vis-attrs1="group.buttonLayout;buttonStyle[raised]/select,text,raised,unelevated,outlined,icon;buttontext/html;colorPress/color;labelWidth/slider,0,100,1;image/custom,materialdesign.viseditor.imagesAndMaterialDesignIcons;imageColor/color;iconPosition[left]/select,left,right;iconHeight/slider,0,200,1;"
        data-vis-attrs2="group.layoutDialog;dialogMaxWidth;viewHeight/number;closingClickOutside[true]/checkbox;viewDistanceToBorder/number;backgroundColor/color;headerHeight/number;headerBackgroundColor/color;footerHeight/number;footerBackgroundColor/color;showDivider/checkbox;dividerColor/color;overlayColor/color;overlayOpacity/slider,0,1,0.1;"
        data-vis-attrs3="group.layoutTitle;showTitle[true]/checkbox;title/html;titleFontSize/number;titleFont/fontname;titleColor/color;"
        data-vis-attrs4="group.layoutdialogCloseButton;buttonPosition[flex-end]/select,flex-start,center,flex-end;buttonSize[medium]/select,small,medium,large;buttonFullWidth/checkbox;buttonText;buttonFontSize/number;buttonFont/fontname;buttonFontColor/color;fullscreenCloseIcon/custom,materialdesign.viseditor.materialDesignIcons;fullscreenCloseIconColor/color;pressColor/color;">
        
        <%
            let init = {button: '', style: ''};
            if (this.data.showDialogMethod === 'button') {
                if (this.data.buttonStyle === 'icon') {
                    init = vis.binds.materialdesign.button.initializeButton(data, true);
                    init.style = 'materialdesign-icon-button ' + init.style; 
                } else {
                    init = vis.binds.materialdesign.button.initializeButton(data);
                    init.style = 'materialdesign-button ' + init.style; 
                }
            } else {
                if (vis.editMode) {
                    init.button = _('dialogUsingDatapoint');
                }
            }
        %>

        <div class="vis-widget materialdesign-widget materialdesign-vuetify-dialog <%== init.style %> <%== this.data.attr('class') %>" style="width: 100px; height: 30px; padding: 0px;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.materialdesign.dialog.vue(el, data, true) %>>
            <%== init.button %>
        </div>
</script>

<script id="tplVis-materialdesign-Table"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_table.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="table"
        data-vis-name="Table"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,table;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,table;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;dataJson/html;countCols[1]/number;"
        data-vis-attrs0="group.tableLayout;tableLayout[standard]/select,standard,card,cardOutlined;showHeader[true]/checkbox;fixedHeader/checkbox;headerRowHeight/number;headerTextSize[headline6]/auto,headline1,headline2,headline3,headline4,headline5,headline6,subtitle1,subtitle2,body1,body2,caption,button,overline,xx-small,x-small,small,medium,large,x-large,xx-large,smaller,larger;headerFontFamily/fontname;rowHeight/number;"
        data-vis-attrs1="group.color;colorBackground/color;colorHeaderRowBackground/color;colorHeaderRowText/color;colorRowBackground/color;colorRowBackgroundHover/color;colorRowText/color;borderColor/color;dividers/color;"
        data-vis-attrs2="group.columnLayout/byindex;showColumn(0-countCols)[true]/checkbox;colType(0-countCols)[text]/select,text,image;columnWidth(0-countCols)/number;colNoWrap(0-countCols)/checkbox;label(0-countCols)/html;textAlign(0-countCols)[center]/select,left,right,center;colTextSize(0-countCols)/auto,headline1,headline2,headline3,headline4,headline5,headline6,subtitle1,subtitle2,body1,body2,caption,button,overline,xx-small,x-small,small,medium,large,x-large,xx-large,smaller,larger;padding_left(0-countCols)/number;padding_right(0-countCols)/number;fontFamily(0-countCols)/fontname;colTextColor(0-countCols)/color;prefix(0-countCols)/html;suffix(0-countCols)/html;imageSize(0-countCols)/number;sortKey(0-countCols);">

        <%
            let overflow = 'overflow: visible;';
            if (this.data.tableLayout === 'standard') {
                overflow = '';
            }
        %>

        <div class="vis-widget materialdesign-widget materialdesign-table <%== this.data.attr('class') %>" style="width: 400px; height: 250px; <%== overflow %>" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.materialdesign.table.handle(el, data) %>>

        </div>
</script>

<script id="tplVis-materialdesign-Masonry-Views"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_masonry_views.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="container,view"
        data-vis-name="Masonry Views"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,masonry;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,masonry;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;countCols/number;desktopGaps/number;countViews[3]/number;viewAlignment[center]/select,left,center,right,justify;showResolutionAssistant[true]/checkbox;"
        data-vis-attrs0="group.handySettings;handyPortraitWidth/number;handyPortraitCols/number;handyPortraitGaps/number;handyLandscapeWidth/number;handyLandscapeCols/number;handyLandscapeGaps/number;"
        data-vis-attrs1="group.tabletSettings;tabletPortraitWidth/number;tabletPortraitCols/number;tabletPortraitGaps/number;tabletLandscapeWidth/number;tabletLandscapeCols/number;tabletLandscapeGaps/number;"
        data-vis-attrs2="group.View/byindex;View(0-countViews)/views;viewsHeight(0-countViews)/number;viewsWidth(0-countViews);viewSortOrder(0-countViews)/number;visibleResolutionGreaterThan(0-countViews)/number;visibleResolutionLessThan(0-countViews)/number;visibilityOid(0-countViews)/id;visibilityCondition(0-countViews)[==]/custom,materialdesign.viseditor.visibilityCondition;visibilityConditionValue(0-countViews);">

        <div class="vis-widget materialdesign-widget materialdesign-masonry-views <%== this.data.attr('class') %>" style="width: 100%; height: 100%;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.materialdesign.views.masonry(el, data) %>> 

        </div>
</script>

<script id="tplVis-materialdesign-Grid-Views"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_grid_views.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="container,view"
        data-vis-name="Grid Views"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,grid;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,grid;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;countViews[3]/number;desktopGaps/number;viewVertAlignment[center]/select,center,flex-start,flex-end;viewHorAlignment[center]/select,center,flex-start,flex-end,space-around,space-between;viewColSpan/number,1,12,1;showResolutionAssistant[true]/checkbox;"
        data-vis-attrs0="group.handySettings;handyGridPortraitColSpan/number,1,12,1;handyPortraitWidth/number;handyPortraitGaps/number;handyGridLandscapeColSpan/number,1,12,1;handyLandscapeWidth/number;handyLandscapeGaps/number;"
        data-vis-attrs1="group.tabletSettings;tabletGridPortraitColSpan/number,1,12,1;tabletPortraitWidth/number;tabletPortraitGaps/number;tabletGridLandscapeColSpan/number,1,12,1;tabletLandscapeWidth/number;tabletLandscapeGaps/number;"
        data-vis-attrs2="group.View/byindex;View(0-countViews)/views;viewsHeight(0-countViews)/number;viewSortOrder(0-countViews)/number;viewColSpan(0-countViews)/number,1,12,1;handyGridPortraitColSpan(0-countViews)/number,1,12,1;handyGridLandscapeColSpan(0-countViews)/number,1,12,1;tabletGridPortraitColSpan(0-countViews)/number,1,12,1;tabletGridLandscapeColSpan(0-countViews)/number,1,12,1;visibleResolutionGreaterThan(0-countViews)/number;visibleResolutionLessThan(0-countViews)/number;visibilityOid(0-countViews)/id;visibilityCondition(0-countViews)[==]/custom,materialdesign.viseditor.visibilityCondition;visibilityConditionValue(0-countViews);">

        <div class="vis-widget materialdesign-widget materialdesign-grid-views <%== this.data.attr('class') %>" style="width: 100%; height: 100%;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.materialdesign.views.grid(el, data) %>> 

        </div>
</script>

<script id="tplVis-materialdesign-Alerts"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_alerts.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="messages"
        data-vis-name="Alerts"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,alerts;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,alerts;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;showMaxAlerts[3]/number;minScreenResolution/number;"
        data-vis-attrs0="group.alertLayout;alertLayouts[normal]/select,normal,outlined,tile;alertDense[true]/checkbox;alertElevation[1]/slider,0,24,1;alertMarginBottom[16]/number;alertBorderLayout[none]/select,none,top,right,left,bottom;alertFontSize/number;alertFontFamily/fontname;alertIconSize/number;closeIcon[close-circle-outline]/custom,materialdesign.viseditor.materialDesignIcons;closeIconColor/color;closeIconPressColor/color;">

        <div class="vis-widget materialdesign-widget materialdesign-alerts <%== this.data.attr('class') %>" style="width: 150px; height: 38px; overflow: visible; pointer-events:none;" id="<%= this.data.attr('wid') %>"> 
            <div class="materialdesign-vuetify-alerts" style="width: 100%; pointer-events: auto;" <%= (el) -> vis.binds.materialdesign.alerts(el, data) %>>
            
            </div>
        </div>
</script>

<script id="tplVis-materialdesign-Calendar"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/materialdesign/img/calendar.png"></img>'
        data-vis-set="materialdesign"
        data-vis-type="messages"
        data-vis-name="Calendar"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,calendar;questionsAndAnswers/custom,materialdesign.viseditor.questionsAndAnswers,calendar;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;oid;calendarView[month]/select,month,week,day;vibrateOnMobilDevices[50]/number;"
        data-vis-attrs0="group.calendarLayout;calendarWeekdays[1,2,3,4,5,6,0];calendarShortWeekdays/checkbox;calendarBorderColor/color;calendarDayBackgroundColor/color;calendarDayBackgroundOutsideColor/color;"
        data-vis-attrs1="group.calendarHeaderLayout;calendarHeaderBackground/color;calendarDayLabelFontSize/number;calendarDayLabelFontFamily/fontname;calendarDayLabelFontColor/color;calendarDayLabelPreviousFontColor/color;calendarDayLabelTodayFontSize/number;calendarDayLabelTodayFontFamily/fontname;calendarDayLabelTodayFontColor/color;"
        data-vis-attrs2="group.calendarButtonsLayout;calendarDayButtonMonthViewGoTo[week]/select,week,day;calendarDayButtonWeekViewGoTo[day]/select,month,day;calendarDayButtonDayViewGoTo[week]/select,month,week;calendarDayButtonRippleEffectColor/color;calendarDayButtonColor/color;calendarDayButtonFontSize/number;calendarDayButtonFontFamily/fontname;calendarDayButtonFontColor/color;calendarDayButtonTodayColor/color;calendarDayButtonTodayFontSize/number;calendarDayButtonTodayFontFamily/fontname;calendarDayButtonTodayFontColor/color;"
        data-vis-attrs3="group.controlLayout;controlShow[true]/checkbox;controlButtonLayout[text]/select,text,raised,unelevated,outlined;controlPosition[stretch]/select,stretch,left,right,center;controlMinWidth/number;controlShowLabel[true]/checkbox;controlButtonColor/color;controlButtonRippelEffectColor/color;controlIconSize/number;controlIconColor/color;controlTextSize/number;controlTextFont/fontname;controlTextColor/color;"
        data-vis-attrs4="group.calendarTimeAxisLayout;calendarTimeAxisStartTime/number,0,24,1;calendarTimeAxisEndTime/number,1,24,1;calendarTimeAxisIntervalMinutes/number;calendarTimeAxisBackgroundColor/color;calendarTimeAxisWidth/number;calendarTimeAxisHeight/number;calendarTimeAxisShortIntervals[true]/checkbox;calendarTimeAxisHeaderBackgroundColor/color;calendarTimeAxisFontSize/number;calendarTimeAxisFont/fontname;calendarTimeAxisFontColor/color;"
        data-vis-attrs5="group.calendarEventLayout;calendarEventOverlapMode[column]/select,column,stack;calendarEventHeight/number;calendarEventFontSize/number;calendarEventFont/fontname;">
        <div class="vis-widget materialdesign-widget materialdesign-calendar <%== this.data.attr('class') %>" style="width: 150px; height: 38px; overflow: visible;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.materialdesign.calendar(el, data) %> > 
            
        </div>
</script>

<script id="tplVis-materialdesign-Icon"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="materialdesign"
        data-vis-type="static"
        data-vis-prev='<img src="widgets/materialdesign/img/prev_icon.png"></img>'
        data-vis-name="Material Design Icon"
        data-vis-attrs="mdwIcon/custom,materialdesign.viseditor.materialDesignIcons;mdwIconSize/number;mdwIconColor/color;exportData/custom,materialdesign.viseditor.exportData,materialdesignicon;">

        <div class="vis-widget materialdesign-widget materialdesign-icon <%== this.data.attr('class') %>" style="width: 50px; height: 50px;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.materialdesign.materialdesignicons.initialize(el, data) %> > 
            
        </div>
</script>


<script id="tplVis-materialdesign-Installed-Version"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplVis-materialdesign-Installed-Version" style="position: relative; text-align: initial; padding: 4px "><div class="vis-widget_prev materialdesign-installed-version vis-tpl-materialdesign-Installed Version " style="width: 120px; height: 22px; text-align: center; left: calc(50% - 170px); top: calc(50% + 55px); font-family: Tahoma, Geneva, sans-serif; position: absolute; z-index: 700;" data-tmodified="true" data-zmodified="true"> <div class="materialdesign-version-container"> <div class="materialdesign-version-content" style="background: #5a5a5a; border-radius: 4px 0 0 4px;">installed</div> <div id="versionNumber" class="materialdesign-version-content" style="background: #45b31b; border-radius: 0 4px 4px 0;">x.x.x</div> </div> <div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-w" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-nw" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-ne" style="z-index: 90;"></div><div class="ui-resizable-handle ui-resizable-sw" style="z-index: 90;"></div></div></div>'
        data-vis-set="materialdesign"
        data-vis-type="tools"        
        data-vis-name="Installed Version"
        data-vis-update-style="true"
        data-vis-attrs="manual/custom,materialdesign.viseditor.manualLink,columnViews;donate/custom,materialdesign.viseditor.bmc;onlineExampleProject/custom,materialdesign.viseditor.onlineExample;">    

        <div class="vis-widget materialdesign-widget materialdesign-installed-version <%== this.data.attr('class') %>" style="width: 120px; height: 20px; text-align: center;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.materialdesign.helper.installedVersion(el, data) %>> 
            <div class="materialdesign-version-container">
                <div class="materialdesign-version-content" style="background: #5a5a5a; border-radius: 4px 0 0 4px;">installed</div>
                <div id="versionNumber" class="materialdesign-version-content" style="background: #45b31b; border-radius: 0 4px 4px 0;">0.2.39</div>  
            </div>
        </div>
</script>
<!-- --------------materialdesign.html--- END -->
<!-- --------------metro.html--- START -->
<!--

    ioBroker.vis Metro Widget-Set

    version: "1.1.2"

    6'2014-2017 hobbyquaker, bluefox

    based on http://metroui.org.ua/

    TODO:
        - Attribute für vordefinierte fg-CSS-Klassen
        - Attribute für font-size, text-align, color, padding, margin in tile.content
        - Tile das JSON-Tabellen durchscrollt
        - content_oid Attribut für mehr Tiles
        - Doku

-->

<link rel="stylesheet" href="widgets/metro/css/iconFont.min.css" />
<link rel="stylesheet" href="widgets/metro/css/metro-bootstrap.css" />
<script type="text/javascript" src="widgets/metro/js/metro.js"></script>

<script type="text/javascript">

    'use strict';
    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {

            "select_current": {
                "en": "Select current view",
                "de": "Aktuelle View selektieren",
                "ru": "Отметить текущую"
            },
            "label":            {"en": "Label",             "de": "Beschriftung",           "ru": "Надпись"},
            "autoclose":        {"en": "Auto close",        "de": "Auto-zu",                "ru": "Автозакрытие"},
            "label_prepend":    {"en": "Label prepend",     "de": "Vor Beschriftung",       "ru": "Перед надписью"},
            "label_append":     {"en": "Label append",      "de": "Nach Beschriftung",      "ru": "После надписи"},
            "badge_label":      {"en": "Badge text",        "de": "Abzeichentext",          "ru": "Текст в бирке"},
            "dialog_url":       {"en": "Dialog URL",        "de": "Dialog URL",             "ru": "URL фрейма в диалоге"},
            "dialog_scroll":    {"en": "Scroll in iFrame",  "de": "Scroll im iFrame",       "ru": "Скролл в диалоге"},
            "icon":             {"en": "Icon URL",          "de": "Icon URL",               "ru": "URL иконки"},
            "icon_src":         {"en": "Icon URL",          "de": "Icon URL",               "ru": "URL иконки"},
            "icon_width":       {"en": "Icon width",        "de": "Iconbreite",             "ru": "Ширина иконки"},
            "icon_height":      {"en": "Icon height",       "de": "Iconhöhe",               "ru": "Высота иконки"},
            "icon_top":         {"en": "Icon left",         "de": "Icon-Offset von oben",   "ru": "Сдвиг иконки сверху"},
            "icon_left":        {"en": "Icon top",          "de": "Icon-Offset von links",  "ru": "Сдвиг иконки слева"},
            "icon_class":       {"en": "Icon class",        "de": "Ikonenklasse",           "ru": "Иконка"},
            "icon_badge":       {"en": "Icon badge",        "de": "Abzeichenikone",         "ru": "Иконка бирки"},
            "bg_class":         {"en": "Background",        "de": "Hintergrund",            "ru": "Фон"},
            "bg_class_active":  {"en": "Background active", "de": "Aktiver Hintergrund",    "ru": "Акивный Фон"},
            "badge_bg_class":   {"en": "Badge background",  "de": "Abzeichen- Hintergrund", "ru": "Фон бирки"},
            "badge_bg_class_active": {
                "en": "Badge background active",
                "de": "Aktiver Abzeichen- Hintergrund",
                "ru": "Фон активной бирки"
            },
            "brand_bg_class":   {"en": "Brand background", "de": "Brand- Hintergrund",      "ru": "Фон полоски"},
            "brand_bg_class_active": {
                "en": "Brand background active",
                "de": "Aktiver Brand- Hintergrund",
                "ru": "Фон активной полоски"
            },
            "badge_src":        {"en": "Badge URL",         "de": "Abzeichen URL",          "ru": "URL бирки"},
            "badge_src_false":  {"en": "Badge URL",         "de": "Abzeichen URL",          "ru": "URL бирки"},
            "badge_src_true":   {"en": "Badge URL by true", "de": "Aktiv-Abzeichen URL",    "ru": "URL активной URL"},
            "badge_width":      {"en": "Badge width[%]",    "de": "Abzeichen-Breite[%]",    "ru": "Ширина бирки"},
            "badge_height":     {"en": "Badge height[%]",   "de": "Abzeichen-Höhe[%]",      "ru": "Высота бирки"},
            "badge_top":        {"en": "Badge top[%]",      "de": "Abzeichen-Top[%]",       "ru": "Отступ сверху для бирки"},
            "badge_left":       {"en": "Badge left[%]",     "de": "Abzeichen-Links[%]",     "ru": "Отступ слева для бирки"},
            "group_icon":       {"en": "Icon",              "de": "Icon",                  "ru": "Иконка"},
            "group_badge":      {"en": "Badge",             "de": "Abzeichen",              "ru": "Бирка"},
            "group_bg-and-text": {"en": "Background and label", "de": "Hintergrund und Titel", "ru": "Фон и надпись"},
            "group_dialog":     {"en": "Dialog",            "de": "Dialog",                 "ru": "Диалог"},
	        "group_brand":      {"en": "Brand",             "de": "Brand",                  "ru": "Brand"},
            "transform":        {"en": "Transform",         "de": "Druckeffekt",            "ru": "Эффект нажатия"},
            "hover":            {"en": "Hover effect",      "de": "Hover-Effekt",           "ru": "Реакция на курсор"},
            "oid-working":      {"en": "Working state ID",  "de": "In Arbeit Zustand ID",   "ru": "'В работе' ID"},
            "min":              {"en": "Min",               "de": "Min",                    "ru": "Минимум"},
            "max":              {"en": "Max",               "de": "Max",                    "ru": "Максимум"},
            "step":             {"en": "Step",              "de": "Schritt",                "ru": "Шаг"},
            "sliderColor":      {"en": "Slider color",      "de": "Schieberfarbe",          "ru": "Цвет ползунка"},
            "sliderCompleteColor": {
                "en": "Slider complete color",
                "de": "Voll Schieberfarbe",
                "ru": "Цвет ползунка (Полный)"
            },
            "sliderMarkerColor": {"en": "Slider handle color", "de": "Schiebergrifffarbe",  "ru": "Цвет ручки"},
            "content_oid":      {"en": "Content ID",        "de": "Inhalt ID",              "ru": "ID Содержания"},
            "dialog_oid":       {"en": "Dialog ID",         "de": "Dialog ID",              "ru": "ID Текста для диалога"},
            "number_oid":       {"en": "Number ID",         "de": "Nummer ID",              "ru": "ID Числа"},
            "hide_on_0":        {"en": "Hide by 0",         "de": "Verbergen bei 0",        "ru": "Скрыть при 0"},
            "dialog_fontSize":  {"en": "Dialog font size",  "de": "Dialogschriftgrösse",    "ru": "Размер шрифта"},
            "dialog_padding":   {"en": "Dialog padding",    "de": "Dialog padding",         "ru": "Отступ"},
            "dialog_textAlign": {"en": "Dialog text align", "de": "Dialogtextausrichtung",  "ru": "Выравнивание текста"},
            "dialog_width":     {"en": "Dialog width",      "de": "Dialogbreite",           "ru": "Ширина"},
            "dialog_height":    {"en": "Dialog height",     "de": "Dialoghöhe",             "ru": "Высота"},
            "dialog_title":     {"en": "Title",             "de": "Titel",                  "ru": "Надпись"},
            "dialog_flat":      {"en": "Flat Design",       "de": "Flaches Design",         "ru": "Плоский дизайн"},
            "dialog_shadow":    {"en": "Shadow",            "de": "Fensterschatten",        "ru": "Показать тень"},
            "dialog_draggable": {"en": "Draggable",         "de": "Konnte verschoben werden", "ru": "Можно двигать"},
            "dialog_modal":     {"en": "Modal",             "de": "Modaldialog",            "ru": "Модальное окно"},
            "dialog_icon_src":  {"en": "Icon URL",          "de": "Ikone URL",              "ru": "URL иконки"},
            "dialog_icon_class": {"en": "Icon class",       "de": "Ikoneklasse",            "ru": "Класс иконки"},
            "Select ID":        {"en": "Select ID",         "de": "Select ID",              "ru": "Select ID"},
            "state_oid":        {"en": "State ID",          "de": "Zustand ID",             "ru": "ID Статуса"},
            "select_on_true":   {"en": "Select by true",    "de": "Selektieren bei Wahr",   "ru": "Отметить при 1"},
            "label_true":       {"en": "Label if true",     "de": "Schild bei Wahr",        "ru": "Надпись при 1"},
            "label_false":      {"en": "Label if false",    "de": "Schild bei Falsch",      "ru": "Надпись при 0"},
            "bg_class_true":    {"en": "Background by true", "de": "Hintergrund bei Wahr",  "ru": "Фон при 1"},
            "bg_class_false":   {"en": "Background by false", "de": "Hintergrund bei Falsch", "ru": "Фон при 0"},
            "icon_true_src":    {"en": "Icon URL by true",  "de": "Ikone URL bei Wahr",     "ru": "URL иконки при 1"},
            "icon_false_src":   {"en": "Icon URL by false", "de": "Ikone URL bei Falsch",   "ru": "URL иконки при 0"},
            "icon_true_src_tooltip": {
                "en": "To center the image select 'icon-custom' class",
                "de": "Um das Bild zu zentrieren, muss 'icon-custom' Klasse gewählt werden",
                "ru": "Для помещения картинки в центре выберите 'icon-custom' класс"
            },
            "icon_false_src_tooltip": {
                "en": "To center the image select 'icon-custom' class",
                "de": "Um das Bild zu zentrieren, muss 'icon-custom' Klasse gewählt werden",
                "ru": "Для помещения картинки в центре выберите 'icon-custom' класс"
            },
            "icon_class_true": {
                "en": "Icon class by true",
                "de": "Ikonenklasse URL bei Wahr",
                "ru": "Класс иконки при 1"
            },
            "icon_class_false": {
                "en": "Icon class by false",
                "de": "Ikonenklasse URL bei Falsch",
                "ru": "Класс иконки при 0"
            },
            "badge_bg_class_true": {
                "en": "Badge background by true",
                "de": "Abzeichen- Hintergrund bei Wahr",
                "ru": "Фон бирки при 1"
            },
            "badge_bg_class_false": {
                "en": "Badge background by false",
                "de": "Abzeichen- Hintergrund bei Falsch",
                "ru": "Фон бирки при 0"
            },
            "brand_bg_class_true": {
                "en": "Brand background by true",
                "de": "Brand- Hintergrund bei Wahr",
                "ru": "Фон полоски при 1"
            },
            "brand_bg_class_false": {
                "en": "Brand background by false",
                "de": "Brand- Hintergrund bei Falsch",
                "ru": "Фон полоски при 0"
            },
            "icon_true":        {"en": "Icon by true",      "de": "Ikone bei Wahr",         "ru": "Иконка при 1"},
            "icon_false":       {"en": "Icon by false",     "de": "Ikone bei Falsch",       "ru": "Иконка при 0"},
            "icon_badge_true":  {"en": "Badge icon by true", "de": "Abzeichenikone bei Wahr", "ru": "Иконка бирки при 1"},
            "icon_badge_false": {
                "en": "Badge icon by false",
                "de": "Abzeichenikone bei Falsch",
                "ru": "Иконка бирки при 0"
            },
            "value":            {"en": "Value",             "de": "Wert",                   "ru": "Значение"},
            "select_on_value":  {"en": "Select on value",   "de": "Selektieren by Wert",    "ru": "Отметить при значении"},
            "group_slider":     {"en": "Slider",            "de": "Schieber",               "ru": "Ползунок"},
            "content_prepend":  {"en": "Сontent prepend",   "de": "Inhaltprefix",           "ru": "Префикс содержания"},
            "content_append":   {"en": "Сontent append",    "de": "Inhaltsuffix",           "ru": "Суффику содержания"},
            "label_id":         {"en": "Label ObjectID",    "de": "Beschriftung ObjectID",  "ru": "ObjectID надписи"},
            "hum_oid":          {"en": "Humidity ID",       "de": "Luftfeutigkeit ID",      "ru": "ID влажности"},
            "label_humidity":   {"en": "Label for humidity", "de": "Beschriftung Luftfeutigkeit", "ru": "Подпись влажности"},
            "lowbat_oid":       {"en": "Low battery ID",    "de": "Low battery ID",         "ru": "ID низкого заряда батареи"},
            "controlmode_oid":  {"en": "Control mode ID",   "de": "Kontrollmodus ID",       "ru": "ID Режима управления"},
            "windowopen_oid":   {"en": "Window open ID",    "de": "Fenstersensor ID",       "ru": "Сенсор окна ID"}
        });
    }

    $.extend(true, systemDictionary, {
        "Set temperature":      {"en": "Set temperature",   "de": "Soll-Temperatur",    "ru": "Выставленная темп."},
        "Actual temp.":         {"en": "Actual temp.",      "de": "Ist-Temperatur",     "ru": "Актуальная темп."},
        "Valve position":       {"en": "Valve position",    "de": "Ventilstellung",     "ru": "Позиция вентиля"},
        "Humidity":             {"en": "Humidity",          "de": "Luftfeuchtigkeit",   "ru": "Влажность"},
        "Target":               {"en": "Target",            "de": "Soll",               "ru": "Должно"},
        "Actual":               {"en": "Now",               "de": "Ist",                "ru": "Сейчас"},
        "group_service":        {"en": "Service",           "de": "Service",            "ru": "Сервис"},
        "icon_lowbat":          {"en": "Icon low battery",  "de": "Icon Batterie leer", "ru": "Иконка низкого заряда батареи"},
        "icon_control_mode_0":  {"en": "Icon auto mode",    "de": "Icon Auto Modus",    "ru": "Иконка для авто-режима"},
        "icon_control_mode_1":  {"en": "Icon manual mode",  "de": "Icon man. Modus",    "ru": "Иконка для ручного режима"},
        "icon_control_mode_2":  {"en": "Icon party mode",   "de": "Icon Party Modus",   "ru": "Иконка для режима вечеринки"},
        "icon_control_mode_3":  {"en": "Icon boost mode",   "de": "Icon Boost Modus",   "ru": "Иконка для режима наддува"},
        "icon_windowopen":      {"en": "Icon window open",  "de": "Icon Fenster offen", "ru": "Иконка открытого окна"}
    });

    vis.navChangeCallbacks.push(function (view) {
        $('.vis-metro-nav').each(function () {
            var $this = $(this);
            if ($this.attr('data-metro-nav') === view) {
                if ($this.attr('data-metro-nav-select') === 'true') {
                    $this.addClass("selected");
                }
                $this.addClass($this.attr('data-metro-class-active'));
                if ($this.attr('data-metro-class-active') !== $this.attr('data-metro-class')) {
                    $this.removeClass($this.attr('data-metro-class'));
                }
            } else {
                $this.addClass($this.attr('data-metro-class'));
                if ($this.attr('data-metro-class-active') !== $this.attr('data-metro-class')) {
                    $this.removeClass($this.attr('data-metro-class-active'));
                }
                $this.removeClass('selected');
            }
        });
    });

    vis.binds.metro = {
        version: "1.1.2",
        format: function (value, type, mustValue) {
            if (!type || type === 'bool') {

                return '_' + !(!value || value === 'false' || value === '0');

            } else if (type == 10) {

                if (!value || value === 'false' || value === '0') value = 0;
                if (value === 'true' || value === true) value = 1;
                return parseInt(value, 10);

            } else if (type === 'compare') {

                if (!value || value === 'false' || value === '0') value = 0;
                if (value === 'true' || value === true) value = 1;

                if (mustValue === 'true'  || mustValue === '1')  mustValue = 1;
                if (mustValue === 'false' || mustValue === '0') mustValue = 0;

                return '_' + (value == mustValue);
            } else if (type === '%') {
                if (value !== undefined && (typeof value === 'number' || typeof value === 'string')) value = parseFloat(value).toFixed(0) + '%';
                if (value === undefined) value = '';
                return value;
            }  else if (type === '°') {
                if (value !== undefined && (typeof value === 'number' || typeof value === 'string')) value = parseFloat(value).toFixed(1) + '°C';
                if (value === undefined) value = '';
                return value;
            }
            return value;
        },
        inputControl: function (el) {
            var $this = $(el).parent().find('input');
        },
        slider: function (el, options) {
            var $this = $(el).parent().find('.slider');
            var oid     = $this.attr('data-oid');
            var wid     = $this.attr('data-oid-working');

            if (!oid && options.hideIfNoOid) {
                $this.hide();
                return;
            }

            var min = (options.min === undefined || options.min === null || options.min === '') ? 0.00 : parseFloat(options.min);
            var max = (options.max === undefined || options.min === null || options.max === '') ? 1.00 : parseFloat(options.max);

            if (max < min) {
                var tmp = max;
                max = min;
                min = tmp;
            }
            var val = vis.states.attr(oid + '.val');
            if (val === true  || val === 'true')  val = max;
            if (val === false || val === 'false') val = min;
            val = parseFloat(val);
            if (isNaN(val)) val = min;

            if (val < min) val = min;
            if (val > max) val = max;

            options.min = min;
            options.max = max;
            options.simRange = 100;
            options.range    = options.max - options.min;
            options.factor   = options.simRange / options.range;
            val = Math.floor((val - options.min) * options.factor);

            $this.metroSlider({
                min:           0,
                max:           options.simRange,
                accuracy:      options.accuracy      || 0,
                color:         options.color         || undefined,
                completeColor: options.completeColor || undefined,
                markerColor:   options.markerColor   || undefined,
                position:      val,
                animate:       true,
                change:        function (val) {
                    val = (parseFloat(val) / options.factor) + options.min;
                    if (options.step) {
                        val = Math.round(val / options.step) * options.step;
                    }
                    if (options.digits !== undefined && options.digits !== null && options.digits !== '') {
                        vis.setValue(oid, val.toFixed(options.digits));
                        //vis.setValue(oid, parseFloat(val).toFixed(options.digits));
                    } else {
                        vis.setValue(oid, val);
                        //vis.setValue(oid, parseFloat(val));
                    }
                },
                changed:       function (val) {

                }
            });

            vis.states.bind(oid + '.val', function (e, newVal, oldVal) {
                var val = vis.states.attr(oid + '.val');

                if (val === true  || val === 'true')  val = options.max;
                if (val === false || val === 'false') val = options.min;

                val = parseFloat(val);
                if (isNaN(val)) val = options.min;
                if (val < options.min) val = options.min;
                if (val > options.max) val = options.max;
                val = Math.floor((val - options.min) * options.factor);

                try {
                    $this.metroSlider('value', val);
                } catch (e) {
                    console.error(e);
                }
            });
        },
        tile: function (el, transform) {
            var $this = $(el).parent().find('.tile');
            if (transform) $this.tileTransform();

            setTimeout(function () {
                $('.vis-metro-nav').each(function () {
                    var $this = $(this);
                    if ($this.attr('data-metro-nav') === vis.activeView) {
                        if ($this.attr('data-metro-nav-select') === 'true') {
                            $this.addClass('selected');
                        }
                        $this.addClass($this.attr('data-metro-class-active'));
                        if ($this.attr('data-metro-class-active') !== $this.attr('data-metro-class')) {
                            $this.removeClass($this.attr('data-metro-class'));
                        }
                    } else {
                        $this.addClass($this.attr('data-metro-class'));
                        if ($this.attr('data-metro-class-active') !== $this.attr('data-metro-class')) {
                            $this.removeClass($this.attr('data-metro-class-active'));
                        }
                        $this.removeClass('selected');
                    }
                });
            }, 100);
        },
        tileDialog: function (el, wid, view, options, html, isIframe) {
            var $this = $(el).parent().find('.tile');

            var width  = parseInt(options.width, 10);
            var height = parseInt(options.height, 10);

            if (isNaN(width))  width = undefined;
            if (isNaN(height)) height = undefined;

            if (view || html || vis.editMode) {
                $(el).parent().on('click touchstart', function () {
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    $.metroDialog({
                        width:     width,
                        height:    height,
                        overlay:   options.overlay   || false,
                        shadow:    options.shadow    || false,
                        flat:      options.flat      || false,
                        draggable: options.draggable || false,
                        title:     options.title     || '',
                        icon:      options.icon  ? '<img src="' + options.icon + '">' : (options.icon_class ? '<span class="' + options.icon_class + '"></span>' : false),
                        content:   '',
                        onShow:    function(_dialog){
                            var content = _dialog.children('.content');
                            if (html) {
                                if (isIframe) {
                                    content.css('overflow', 'hidden');
                                    content.html('<iframe src="' + html + '" style="width: 100%; height: 100%" scrolling="' + (options.scroll ? 'yes' : 'no') + '"></iframe>');
                                } else {
                                    content.html(html);
                                }
                            } else {
                                content.html('<div class="vis-view-container" data-vis-contains="' + view + '"></div>');
                                if (vis.views[view]) {
                                    vis.renderView(view, view, false, function (_view) {
                                        $('#visview_' + _view).appendTo(content).show();
                                    });
                                }
                                $('#visview_' + view).appendTo(content);
                                $('#visview_' + view).show();
                            }
                        }
                    });
                });
            }
        },
        tileDialogString: function (el, wid, content_oid, options, fontSize, padding, textAlign) {
            content_oid = content_oid || '';
            var $this = $(el).parent().find('.tile');

            var width = parseInt(options.width, 10);
            var height = parseInt(options.height, 10);

            if (isNaN(width))  width = undefined;
            if (isNaN(height)) height = undefined;

            $(el).parent().on('click touchstart', function () {
                // Protect against two events
                if (vis.detectBounce(this)) return;

                $.metroDialog({
                    width:     width,
                    height:    height,
                    overlay:   options.overlay || false,
                    shadow:    options.shadow || false,
                    flat:      options.flat || false,
                    draggable: options.draggable || false,
                    icon:      options.icon  ? '<img src="' + options.icon + '">' : (options.icon_class ? '<span class="' + options.icon_class + '"></span>' : false),
                    title:     options.title || '',
                    content:   '',
                    onShow:    function(_dialog){
                        var content = _dialog.children('.content');
                        var style = '';
                        if (fontSize)  style += 'font-size:'  + fontSize + ';';
                        if (padding)   style += 'padding:'    + padding + ';';
                        if (textAlign) style += 'text-align:' + textAlign + ';';

                        var value = vis.states.attr(content_oid + '.val');
                        if (value === undefined) value = '';
                        content.html('<div style="' + style + '" class="metro-dialog-string" data-oid="' + content_oid + '">' + value + '</div>');
                    }
                });
            });
            vis.states.bind(content_oid + '.val', function (e, newVal, oldVal) {
                $('div.metro-dialog-string[data-oid="' + content_oid + '"]').html(newVal);
            });
        },
        tileDialogSlider: function (el, wid, level_id, working_id, options, sliderOptions) {
            var $this = $(el).parent().find('.tile');

            var width  = parseInt(options.width, 10);
            var height = parseInt(options.height, 10);

            if (isNaN(width))  width  = undefined;
            if (isNaN(height)) height = undefined;
            
            level_id   = level_id   || '';
            working_id = working_id || '';

            sliderOptions.min = (sliderOptions.min === undefined || sliderOptions.min === null || sliderOptions.min === '') ? 0.00 : parseFloat(sliderOptions.min);
            sliderOptions.max = (sliderOptions.max === undefined || sliderOptions.min === null || sliderOptions.max === '') ? 1.00 : parseFloat(sliderOptions.max);

            var range =  sliderOptions.max - sliderOptions.min;
            var factor = 100 / range;

            $(el).parent().on('click touchstart', function () {
                // Protect against two events
                if (vis.detectBounce(this)) return;

                $.metroDialog({
                    width:     width,
                    height:    height,
                    overlay:   options.overlay   || false,
                    shadow:    options.shadow    || false,
                    flat:      options.flat      || false,
                    draggable: options.draggable || false,
                    icon:      options.icon  ? '<img src="' + options.icon + '">' : (options.icon_class ? '<span class="' + options.icon_class + '"></span>' : false),
                    title:     options.title     || '',
                    content:   '',
                    onShow:    function(_dialog){
                        var content = _dialog.children('.content');
                        var html = '<div style="margin: 24px 0 0 24px;">';
                        html += '<div class="input-control switch"><label>';
                        html += '<input type="checkbox" name="' + wid + '_checkbox" id="' + wid + '_checkbox" data-oid="' + level_id + '" data-oid-working="' + working_id + '"/>';
                        html += '<span class="check"></span>';
                        html += '</label></div>';
                        html += '</div><div style="margin: 24px 12px 0 12px;">';
                        html += '<div data-oid="' + level_id + '" data-oid-working="' + working_id + '" id="metroSlider_' + wid + '" class="slider" data-role="slider"></div>';
                        html += '</div>';
                        content.html(html);

                        var val = vis.states.attr(level_id + '.val');
                        if (val === true || val === 'true') val = sliderOptions.max;
                        val = parseFloat(val);
                        if (isNaN(val)) val = sliderOptions.min;

                        val = Math.floor((val - sliderOptions.min) * factor);
                        sliderOptions.position = val;

                        vis.binds.metro.slider(document.getElementById('metroSlider_' + wid), sliderOptions);
                        vis.binds.basic.checkbox(document.getElementById(wid + '_checkbox'), true, sliderOptions.min, sliderOptions.max);
                    }
                });
            });
        },
        tileDialogHeating: function (el, wid, set_oid, temp_oid, drive_oid, options, sliderOptions) {
            var $this = $(el).parent().find('.tile');

            var width =  parseInt(options.width, 10);
            var height = parseInt(options.height, 10);

            if (isNaN(width))  width = undefined;
            if (isNaN(height)) height = undefined;

            set_oid   = set_oid   || '';
            temp_oid  = temp_oid  || '';
            drive_oid = drive_oid || '';

            $(el).parent().on('click touchstart', function () {
                // Protect against two events
                if (vis.detectBounce(this)) return;

                $.metroDialog({
                    width:     width,
                    height:    height,
                    overlay:   options.overlay || false,
                    shadow:    options.shadow || false,
                    flat:      options.flat || false,
                    draggable: options.draggable || false,
                    icon:      options.icon  ? '<img src="' + options.icon + '">' : (options.icon_class ? '<span class="' + options.icon_class + '"></span>' : false),
                    title:     options.title || '',
                    content:   '',
                    onShow:    function(_dialog){
                        var val_set_id = vis.states.attr(set_oid + '.val');
                        if (val_set_id === undefined || val_set_id === null || val_set_id === '') {
                            val_set_id = '';
                        } else {
                            val_set_id = val_set_id.toFixed(1);
                        }

                        var val_temp_id = vis.states.attr(temp_oid + '.val');
                        if (val_temp_id === undefined || val_temp_id === null || val_temp_id === '') {
                            val_temp_id = '';
                        } else {
                            val_temp_id = val_temp_id.toFixed(1);
                        }

                        var val_drive_id = vis.states.attr(drive_oid + '.val');
                        if (val_drive_id === undefined || val_drive_id === null || val_drive_id === '') {
                            val_drive_id = '';
                        } else {
                            val_drive_id = val_drive_id.toFixed(0);
                        }

                        var content = _dialog.children('.content');
                        var html = '<div style="margin: 24px 12px 0 12px;">';
                        if (set_oid) {
                            html += '<div data-oid="' + set_oid + '" id="metroSlider_' + wid + '" class="slider" data-role="slider"></div>';
                        }
                        html += '</div>';
                        html += '<table style="margin-top: 12px; margin-left: 12px; font-size:14px;display:inline-block;">' +
                                (set_oid   ? ('<tr><td>' + (options.label_set   || ('Set temperature')) + ':</td><td><span class="metro-dialog-string" data-oid="' + set_oid   + '">' + val_set_id   + '</span>°C</td></tr>') : '') +
                                (temp_oid  ? ('<tr><td>' + (options.label_temp  || _('Actual temp.'))   + ':</td><td><span class="metro-dialog-string" data-oid="' + temp_oid  + '">' + val_temp_id  + '</span>°C</td></tr>') : '') +
                                (drive_oid ? ('<tr><td>' + (options.label_drive || _('Valve position')) + ':</td><td><span class="metro-dialog-string" data-oid="' + drive_oid + '">' + val_drive_id + '</span>%</td></tr>')  : '') +
                                '</table>';

                        content.html(html);
                        sliderOptions.min = sliderOptions.min === undefined ? 6  : parseFloat(sliderOptions.min);
                        sliderOptions.max = sliderOptions.max === undefined ? 30 : parseFloat(sliderOptions.max);
                        if (set_oid) {
                            vis.binds.metro.slider(document.getElementById('metroSlider_' + wid), sliderOptions);
                            vis.states.bind(set_oid   + '.val', function (e, newVal, oldVal) {
                                $('span.metro-dialog-string[data-oid="' + set_oid + '"]').html(parseFloat(newVal).toFixed(1));
                            });
                        }
                        if (temp_oid) {
                            vis.states.bind(temp_oid  + '.val', function (e, newVal, oldVal) {
                                $('span.metro-dialog-string[data-oid="' + temp_oid + '"]').html(parseFloat(newVal).toFixed(1));
                            });
                        }
                        if (drive_oid) {
                            vis.states.bind(drive_oid + '.val', function (e, newVal, oldVal) {
                                $('span.metro-dialog-string[data-oid="' + drive_oid + '"]').html(parseFloat(newVal).toFixed(0));
                            });
                        }
                    }
                });
            });
        },
        onHeatingOid: function (widgetID, view, value, attr, isCss) {
            var obj = vis.objects[value];
            var changed = [];
            // If it is real object and SETPOINT
            if (obj && obj.common && obj.common.role === 'level.temperature') {
                var roles = [];
                // If some attributes are not set
                if (!vis.views[view].widgets[widgetID].data.temp_oid) {
                    roles.push('value.temperature');
                }
                if (!vis.views[view].widgets[widgetID].data.drive_oid) {
                    roles.push('value.valve');
                }
                if (!vis.views[view].widgets[widgetID].data.hum_oid) {
                    roles.push('value.humidity');
                }
                if (!vis.views[view].widgets[widgetID].data.lowbat_oid) {
                    roles.push('indicator.battery');
                }
                if (roles.length) {
                    var result = vis.findByRoles(value, roles);
                    if (result) {
                        for (var r in result) {
                            switch (r) {
                                case 'value.temperature':
                                    changed.push('temp_oid'); // remember attr to update it
                                    vis.views[view].widgets[widgetID].data.temp_oid = result[r];
                                    vis.widgets[widgetID].data.temp_oid = result[r];
                                    break;

                                case 'value.valve':
                                    changed.push('drive_oid'); // remember attr to update it
                                    vis.views[view].widgets[widgetID].data.drive_oid = result[r];
                                    vis.widgets[widgetID].data.drive_oid = result[r];
                                    break;

                                case  'value.humidity':
                                    changed.push('hum_oid');
                                    vis.views[view].widgets[widgetID].data.hum_oid = result[r];
                                    vis.widgets[widgetID].data.hum_oid = result[r];
                                    break;

                                case  'indicator.battery':
                                    changed.push('lowbat_oid');
                                    vis.views[view].widgets[widgetID].data.lowbat_oid = result[r];
                                    vis.widgets[widgetID].data.lowbat_oid = result[r];
                                    break
                            }
                        }
                    }
                }

                if (!vis.views[view].widgets[widgetID].data.controlmode_oid) {
                    var result = vis.findByName(value, 'CONTROL_MODE');
                    if (result) {
                        changed.push('controlmode_oid');
                        vis.views[view].widgets[widgetID].data.controlmode_oid = result;
                        vis.widgets[widgetID].data.controlmode_oid = result;
                    }
                }
                if (!vis.views[view].widgets[widgetID].data.windowopen_oid) {
                    var result = vis.findByName(value, 'WINDOW_STATE');
                    if (result) {
                       changed.push('windowopen_oid');
                        vis.views[view].widgets[widgetID].data.windowopen_oid = result;
                        vis.widgets[widgetID].data.windowopen_oid = result;
                    }
                }
                if (!vis.views[view].widgets[widgetID].data.windowopen_oid) {
                    var result = vis.findByName(value, 'WINDOW_OPEN_REPORTING');
                    if (result) {
                        changed.push('windowopen_oid');
                        vis.views[view].widgets[widgetID].data.windowopen_oid = result;
                        vis.widgets[widgetID].data.windowopen_oid = result;
                    }
                }
            }

            return changed.length ? changed : null;
        }
    };

	console.log('Metro version: "' + vis.binds.metro.version + '"');
</script>

<script id="tplMetroSlider"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroSlider" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-selectee" style="top: 21px; left: 41px; width: 78px; height: 17px;"> <div class="metro vis-widget-prev-body " style="padding:2px"> <div data-o data-oid-working="" class="slider" data-role="slider"><div class="complete" style="background-color: rgb(32, 32, 255); width: 0;"></div><a class="marker" style="background-color: rgb(32, 32, 255); left: 0;"></a></div> <div></div> </div> </div>'
        data-vis-attrs="oid;oid-working;min;max;step;sliderColor/color;sliderCompleteColor/color;sliderMarkerColor/color"
        data-vis-set="metro"
        data-vis-type="ctrl,slider,dimmer"
        data-vis-name="Slider horizontal">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width:360px; height: 16px;">
        <div class="metro vis-widget-body <%== this.data.attr('class') %>" style="padding:2px" >
            <% if (vis.editMode) { %>
                <div class="editmode-helper" />
            <% } %>
            <div data-oid="<%= this.data.attr('oid') %>" data-oid-working="<%= this.data.attr('oid-working') %>" id="metroSlider_<%= this.data.attr('wid') %>" class="slider" data-role="slider"></div>
            <div <%= (el) -> vis.binds.metro.slider(el, {min: data.min, max: data.max, step: data.step, color: data.sliderBgColor, completeColor:data.sliderCompleteColor, markerColor: data.sliderMarkerColor}) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroSliderVertical"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroSliderVertical" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock ui-selectee" style="top: 215px; left: 460px; width: 12px; height: 73px;"> <div class="metro vis-widget-prev-body " style="padding:2px"> <div data-o data-oid-working="" style="height: 100%;" class="slider vertical" data-role="slider"><div class="complete" style="height: 12px;"></div><a class="marker" style="background-color: rgb(75, 0, 130); top: 344px;"></a></div> <div></div> </div> </div>'
        data-vis-attrs="oid;oid-working;min;max;step;sliderColor/color;sliderCompleteColor/color;sliderMarkerColor/color"
        data-vis-set="metro"
        data-vis-type="ctrl,slider,dimmer"
        data-vis-name="Slider vertical">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 16px; height:360px;">
        <div class="metro vis-widget-body <%== this.data.attr('class') %>" style="padding:2px" >
            <% if (vis.editMode) { %>
                <div class="editmode-helper" />
            <% } %>
            <div data-oid="<%= this.data.attr('oid') %>" data-oid-working="<%= this.data.attr('oid-working') %>" style="height: 100%;" id="metroSlider_<%= this.data.attr('wid') %>" class="slider vertical" class="slider" data-role="slider"></div>
            <div <%= (el) -> vis.binds.metro.slider(el, {min: data.min, max: data.max, step: data.step, color: data.sliderBgColor, completeColor: data.sliderCompleteColor, markerColor: data.sliderMarkerColor}) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroValueBoolCheckbox"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroValueBoolCheckbox" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock ui-selectee" style="left: 110px; top: 81px; height: 44px; width: 21px;" > <div class="metro vis-widget-prev-body"> <div class="input-control checkbox"> <label> <input type="checkbox" name="w00003_checkbox" data-o> <span class="check"></span> </label> </div> <div></div> </div> </div>'
        data-vis-attrs="html_prepend;html_append;oid"
        data-vis-set="metro"
        data-vis-type="ctrl,bool"
        data-vis-name="Bool Checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" style="" id="<%= this.data.attr('wid') %>" >
        <div class="metro vis-widget-body">
            <div class="input-control checkbox">
                <label>
                    <%== this.data.attr("html_prepend") %>
                    <input type="checkbox" name="<%= this.data.attr('wid') %>_checkbox" id="<%= this.data.attr('wid') %>_checkbox" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.checkbox(el) %>/>
                    <span class="check"></span>
                    <%== this.data.attr("html_append") %>
                </label>
            </div>
            <div <%= (el) -> vis.binds.metro.inputControl(el) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroValueBoolSwitch"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroValueBoolSwitch" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock ui-selectee" style="left: 110px; top: 432px;" > <div class="metro vis-widget-prev-body"> <div class="input-control switch"> <label> <input type="checkbox" name="w00002_checkbox" data-o> <span class="check"></span> </label> </div> <div></div> </div> </div>'
        data-vis-set="metro"
        data-vis-type="ctrl,bool"
        data-vis-name="Switch"
        data-vis-attrs="html_prepend;html_append;oid">
    <div class="vis-widget <%== this.data.attr('class') %>" style="" id="<%= this.data.attr('wid') %>" >
        <div class="metro vis-widget-body">
            <div class="input-control switch">
                <label>
                    <%== this.data.attr("html_prepend") %>
                    <input type="checkbox" name="<%= this.data.attr('wid') %>_checkbox" id="<%= this.data.attr('wid') %>_checkbox" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.checkbox(el) %>/>
                    <span class="check"></span>
                    <%== this.data.attr("html_append") %>
                </label>
            </div>
            <div <%= (el) -> vis.binds.metro.inputControl(el) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileNav"
        type="text/ejs"
        data-vis-prev='<div id="prev_tplMetroTileNav" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev  " style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "> <div data-metro-nav-select="false" data-metro-class-active="bg-magenta" data-metro-class="bg-indigo" style="width: 100%; height: 100%;" class="vis-metro-nav tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-new"></i> </div> <div class="vis-metro-nav brand ribbed-steel" data-metro-nav="" data-metro-class-active="ribbed-indigo" data-metro-class="ribbed-steel"> <span class="label fg-white">Navigation</span> <div class="vis-metro-nav badge bg-cyan" data-metro-nav="" data-metro-class-active="bg-teal" data-metro-class="bg-cyan"><i class="icon-file"></i></div> </div> </div>  </div> </div></div>'
        data-vis-attrs="nav_view;hover[true]/checkbox;transform[true]/checkbox;select_current/checkbox;label[Navigation];"
        data-vis-attrs0="bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="bg_class_active[bg-magenta]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.badge;badge_bg_class[bg-cyan]/style,metro-,bg-;badge_bg_class_active[bg-teal]/style,metro-,bg-;"
        data-vis-attrs3="badge_src/image;badge_width/slider,0,100,1;badge_height/slider,0,100,1;badge_top[0]/slider,0,100,1;badge_left[0]/slider,0,100,1;"
        data-vis-attrs4="icon_badge[icon-file]/style,iconFont,icon-,,Icon ;brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs5="brand_bg_class_active[ribbed-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs6="group.icon;icon_src/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;icon_class[icon-new]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs7="group.effects;sync/checkbox;hide_effect/effect;hide_duration/slider,0,10000,100;hide_options/effect-options;show_effect/effect;show_duration/slider,0,10000,100;show_options/effect-options;body-background/color"
        class="vis-tpl"
        data-vis-type="static,navigation"
        data-vis-set="metro"
        data-vis-name="Tile Navigation">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;"  <%= (el) -> vis.binds.basic.navigation(el, {nav_view:data.attr('nav_view'),hideOptions:{effect:data.attr('hide_effect'),options:(data.attr('hide_options')?data.attr('hide_options'):{}),duration:data.attr('hide_duration')},showOptions:{effect:data.attr('show_effect'),options:(data.attr('show_options')?data.attr('show_options'):{}),duration:data.attr('show_duration')},sync:data.attr('sync'),background:data.attr('body-background')}); %> >
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>">
            <div data-metro-nav="<%= this.data.attr('nav_view') %>" data-metro-nav-select="<%= this.data.attr('select_current') %>" data-metro-class-active="<%= this.data.attr('bg_class_active') %>" data-metro-class="<%= this.data.attr('bg_class') %>" style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="vis-metro-nav tile <%= this.data.attr('hover') ? 'hover' : '' %>" >
                <div class="tile-content icon <%= this.data.attr('icon_class') ? '' : 'icon-custom' %>">
                    <%== this.data.attr("icon_src") ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr("icon_src") + '"/>' : '' %>
                    <i class="<%= this.data.attr("icon_class") %>"></i>
                </div>
                <div class="vis-metro-nav brand" data-metro-nav="<%= this.data.attr('nav_view') %>" data-metro-class-active="<%= this.data.attr('brand_bg_class_active') %>" data-metro-class="<%= this.data.attr('brand_bg_class') %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                    <div class="vis-metro-nav badge" data-metro-nav="<%= this.data.attr('nav_view') %>" data-metro-class-active="<%= this.data.attr('badge_bg_class_active') %>" data-metro-class="<%= this.data.attr('badge_bg_class') %>">
                        <%== this.data.attr('badge_src') ? '<img style="position: absolute;' + (this.data.attr('badge_top') ? ('top:' + this.data.attr('badge_top') + '%;') : '') + (this.data.attr('badge_left') ? ('left:' + this.data.attr('badge_left') + '%;') : '') + (this.data.attr('badge_width') ? ('width:' + this.data.attr('badge_width') + '%;') : '') + (this.data.attr('badge_height') ? ('height:' + this.data.attr('badge_height') + '%;') : '') + '" src="' + this.data.attr("badge_src") + '"/>' : '' %>
                        <i class="<%= this.data.attr("icon_badge") %>"></i>
                    </div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileString"
        type="text/ejs"
        data-vis-prev='<div id="prev_tplMetroTileString" style="position: relative; text-align: initial;padding: 4px"><div class="vis-widget_prev" style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content fg-white icon"> <i class="icon-sun-3"></i> </div> <div class="brand ribbed-steel"> <span class="label fg-white"> String </span> <div class="badge bg-cyan"><i class="icon-sunrise"></i></div> </div> </div>  </div> </div></div>'
        data-vis-attrs="content_prepend;content_append;content_oid/id;"
        data-vis-attrs0="state_oid/id;hover/checkbox;transform/checkbox;select_on_true/checkbox;bg_class_false[bg-indigo]/style,metro-,bg- ribbed-;bg_class_true[bg-teal]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="group.icon;icon_false/image;icon_true/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;icon_class_false[icon-sun-3]/style,iconFont,icon-,,Icon ;icon_class_true[icon-weather-4]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs2="group.badge;label_prepend;label_append;label_id/id;badge_bg_class_false[bg-cyan]/style,metro-,bg-;badge_bg_class_true[bg-teal]/style,metro-,bg-;icon_badge_false[icon-sunrise]/style,iconFont,icon-,,Icon ;icon_badge_true[icon-sunrise]/style,iconFont,icon-,,Icon ;brand_bg_class_false[ribbed-steel]/style,metro-,bg- ribbed-;brand_bg_class_true[ribbed-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs3="badge_src_false/image;badge_src_true/image;badge_width/slider,0,100,1;badge_height/slider,0,100,1;badge_top[0]/slider,0,100,1;badge_left[0]/slider,0,100,1;"
        class="vis-tpl"
        data-vis-set="metro"
        data-vis-type="val"
        data-vis-name="Tile String">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" data-oid="<%= this.data.attr('state_oid') %>">
            <div style="width: 100%; height: 100%;"  id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= (vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val')) === '_true') && this.data.attr('select_on_true') ? 'selected' : '' %> <%= this.data.attr('bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) %>" >
                <div class="tile-content fg-white icon <%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) ? '' : 'icon-custom' %>">
                    <%== this.data.attr('content_prepend') %><%== vis.states.attr(this.data.attr('content_oid') + '.val') %><%== this.data.attr('content_append') %>
                    <%== this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) + '"/>' : '' %>
                    <i class="<%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) %>"></i>
                </div>
                <div class="brand <%= this.data.attr('brand_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) %>">
                    <span class="label fg-white">
                        <%== this.data.attr('label_prepend') %><%== vis.states.attr(this.data.attr('label_id') + '.val') %><%== this.data.attr('label_append') %>
                    </span>
                    <div class="badge <%= this.data.attr('badge_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) %>">
                        <i class="<%= this.data.attr('icon_badge' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) %>"></i>
                        <%== this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('badge_top') ? ('top:' + this.data.attr('badge_top') + '%;') : '') + (this.data.attr('badge_left') ? ('left:' + this.data.attr('badge_left') + '%;') : '') + (this.data.attr('badge_width') ? ('width:' + this.data.attr('badge_width') + '%;') : '') + (this.data.attr('badge_height') ? ('height:' + this.data.attr('badge_height') + '%;') : '') + '" src="' + this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) + '"/>' : '' %>
                    </div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileBool"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileBool" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev  " style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"><div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-newspaper"></i> </div> <div class="brand ribbed-steel"> <span class="label fg-white">Boolean</span> <div class="badge bg-cyan"><i class="icon-folder"></i></div> </div> </div>  </div> </div></div>'
        data-vis-attrs="oid;hover[true]/checkbox;transform/checkbox;select_on_true/checkbox;label_false[false];label_true[true];"
        data-vis-attrs0="bg_class_false[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="bg_class_true[bg-teal]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.icon;icon_false/image;icon_true/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;"
        data-vis-attrs3="icon_class_false[icon-cancel-2]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs4="icon_class_true[icon-checkmark]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs5="group.badge;icon_badge_false[icon-folder-2]/style,iconFont,icon-,,Icon ;icon_badge_true[icon-folder]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs6="badge_bg_class_false[bg-cyan]/style,metro-,bg-;badge_bg_class_true[bg-teal]/style,metro-,bg-;"
        data-vis-attrs7="badge_src_false/image;badge_src_true/image;badge_width/slider,0,100,1;badge_height/slider,0,100,1;badge_top[0]/slider,0,100,1;badge_left[0]/slider,0,100,1;"
        data-vis-attrs8="brand_bg_class_false[ribbed-steel]/style,metro-,bg- ribbed-;brand_bg_class_true[ribbed-indigo]/style,metro-,bg- ribbed-;"
        data-vis-set="metro"
        data-vis-type="val,bool"
        data-vis-name="Tile Bool">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" data-oid="<%= this.data.attr('oid') %>">
            <div style="width: 100%; height: 100%;"  id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= (vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val')) === '_true') && this.data.attr('select_on_true') ? 'selected' : '' %> <%= this.data.attr('bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>" >
                <div class="tile-content icon <%= this.data.attr("icon_class" + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) ? '' : 'icon-custom' %>">
                    <%== this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) + '"/>' : '' %>
                    <i class="<%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>"></i>
                </div>
                <div class="brand <%= this.data.attr('brand_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>">
                    <span class="label fg-white"><%== this.data.attr('label' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %></span>
                    <div class="badge <%= this.data.attr('badge_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>">
                        <i class="<%= this.data.attr('icon_badge' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>"></i>
                        <%== this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('badge_top') ? ('top:' + this.data.attr('badge_top') + '%;') : '') + (this.data.attr('badge_left') ? ('left:' + this.data.attr('badge_left') + '%;') : '') + (this.data.attr('badge_width') ? ('width:' + this.data.attr('badge_width') + '%;') : '') + (this.data.attr('badge_height') ? ('height:' + this.data.attr('badge_height') + '%;') : '') + '" src="' + this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) + '"/>' : '' %>
                    </div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileBoolDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileBoolDialog" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev " style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"><div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-newspaper"></i> </div> <div class="brand ribbed-steel"> <span class="label fg-white">Boolean</span> <div class="badge bg-cyan"><i class="icon-folder"></i></div> </div> </div> </div> </div></div>'
        data-vis-attrs="oid;hover[true]/checkbox;transform/checkbox;select_on_true/checkbox;label_false[false];label_true[true];"
        data-vis-attrs0="bg_class_false[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="bg_class_true[bg-teal]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.icon;icon_false/image;icon_true/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;"
        data-vis-attrs3="icon_class_false[icon-cancel-2]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs4="icon_class_true[icon-checkmark]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs5="group.badge;icon_badge_false[icon-folder-2]/style,iconFont,icon-,,Icon ;icon_badge_true[icon-folder]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs6="badge_bg_class_false[bg-cyan]/style,metro-,bg-;badge_bg_class_true[bg-teal]/style,metro-,bg-;"
        data-vis-attrs7="badge_src_false/image;badge_src_true/image;badge_width/slider,0,100,1;badge_height/slider,0,100,1;badge_top[0]/slider,0,100,1;badge_left[0]/slider,0,100,1;"
        data-vis-attrs8="brand_bg_class_false[ribbed-steel]/style,metro-,bg- ribbed-;brand_bg_class_true[ribbed-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs9="group.dialog;contains_view/views;dialog_width;dialog_height;dialog_title;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox;dialog_icon_src/image;dialog_icon_class[]/style,iconFont,icon-,,Icon ;"
        data-vis-set="metro"
        data-vis-type="bool,dialog"
        data-vis-name="Tile Bool Dialog">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" data-oid="<%= this.data.attr('oid') %>">
            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= (vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val')) === '_true') && this.data.attr('select_on_true') ? 'selected' : '' %> <%= this.data.attr('bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>" >
                <div class="tile-content icon <%= this.data.attr("icon_class" + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) ? '' : 'icon-custom' %>">
                    <%== this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) + '"/>' : '' %>
                    <i class="<%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>"></i>
                </div>
                <div class="brand <%= this.data.attr('brand_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>">
                    <span class="label fg-white"><%== this.data.attr('label' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %></span>
                    <div class="badge <%= this.data.attr('badge_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>">
                        <i class="<%= this.data.attr('icon_badge' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>"></i>
                        <%== this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('badge_top') ? ('top:' + this.data.attr('badge_top') + '%;') : '') + (this.data.attr('badge_left') ? ('left:' + this.data.attr('badge_left') + '%;') : '') + (this.data.attr('badge_width') ? ('width:' + this.data.attr('badge_width') + '%;') : '') + (this.data.attr('badge_height') ? ('height:' + this.data.attr('badge_height') + '%;') : '') + '" src="' + this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) + '"/>' : '' %>
                    </div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tileDialog(el, data.wid, data.contains_view, {title:data.dialog_title,flat:data.dialog_flat,shadow:data.dialog_shadow,overlay:data.dialog_modal,icon:data.dialog_icon_src,icon_class:data.dialog_icon_class,draggable:data.dialog_draggable,width:data.dialog_width,height:data.dialog_height}) %> style="padding: 42px 10px 10px;">
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileList8"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileList8" style="position: relative; text-align: initial;padding: 4px"><div class="vis-widget_prev  vis-widget-lock" style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"><div style="width: 100%; height: 100%;" class="tile bg-indigo"> <div class="tile-content icon"><i class="icon-pencil"></i> </div> <div class="brand ribbed-steel"><span class="label fg-white">Value list</span><div class="badge bg-cyan"></div></div></div></div></div></div>'
        data-vis-attrs="oid;hover/checkbox;transform/checkbox;label_prepend;label_append;group.bg-and-text;label(0-7)[Value list];"
        data-vis-attrs0="bg_class(0-7)[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="group.icon;icon(0-7)/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;"
        data-vis-attrs2="icon_class(0-7)[icon-pencil]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs3="group.badge;icon_badge(0-7)[icon-pencil]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs4="badge_bg_class(0-7)[bg-cyan]/style,metro-,bg-;"
        data-vis-attrs5="brand_bg_class(0-7)[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs6="badge_src/image;badge_width/slider,0,100,1;badge_height/slider,0,100,1;badge_top[0]/slider,0,100,1;badge_left[0]/slider,0,100,1;"
        data-vis-set="metro"
        data-vis-type="val,list"
        data-vis-name="Tile ValueList 8">
        <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
            <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" data-oid="<%= this.data.attr('oid') %>">
                <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %> <%= this.data.attr('bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'), 10)) %>" >
                    <div class="tile-content icon <%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'), 10)) ? '' : 'icon-custom' %>">
                        <%== this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'), 10)) ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'), 10)) + '"/>' : '' %>
                        <i class="<%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'), 10)) %>"></i>
                    </div>
                    <div class="brand <%= this.data.attr('brand_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'), 10)) %>">
                        <span class="label fg-white"><%== this.data.attr('label_prepend') %><%== this.data.attr('label' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'), 10)) %><%== this.data.attr('label_append') %></span>
                        <div class="badge <%= this.data.attr('badge_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'), 10)) %>">
                            <i class="<%= this.data.attr('icon_badge' + vis.states.attr(this.data.attr('oid') + '.val')) %>"></i>
                            <%== this.data.attr('badge_src') ? '<img style="position: absolute;' + (this.data.attr('badge_top') ? ('top:' + this.data.attr('badge_top') + '%;') : '') + (this.data.attr('badge_left') ? ('left:' + this.data.attr('badge_left') + '%;') : '') + (this.data.attr('badge_width') ? ('width:' + this.data.attr('badge_width') + '%;') : '') + (this.data.attr('badge_height') ? ('height:' + this.data.attr('badge_height') + '%;') : '') + '" src="' + this.data.attr("badge_src") + '"/>' : '' %>
                        </div>
                    </div>
                </div>
                <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
            </div>
        </div>
    </div>
</script>

<script id="tplMetroTileBoolNumber"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileBoolNumber" style="position: relative; text-align: initial;padding: 4px"><div class="vis-widget_prev  vis-widget-lock" style="width: 120px; height: 120px; padding: 3px;"><div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"><div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-cancel-2"></i></div><div class="brand ribbed-steel"><span class="label fg-white">Bool/Num</span><div class="badge bg-cyan"><i class=""></i></div></div></div></div> </div></div>'
        data-vis-attrs="state_oid/id;select_on_true/checkbox;number_oid/id;hover[true]/checkbox;transform/checkbox;label_false;label_true;label_append;"
        data-vis-attrs0="bg_class_false[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="bg_class_true[bg-teal]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.icon;icon_false_src/image;icon_true_src/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;"
        data-vis-attrs3="icon_class_false[icon-cancel-2]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs4="icon_class_true[icon-checkmark]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs5="group.badge;icon_badge_false[]/style,iconFont,icon-,,Icon ;icon_badge_true[]/style,iconFont,icon-,,Icon ;badge_bg_class_false[bg-cyan]/style,metro-,bg-;badge_bg_class_true[bg-teal]/style,metro-,bg-;"
        data-vis-attrs6="brand_bg_class_false[ribbed-steel]/style,metro-,bg- ribbed-;brand_bg_class_true[ribbed-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs7="badge_src_false/image;badge_src_true/image;badge_width/slider,0,100,1;badge_height/slider,0,100,1;badge_top[0]/slider,0,100,1;badge_left[0]/slider,0,100,1;"
        data-vis-set="metro"
        data-vis-type="val,bool"
        data-vis-name="Tile Bool / Number">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" data-oid="<%= this.data.attr('state_oid') %>">
            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= (vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val')) === '_true') && this.data.select_on_true ? 'selected' : '' %> <%= this.data.attr('bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) %>" >
                <div class="tile-content icon <%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) ? '' : 'icon-custom' %>">
                    <%== this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val')) + '_src') ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))  + '_src')+ '"/>' : '' %>
                    <i class="<%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) %>"></i>
                </div>
                <div class="brand <%= this.data.attr('brand_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) %>">
                    <span class="label fg-white"><%== (this.data.attr('label' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) || '') + ((vis.states.attr(this.data.attr('number_oid') + '.val') !== undefined) ? vis.states.attr(this.data.attr('number_oid') + '.val') : '') %><%== this.data.attr('label_append') || '' %></span>
                    <div class="badge <%= this.data.attr('badge_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) %>">
                        <i class="<%= this.data.attr('icon_badge' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) %>"></i>
                        <%== this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('badge_top') ? ('top:' + this.data.attr('badge_top') + '%;') : '') + (this.data.attr('badge_left') ? ('left:' + this.data.attr('badge_left') + '%;') : '') + (this.data.attr('badge_width') ? ('width:' + this.data.attr('badge_width') + '%;') : '') + (this.data.attr('badge_height') ? ('height:' + this.data.attr('badge_height') + '%;') : '') + '" src="' + this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) + '"/>' : '' %>
                    </div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileState"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileState" style="position: relative; text-align: initial;padding: 4px"><div class="vis-widget_prev  vis-widget-lock" style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"> <div style="width: 100%; height: 100%" class="tile hover bg-indigo"><div class="tile-content icon"><i class="icon-unlocked"></i> </div> <div class="brand ribbed-steel"><span class="label fg-white">State</span><div class="badge bg-cyan"><i class=""></i></div></div></div></div></div></div>'
        data-vis-attrs="state_oid/id;value;select_on_value/checkbox;hover[true]/checkbox;transform[true]/checkbox;label_false;label_true;"
        data-vis-attrs0="bg_class_false[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="bg_class_true[bg-teal]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.icon;icon_false/image;icon_true/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;"
        data-vis-attrs3="icon_class_false[]/style,iconFont,icon-,,Icon ;icon_class_true[]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs4="group.badge;icon_badge_false[]/style,iconFont,icon-,,Icon ;icon_badge_true[]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs5="badge_bg_class_false[bg-cyan]/style,metro-,bg-;"
        data-vis-attrs6="badge_bg_class_true[bg-teal]/style,metro-,bg-;"
        data-vis-attrs7="brand_bg_class_false[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs8="brand_bg_class_true[ribbed-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs9="badge_src_false/image;badge_src_true/image;badge_width/slider,0,100,1;badge_height/slider,0,100,1;badge_top[0]/slider,0,100,1;badge_left[0]/slider,0,100,1;"
        data-vis-set="metro"
        data-vis-type="ctrl"
        data-vis-name="Tile State">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" data-val="<%= this.data.attr('value') %>" data-oid="<%= this.data.attr('state_oid') %>" <%= (el) -> vis.binds.basic.state(el) %> >
            <div style="width: 100%; height: 100%;"  id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= (vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value')) === '_true') && this.data.select_on_value ? 'selected' : '' %> <%= this.data.attr('bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %>" >
                <div class="tile-content icon <%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) ? '' : 'icon-custom' %>">
                    <%== this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) + '"/>' : '' %>
                    <i class="<%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %>"></i>
                </div>
                <div class="brand <%= this.data.attr('brand_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %>">
                    <span class="label fg-white"><%== this.data.attr('label' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %></span>
                    <div class="badge <%= this.data.attr('badge_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %>">
                        <i class="<%= this.data.attr('icon_badge' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %>"></i>
                        <%== this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('badge_top') ? ('top:' + this.data.attr('badge_top') + '%;') : '') + (this.data.attr('badge_left') ? ('left:' + this.data.attr('badge_left') + '%;') : '') + (this.data.attr('badge_width') ? ('width:' + this.data.attr('badge_width') + '%;') : '') + (this.data.attr('badge_height') ? ('height:' + this.data.attr('badge_height') + '%;') : '') + '" src="' + this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) + '"/>' : '' %>
                    </div>
                </div>
            </div>
        <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileToggle"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileToggle" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock" style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body " data-oid="dev1"> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-minus-2"></i> </div> <div class="brand ribbed-steel"> <span class="label fg-white">Toggle</span> <div class="badge bg-cyan"><i class="icon-minus"></i></div> </div> </div>  </div> </div></div>'
        data-vis-attrs="oid;hover[true]/checkbox;transform[true]/checkbox;select_on_true/checkbox;label_false;label_true;"
        data-vis-attrs0="bg_class_false[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="bg_class_true[bg-teal]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.icon;icon_false/image;icon_true/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;"
        data-vis-attrs3="icon_class_false[icon-minus]/style,iconFont,icon-,,Icon ;icon_class_true[icon-plus]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs4="group.badge;icon_badge_false[icon-minus-2]/style,iconFont,icon-,,Icon ;icon_badge_true[icon-plus-2]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs5="badge_bg_class_false[bg-cyan]/style,metro-,bg-;"
        data-vis-attrs6="badge_bg_class_true[bg-teal]/style,metro-,bg-;"
        data-vis-attrs7="brand_bg_class_false[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs8="brand_bg_class_true[ribbed-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs9="badge_src_false/image;badge_src_true/image;badge_width/slider,0,100,1;badge_height/slider,0,100,1;badge_top[0]/slider,0,100,1;badge_left[0]/slider,0,100,1;"
        data-vis-attrs10="group.ccontrol;urlTrue;urlFalse;oidTrue/id;oidFalse/id;oidTrueValue;oidFalseValue;"
        data-vis-set="metro"
        data-vis-type="ctrl,bool"
        data-vis-name="Tile Toggle">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%"
            class="metro vis-widget-body <%== this.data.attr('class') %>"
            data-oid="<%= this.data.attr('oid') %>"
            data-url-true="<%=  this.data.attr('urlTrue') %>"
            data-url-false="<%= this.data.attr('urlFalse') %>"
            data-oid-true="<%=  this.data.attr('oidTrue') %>"
            data-oid-false="<%= this.data.attr('oidFalse') %>"
            data-oid-true-value="<%=  this.data.attr('oidTrueValue') %>"
            data-oid-false-value="<%= this.data.attr('oidFalseValue') %>"
            <%= (el) -> vis.binds.basic.toggle(el) %>
            >
            <div style="width: 100%; height: 100%;"  id="metroTile_<%= this.data.attr('wid') %>" class="tile icon <%= this.data.attr('hover') ? 'hover ' : '' %><%= (vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val')) === '_true') && this.data.attr('select_on_true') ? 'selected' : '' %> <%= this.data.attr('bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>" >
                <div class="tile-content icon <%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) ? '' : 'icon-custom' %>">
                    <%== this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) + '"/>' : '' %>
                    <i class="<%= vis.states.attr(this.data.attr('oid') + '.val') ? this.data.attr("icon_class_true") : this.data.attr("icon_class_false") %>"></i>
                </div>
                <div class="brand <%= this.data.attr('brand_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>">
                    <span class="label fg-white"><%== this.data.attr('label' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %></span>
                    <div class="badge <%= this.data.attr('badge_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>">
                        <i class="<%= this.data.attr('icon_badge' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>"></i>
                        <%== this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('badge_top') ? ('top:' + this.data.attr('badge_top') + '%;') : '') + (this.data.attr('badge_left') ? ('left:' + this.data.attr('badge_left') + '%;') : '') + (this.data.attr('badge_width') ? ('width:' + this.data.attr('badge_width') + '%;') : '') + (this.data.attr('badge_height') ? ('height:' + this.data.attr('badge_height') + '%;') : '') + '" src="' + this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) + '"/>' : '' %>
                    </div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileStateNumber"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileStateNumber" style="position: relative; text-align: initial;padding: 4px"><div class="vis-widget_prev vis-widget-lock" style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-meter-slow"></i></div><div class="brand ribbed-steel"><span class="label fg-white">State/Num</span><div class="badge bg-cyan"><i class=""></i></div></div></div></div></div></div>'
        data-vis-attrs="state_oid/id;value;select_on_value/checkbox;number_oid/id;hover[true]/checkbox;transform[true]/checkbox;label_false;label_true;label_append;"
        data-vis-attrs0="bg_class_false[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="bg_class_true[bg-teal]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.icon;icon_false_src/image;icon_true_src/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;"
        data-vis-attrs3="icon_class_false[icon-meter-slow]/style,iconFont,icon-,,Icon ;icon_class_true[icon-meter-fast]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs4="group.badge;badge_bg_class[]/style,metro-,bg-;hide_on_0/checkbox;"
        data-vis-attrs5="group.brand;brand_bg_class_false[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs6="brand_bg_class_true[ribbed-indigo]/style,metro-,bg- ribbed-;"
        data-vis-set="metro"
        data-vis-type="val"
        data-vis-name="Tile State / val Badge Number">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;" >
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" data-val="<%= this.data.attr('value') %>" data-oid="<%= this.data.attr('state_oid') %>" <%= (el) -> vis.binds.basic.state(el) %> >
            <div style="width: 100%; height: 100%;"  id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= (vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value')) === '_true') && this.data.select_on_value ? 'selected' : '' %> <%= this.data.attr('bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %>" >
                <div class="tile-content icon <%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) ? '' : 'icon-custom' %>">
                    <%== this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value')) + '_src') ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value')) + '_src') + '"/>' : '' %>
                    <i class="<%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %>"></i>
                </div>
                <div class="brand <%= this.data.attr('brand_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %>">
                    <span class="label fg-white"><%== this.data.attr('label' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %><%== this.data.attr('label_append') %></span>
                    <div class="badge <%= this.data.attr('badge_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %>">
                        <i class="<%= this.data.attr('icon_badge' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'), 'compare', this.data.attr('value'))) %>"></i>
                        <%== this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('badge_top') ? ('top:' + this.data.attr('badge_top') + '%;') : '') + (this.data.attr('badge_left') ? ('left:' + this.data.attr('badge_left') + '%;') : '') + (this.data.attr('badge_width') ? ('width:' + this.data.attr('badge_width') + '%;') : '') + (this.data.attr('badge_height') ? ('height:' + this.data.attr('badge_height') + '%;') : '') + '" src="' + this.data.attr('badge_src' + vis.binds.metro.format(vis.states.attr(this.data.attr('state_oid') + '.val'))) + '"/>' : '' %><%= (vis.states.attr(this.data.attr("number_oid") + '.val') !== undefined) ? vis.states.attr(this.data.attr("number_oid") + '.val') : '' %>
                    </div>
                </div>
            </div> 
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileDimmer"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileDimmer" style=" position: relative; text-align: initial;padding: 4px"><div class="vis-widget_prev" style="width: 122px; height: 77px; padding: 3px;"><div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "><div style="width: 100%; height: 100%;" class="tile bg-indigo"> <div class="tile-content" style=" zoom: 0.5;"> <div style="float:left; height: 90px;"> <img width="90px" src="widgets/metro/img/light_light_dim.png"> </div> <div style="margin: 30px 70px 0 0; float:right"> <div class="input-control switch"> <label> <input type="checkbox" name="w00004_checkbox" data-o> <span class="check"></span> </label> </div> </div> <div style="clear: both; margin: 0 12px;" class="slider" data-role="slider"><div class="complete" style="width: 0;"></div><a class="marker" style="left: 0;"></a></div> <div></div> </div> <div class="brand ribbed-steel"> <span class="label fg-white">Dimmer</span> </div> </div> <div></div> </div> </div>'
        data-vis-attrs="oid;oid-working;min;max;step[1];hover/checkbox;transform/checkbox;label;"
        data-vis-attrs0="bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.slider;sliderColor/color;sliderCompleteColor/color;sliderMarkerColor/color"
        data-vis-set="metro"
        data-vis-type="ctrl,dimmer"
        data-vis-name="Tile Dimmer">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width:287px; height: 136px; padding: 3px;" <%= (el) -> vis.preloadImages(['widgets/metro/img/light_light_dim_100.png','widgets/metro/img/light_light_dim_90.png','widgets/metro/img/light_light_dim_80.png','widgets/metro/img/light_light_dim_70.png','widgets/metro/img/light_light_dim_60.png','widgets/metro/img/light_light_dim_50.png','widgets/metro/img/light_light_dim_40.png','widgets/metro/img/light_light_dim_30.png','widgets/metro/img/light_light_dim_20.png','widgets/metro/img/light_light_dim_10.png','widgets/metro/img/light_light_dim.png']); %>>
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >

            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>">
                <div class="tile-content">
                <div style="float:left; height: 90px;">
                <%
                var str = vis.states.attr(this.data.oid + '.val');
                var val = parseFloat(str);
                if (str === true || str === 'true') val = 1;
                if (isNaN(val)) val = 0;
                                
                var min = this.data.attr('min');
                if (min !== undefined && min !== null && min !== '') {
                    min = parseFloat(min);
                } else {
                    min = 0;
                }

                var max = this.data.attr('max');
                if (max !== undefined && max !== null && max !== '') {
                    max = parseFloat(max);
                } else {
                    max = 1;
                }

                val = (val - min) / (max - min);
				
                if (val === 1) {
                %>
                <img width="90px" src="widgets/metro/img/light_light_dim_100.png"/>
                <% } else if (val >= 0.9) { %>
                <img width="90px" src="widgets/metro/img/light_light_dim_90.png"/>
                <% } else if (val >= 0.8) { %>
                <img width="90px" src="widgets/metro/img/light_light_dim_80.png"/>
                <% } else if (val >= 0.7) { %>
                <img width="90px" src="widgets/metro/img/light_light_dim_70.png"/>
                <% } else if (val >= 0.6) { %>
                <img width="90px" src="widgets/metro/img/light_light_dim_60.png"/>
                <% } else if (val >= 0.5) { %>
                <img width="90px" src="widgets/metro/img/light_light_dim_50.png"/>
                <% } else if (val >= 0.4) { %>
                <img width="90px" src="widgets/metro/img/light_light_dim_40.png"/>
                <% } else if (val >= 0.3) { %>
                <img width="90px" src="widgets/metro/img/light_light_dim_30.png"/>
                <% } else if (val >= 0.2) { %>
                <img width="90px" src="widgets/metro/img/light_light_dim_20.png"/>
                <% } else if (val >= 0.1) { %>
                <img width="90px" src="widgets/metro/img/light_light_dim_10.png"/>
                <% } else if (val >= 0.01) { %>
                <img width="90px" src="widgets/metro/img/light_light_dim_00.png"/>
                <% } else { %>
                <img width="90px" src="widgets/metro/img/light_light_dim.png"/>
                <% } %>
                </div>
                <div style="margin: 30px 70px 0 0; float:right">
                    <div class="input-control switch">
                        <label>
                            <input type="checkbox" name="<%= this.data.attr('wid') %>_checkbox" id="<%= this.data.attr('wid') %>_checkbox" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.checkbox(el, true, data.min, data.max) %>/>
                            <span class="check"></span>
                        </label>
                    </div>
                </div>
                    <div style="clear: both; margin: 0 12px;" data-oid="<%= this.data.attr('oid') %>" data-oid-working="<%= this.data.attr('oid-working') %>" id="metroSlider_<%= this.data.attr('wid') %>" class="slider" data-role="slider"></div>
                    <div <%= (el) -> vis.binds.metro.slider(el, {min: parseFloat(data.min), max: parseFloat(data.max), step: parseFloat(data.step), color: data.sliderColor, completeColor: data.sliderCompleteColor, markerColor: data.sliderMarkerColor}) %>></div>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %><%= (el) -> vis.binds.metro.inputControl(el) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileDimmerDialog"
        type="text/ejs"
        data-vis-prev='<div id="prev_tplMetroTileDimmerDialog" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock" style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"><div class="tile-content" style="text-align: center"><img width="90%" src="widgets/metro/img/light_light_dim.png"></div> <div class="brand ribbed-steel"><span class="label fg-white">Dimmer Dialog</span></div> </div><div style="padding: 42px 10px 10px;"></div></div></div></div>'
        data-vis-attrs="oid;oid-working;min;max;step[1];digits/number;hover[true]/checkbox;transform[true]/checkbox;label;"
        data-vis-attrs0="bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.slider;sliderColor/color;sliderCompleteColor/color;sliderMarkerColor/color;"
        data-vis-attrs3="group.dialog;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox"
        class="vis-tpl"
        data-vis-set="metro"
        data-vis-type="ctrl,dimmer,dialog"
        data-vis-name="Tile Dimmer Dialog">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;" <%= (el) -> vis.preloadImages(['widgets/metro/img/light_light_dim_100.png','widgets/metro/img/light_light_dim_90.png','widgets/metro/img/light_light_dim_80.png','widgets/metro/img/light_light_dim_70.png','widgets/metro/img/light_light_dim_60.png','widgets/metro/img/light_light_dim_50.png','widgets/metro/img/light_light_dim_40.png','widgets/metro/img/light_light_dim_30.png','widgets/metro/img/light_light_dim_20.png','widgets/metro/img/light_light_dim_10.png','widgets/metro/img/light_light_dim.png']); %>>
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >

            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>">
                <div class="tile-content" style="text-align: center">
                <%
                var str = vis.states.attr(this.data.oid + '.val');
                var val = parseFloat(str);
                if (str === true || str === 'true') val = 1;
                if (isNaN(val)) val = 0;
                                
                var min = this.data.attr('min');
                if (min !== undefined && min !== null && min !== '') {
                    min = parseFloat(min);
                } else {
                    min = 0;
                }

                var max = this.data.attr('max');
                if (max !== undefined && max !== null && max !== '') {
                    max = parseFloat(max);
                } else {
                    max = 1;
                }

                val = (val - min) / (max - min);

                if (val === 1) {
                %>
                <img width="90%" src="widgets/metro/img/light_light_dim_100.png"/>
                <% } else if (val >= 0.9) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_90.png"/>
                <% } else if (val >= 0.8) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_80.png"/>
                <% } else if (val >= 0.7) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_70.png"/>
                <% } else if (val >= 0.6) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_60.png"/>
                <% } else if (val >= 0.5) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_50.png"/>
                <% } else if (val >= 0.4) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_40.png"/>
                <% } else if (val >= 0.3) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_30.png"/>
                <% } else if (val >= 0.2) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_20.png"/>
                <% } else if (val >= 0.1) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_10.png"/>
                <% } else if (val >= 0.01) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_00.png"/>
                <% } else { %>
                <img width="90%" src="widgets/metro/img/light_light_dim.png"/>
                <% } %>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                </div>
            </div>
            <div
                <%= (el) -> vis.binds.metro.tileDialogSlider(el, data.wid, data.oid, data['oid-working'], {title: data.label, flat: data.dialog_flat, shadow: data.dialog_shadow, overlay: data.dialog_modal, icon: data.dialog_icon_src, icon_class: data.dialog_icon_class, draggable: data.dialog_draggable, width: 300, height: 180}, {min: data.min, max: data.max, step: parseFloat(data.step), color: data.sliderColor, completeColor: data.sliderCompleteColor, markerColor: data.sliderMarkerColor, digits: data.digits}) %> style="padding: 42px 10px 10px;">
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileShutter"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileShutter" style="position: relative; text-align: initial;padding: 4px "><div id="19l1ml014" class="vis-widget_prev  vis-widget-lock " style="width: 287px; height: 120px; padding: 3px; zoom: 0.5;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "> <div style="width: 100%; height: 100%;" id="metroTile_19l1ml014" class="tile hover bg-indigo"> <div class="tile-content"> <div style="float:left; height: 90px;"> <img width="90px" src="widgets/metro/img/fts_shutter_100.png"> </div> <div style="margin: 30px 70px 0 0; float:right"> <div class="input-control switch"> <label> <input type="checkbox" name="19l1ml014_checkbox" id="19l1ml014_checkbox" data-oid="nothing_selected" data-oid-working=""> <span class="check"></span> </label> </div> </div> <div style="clear: both; margin: 0 12px;" data-oid="nothing_selected" data-oid-working="" class="slider" data-role="slider"><div class="complete" style="width: 0;"></div><a class="marker" style="left: 0;"></a></div>  </div> <div class="brand ribbed-steel"><span class="label fg-white">Shutter</span></div></div><div></div> </div></div></div>'
        data-vis-attrs="oid;oid-working;min;max;step[1];hover/checkbox;transform/checkbox;label;"
        data-vis-attrs0="bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.slider;sliderColor/color;sliderCompleteColor/color;sliderMarkerColor/color"
        data-vis-set="metro"
        data-vis-type="ctrl,shutter"
        data-vis-name="Tile Shutter">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width:287px; height: 136px; padding: 3px;" <%= (el) -> vis.preloadImages(['widgets/metro/img/light_light_dim_100.png','widgets/metro/img/light_light_dim_90.png','widgets/metro/img/light_light_dim_80.png','widgets/metro/img/light_light_dim_70.png','widgets/metro/img/light_light_dim_60.png','widgets/metro/img/light_light_dim_50.png','widgets/metro/img/light_light_dim_40.png','widgets/metro/img/light_light_dim_30.png','widgets/metro/img/light_light_dim_20.png','widgets/metro/img/light_light_dim_10.png','widgets/metro/img/light_light_dim.png']); %>>
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >

            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>">
                <div class="tile-content">
                    <div style="float:left; height: 90px;">
                    <%
                    var str = vis.states.attr(this.data.oid + '.val');
                    var val = parseFloat(str);
                    if (str === true || str === 'true') val = 1;
                    if (isNaN(val)) val = 0;

                    var min = this.data.attr('min');
                    if (min !== undefined && min !== null && min !== '') {
                        min = parseFloat(min);
                    } else {
                        min = 0;
                    }

                    var max = this.data.attr('max');
                    if (max !== undefined && max !== null && max !== '') {
                        max = parseFloat(max);
                    } else {
                        max = 1;
                    }

                    val = (val - min) / (max - min);
                    val = 1 - val;
                    if (val === 1) { %>
                    <img width="90px" src="widgets/metro/img/fts_shutter_100.png"/>
                    <% } else if (val >= 0.9) { %>
                    <img width="90px" src="widgets/metro/img/fts_shutter_90.png"/>
                    <% } else if (val >= 0.8) { %>
                    <img width="90px" src="widgets/metro/img/fts_shutter_80.png"/>
                    <% } else if (val >= 0.7) { %>
                    <img width="90px" src="widgets/metro/img/fts_shutter_70.png"/>
                    <% } else if (val >= 0.6) { %>
                    <img width="90px" src="widgets/metro/img/fts_shutter_60.png"/>
                    <% } else if (val >= 0.5) { %>
                    <img width="90px" src="widgets/metro/img/fts_shutter_50.png"/>
                    <% } else if (val >= 0.4) { %>
                    <img width="90px" src="widgets/metro/img/fts_shutter_40.png"/>
                    <% } else if (val >= 0.3) { %>
                    <img width="90px" src="widgets/metro/img/fts_shutter_30.png"/>
                    <% } else if (val >= 0.2) { %>
                    <img width="90px" src="widgets/metro/img/fts_shutter_20.png"/>
                    <% } else if (val >= 0.1) { %>
                    <img width="90px" src="widgets/metro/img/fts_shutter_10.png"/>
                    <% } else { %>
                    <img width="90px" src="widgets/metro/img/fts_window_2w.png"/>
                    <% } %>
                    </div>
                    <div style="margin: 30px 70px 0 0; float:right">
                        <div class="input-control switch">
                            <label>
                                <input type="checkbox" name="<%= this.data.attr('wid') %>_checkbox" id="<%= this.data.attr('wid') %>_checkbox" data-oid="<%= this.data.attr('oid') %>" data-oid-working="<%= this.data.attr('oid-working') %>" <%= (el) -> vis.binds.basic.checkbox(el, true, data.min, data.max) %>/>
                                <span class="check"></span>
                            </label>
                        </div>
                    </div>
                    <div style="clear: both; margin: 0 12px;" data-oid="<%= this.data.attr('oid') %>" data-oid-working="<%= this.data.attr('oid-working') %>" id="metroSlider_<%= this.data.attr('wid') %>" class="slider" data-role="slider"></div>
                    <div <%= (el) -> vis.binds.metro.slider(el, {min: data.min, max: data.max, step: parseFloat(data.step), color:data.sliderColor,completeColor:data.sliderCompleteColor,markerColor:data.sliderMarkerColor}) %>></div>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                </div>
            </div>


            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %><%= (el) -> vis.binds.metro.inputControl(el) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileShutterDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileShutterDialog" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock " style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content" style="text-align: center"> <img width="90px" src="widgets/metro/img/fts_shutter_100.png"> </div> <div class="brand ribbed-steel"> <span class="label fg-white">Shutter dialog</span> </div> </div> <div style="padding: 42px 10px 10px;"> </div>  </div> </div></div>'
        data-vis-attrs="oid;oid-working;min;max;step[1];hover[true]/checkbox;transform[true]/checkbox;label;"
        data-vis-attrs0="bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.slider;sliderColor/color;sliderCompleteColor/color;sliderMarkerColor/color;"
        data-vis-attrs3="group.dialog;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox"
        data-vis-set="metro"
        data-vis-type="ctrl,shutter,dialog"
        data-vis-name="Tile Shutter Dialog">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;" <%= (el) -> vis.preloadImages(['widgets/metro/img/light_light_dim_100.png','widgets/metro/img/light_light_dim_90.png','widgets/metro/img/light_light_dim_80.png','widgets/metro/img/light_light_dim_70.png','widgets/metro/img/light_light_dim_60.png','widgets/metro/img/light_light_dim_50.png','widgets/metro/img/light_light_dim_40.png','widgets/metro/img/light_light_dim_30.png','widgets/metro/img/light_light_dim_20.png','widgets/metro/img/light_light_dim_10.png','widgets/metro/img/light_light_dim.png']); %>>
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >

            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>">
                <div class="tile-content" style="text-align: center">
                <%
                var str = vis.states.attr(this.data.oid + '.val');
                var val = parseFloat(str);
                if (str === true || str === 'true') val = 1;
                if (isNaN(val)) val = 0;

                var min = this.data.attr('min');
                if (min !== undefined && min !== null && min !== '') {
                    min = parseFloat(min);
                } else {
                    min = 0;
                }

                var max = this.data.attr('max');
                if (max !== undefined && max !== null && max !== '') {
                    max = parseFloat(max);
                } else {
                    max = 1;
                }

                val = (val - min) / (max - min);
                val = 1 - val;

                if (val === 1) { %>
                <img width="90px" src="widgets/metro/img/fts_shutter_100.png"/>
                <% } else if (val >= 0.9) { %>
                <img width="90px" src="widgets/metro/img/fts_shutter_90.png"/>
                <% } else if (val >= 0.8) { %>
                <img width="90px" src="widgets/metro/img/fts_shutter_80.png"/>
                <% } else if (val >= 0.7) { %>
                <img width="90px" src="widgets/metro/img/fts_shutter_70.png"/>
                <% } else if (val >= 0.6) { %>
                <img width="90px" src="widgets/metro/img/fts_shutter_60.png"/>
                <% } else if (val >= 0.5) { %>
                <img width="90px" src="widgets/metro/img/fts_shutter_50.png"/>
                <% } else if (val >= 0.4) { %>
                <img width="90px" src="widgets/metro/img/fts_shutter_40.png"/>
                <% } else if (val >= 0.3) { %>
                <img width="90px" src="widgets/metro/img/fts_shutter_30.png"/>
                <% } else if (val >= 0.2) { %>
                <img width="90px" src="widgets/metro/img/fts_shutter_20.png"/>
                <% } else if (val >= 0.1) { %>
                <img width="90px" src="widgets/metro/img/fts_shutter_10.png"/>
                <% } else { %>
                <img width="90px" src="widgets/metro/img/fts_window_2w.png"/>
                <% } %>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                </div>
            </div>
            <div
                <%= (el) -> vis.binds.metro.tileDialogSlider(el, data.wid, data.oid, data['oid-working'], {title:data.label,flat:data.dialog_flat,shadow:data.dialog_shadow,overlay:data.dialog_modal,icon:data.dialog_icon_src,icon_class:data.dialog_icon_class,draggable:data.dialog_draggable,width:300,height: 180}, {min: data.min, max: data.max, step: parseFloat(data.step),color:data.sliderColor,completeColor:data.sliderCompleteColor,markerColor:data.sliderMarkerColor}) %> style="padding: 42px 10px 10px;">
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileHeating"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileHeating" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock " style="width: 250px; height: 136px; padding: 3px; zoom: 0.5;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "> <div style="width: 100%; height: 100%;" class="tile bg-indigo"> <div class="tile-content"> <div style="float:left; height: 90px;"> <img width="90px" src="widgets/metro/img/sani_heating_temp.png"> </div> <div style="float: right; padding-top: 16px; padding-right: 12px;"> <table style="color:white;font-size:11px;display:inline-block;"> <tr><td>Set temperature:</td><td>0%</td></tr> <tr><td>Actual temperature:</td><td>0.0°C</td></tr> <tr><td>Drive position:</td><td>0</td></tr> </table> </div> <div style="clear: both; margin: 0 12px;" class="slider" data-role="slider"></div>  </div> <div class="brand ribbed-steel"> <span class="label fg-white">Heating</span> </div> </div> <div></div> </div> </div></div>'
        data-vis-attrs="set_oid/id/onHeatingOid;temp_oid/id;drive_oid/id;hum_oid/id;hover/checkbox;transform/checkbox;label;min[6]/slider,-20,40,1;max[30]/slider,-20,40,1;step;"
        data-vis-attrs0="bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="label_set;label_temp;label_drive;label_humidity;"
        data-vis-attrs3="group.slider;sliderColor/color;sliderCompleteColor/color;sliderMarkerColor/color;"
        data-vis-attrs4="group.service;lowbat_oid/id;icon_lowbat[icon-battery]/style,iconFont,icon-,,Icon;controlmode_oid/id;icon_control_mode_0[icon-clock]/style,iconFont,icon-,,Icon;icon_control_mode_1[icon-radio-unchecked]/style,iconFont,icon-,,Icon;icon_control_mode_2[icon-briefcase]/style,iconFont,icon-,,Icon;windowopen_oid/id;icon_windowopen[icon-enter]/style,iconFont,icon-,,Icon;badge_bg_class[]/style,metro-,bg-;"
        data-vis-set="metro"
        data-vis-type="ctrl,heating"
        data-vis-name="Tile Heating">
    <% // some data processing to prepare the data 
        var size_badge      = 0;

        if (this.data.attr('controlmode_oid')) size_badge++;
        if (this.data.attr('windowopen_oid'))  size_badge++;
        if (this.data.attr('lowbat_oid'))      size_badge++; 
    %>
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width:287px; height: 136px; padding: 3px;" <%= (el) -> vis.preloadImages(['widgets/metro/img/light_light_dim_100.png','widgets/metro/img/light_light_dim_90.png','widgets/metro/img/light_light_dim_80.png','widgets/metro/img/light_light_dim_70.png','widgets/metro/img/light_light_dim_60.png','widgets/metro/img/light_light_dim_50.png','widgets/metro/img/light_light_dim_40.png','widgets/metro/img/light_light_dim_30.png','widgets/metro/img/light_light_dim_20.png','widgets/metro/img/light_light_dim_10.png','widgets/metro/img/light_light_dim.png']); %>>
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >
            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>">
                <div class="tile-content">
                    <div style="float:left; height: 90px;">
                        <img width="90px" src="widgets/metro/img/sani_heating_temp.png"/>
                    </div>
                    <div style="float: right; padding-top: 16px; padding-right: 12px;">
                        <table style="color:white;font-size:11px;display:inline-block;">
                            <% if (this.data.attr('set_oid')) { %>
                                <tr><td><%== this.data.attr('label_set')   ? this.data.attr('label_set')   : _('Set temperature') %>:</td><td><%= vis.binds.metro.format(vis.states.attr(this.data.attr('set_oid') + '.val'), '°') %></td></tr>
                            <% } %>
                            <% if (this.data.attr('temp_oid')) { %>
                                <tr><td><%== this.data.attr('label_temp')  ? this.data.attr('label_temp')  : _('Actual temp.') %>:</td><td><%=    vis.binds.metro.format(vis.states.attr(this.data.attr('temp_oid') + '.val'), '°') %></td></tr>
                            <% } %>
                            <% if (this.data.attr('drive_oid')) { %>
                                <tr><td><%== this.data.attr('label_drive') ? this.data.attr('label_drive') : _('Valve position') %>:</td><td><%=  vis.binds.metro.format(vis.states.attr(this.data.attr('drive_oid') + '.val'), '%') %></td></tr>
                            <% } %>
                            <% if (this.data.attr('hum_oid')) { %>
                                <tr><td><%== this.data.attr('label_humidity') ? this.data.attr('label_humidity') : _('Humidity') %>:</td><td><%=  vis.binds.metro.format(vis.states.attr(this.data.attr('hum_oid') + '.val'), '%') %></td></tr>
                            <% } %>
                        </table>
                    </div>
                    <div style="clear: both; margin: 0 12px;" data-oid="<%= this.data.attr('set_oid') %>" data-oid-working="<%= this.data.attr('oid-working') %>" id="metroSlider_<%= this.data.attr('wid') %>" class="slider" data-role="slider"></div>
                    <div <%= (el) -> vis.binds.metro.slider(el, {color: data.sliderColor, completeColor: data.sliderCompleteColor, markerColor: data.sliderMarkerColor, max: (data.max === '' || data.max === undefined || data.max === null) ? 30 : data.max, min: (data.min === '' || data.min === undefined || data.min === null) ? 6 : data.min, step: parseFloat(data.step) || 0.1, hideIfNoOid: true}) %>></div>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                    <% if (size_badge > 0) { %>
                        <div class="badge <%= this.data.attr('badge_bg_class') %>" style="width: <%= size_badge * 19 %>px">
                        <% if (this.data.attr('controlmode_oid')) { %>
                            <i class="<%= this.data.attr('icon_control_mode_' + vis.states.attr(this.data.attr('controlmode_oid') + '.val')) %>" style="padding: 0 1px;"></i>
                        <% } %>
                        <% if (this.data.attr('lowbat_oid')) { %>
                            <i class="<%= (vis.states.attr(this.data.attr('lowbat_oid') + '.val') === true || vis.states.attr(this.data.attr('lowbat_oid') + '.val') === 'true' || vis.states.attr(this.data.attr('lowbat_oid') + '.val') == 1) ? this.data.attr('icon_lowbat') : 'metro-invisible' %>" style="padding: 0 1px;"></i>
                        <% } %>
                        <% if (this.data.attr('windowopen_oid')) { %>
                            <i class="<%= (vis.states.attr(this.data.attr('windowopen_oid') + '.val') === true || vis.states.attr(this.data.attr('windowopen_oid') + '.val') === 'true' || vis.states.attr(this.data.attr('windowopen_oid') + '.val') == 1) ? this.data.attr('icon_windowopen') : 'metro-invisible' %>" style="padding: 0 1px;"></i>
                        <% } %>
                        </div>
                    <% } %>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %><%= (el) -> vis.binds.metro.inputControl(el) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileHeatingDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileHeatingDialog" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock" style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content" style="text-align: center"> <img width="105px" src="widgets/metro/img/sani_heating_temp.png"> </div> <div style="color:white; font-size:11px; margin-top: 84px; padding-left: 12px;"> Target: °C, Actual: °C </div> <div class="brand "> <span class="label fg-white"></span> </div> </div> <div></div> <div></div> </div> </div>'
        data-vis-attrs="set_oid/id/onHeatingOid;temp_oid/id;drive_oid/id;hover[true]/checkbox;transform[true]/checkbox;label;min[6]/slider,-20,40,1;max[30]/slider,-20,40,1;step;"
        data-vis-attrs0="bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="label_short_set;label_short_temp;label_short_drive;label_set;label_temp;label_drive;"
        data-vis-attrs3="group.slider;sliderColor/color;sliderCompleteColor/color;sliderMarkerColor/color;"
        data-vis-attrs4="group.dialog;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox"
        data-vis-set="metro"
        data-vis-type="ctrl,heating,dialog"
        data-vis-name="Tile Heating Dialog">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;" <%= (el) -> vis.preloadImages(['widgets/metro/img/light_light_dim_100.png','widgets/metro/img/light_light_dim_90.png','widgets/metro/img/light_light_dim_80.png','widgets/metro/img/light_light_dim_70.png','widgets/metro/img/light_light_dim_60.png','widgets/metro/img/light_light_dim_50.png','widgets/metro/img/light_light_dim_40.png','widgets/metro/img/light_light_dim_30.png','widgets/metro/img/light_light_dim_20.png','widgets/metro/img/light_light_dim_10.png','widgets/metro/img/light_light_dim.png']); %>>
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >
            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>">
                <div class="tile-content" style="text-align: center">
                     <img width="105px" src="widgets/metro/img/sani_heating_temp.png"/>
                </div>
                <div style="color:white; font-size:11px; margin-top: 84px; padding-left: 12px;">
                    <%== this.data.attr('set_oid')   ? (      (this.data.attr('label_short_set')   ? this.data.attr('label_short_set')   : _('Target'))         + ': ' + vis.binds.metro.format(vis.states.attr(this.data.attr('set_oid')   + '.val'), '°')) : '' %>
                    <%== this.data.attr('temp_oid')  ? (' ' + (this.data.attr('label_short_temp')  ? this.data.attr('label_short_temp')  : _('Actual'))         + ': ' + vis.binds.metro.format(vis.states.attr(this.data.attr('temp_oid')  + '.val'), '°')) : '' %>
                    <%== this.data.attr('drive_oid') ? (' ' + (this.data.attr('label_short_drive') ? this.data.attr('label_short_drive') : _('Valve position')) + ': ' + vis.binds.metro.format(vis.states.attr(this.data.attr('drive_oid') + '.val'), '%')) : '' %>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tileDialogHeating(el, data.wid, data.set_oid, data.temp_oid, data.drive_oid, {title: data.label, flat: data.dialog_flat, shadow: data.dialog_shadow, overlay: data.dialog_modal, icon: data.dialog_icon_src, icon_class: data.dialog_icon_class, draggable: data.dialog_draggable, width: 300, height: 180, label_set: this.data.attr('label_set'), label_temp: this.data.attr('label_temp'), label_drive: this.data.attr('label_drive')}, {color: data.sliderColor, completeColor: data.sliderCompleteColor, markerColor: data.sliderMarkerColor, max: data.max, min: data.min, step: parseFloat(data.step)}); %>></div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileDialogStatic"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileDialogStatic" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev  vis-widget-lock" style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content fg-white icon"> <i class="icon-home"></i> </div> <div class="brand "> <span class="label fg-white"></span> <div class="badge "><i class=""></i></div> </div> </div> <div style="padding: 42px 10px 10px;"> <div class="caption"></div> <div class="content"></div></div> </div> <div></div> </div>'
        data-vis-attrs="label;content_oid/id;hover[true]/checkbox;transform[true]/checkbox;"
        data-vis-attrs0="bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="group.icon;icon_src/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;icon_class[]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs2="group.badge;icon_badge[]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs3="badge_bg_class[]/style,metro-,bg-;"
        data-vis-attrs4="brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs5="group.dialog;html/html;dialog_width;dialog_height;dialog_title;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox;dialog_icon_src/image;dialog_icon_class[]/style,iconFont,icon-,,Icon ;"
        data-vis-set="metro"
        data-vis-type="ctrl,dialog"
        data-vis-name="static - Tile Dialog">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >
            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>" >
                <div class="tile-content fg-white icon <%= this.data.attr("icon_class") ? '' : 'icon-custom' %>">
                    <%== this.data.attr("icon_src") ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr("icon_src") + '"/>' : '' %>
                    <i class="<%= this.data.attr("icon_class") %>"></i>
                    <%== this.data.attr('content_oid') ? vis.states.attr(this.data.content_oid + '.val') : '' %>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                    <div class="badge <%= this.data.attr("badge_bg_class") %>"><i class="<%= this.data.attr("icon_badge") %>"></i></div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tileDialog(el, data.wid, null, {title: data.dialog_title,flat:data.dialog_flat,shadow:data.dialog_shadow,overlay: data.dialog_modal, icon: data.dialog_icon_src, icon_class: data.dialog_icon_class, draggable: data.dialog_draggable, width: data.dialog_width, height: data.dialog_height}, data.html) %> style="padding: 42px 10px 10px;">
                <div class="caption"></div>
                <div class="content"></div>
            </div>
        </div>
        <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
    </div>
</script>

<script id="tplMetroTileStaticDialogNumber"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileStaticDialogNumber" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev " style="width: 120px; height: 120px; padding: 3px; z-index: 0;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-book"></i> </div> <div class="brand bg-orange"> <span class="label fg-white"></span> <div style="display: none;" class="badge "></div> </div> </div> <div style="padding: 42px 10px 10px;"> <div class="caption"></div> <div class="content"></div></div> </div> <div></div> </div>'
        data-vis-attrs="content_oid/id;number_oid/id;hide_on_0/checkbox;hover[true]/checkbox;transform[true]/checkbox;bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs0="group.icon;icon_src/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;icon_class[icon-pictures]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs1="group.badge;label;badge_bg_class[]/style,metro-,bg-;brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.dialog;html/html;dialog_width;dialog_height;dialog_title;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox;dialog_icon_src/image;dialog_icon_class[]/style,iconFont,icon-,,Icon ;"
        data-vis-set="metro"
        data-vis-type="static,dialog"
        data-vis-name="Tile Dialog / val - Badge Number">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >
        <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %> <%= this.data.attr('bg_class') %>" >
            <div class="tile-content icon <%= this.data.attr("icon_class") ? '' : 'icon-custom' %>">
                <%== this.data.attr("icon_src") ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr("icon_src") + '"/>' : '' %>
                <i class="<%= this.data.attr("icon_class") %>"></i>
                <%== this.data.attr('content_oid') ? vis.states.attr(this.data.content_oid + '.val') : '' %>
            </div>
            <div class="brand <%= this.data.attr("brand_bg_class") %>">
                <span class="label fg-white"><%= this.data.attr("label") %></span>
                <div style="<%= vis.states.attr(this.data.number_oid + '.val') > 0 ? '' : 'display:none;' %>" class="badge <%= this.data.attr("badge_bg_class") %>"><%= vis.states.attr(this.data.number_oid + '.val') %></div>
            </div>
        </div>
        <div <%= (el) -> vis.binds.metro.tileDialog(el, data.wid, null, {title:data.dialog_title,flat:data.dialog_flat,shadow:data.dialog_shadow,overlay:data.dialog_modal,icon:data.dialog_icon_src,icon_class:data.dialog_icon_class,draggable:data.dialog_draggable,width:data.dialog_width,height:data.dialog_height}, data.html) %> style="padding: 42px 10px 10px;">
            <div class="caption"></div>
            <div class="content"></div></div>
            </div>
        <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
    </div>
</script>

<script id="tplMetroTileDialogString"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileDialogString" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-draggable-handle " style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-film"></i> </div> <div class="brand ribbed-steel"> <span class="label fg-white">Dialog Object</span> <div class="badge "><i class=""></i></div> </div> </div> <div style="padding: 42px 10px 10px;"> <div class="caption"></div> <div class="content"></div></div> </div>  </div></div>'
        data-vis-attrs="content_oid/id;dialog_oid/id;hover[true]/checkbox;transform[true]/checkbox;bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs0="group.icon;icon_src/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;icon_class[]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs1="group.badge;label;icon_badge[]/style,iconFont,icon-,,Icon ;badge_bg_class[]/style,metro-,bg-;brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.dialog;dialog_fontSize[12px];dialog_padding[0px 0px 0px 0px];dialog_textAlign;dialog_width;dialog_height;dialog_title;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox;dialog_icon_src/image;dialog_icon_class[]/style,iconFont,icon-,,Icon ;"
        data-vis-set="metro"
        data-vis-type="val,dialog"
        data-vis-name="Tile Dialog">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
    <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >

        <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>" >
        <div class="tile-content icon <%= this.data.attr("icon_class") ? '' : 'icon-custom' %>">
        <%== this.data.attr("icon_src") ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr("icon_src") + '"/>' : '' %>
        <i class="<%= this.data.attr("icon_class") %>"></i>
        <%== this.data.attr('content_oid') ? vis.states.attr(this.data.content_oid + '.val') : '' %>
    </div>
    <div class="brand <%= this.data.attr("brand_bg_class") %>">
    <span class="label fg-white"><%= this.data.attr("label") %></span>
    <div class="badge <%= this.data.attr("badge_bg_class") %>"><i class="<%= this.data.attr("icon_badge") %>"></i></div>
    </div>
    </div>

    <div <%= (el) -> vis.binds.metro.tileDialogString(el, data.wid, data.dialog_oid, {title:data.dialog_title,flat:data.dialog_flat,shadow:data.dialog_shadow,overlay:data.dialog_modal,icon:data.dialog_icon_src,icon_class:data.dialog_icon_class,draggable:data.dialog_draggable,width:data.dialog_width,height:data.dialog_height},data.dialog_fontSize, data.dialog_padding, data.dialog_textAlign) %> style="padding: 42px 10px 10px;">
    <div class="caption"></div>
    <div class="content"></div></div>
    </div>
    <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
    </div>
</script>

<script id="tplMetroTileStringDialogNumber"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileStringDialogNumber" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-draggable-handle " style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "> <div style="width: 100%; height: 100%;"class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-film"></i> </div> <div class="brand ribbed-steel"> <span class="label fg-white">Dialog Object</span> <div class="badge bg-cyan">1</div> </div> </div> <div style="padding: 42px 10px 10px;"> <div class="caption"></div> <div class="content"></div></div> </div>  </div></div>'
        data-vis-attrs="content_oid/id;dialog_oid/id;number_oid/id;hide_on_0/checkbox;hover[true]/checkbox;transform[true]/checkbox;bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs0="group.icon;icon_src/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;icon_class[icon-database]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs1="group.badge;label;badge_bg_class[]/style,metro-,bg-;brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.dialog;dialog_fontSize[12px];dialog_padding[0px 0px 0px 0px];dialog_textAlign;dialog_width;dialog_height;dialog_title;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox;dialog_icon_src/image;dialog_icon_class[]/style,iconFont,icon-,,Icon ;"
        data-vis-set="metro"
        data-vis-type="val,dialog"
        data-vis-name="Tile Dialog / Badge Number">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >
            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>" >
                <div class="tile-content icon <%= this.data.attr("icon_class") ? '' : 'icon-custom' %>">
                    <%== this.data.attr("icon_src") ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr("icon_src") + '"/>' : '' %>
                    <i class="<%= this.data.attr("icon_class") %>"></i>
                    <%== this.data.attr('content_oid') ? vis.states.attr(this.data.content_oid + '.val') : '' %>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                <div style="<%= vis.states.attr(this.data.number_oid + '.val') > 0 ? '' : 'display:none;' %>" class="badge <%= this.data.attr("badge_bg_class") %>"><%= vis.states.attr(this.data.number_oid + '.val') %></div>
            </div>
        </div>

        <div <%= (el) -> vis.binds.metro.tileDialogString(el, data.wid, data.dialog_oid, {title:data.dialog_title,flat:data.dialog_flat,shadow:data.dialog_shadow,overlay:data.dialog_modal,icon:data.dialog_icon_src,icon_class:data.dialog_icon_class,draggable:data.dialog_draggable,width:data.dialog_width,height:data.dialog_height},data.dialog_fontSize,data.dialog_padding,data.dialog_textAlign) %> style="padding: 42px 10px 10px;">
            <div class="caption"></div>
            <div class="content"></div></div>
        </div>
        <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
    </div>
</script>

<script id="tplMetroTileDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileDialog" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-draggable-handle " style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-pictures"></i> </div> <div class="brand ribbed-steel"> <span class="label fg-white">View Container</span> <div class="badge "><i class=""></i></div> </div> </div> <div style="padding: 42px 10px 10px;"> <div class="caption"></div> <div class="content"></div> </div> </div>  </div></div>'
        data-vis-attrs="contains_view/views;hover[true]/checkbox;transform[true]/checkbox;"
        data-vis-attrs0="bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="group.icon;icon_src/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;"
        data-vis-attrs2="icon_class[icon-pictures]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs3="group.badge;label;icon_badge[]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs4="badge_bg_class[]/style,metro-,bg-;"
        data-vis-attrs5="brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs6="group.dialog;dialog_width;dialog_height;dialog_title;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox;dialog_icon_src/image;"
        data-vis-attrs7="dialog_icon_class[]/style,iconFont,icon-,,Icon ;"
        data-vis-set="metro"
        data-vis-type="container,dialog"
        data-vis-name="Tile Dialog">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >
            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>" >
                <div class="tile-content icon <%= this.data.attr("icon_class") ? '' : 'icon-custom' %>">
                    <%== this.data.attr("icon_src") ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr("icon_src") + '"/>' : '' %>
                    <i class="<%= this.data.attr("icon_class") %>"></i>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                    <div class="badge <%= this.data.attr("badge_bg_class") %>"><i class="<%= this.data.attr("icon_badge") %>"></i></div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tileDialog(el, data.wid, data.contains_view, {title:data.dialog_title,flat:data.dialog_flat,shadow:data.dialog_shadow,overlay:data.dialog_modal,icon:data.dialog_icon_src,icon_class:data.dialog_icon_class,draggable:data.dialog_draggable,width:data.dialog_width,height:data.dialog_height}) %> style="padding: 42px 10px 10px;">
                <div class="caption"></div>
                <div class="content"></div>
            </div>
        </div>
        <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
    </div>
</script>

<script id="tplMetroTileDialogNumber"
        type="text/ejs"
        data-vis-prev='<div id="prev_tplMetroTileDialogNumber" style="position: relative; text-align: initial;padding: 4px"><div class="vis-widget_prev ui-draggable-handle " style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body "> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-pictures"></i> </div> <div class="brand ribbed-steel"> <span class="label fg-white">Dialog num</span> <div class="badge bg-teal">2</div> </div> </div> <div style="padding: 42px 10px 10px;"> <div class="caption"></div> <div class="content"></div> </div> </div>  </div></div>'
        data-vis-attrs="contains_view/views;number_oid/id;hide_on_0/checkbox;hover[true]/checkbox;transform[true]/checkbox;"
        data-vis-attrs0="bg_class[]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="group.icon;icon_src/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;icon_class[]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs2="group.badge;label;badge_bg_class[]/style,metro-,bg-;"
        data-vis-attrs3="brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs4="group.dialog;dialog_width;dialog_height;dialog_title;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox;dialog_icon_src/image;"
        data-vis-attrs5="dialog_icon_class[]/style,iconFont,icon-,,Icon ;"
        class="vis-tpl"
        data-vis-set="metro"
        data-vis-type="container,dialog"
        data-vis-name="Tile Dialog / val - Badge Number">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >
            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>" >
                <div class="tile-content icon <%= this.data.attr("icon_class") ? '' : 'icon-custom' %>">
                    <%== this.data.attr("icon_src") ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr("icon_src") + '"/>' : '' %>
                    <i class="<%= this.data.attr("icon_class") %>"></i>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                    <div style="<%= vis.states.attr(this.data.number_oid + '.val') > 0 ? '' : 'display:none;' %>" class="badge <%= this.data.attr("badge_bg_class") %>"><%= vis.states.attr(this.data.number_oid + '.val') %></div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tileDialog(el, data.wid, data.contains_view, {title:data.dialog_title,flat:data.dialog_flat,shadow:data.dialog_shadow,overlay:data.dialog_modal,icon:data.dialog_icon_src,icon_class:data.dialog_icon_class,draggable:data.dialog_draggable,width:data.dialog_width,height:data.dialog_height}) %> style="padding: 42px 10px 10px;">
                <div class="caption"></div>
                <div class="content"></div>
            </div>
        </div>
        <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
    </div>
</script>

<script id="tplMetroTileFrameDialogNumber"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileFrameDialogNumber" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev" style="width: 136px; height: 136px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"><div class="tile-content icon"><i class="icon-cloud"></i></div><div class="brand ribbed-steel"><span class="label fg-white">iFrame Dialog</span> <div style="" class="badge "></div> </div> </div> <div style="padding: 42px 10px 10px;"> <div class="caption"></div> <div class="content"></div></div> </div>  </div></div>'
        data-vis-attrs="content;hover[true]/checkbox;transform[true]/checkbox;bg_class[bg-indigo]/style,metro-,bg- ribbed-;group.icon;icon_src/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;icon_class[icon-accessibility]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs0="group.badge;label;badge_label;badge_bg_class[]/style,metro-,bg-;brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="group.dialog;dialog_url[https:~~maps.google.com~maps?f=q&source=s_q&hl=de&geocode=&q=Karlsruhe&ie=UTF8&t=m&z=12&output=embed&iwloc=near];dialog_scroll;dialog_width[400px];dialog_height[300px];dialog_title[Google maps];dialog_flat[true]/checkbox;dialog_shadow[true]/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox;dialog_icon_src/image;dialog_icon_class[icon-globe]/style,iconFont,icon-,,Icon ;"
        data-vis-set="metro"
        data-vis-type="iframe,dialog"
        data-vis-name="Tile Dialog / iFrame">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >
            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>" >
                <div class="tile-content icon <%= this.data.attr("icon_class") ? '' : 'icon-custom' %>">
                    <%== this.data.attr("icon_src") ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr("icon_src") + '"/>' : '' %>
                    <i class="<%= this.data.attr("icon_class") %>"></i>
                    <%== this.data.attr('content') || '' %>
                </div>
                <div class="brand <%= this.data.attr("brand_bg_class") %>">
                    <span class="label fg-white"><%= this.data.attr('label') %></span>
                    <div style="" class="badge <%= this.data.attr('badge_bg_class') %>"><%= this.data.attr('badge_label') %></div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tileDialog(el, data.wid, null, {title: data.dialog_title, flat: data.dialog_flat, shadow: data.dialog_shadow, overlay: data.dialog_modal, icon: data.dialog_icon_src, icon_class: data.dialog_icon_class, draggable: data.dialog_draggable, width: data.dialog_width, height: data.dialog_height, scroll: data.dialog_scroll}, data.dialog_url, true) %> style="padding: 42px 10px 10px;">
                <div class="caption"></div>
                <div class="content"></div></div>
            </div>
        <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
    </div>
</script>

 
 
<script id="tplMetroTileToggleNumber"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMetroTileToggle" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock" style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body " data-oid="dev1"> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"> <div class="tile-content icon"> <i class="icon-minus-2"></i> </div> <div class="brand ribbed-steel"> <span class="label fg-white">Toggle</span> <div class="badge bg-cyan"><i class="icon-minus"></i></div> </div> </div>  </div> </div></div>'
        data-vis-attrs="oid;number_oid/id;hide_on_0/checkbox;hover[true]/checkbox;transform[true]/checkbox;select_on_true/checkbox;label_false;label_true;"
        data-vis-attrs0="bg_class_false[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="bg_class_true[bg-teal]/style,metro-,bg- ribbed-;"
        data-vis-attrs2="group.icon;icon_false/image;icon_true/image;icon_width/slider,0,100,1;icon_height/slider,0,100,1;icon_top/slider,0,100,1;icon_left/slider,0,100,1;"
        data-vis-attrs3="icon_class_false[icon-minus]/style,iconFont,icon-,,Icon ;icon_class_true[icon-plus]/style,iconFont,icon-,,Icon ;"
        data-vis-attrs4="group.badge;badge_bg_class[]/style,metro-,bg-;"
        data-vis-attrs5="badge_bg_class_false[bg-cyan]/style,metro-,bg-;"
        data-vis-attrs6="badge_bg_class_true[bg-teal]/style,metro-,bg-;"
        data-vis-attrs7="brand_bg_class_false[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs8="brand_bg_class_true[ribbed-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs9="group.ccontrol;urlTrue;urlFalse;oidTrue/id;oidFalse/id;oidTrueValue;oidFalseValue;"
        data-vis-set="metro"
        data-vis-type="ctrl,bool"
        data-vis-name="Tile Toggle - Bage Number">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;">
        <div style="width: 100%; height: 100%"
            class="metro vis-widget-body <%== this.data.attr('class') %>"
            data-oid="<%= this.data.attr('oid') %>"
            data-url-true="<%=  this.data.attr('urlTrue') %>"
            data-url-false="<%= this.data.attr('urlFalse') %>"
            data-oid-true="<%=  this.data.attr('oidTrue') %>"
            data-oid-false="<%= this.data.attr('oidFalse') %>"
            data-oid-true-value="<%=  this.data.attr('oidTrueValue') %>"
            data-oid-false-value="<%= this.data.attr('oidFalseValue') %>"
            <%= (el) -> vis.binds.basic.toggle(el) %>
            >
            <div style="width: 100%; height: 100%;"  id="metroTile_<%= this.data.attr('wid') %>" class="tile icon <%= this.data.attr('hover') ? 'hover ' : '' %><%= (vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val')) === '_true') && this.data.attr('select_on_true') ? 'selected' : '' %> <%= this.data.attr('bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>" >
                <div class="tile-content icon <%= this.data.attr('icon_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) ? '' : 'icon-custom' %>">
                    <%== this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) ? '<img style="position: absolute;' + (this.data.attr('icon_top') ? ('top:' + this.data.attr('icon_top') + '%;') : '') + (this.data.attr('icon_left') ? ('left:' + this.data.attr('icon_left') + '%;') : '') + (this.data.attr('icon_width') ? ('width:' + this.data.attr('icon_width') + '%;') : '') + (this.data.attr('icon_height') ? ('height:' + this.data.attr('icon_height') + '%;') : '') + '" src="' + this.data.attr('icon' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) + '"/>' : '' %>
                    <i class="<%= vis.states.attr(this.data.attr('oid') + '.val') ? this.data.attr("icon_class_true") : this.data.attr("icon_class_false") %>"></i>
                </div>
                <div class="brand <%= this.data.attr('brand_bg_class' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %>">
                    <span class="label fg-white"><%== this.data.attr('label' + vis.binds.metro.format(vis.states.attr(this.data.attr('oid') + '.val'))) %></span>
                    <div style="<%= vis.states.attr(this.data.number_oid + '.val') > 0 ? '' : 'display:none;' %>" class="badge <%= this.data.attr("badge_bg_class") %>"><%= vis.states.attr(this.data.number_oid + '.val') %></div>
                </div>
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
    </div>
</script>

<script id="tplMetroTileDimmerDialogactiv"
        type="text/ejs"
        data-vis-prev='<div id="prev_tplMetroTileDimmerDialog" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget-lock" style="width: 120px; height: 120px; padding: 3px;"> <div style="width: 100%; height: 100%" class="metro vis-widget-prev-body"> <div style="width: 100%; height: 100%;" class="tile hover bg-indigo"><div class="tile-content" style="text-align: center"><img width="90%" src="widgets/metro/img/light_light_dim.png"></div> <div class="brand ribbed-steel"><span class="label fg-white">Dimmer Dialog</span></div> </div><div style="padding: 42px 10px 10px;"></div></div></div></div>'
        data-vis-attrs="oid;oid-working;min;max;step[1];digits/number;hover[true]/checkbox;transform[true]/checkbox;label;"
        data-vis-attrs0="bg_class[bg-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs1="brand_bg_class[ribbed-steel]/style,metro-,bg- ribbed-;"
	data-vis-attrs2="brand_bg_class_false[ribbed-steel]/style,metro-,bg- ribbed-;"
        data-vis-attrs3="brand_bg_class_true[ribbed-indigo]/style,metro-,bg- ribbed-;"
        data-vis-attrs4="group.slider;sliderColor/color;sliderCompleteColor/color;sliderMarkerColor/color;"
        data-vis-attrs5="group.dialog;dialog_flat/checkbox;dialog_shadow/checkbox;dialog_draggable[true]/checkbox;dialog_modal/checkbox;autoclose/slider,0,30000,100;"
        class="vis-tpl"
        data-vis-set="metro"
        data-vis-type="ctrl,dimmer,dialog"
        data-vis-name="Tile Dimmer Dialog activ">
    <div id="<%= this.data.attr('wid') %>" class="vis-widget" style="width: 136px; height: 136px; padding: 3px;" <%= (el) -> vis.preloadImages(['widgets/metro/img/light_light_dim_100.png','widgets/metro/img/light_light_dim_90.png','widgets/metro/img/light_light_dim_80.png','widgets/metro/img/light_light_dim_70.png','widgets/metro/img/light_light_dim_60.png','widgets/metro/img/light_light_dim_50.png','widgets/metro/img/light_light_dim_40.png','widgets/metro/img/light_light_dim_30.png','widgets/metro/img/light_light_dim_20.png','widgets/metro/img/light_light_dim_10.png','widgets/metro/img/light_light_dim.png']); %>>
        <div style="width: 100%; height: 100%" class="metro vis-widget-body <%== this.data.attr('class') %>" >

            <div style="width: 100%; height: 100%;" id="metroTile_<%= this.data.attr('wid') %>" class="tile <%= this.data.attr('hover') ? 'hover ' : '' %><%= this.data.attr('bg_class') %>">
                <div class="tile-content" style="text-align: center">
                <%
                var str = vis.states.attr(this.data.oid + '.val');
                var val = parseFloat(str);
                if (str === true || str === 'true') val = 1;
                if (isNaN(val)) val = 0;
                                
                var min = this.data.attr('min');
                if (min !== undefined && min !== null && min !== '') {
                    min = parseFloat(min);
                } else {
                    min = 0;
                }

                var max = this.data.attr('max');
                if (max !== undefined && max !== null && max !== '') {
                    max = parseFloat(max);
                } else {
                    max = 1;
                }

                val = (val - min) / (max - min);

                if (val === 1) {
                %>
                <img width="90%" src="widgets/metro/img/light_light_dim_100.png"/>
                <% } else if (val >= 0.9) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_90.png"/>
                <% } else if (val >= 0.8) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_80.png"/>
                <% } else if (val >= 0.7) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_70.png"/>
                <% } else if (val >= 0.6) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_60.png"/>
                <% } else if (val >= 0.5) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_50.png"/>
                <% } else if (val >= 0.4) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_40.png"/>
                <% } else if (val >= 0.3) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_30.png"/>
                <% } else if (val >= 0.2) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_20.png"/>
                <% } else if (val >= 0.1) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_10.png"/>
                <% } else if (val >= 0.01) { %>
                <img width="90%" src="widgets/metro/img/light_light_dim_00.png"/>
                <% } else { %>
                <img width="90%" src="widgets/metro/img/light_light_dim.png"/>
                <% } %>
                </div>
                
		<div class="brand <%= vis.states.attr(this.data.attr('oid') + '.val') > 0 ? this.data.attr("brand_bg_class_true") : this.data.attr("brand_bg_class_false") %>">
                    <span class="label fg-white"><%= this.data.attr("label") %></span>
                </div>
            </div>
            <div
                <%= (el) -> vis.binds.metro.tileDialogSlider(el, data.wid, data.oid, data['oid-working'], {title: data.label, flat: data.dialog_flat, shadow: data.dialog_shadow, overlay: data.dialog_modal, icon: data.dialog_icon_src, icon_class: data.dialog_icon_class, draggable: data.dialog_draggable, width: 300, height: 180}, {min: data.min, max: data.max, step: parseFloat(data.step), color: data.sliderColor, completeColor: data.sliderCompleteColor, markerColor: data.sliderMarkerColor, digits: data.digits}) %> style="padding: 42px 10px 10px;">
            </div>
            <div <%= (el) -> vis.binds.metro.tile(el, data.transform) %>></div>
        </div>
	<div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
    </div>
</script>


<!-- --------------metro.html--- END -->
<!-- --------------mihome-vacuum.html--- START -->
<script type="text/javascript">
    'use strict';

    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {
            // Bars
            "picVisible":       {"en": "Background",        "de": "Hintergrund",        "ru": "Фон"},
            "oid-state":        {"en": "ID state",          "de": "Zustands ID",        "ru": "ID старт/стоп"},
            "oid-start":        {"en": "ID to start",       "de": "ID für Start",       "ru": "ID to start"},
            "oid-pause":        {"en": "ID to pause",       "de": "ID für Pause",       "ru": "ID to pause"},
            "oid-find":         {"en": "ID for search",     "de": "ID für Suche",       "ru": "ID для поиска"},
            "oid-home":         {"en": "ID go home",        "de": "ID zu Homebase",     "ru": "ID идти к базе"},
            "oid-power-level":  {"en": "ID for power level","de": "ID für Saugstufe",   "ru": "ID для мощности"},
            "oid-power-level-1":  {"en": "Value for power level 1","de": "Wert für Saugstufe 1",   "ru": "Value для мощности 1"},
            "oid-power-level-2":  {"en": "Value for power level 2","de": "Wert für Saugstufe 2",   "ru": "Value для мощности 2"},
            "oid-power-level-3":  {"en": "Value for power level 3","de": "Wert für Saugstufe 3",   "ru": "Value для мощности 3"},
            "oid-connected":    {"en": "ID is connected",   "de": "ID ist verbunden",   "ru": "ID online"}
        });
    }
    vis.binds['mihome-vacuum'] = {
        onclick: function (el, isRunning) {
            var oid = $(el).data('oid');
            if (oid) {
                var val = $(el).data('value');
                if (val) {
                    vis.setValue(oid, parseInt(val));
                } else {
                    if ($(el).data('type') === 'state') {
                        if (isRunning) {
                            vis.setValue($(el).data('pause'), true);
                        } else {
                            vis.setValue($(el).data('start'), true);
                        }
                    } else {
                        if ($(el).data('type') === 'home' && isRunning) {
                            // pause first to send back to the dock;
                            vis.setValue($(el).data('pause'), true);
                        }
                        vis.setValue(oid, true);
                    }
                }
            }
        }
    };

    if (vis.editMode) {
        vis.binds['mihome-vacuum'].changedId = function (widgetID, view, newId, attr, isCss, oldValue) {
            var obj = vis.objects[newId];
            var changed = [];

            if (oldValue) return false;

            if (obj) {
                var ids = newId.split('.');
                ids.pop();
                ids.pop();
                var id = ids.join('.');
                if (!vis.views[view].widgets[widgetID].data['oid-home'] && vis.objects[id + '.control.home']) {
                    vis.views[view].widgets[widgetID].data['oid-home'] = id + '.control.home';
                    vis.widgets[widgetID].data['oid-home'] = id + '.control.home';
                    changed.push('oid-home');
                }
                if (!vis.views[view].widgets[widgetID].data['oid-start'] && vis.objects[id + '.control.start']) {
                    vis.views[view].widgets[widgetID].data['oid-start'] = id + '.control.start';
                    vis.widgets[widgetID].data['oid-start'] = id + '.control.start';
                    changed.push('oid-start');
                }
                if (!vis.views[view].widgets[widgetID].data['oid-pause'] && vis.objects[id + '.control.pause']) {
                    vis.views[view].widgets[widgetID].data['oid-pause'] = id + '.control.pause';
                    vis.widgets[widgetID].data['oid-pause'] = id + '.control.pause';
                    changed.push('oid-pause');
                }
                if (!vis.views[view].widgets[widgetID].data['oid-connected'] && vis.objects[id + '.info.connection']) {
                    vis.views[view].widgets[widgetID].data['oid-connected'] = id + '.info.connection';
                    vis.widgets[widgetID].data['oid-connected'] = id + '.info.connection';
                    changed.push('oid-connected');
                }
                if (!vis.views[view].widgets[widgetID].data['oid-find'] && vis.objects[id + '.control.find']) {
                    vis.views[view].widgets[widgetID].data['oid-find'] = id + '.control.find';
                    vis.widgets[widgetID].data['oid-find'] = id + '.control.find';
                    changed.push('oid-find');
                }
                if (!vis.views[view].widgets[widgetID].data['oid-power-level'] && vis.objects[id + '.control.fan_power']) {
                    vis.views[view].widgets[widgetID].data['oid-power-level'] = id + '.control.fan_power';
                    vis.widgets[widgetID].data['oid-power-level'] = id + '.control.fan_power';
                    changed.push('oid-power-level');
                }
            }
            return changed.length ? changed : null;
        };
    }

</script>
<script id="tplXiaomiVacuum"
        type="text/ejs"
        class="vis-tpl"
        data-vis-type="ctrl"
        data-vis-set="mihome-vacuum"
        data-vis-name="Control"
        data-vis-prev='<img src="widgets/mihome-vacuum/img/previewControl.png"></img>'
        data-vis-attrs="oid-state/id/changedId;oid-home;oid-start;oid-pause;oid-connected;oid-find;oid-power-level;oid-power-level-1[101]/number;oid-power-level-2[102]/number;oid-power-level-3[104]/number;picVisible[true]/checkbox;"
>
<%
    function isRunning(data) {
        var val= vis.states.attr(data['oid-state'] + '.val');
        // 5 = Cleaning, 6 = Returning home, 11 = Spot cleaning, 17 = Zone cleaning
        return (val == 5 || val == 6 || val == 11 || val == 17);
    }
%>
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 130px; height: 130px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="overflow: visible">
        <img src="widgets/mihome-vacuum/img/vacuum.png" style="width: 100%; height: 100%; <%= this.data.picVisible === true || this.data.picVisible === 'true' ? '' : 'display: none' %>"/>
        <div style="position: absolute;width: 33%;top: 0;left: 31%;border: 4px solid black; height: calc(100% - 8px);border-radius: 100px;">
            <div style="width: calc(100% - 8px); border: 4px solid <%= vis.states.attr(this.data['oid-connected'] + '.val') ? '#C6D4FF' : 'gray' %>; height: calc(100% - 8px); border-radius: 100px;
            /* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#9e9e9e+0,4c4c4c+100,4c4c4c+100 */
        background: rgb(158,158,158); /* Old browsers */
        background: -moz-linear-gradient(left,  rgba(158,158,158,1) 0%, rgba(76,76,76,1) 100%, rgba(76,76,76,1) 100%); /* FF3.6-15 */
        background: -webkit-linear-gradient(left,  rgba(158,158,158,1) 0%,rgba(76,76,76,1) 100%,rgba(76,76,76,1) 100%); /* Chrome10-25,Safari5.1-6 */
        background: linear-gradient(to right,  rgba(158,158,158,1) 0%,rgba(76,76,76,1) 100%,rgba(76,76,76,1) 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#9e9e9e', endColorstr='#4c4c4c',GradientType=1 ); /* IE6-9 */
        ">
            </div>
            <img onclick="vis.binds['mihome-vacuum'].onclick(this, <%= isRunning(this.data) %>)" data-pause="<%= this.data['oid-pause'] %>" data-start="<%= this.data['oid-start'] %>" data-type="state" data-oid="<%= this.data['oid-state'] %>" style="position: absolute; width: 60%; left: 20%; top: 15%;cursor: pointer;<%= this.data['oid-state'] ? '' : 'display: none;' %>" src="widgets/mihome-vacuum/img/<%= isRunning(this.data) ? 'on' : 'off' %>.png"  />
            <img onclick="vis.binds['mihome-vacuum'].onclick(this, <%= isRunning(this.data) %>)" data-type="home" data-pause="<%= this.data['oid-pause'] %>" data-oid="<%= this.data['oid-home'] %>" style="position: absolute;width: 60%;left: 20%;bottom: 15%;cursor: pointer;<%= this.data['oid-home'] ? '' : 'display: none;' %>" src="widgets/mihome-vacuum/img/home.png" />
        </div>
        </div>
        <img onclick="vis.binds['mihome-vacuum'].onclick(this)" data-oid="<%= this.data['oid-find'] %>" style="position: absolute; width: 20%; left: 8%; top: 39%;<%= this.data['oid-find'] ? 'cursor: pointer;' : 'display: none;' %>" src="widgets/mihome-vacuum/img/search.png"  />
        <div onclick="vis.binds['mihome-vacuum'].onclick(this)" data-value="<%= this.data['oid-power-level-1'] %>" data-oid="<%= this.data['oid-power-level'] %>" style="position: absolute;top: calc(27% - 8px); left: 72%; border: 1px gray solid; border-radius: 25px; width: 16px; height: 16px; text-align: center;cursor: pointer;<%= this.data['oid-power-level'] ? '' : 'display: none;' %>">1</div>
        <div onclick="vis.binds['mihome-vacuum'].onclick(this)" data-value="<%= this.data['oid-power-level-2'] %>" data-oid="<%= this.data['oid-power-level'] %>" style="position: absolute;top: calc(47% - 8px); left: 77%; border: 1px gray solid; border-radius: 25px; width: 16px; height: 16px; text-align: center;cursor: pointer;<%= this.data['oid-power-level'] ? '' : 'display: none;' %>">2</div>
        <div onclick="vis.binds['mihome-vacuum'].onclick(this)" data-value="<%= this.data['oid-power-level-3'] %>" data-oid="<%= this.data['oid-power-level'] %>" style="position: absolute;top: calc(66% - 8px); left: 72%; border: 1px gray solid; border-radius: 25px; width: 16px; height: 16px; text-align: center;cursor: pointer;<%= this.data['oid-power-level'] ? '' : 'display: none;' %>">3</div>
    </div>
</script>

<!-- --------------mihome-vacuum.html--- END -->
<!-- --------------milight.html--- START -->
<!--
    ioBroker.vis Milight JQuery widgets with MFD icons
    version: "0.0.3"
    Copyright foxthtefox

    based on iobroker.vis-jqui, jqui-mfd
    extended for milight


-->
 <style type="text/css">
 .hue-slider-hue1.ui-slider {
     background-image: url(widgets/jqui/img/hue.png);
     background-size: 0%;
 }
 .hue-slider-ct1.ui-slider {
    background-image: url(widgets/jqui/img/hue.png);
    background-size: 0%;
 }

</style>

<script type="text/javascript" src="widgets/milight/js/milight.js"></script>

<script id="tplMfdMilightDialogCW"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="milight"
        data-vis-type="dimmer,ctrl,dialog"
        data-vis-prev='<div id="prev_tplMfdLight" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget ui-widget ui-button ui-corner-all ui-state-default" style="width: 70px; height: 70px;"> <div class="vis-widget-prev-body"> <img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" width="100%" src="widgets/jqui-mfd/img/light_light_dim.png"></div></div></div>'
        data-vis-name="Light/Dimmer Milight CW/WW for v4"
        data-vis-attrs="oid/id;oid-maxbright;oid-brightdown;oid-brightup;oid-cooler;oid-warmer;buttontext_maxbright[100%]/text;buttontext_brightdown[B-]/text;buttontext_brightup[B+]/text;buttontext_cooler[cool+]/text;buttontext_warmer[warm+]/text;value[true];invert_icon/checkbox;asButton[true]/checkbox;iconColor/color;"
        data-vis-attrs0="group.colors;iconColor0/color;iconColor1/color;iconColor2/color;iconColor3/color;iconColor4/color;iconColor5/color;iconColor6/color;iconColor7/color;iconColor8/color;iconColor9/color;iconColor10/color;"
        data-vis-attrs1="group.dialog;title;noHeader/checkbox;autoclose/checkbox,0,30000,100;modal/checkbox;dialog_width[470];dialog_height[180];dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit;show_value/checkbox;units;"
        >

    <div data-oid="<%= this.data.attr('oid') %>" class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute" <%= (el) -> this.data.attr('asButton') ? vis.binds.jqueryui.classes(el) : '' %>>
    <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body" style="width:100%; height:100%" <%= (el) -> vis.preloadImages(['widgets/jqui-mfd/img/light_light_dim_100.png','widgets/jqui-mfd/img/light_light_dim.png']); %>>
    <%
    var styles = "";
    if (this.data.invert_icon === "true" || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }

    var val = vis.states.attr(this.data.attr('oid') + '.val');

    var image = '';
    if (val == true ||val === 'true' ) {
    %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_100.png"/>
    <% } else { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim.png"/>
    <% } %>
    </div>

    <div id="<%= this.data.attr('wid') %>_dialog" class="<%= this.data.attr('wid') %>_dialog vis-widget-dialog" title="<%= this.data.title || this.data.attr('oid') %>" style="padding-left:20px;" style="width:100px; height:120px">

        <br/>
        <span id="<%= this.data.attr('wid') %>_radio"  class="<%= this.data.attr('wid') %>_radio" style="text-align: center" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
            <input type="radio" id="<%= this.data.attr('wid') %>_radio_off" name="<%= this.data.attr('wid') %>_radio" value="0" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio_off">aus</label>
            <input type="radio" id="<%= this.data.attr('wid') %>_radio_on" name="<%= this.data.attr('wid') %>_radio" value="1"/><label for="<%= this.data.attr('wid') %>_radio_on">an</label>
        </span>
        <br/>
        Helligkeit
        <br/><br/>
        <span style="padding-left: 0px">        
            <button id="<%= this.data.attr('wid') %>_maxbright" style="width:100px; height:40px" data-oid="<%= this.data.attr('oid-maxbright') %>" data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.milightui.buttonToggle(el, this.data.value); vis.binds.milightui.state(el); %>><%== this.data.attr('buttontext_maxbright') %></button>   
        </span>  
        <span style="padding-left: 25px">
            <button id="<%= this.data.attr('wid') %>_brightdown" style="width:100px; height:40px" data-oid="<%= this.data.attr('oid-brightdown') %>" data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.milightui.buttonToggle(el, this.data.value); vis.binds.milightui.state(el); %>><%== this.data.attr('buttontext_brightdown') %></button>
        </span> 
        <span style="padding-left: 10px">
            <button id="<%= this.data.attr('wid') %>_brightup" style="width:100px; height:40px" data-oid="<%= this.data.attr('oid-brightdown') %>" data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.milightui.buttonToggle(el, this.data.value); vis.binds.milightui.state(el); %>><%== this.data.attr('buttontext_brightup') %></button>
        </span> 

        <br/><br/>
        Farbtemperatur
        <br/>
        <span style="padding-left: 50px">        
            <button id="<%= this.data.attr('wid') %>_warmer" style="width:100px; height:40px" data-oid="<%= this.data.attr('oid-warmer') %>" data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.milightui.buttonToggle(el, this.data.value); vis.binds.milightui.state(el); %>><%== this.data.attr('buttontext_warmer') %></button>   
        </span>  
        <span style="padding-left: 10px">
            <button id="<%= this.data.attr('wid') %>_cooler" style="width:100px; height:40px" data-oid="<%= this.data.attr('oid-cooler') %>" data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.milightui.buttonToggle(el, this.data.value); vis.binds.milightui.state(el); %>><%== this.data.attr('buttontext_cooler') %></button>
        </span>    
    </div>
    <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el,{width:400,height:220,modal:data.attr('modal')},true) %> />
    <div class="popup-helper" <%= (el) -> if (data.attr("autoclose") === 'true' || data.attr("autoclose") === true) { vis.binds.jqueryui.dialogAutoClose(el) }  %> />
    </div>
</script>

<script id="tplMfdMilightDialog"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="milight"
        data-vis-type="dimmer,ctrl,dialog"
        data-vis-prev='<div id="prev_tplMfdLight" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget ui-widget ui-button ui-corner-all ui-state-default" style="width: 70px; height: 70px;"> <div class="vis-widget-prev-body"> <img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" width="100%" src="widgets/jqui-mfd/img/light_light_dim.png"></div></div></div>'
        data-vis-name="Light/Dimmer Milight RGBW for v4/5"
        data-vis-attrs="oid/id;oid-level;oid-color;oid-colormode;oid-disco;oid-speedup;oid-speeddown;buttontext_disco[Disco]/text;buttontext_speeddown[S-]/text;buttontext_speedup[S+]/text;value[true];invert_icon/checkbox;asButton[true]/checkbox;iconColor/color;"
        data-vis-attrs0="group.colors;iconColor0/color;iconColor1/color;iconColor2/color;iconColor3/color;iconColor4/color;iconColor5/color;iconColor6/color;iconColor7/color;iconColor8/color;iconColor9/color;iconColor10/color;"
        data-vis-attrs1="group.dialog;title;noHeader/checkbox;autoclose/checkbox,0,30000,100;modal/checkbox;dialog_width[470];dialog_height[180];dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit;show_value/checkbox;units;"
        >

    <div data-oid="<%= this.data.attr('oid') %>" class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute" <%= (el) -> this.data.attr('asButton') ? vis.binds.jqueryui.classes(el) : '' %>>
    <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body" style="width:100%; height:100%" <%= (el) -> vis.preloadImages(['widgets/jqui-mfd/img/light_light_dim_100.png','widgets/jqui-mfd/img/light_light_dim_90.png','widgets/jqui-mfd/img/light_light_dim_80.png','widgets/jqui-mfd/img/light_light_dim_70.png','widgets/jqui-mfd/img/light_light_dim_60.png','widgets/jqui-mfd/img/light_light_dim_50.png','widgets/jqui-mfd/img/light_light_dim_40.png','widgets/jqui-mfd/img/light_light_dim_30.png','widgets/jqui-mfd/img/light_light_dim_20.png','widgets/jqui-mfd/img/light_light_dim_10.png','widgets/jqui-mfd/img/light_light_dim.png']); %>>
    <%
    var styles = "";
    if (this.data.invert_icon === "true" || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }

    var str = vis.states.attr(this.data.attr('oid-level') + '.val');
    var val = (parseFloat(str)/100);
    var image = '';
    if (val == 1) {
    %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_100.png"/>
    <% } else if (val >= 0.9) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_90.png"/>
    <% } else if (val >= 0.8) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_80.png"/>
    <% } else if (val >= 0.7) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_70.png"/>
    <% } else if (val >= 0.6) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_60.png"/>
    <% } else if (val >= 0.5) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_50.png"/>
    <% } else if (val >= 0.4) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_40.png"/>
    <% } else if (val >= 0.3) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_30.png"/>
    <% } else if (val >= 0.2) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_20.png"/>
    <% } else if (val >= 0.1) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_10.png"/>
    <% } else if (val >= 0.01) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_00.png"/>
    <% } else { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim.png"/>
    <% } %>
    </div>

    <div id="<%= this.data.attr('wid') %>_dialog" class="<%= this.data.attr('wid') %>_dialog vis-widget-dialog" title="<%= this.data.title || this.data.attr('oid') %>" style="padding-left:20px;" style="width:100px; height:100px">

        <br/>
        <span id="<%= this.data.attr('wid') %>_radio"  class="<%= this.data.attr('wid') %>_radio" style="text-align: center" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
            <input type="radio" id="<%= this.data.attr('wid') %>_radio_off" name="<%= this.data.attr('wid') %>_radio" value="0" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio_off">aus</label>
            <input type="radio" id="<%= this.data.attr('wid') %>_radio_on" name="<%= this.data.attr('wid') %>_radio" value="1"/><label for="<%= this.data.attr('wid') %>_radio_on">an</label>
        </span>

        <span style="padding-left: 25px" id="<%= this.data.attr('wid') %>_radio_cm"  class="<%= this.data.attr('wid') %>_radio" style="text-align: center" data-oid="<%= this.data.attr('oid-colormode') %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
            <input type="radio" id="<%= this.data.attr('wid') %>_radio_cm_ct" name="<%= this.data.attr('wid') %>_radio_cm" value="ct" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio_cm_ct">weiß</label>
            <input type="radio" id="<%= this.data.attr('wid') %>_radio_cm_hs" name="<%= this.data.attr('wid') %>_radio_cm" value="hs"/><label for="<%= this.data.attr('wid') %>_radio_cm_hs">farbe</label>
        </span>

        <br/><br/>
        Helligkeit
        <div class="sliderJQUI" style="width:90%" id="<%= this.data.attr('wid') %>_slider" data-oid="<%= this.data.attr('oid-level') %>"  <%= (el) -> vis.binds.jqueryui.slider(el, {min:1,max:100,step:1}) %> />
        <br/>
        <br/>

        <div class="hue-mode-hue">
            <div class="sliderJQUI hue-slider-hue1" style="width:90%" id="<%= this.data.attr('wid') %>_hue_hue_slider" data-oid="<%= this.data.attr('oid-color') %>"  <%= (el) -> vis.binds.milightui.hueslider(el, {min:0,max:255,step:1}) %> />
        </div>
        <br/>
        
        <button id="<%= this.data.attr('wid') %>_disco" style="width:80px; height:40px" data-oid="<%= this.data.attr('oid-disco') %>" data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.milightui.buttonToggle(el, this.data.value); vis.binds.milightui.state(el); %>><%== this.data.attr('buttontext_disco') %></button>
        <span style="padding-left: 25px">        
            <button id="<%= this.data.attr('wid') %>_discospeeddown" style="width:70px; height:40px" data-oid="<%= this.data.attr('oid-discospeeddown') %>" data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.milightui.buttonToggle(el, this.data.value); vis.binds.milightui.state(el); %>><%== this.data.attr('buttontext_speeddown') %></button>   
        </span>  
        <span style="padding-left: 25px">
            <button id="<%= this.data.attr('wid') %>_discospeeddown" style="width:70px; height:40px" data-oid="<%= this.data.attr('oid-discospeedup') %>" data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.milightui.buttonToggle(el, this.data.value); vis.binds.milightui.state(el); %>><%== this.data.attr('buttontext_speedup') %></button>
        </span>
        
    </div>
    <div class="pupup-helper" <%= (el) -> vis.binds.milightui.milightColormode(el, this.data.attr('oid-colormode')) %> />
    <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el,{width:440,height:240,modal:data.attr('modal')},true) %> />
    <div class="popup-helper" <%= (el) -> if (data.attr("autoclose") === 'true' || data.attr("autoclose") === true) { vis.binds.jqueryui.dialogAutoClose(el) }  %> />
    </div>
</script>

<script id="tplMfdMilightDialogCWv6"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="milight"
        data-vis-type="dimmer,ctrl,dialog"
        data-vis-prev='<div id="prev_tplMfdLight" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget ui-widget ui-button ui-corner-all ui-state-default" style="width: 70px; height: 70px;"> <div class="vis-widget-prev-body"> <img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" width="100%" src="widgets/jqui-mfd/img/light_light_dim.png"></div></div></div>'
        data-vis-name="Light/Dimmer Milight CW/WW for v6"
        data-vis-attrs="oid/id;oid-nightmode;oid-maxbright;oid-brightdown;oid-brightup;oid-cooler;oid-warmer;buttontext_nightmode[night]/text;buttontext_maxbright[100%]/text;buttontext_brightdown[B-]/text;buttontext_brightup[B+]/text;buttontext_cooler[cool+]/text;buttontext_warmer[warm+]/text;value[true];invert_icon/checkbox;asButton[true]/checkbox;iconColor/color;"
        data-vis-attrs0="group.colors;iconColor0/color;iconColor1/color;iconColor2/color;iconColor3/color;iconColor4/color;iconColor5/color;iconColor6/color;iconColor7/color;iconColor8/color;iconColor9/color;iconColor10/color;"
        data-vis-attrs1="group.dialog;title;noHeader/checkbox;autoclose/checkbox,0,30000,100;modal/checkbox;dialog_width[470];dialog_height[180];dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit;show_value/checkbox;units;"
        >

    <div data-oid="<%= this.data.attr('oid') %>" class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute" <%= (el) -> this.data.attr('asButton') ? vis.binds.jqueryui.classes(el) : '' %>>
    <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body" style="width:100%; height:100%" <%= (el) -> vis.preloadImages(['widgets/jqui-mfd/img/light_light_dim_100.png','widgets/jqui-mfd/img/light_light_dim.png']); %>>
    <%
    var styles = "";
    if (this.data.invert_icon === "true" || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }

    var val = vis.states.attr(this.data.attr('oid') + '.val');

    var image = '';
    if (val == true ||val === 'true' ) {
    %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_100.png"/>
    <% } else { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim.png"/>
    <% } %>
    </div>

    <div id="<%= this.data.attr('wid') %>_dialog" class="<%= this.data.attr('wid') %>_dialog vis-widget-dialog" title="<%= this.data.title || this.data.attr('oid') %>" style="padding-left:20px;" style="width:100px; height:120px">

        <br/>
        <span id="<%= this.data.attr('wid') %>_radio"  class="<%= this.data.attr('wid') %>_radio" style="text-align: center" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
            <input type="radio" id="<%= this.data.attr('wid') %>_radio_off" name="<%= this.data.attr('wid') %>_radio" value="0" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio_off">aus</label>
            <input type="radio" id="<%= this.data.attr('wid') %>_radio_on" name="<%= this.data.attr('wid') %>_radio" value="1"/><label for="<%= this.data.attr('wid') %>_radio_on">an</label>
        </span>
        <span style="padding-left: 25px">        
            <button id="<%= this.data.attr('wid') %>_nightmode" style="width:100px; height:40px" data-oid="<%= this.data.attr('oid-nightmode') %>" data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.milightui.buttonToggle(el, this.data.value); vis.binds.milightui.state(el); %>><%== this.data.attr('buttontext_nightmode') %></button>   
        </span> 
        <br/>
        Helligkeit
        <br/><br/>
        <span style="padding-left: 0px">        
            <button id="<%= this.data.attr('wid') %>_maxbright" style="width:100px; height:40px" data-oid="<%= this.data.attr('oid-maxbright') %>" data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.milightui.buttonToggle(el, this.data.value); vis.binds.milightui.state(el); %>><%== this.data.attr('buttontext_maxbright') %></button>   
        </span>  
        <span style="padding-left: 25px">
            <button id="<%= this.data.attr('wid') %>_brightdown" style="width:100px; height:40px" data-oid="<%= this.data.attr('oid-brightdown') %>" data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.milightui.buttonToggle(el, this.data.value); vis.binds.milightui.state(el); %>><%== this.data.attr('buttontext_brightdown') %></button>
        </span> 
        <span style="padding-left: 10px">
            <button id="<%= this.data.attr('wid') %>_brightup" style="width:100px; height:40px" data-oid="<%= this.data.attr('oid-brightdown') %>" data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.milightui.buttonToggle(el, this.data.value); vis.binds.milightui.state(el); %>><%== this.data.attr('buttontext_brightup') %></button>
        </span> 

        <br/><br/>
        Farbtemperatur
        <br/>
        <span style="padding-left: 50px">        
            <button id="<%= this.data.attr('wid') %>_warmer" style="width:100px; height:40px" data-oid="<%= this.data.attr('oid-warmer') %>" data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.milightui.buttonToggle(el, this.data.value); vis.binds.milightui.state(el); %>><%== this.data.attr('buttontext_warmer') %></button>   
        </span>  
        <span style="padding-left: 10px">
            <button id="<%= this.data.attr('wid') %>_cooler" style="width:100px; height:40px" data-oid="<%= this.data.attr('oid-cooler') %>" data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.milightui.buttonToggle(el, this.data.value); vis.binds.milightui.state(el); %>><%== this.data.attr('buttontext_cooler') %></button>
        </span>    
    </div>
    <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el,{width:400,height:220,modal:data.attr('modal')},true) %> />
    <div class="popup-helper" <%= (el) -> if (data.attr("autoclose") === 'true' || data.attr("autoclose") === true) { vis.binds.jqueryui.dialogAutoClose(el) }  %> />
    </div>
</script>

<script id="tplMfdMilightDialogRGBWv6"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="milight"
        data-vis-type="dimmer,ctrl,dialog"
        data-vis-prev='<div id="prev_tplMfdLight" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget ui-widget ui-button ui-corner-all ui-state-default" style="width: 70px; height: 70px;"> <div class="vis-widget-prev-body"> <img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" width="100%" src="widgets/jqui-mfd/img/light_light_dim.png"></div></div></div>'
        data-vis-name="Light/Dimmer RGBW Milight for v6"
        data-vis-attrs="oid/id;oid-level;oid-color;oid-colormode;oid-mode;open/checkbox;no_style/checkbox;mode_values[1§2§3§4§5§6§7§8§9]/text;mode_texts[Mode 1§Mode 2§Mode 3§Mode 4§Mode 5§Mode 6§Mode 7§Mode 8§Mode 9]/text;oid-speedup;oid-speeddown;buttontext_disco[Disco]/text;buttontext_speeddown[S-]/text;buttontext_speedup[S+]/text;value[true];invert_icon/checkbox;asButton[true]/checkbox;iconColor/color;"
        data-vis-attrs0="group.colors;iconColor0/color;iconColor1/color;iconColor2/color;iconColor3/color;iconColor4/color;iconColor5/color;iconColor6/color;iconColor7/color;iconColor8/color;iconColor9/color;iconColor10/color;"
        data-vis-attrs1="group.dialog;title;noHeader/checkbox;autoclose/checkbox,0,30000,100;modal/checkbox;dialog_width[470];dialog_height[180];dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit;show_value/checkbox;units;"
        >
    <div data-oid="<%= this.data.attr('oid') %>" class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute" <%= (el) -> this.data.attr('asButton') ? vis.binds.jqueryui.classes(el) : '' %>>
    <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body" style="width:100%; height:100%" <%= (el) -> vis.preloadImages(['widgets/jqui-mfd/img/light_light_dim_100.png','widgets/jqui-mfd/img/light_light_dim_90.png','widgets/jqui-mfd/img/light_light_dim_80.png','widgets/jqui-mfd/img/light_light_dim_70.png','widgets/jqui-mfd/img/light_light_dim_60.png','widgets/jqui-mfd/img/light_light_dim_50.png','widgets/jqui-mfd/img/light_light_dim_40.png','widgets/jqui-mfd/img/light_light_dim_30.png','widgets/jqui-mfd/img/light_light_dim_20.png','widgets/jqui-mfd/img/light_light_dim_10.png','widgets/jqui-mfd/img/light_light_dim.png']); %>>
    <%
    var styles = "";
    if (this.data.invert_icon === "true" || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    var str = vis.states.attr(this.data.attr('oid-level') + '.val');
    var val = (parseFloat(str)/100);
    var image = '';
    if (val == 1) {
    %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_100.png"/>
    <% } else if (val >= 0.9) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_90.png"/>
    <% } else if (val >= 0.8) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_80.png"/>
    <% } else if (val >= 0.7) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_70.png"/>
    <% } else if (val >= 0.6) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_60.png"/>
    <% } else if (val >= 0.5) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_50.png"/>
    <% } else if (val >= 0.4) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_40.png"/>
    <% } else if (val >= 0.3) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_30.png"/>
    <% } else if (val >= 0.2) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_20.png"/>
    <% } else if (val >= 0.1) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_10.png"/>
    <% } else if (val >= 0.01) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_00.png"/>
    <% } else { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim.png"/>
    <% } %>
    </div>
    <div id="<%= this.data.attr('wid') %>_dialog" class="<%= this.data.attr('wid') %>_dialog vis-widget-dialog" title="<%= this.data.title || this.data.attr('oid') %>" style="padding-left:20px;" style="width:100px; height:100px">
        <br/>
        <span id="<%= this.data.attr('wid') %>_radio"  class="<%= this.data.attr('wid') %>_radio" style="text-align: center" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
            <input type="radio" id="<%= this.data.attr('wid') %>_radio_off" name="<%= this.data.attr('wid') %>_radio" value="0" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio_off">aus</label>
            <input type="radio" id="<%= this.data.attr('wid') %>_radio_on" name="<%= this.data.attr('wid') %>_radio" value="1"/><label for="<%= this.data.attr('wid') %>_radio_on">an</label>
        </span>
        <span style="padding-left: 25px" id="<%= this.data.attr('wid') %>_radio_cm"  class="<%= this.data.attr('wid') %>_radio" style="text-align: center" data-oid="<%= this.data.attr('oid-colormode') %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
            <input type="radio" id="<%= this.data.attr('wid') %>_radio_cm_ct" name="<%= this.data.attr('wid') %>_radio_cm" value="0" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio_cm_ct">night</label>
            <input type="radio" id="<%= this.data.attr('wid') %>_radio_cm_hs" name="<%= this.data.attr('wid') %>_radio_cm" value="1"/><label for="<%= this.data.attr('wid') %>_radio_cm_hs">weiß</label>
        </span>
        <br/><br/>
        Helligkeit
        <div class="sliderJQUI" style="width:90%" id="<%= this.data.attr('wid') %>_slider" data-oid="<%= this.data.attr('oid-level') %>"  <%= (el) -> vis.binds.jqueryui.slider(el, {min:1,max:100,step:1}) %> />
        <br/>
        <br/>
        <div class="sliderJQUI hue-slider-hue1" style="width:90%" id="<%= this.data.attr('wid') %>_hue_hue_slider" data-oid="<%= this.data.attr('oid-color') %>"  <%= (el) -> vis.binds.milightui.rgbslider(el, {min:0,max:360,step:1}) %> />
        <br/>
        <select style="width:40px" id="<%= this.data.attr('wid') %>_multiselect" data-no-style="<%= this.data.attr('no_style') %>" data-oid="<%= this.data.attr('oid-mode') %>" data-view="<%= this.view %>" <%= (el) -> setTimeout(function (el_) { vis.binds.jqueryui.multiselect(el_, {height: (data.height || 220)}, data.open)}, 250, el); %> >
        <%
            var values = (data.attr('mode_values') ? data.attr('mode_values').split(';') : []);
            var texts  = (data.attr('mode_texts')  ? data.attr('mode_texts').split(';')  : []);
            for (var val in values) {
                %>
                <option value="<%= values[val] %>"><%= texts[val] %></option>
                <%
            }
        %>
        </select >
        <br/>
        <span style="padding-left: 25px">        
            <button id="<%= this.data.attr('wid') %>_discospeeddown" style="width:100px; height:40px" data-oid="<%= this.data.attr('oid-speeddown') %>" data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.milightui.buttonToggle(el, this.data.value); vis.binds.milightui.state(el); %>><%== this.data.attr('buttontext_speeddown') %></button>   
        </span>  
        <span style="padding-left: 25px">
            <button id="<%= this.data.attr('wid') %>_discospeeddown" style="width:100px; height:40px" data-oid="<%= this.data.attr('oid-speedup') %>" data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.milightui.buttonToggle(el, this.data.value); vis.binds.milightui.state(el); %>><%== this.data.attr('buttontext_speedup') %></button>
        </span> 
    </div>
    <div class="pupup-helper" <%= (el) -> vis.binds.milightui.milightColormode(el, this.data.attr('oid-colormode')) %> />
    <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el,{width:440,height:220,modal:data.attr('modal')},true) %> />
    <div class="popup-helper" <%= (el) -> if (data.attr("autoclose") === 'true' || data.attr("autoclose") === true) { vis.binds.jqueryui.dialogAutoClose(el) }  %> />
    </div>
</script>

<script id="tplMfdMilightDialogRGBWWv6"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="milight"
        data-vis-type="dimmer,ctrl,dialog"
        data-vis-prev='<div id="prev_tplMfdLight" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev vis-widget ui-widget ui-button ui-corner-all ui-state-default" style="width: 70px; height: 70px;"> <div class="vis-widget-prev-body"> <img style="filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);" width="100%" src="widgets/jqui-mfd/img/light_light_dim.png"></div></div></div>'
        data-vis-name="Light/Dimmer RGBWW Milight for v6"
        data-vis-attrs="oid/id;oid-level;oid-color;oid-ctemp;oid-saturation;oid-colormode;oid-mode;open/checkbox;no_style/checkbox;mode_values[1§2§3§4§5§6§7§8§9]/text;mode_texts[Mode 1§Mode 2§Mode 3§Mode 4§Mode 5§Mode 6§Mode 7§Mode 8§Mode 9]/text;oid-speedup;oid-speeddown;buttontext_disco[Disco]/text;buttontext_speeddown[S-]/text;buttontext_speedup[S+]/text;value[true];invert_icon/checkbox;asButton[true]/checkbox;iconColor/color;"
        data-vis-attrs0="group.colors;iconColor0/color;iconColor1/color;iconColor2/color;iconColor3/color;iconColor4/color;iconColor5/color;iconColor6/color;iconColor7/color;iconColor8/color;iconColor9/color;iconColor10/color;"
        data-vis-attrs1="group.dialog;title;noHeader/checkbox;autoclose/checkbox,0,30000,100;modal/checkbox;dialog_width[470];dialog_height[180];dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit;show_value/checkbox;units;"
        >
    <div data-oid="<%= this.data.attr('oid') %>" class="vis-widget <%= this.data.attr('asButton') ? ' ui-widget ui-button ui-corner-all ui-state-default' : '' %> <%= this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" style="width:76px; height:76px; position:absolute" <%= (el) -> this.data.attr('asButton') ? vis.binds.jqueryui.classes(el) : '' %>>
    <div id="<%= this.data.attr('wid') %>_body" class="vis-widget-body" style="width:100%; height:100%" <%= (el) -> vis.preloadImages(['widgets/jqui-mfd/img/light_light_dim_100.png','widgets/jqui-mfd/img/light_light_dim_90.png','widgets/jqui-mfd/img/light_light_dim_80.png','widgets/jqui-mfd/img/light_light_dim_70.png','widgets/jqui-mfd/img/light_light_dim_60.png','widgets/jqui-mfd/img/light_light_dim_50.png','widgets/jqui-mfd/img/light_light_dim_40.png','widgets/jqui-mfd/img/light_light_dim_30.png','widgets/jqui-mfd/img/light_light_dim_20.png','widgets/jqui-mfd/img/light_light_dim_10.png','widgets/jqui-mfd/img/light_light_dim.png']); %>>
    <%
    var styles = "";
    if (this.data.invert_icon === "true" || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    var str = vis.states.attr(this.data.attr('oid-level') + '.val');
    var val = (parseFloat(str)/100);
    var image = '';
    if (val == 1) {
    %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_100.png"/>
    <% } else if (val >= 0.9) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_90.png"/>
    <% } else if (val >= 0.8) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_80.png"/>
    <% } else if (val >= 0.7) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_70.png"/>
    <% } else if (val >= 0.6) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_60.png"/>
    <% } else if (val >= 0.5) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_50.png"/>
    <% } else if (val >= 0.4) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_40.png"/>
    <% } else if (val >= 0.3) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_30.png"/>
    <% } else if (val >= 0.2) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_20.png"/>
    <% } else if (val >= 0.1) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_10.png"/>
    <% } else if (val >= 0.01) { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim_00.png"/>
    <% } else { %>
    <img style="<%= styles %>" width="100%" src="widgets/jqui-mfd/img/light_light_dim.png"/>
    <% } %>
    </div>
    <div id="<%= this.data.attr('wid') %>_dialog" class="<%= this.data.attr('wid') %>_dialog vis-widget-dialog" title="<%= this.data.title || this.data.attr('oid') %>" style="padding-left:20px;" style="width:100px; height:100px">
        <br/>
        <span id="<%= this.data.attr('wid') %>_radio"  class="<%= this.data.attr('wid') %>_radio" style="text-align: center" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
            <input type="radio" id="<%= this.data.attr('wid') %>_radio_off" name="<%= this.data.attr('wid') %>_radio" value="0" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio_off">aus</label>
            <input type="radio" id="<%= this.data.attr('wid') %>_radio_on" name="<%= this.data.attr('wid') %>_radio" value="1"/><label for="<%= this.data.attr('wid') %>_radio_on">an</label>
        </span>
        <span style="padding-left: 25px" id="<%= this.data.attr('wid') %>_radio_cm"  class="<%= this.data.attr('wid') %>_radio" style="text-align: center" data-oid="<%= this.data.attr('oid-colormode') %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
            <input type="radio" id="<%= this.data.attr('wid') %>_radio_cm_ct" name="<%= this.data.attr('wid') %>_radio_cm" value="0" checked="checked"/><label for="<%= this.data.attr('wid') %>_radio_cm_ct">night</label>
            <input type="radio" id="<%= this.data.attr('wid') %>_radio_cm_hs" name="<%= this.data.attr('wid') %>_radio_cm" value="1"/><label for="<%= this.data.attr('wid') %>_radio_cm_hs">weiß</label>
        </span>
        <br/><br/>
        Helligkeit
        <div class="sliderJQUI" style="width:90%" id="<%= this.data.attr('wid') %>_slider" data-oid="<%= this.data.attr('oid-level') %>"  <%= (el) -> vis.binds.jqueryui.slider(el, {min:1,max:100,step:1}) %> />
        <br/>
        <div class="sliderJQUI hue-slider-ct1" style="width:90%" id="<%= this.data.attr('wid') %>_hue_ct_slider" data-oid="<%= this.data.attr('oid-ctemp') %>"  <%= (el) -> vis.binds.milightui.ctslider(el, {min:2700,max:6500,step:100}) %> />
        <br/>
        <div class="sliderJQUI hue-slider-hue1" style="width:90%" id="<%= this.data.attr('wid') %>_hue_hue_slider" data-oid="<%= this.data.attr('oid-color') %>"  <%= (el) -> vis.binds.milightui.rgbslider(el, {min:0,max:360,step:1}) %> />
        <br/>
        Sättigung
        <div class="sliderJQUI hue-slider-sat" style="width:90%" id="<%= this.data.attr('wid') %>_hue_sat_slider" data-oid="<%= this.data.attr('oid-saturation') %>"  <%= (el) -> vis.binds.jqueryui.slider(el, {min:0,max:100,step:1}) %> />

        <br/>
        <select id="<%= this.data.attr('wid') %>_multiselect" data-no-style="<%= this.data.attr('no_style') %>" data-oid="<%= this.data.attr('oid-mode') %>" data-view="<%= this.view %>" <%= (el) -> setTimeout(function (el_) { vis.binds.jqueryui.multiselect(el_, {height: (data.height || 220)}, data.open)}, 250, el); %> >
        <%
            var values = (data.attr('mode_values') ? data.attr('mode_values').split(';') : []);
            var texts  = (data.attr('mode_texts')  ? data.attr('mode_texts').split(';')  : []);
            for (var val in values) {
                %>
                <option value="<%= values[val] %>"><%= texts[val] %></option>
                <%
            }
        %>
        </select >

        <br/>        
        <span style="padding-left: 25px">        
            <button id="<%= this.data.attr('wid') %>_discospeeddown" style="width:100px; height:40px" data-oid="<%= this.data.attr('oid-speeddown') %>" data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.milightui.buttonToggle(el, this.data.value); vis.binds.milightui.state(el); %>><%== this.data.attr('buttontext_speeddown') %></button>   
        </span>  
        <span style="padding-left: 25px">
            <button id="<%= this.data.attr('wid') %>_discospeeddown" style="width:100px; height:40px" data-oid="<%= this.data.attr('oid-speedup') %>" data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.milightui.buttonToggle(el, this.data.value); vis.binds.milightui.state(el); %>><%== this.data.attr('buttontext_speedup') %></button>
        </span> 
    </div>
    <div class="pupup-helper" <%= (el) -> vis.binds.milightui.milightRGBWWColormode(el, this.data.attr('oid-colormode')) %> />
    <div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialog(el,{width:440,height:240,modal:data.attr('modal')},true) %> />
    <div class="popup-helper" <%= (el) -> if (data.attr("autoclose") === 'true' || data.attr("autoclose") === true) { vis.binds.jqueryui.dialogAutoClose(el) }  %> />
    </div>
</script>

<!-- --------------milight.html--- END -->
<!-- --------------musiccast.html--- START -->
<!--
    ioBroker.musiccast Widget-Set

    version: "0.0.2"

    Copyright 2018 Author foxthefox<foxthefox@wysiwis.net>
-->
<!-- here you can include so many css as you want -->
<link rel="stylesheet" href="widgets/musiccast/css/style.css" />
<!-- here you can include so many js-files as you want -->
<script type="text/javascript" src="widgets/musiccast/js/musiccast.js"></script>


<script id="tplMusiccastInputSelect"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiSelectList" style=" position: relative; text-align: initial;padding: 4px ">
            <div class="vis-widget_prev ui-selectee ui-draggable-handle" data-vis-resizable="{"disabled":true, "handles":""}" style="left: 336px; top: 323px;"> 
                <div class="vis-widget-prev-body"> <select data-o disabled="" style="display: none;"> <option value="net_radio">NET RADIO</option> <option value="napster">NAPSTER</option> <option value="2">AUTO</option> </select><button type="button" class="ui-multiselect ui-widget ui-state-default ui-corner-all" aria-haspopup="true" style="width: 86px;"><span class="ui-icon ui-icon-triangle-2-n-s"></span><span>Input</span></button> </div> </div>'
        data-vis-set="musiccast"
        data-vis-type="ctrl"
        data-vis-name="Input Selector"
        data-vis-attrs="oid/id;oid_list/id;height[100]/slider,15,500,1;open/checkbox;no_style/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" >
        <% if (false && vis.editMode) { %>
			<div class="editmode-helper" />
		<% } %>
        <div class="vis-widget-body" >
            <select id="<%= this.data.attr('wid') %>_multiselect" data-no-style="<%= this.data.attr('no_style') %>" data-oid="<%= this.data.attr('oid') %>" data-view="<%= this.view %>" <%= (el) -> setTimeout(function (el_) { vis.binds.jqueryui.multiselect(el_, {height: (data.height || 220)}, data.open)}, 250, el); %> >
            <%
				var getValue = vis.binds.musiccast.getValue;
				//(getValue(data['oid_list']) ? getValue(data['oid_list']).split(';') : [])
				var texts  = vis.states[this.data.attr('oid_list') + '.val'];
				var values = getValue(data['oid_list']);
				if (values){
					for (var val=0; val < values.length; val++) { //var val in values wirft Fehler!!
						%>
						<option value="<%= values[val] %>"><%= values[val].toUpperCase() %></option>
						<%
					}
				}
            %>
            </select >
        </div>
    </div>
</script>

<script id="tplMusiccastPresetSelect"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiSelectList" style=" position: relative; text-align: initial;padding: 4px ">
            <div class="vis-widget_prev ui-selectee ui-draggable-handle" data-vis-resizable="{"disabled":true, "handles":""}" style="left: 336px; top: 323px;"> 
                <div class="vis-widget-prev-body"> <select data-o disabled="" style="display: none;"> <option value="1">Preset 1</option> <option value="2">Preset 2</option> <option value="2">AUTO</option> </select><button type="button" class="ui-multiselect ui-widget ui-state-default ui-corner-all" aria-haspopup="true" style="width: 86px;"><span class="ui-icon ui-icon-triangle-2-n-s"></span><span>Preset</span></button> </div> </div>'
        data-vis-set="musiccast"
        data-vis-type="ctrl"
        data-vis-name="Preset Selector"
        data-vis-attrs="oid/id;oid_list/id;height[100]/slider,15,500,1;open/checkbox;no_style/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" >
        <% if (false && vis.editMode) { %>
			<div class="editmode-helper" />
		<% } %>
        <div class="vis-widget-body" >
            <select id="<%= this.data.attr('wid') %>_multiselect" data-no-style="<%= this.data.attr('no_style') %>" data-oid="<%= this.data.attr('oid') %>" data-oid-list="<%= this.data.attr('oid_list') %>"data-view="<%= this.view %>" <%= (el) -> setTimeout(function (el_) { vis.binds.jqueryui.multiselect(el_, {height: (data.height || 220)}, data.open)}, 250, el); %> >
            <%
				var getValue = vis.binds.musiccast.getValue;
				//(getValue(data['oid_list']) ? getValue(data['oid_list']).split(';') : [])
				var texts  = vis.states[this.data.attr('oid_list') + '.val'];
				var values = JSON.parse(getValue(data['oid_list']));
				if (values){
					for (var val=0; val < values.length; val++) {
						var valn = (parseInt(val) + 1);
						%>
						<option value="<%= valn %>"><%= values[val].text %></option>
						<%
					}
				}
            %>
            </select >
        </div>
    </div>
</script>
<script id="tplMusiccastSleep"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiSelectList" style=" position: relative; text-align: initial;padding: 4px ">
            <div class="vis-widget_prev ui-selectee ui-draggable-handle" data-vis-resizable="{"disabled":true, "handles":""}" style="left: 336px; top: 323px;"> 
                <div class="vis-widget-prev-body"> <select data-o disabled="" style="display: none;"> <option value="0">Sleep</option> <option value="30">30min</option> <option value="2">AUTO</option> </select><button type="button" class="ui-multiselect ui-widget ui-state-default ui-corner-all" aria-haspopup="true" style="width: 86px;"><span class="ui-icon ui-icon-triangle-2-n-s"></span><span>OFF</span></button> </div> </div>'
        data-vis-set="musiccast"
        data-vis-type="ctrl"
        data-vis-name="Sleep Selector"
        data-vis-attrs="oid/id;height[100]/slider,15,500,1;open/checkbox;no_style/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" >
        <% if (false && vis.editMode) { %>
			<div class="editmode-helper" />
		<% } %>
        <div class="vis-widget-body" >
            <select id="<%= this.data.attr('wid') %>_multiselect" data-no-style="<%= this.data.attr('no_style') %>" data-oid="<%= this.data.attr('oid') %>" data-view="<%= this.view %>" <%= (el) -> setTimeout(function (el_) { vis.binds.jqueryui.multiselect(el_, {height: (data.height || 220)}, data.open)}, 250, el); %> >
				<option value="off">OFF</option>
				<option value="30">30 min</option>
				<option value="60">60 min</option>
				<option value="90">90 min</option>
				<option value="120">120 min</option>
            </select >
        </div>
    </div>
</script>



<script id="tplMusiccastButtonToggle"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiButtonState" style=" position: relative; text-align: initial;padding: 4px; height: 30px ">
            <div style="left: 384px; top: 470px;" class="vis-widget_prev ui-selectee ui-draggable-handle" data-vis-resizable="{"disabled":true, "handles":"e"}"> 
                <div class="vis-widget-prev-body"> <input type="button" value=" Toggle Button " data-o data-val="" class="ui-button ui-widget ui-state-default ui-corner-all" role="button"> </div> </div>'
        data-vis-set="musiccast"
        data-vis-type="ctrl"
        data-vis-name="Button Toggle"
        data-vis-attrs="oid;html_prepend/html;html_append/html;buttontext[Text];value[true];no_style/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" >
            <%== this.data.attr("html_prepend") %>
            <button style="width:100%; height:100%" data-oid="<%= this.data.attr('oid') %>"  data-no-style="<%= this.data.attr('no_style') %>" data-val="<%= this.data.attr('value') %>" <%= (el) -> vis.binds.musiccast.buttonToggle(el, data.value); vis.binds.musiccast.state(el); %>><%== this.data.attr('buttontext') %></button>
            <%== this.data.attr("html_append") %>
        </div>
    </div>
</script>

<script id="tplMusiccastBool"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="musiccast"
        data-vis-prev='<div id="prev_tplIconStateBool" style="position: relative; text-align: initial;padding: 4px ">
            <div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default " style="width: 100px; height: 25px;" > 
                <div class="vis-widget-prev-body"> <img class="tplImgFalse" src="/vis/img/bulb_on.png" style=" vertical-align:middle;height:100%;" alt=""Bool </div> </div></div>'
        data-vis-name="ctrl - 2cmd, Bool State"
        data-vis-attrs="oid;value_false;value_true;false_text;true_text;false_src/image;true_src/image;imageHeight/slider,0,200,1;false_alt;true_alt;invert_icon/checkbox">
    <%
    var styles = "";
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>
    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 100px; height: 35px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" data-falsecmd="<%= this.data.attr('value_false') %>" data-truecmd="<%= this.data.attr('value_true') %>" <%= (el) -> vis.binds.musiccast.stateBool(el); vis.binds.jqueryui.classes(el, null, data.value_true) %>>
        <div class="vis-widget-body">
            <img class="imgToggleFalse" <%= this.data.attr('false_src') ? 'src="' +  this.data.attr('false_src') + '"' : '' %> style="               <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('false_alt') %>"/ ><span class="imgToggleFalse"><%= this.data.attr('false_text') %></span>
            <img class="imgToggleTrue"  <%= this.data.attr('true_src')  ? 'src="' +  this.data.attr('true_src')  + '"' : '' %> style="display: none; <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('true_alt')  %>" /><span class="imgToggleTrue" style="display:none"><%= this.data.attr('true_text')  %></span>
            <div <%= (el) -> vis.binds.musiccast.itoggle(el) %>></div>
        </div>
    </div>
</script>

<script id="tplMusiccastPlayPause"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="musiccast"
        data-vis-prev='<div id="prev_tplIconStateBool" style="position: relative; text-align: initial;padding: 4px ">
            <div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default " style="width: 100px; height: 25px;" > 
                <div class="vis-widget-prev-body"> <img class="tplImgFalse" src="/vis/img/bulb_on.png" style=" vertical-align:middle;height:100%;" alt="">Play/Pause </div> </div></div>'
        data-vis-name="ctrl - 2cmd, sep. bool state"
        data-vis-attrs="oid;click_id/id;value_false;value_true;false_text;true_text;false_src[/icons-addictive-flavour-png/button/button_blue_pause.png]/image;true_src[/icons-addictive-flavour-png/button/button_blue_play.png]/image;imageHeight/slider,0,200,1;false_alt;true_alt;invert_icon/checkbox">
    <%
    var styles = "";
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>
    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 100px; height: 35px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" data-oid-cmd="<%= this.data.attr('click_id') %>"data-falsecmd="<%= this.data.attr('value_false') %>" data-truecmd="<%= this.data.attr('value_true') %>" <%= (el) -> vis.binds.musiccast.stateBool2(el); vis.binds.jqueryui.classes(el, null, data.value_true) %>>
        <div class="vis-widget-body">
            <img class="imgTogglePlay" <%= this.data.attr('false_src') ? 'src="' +  this.data.attr('false_src') + '"' : '' %> style="               <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('false_alt') %>"/ ><span class="imgToggleFalse"><%= this.data.attr('false_text') %></span>
            <img class="imgTogglePause"  <%= this.data.attr('true_src')  ? 'src="' +  this.data.attr('true_src')  + '"' : '' %> style="display: none; <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('true_alt')  %>" /><span class="imgToggleTrue" style="display:none"><%= this.data.attr('true_text')  %></span>
            <div <%= (el) -> vis.binds.musiccast.itoggle(el) %>></div>
        </div>
    </div>
</script>

<script id="tplMusiccastTray"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="musiccast"
        data-vis-beta="true"
        data-vis-prev='<div id="prev_tplIconStateBool" style="position: relative; text-align: initial;padding: 4px ">
            <div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default " style="width: 100px; height: 25px;" > 
                <div class="vis-widget-prev-body"> <img class="tplImgFalse" src="/vis/img/bulb_on.png" style=" vertical-align:middle;height:100%;" alt=""> CDtray </div> </div></div>'
        data-vis-name="ctrl - toggle, bool state"
        data-vis-attrs="oid;click_id/id;click_value[true];value_true[open];false_text[close];true_text[open];false_src/image;true_src/image;imageHeight/slider,0,200,1;false_alt;true_alt;invert_icon/checkbox">
    <%
    var styles = "";
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>
    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 100px; height: 35px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" data-oid-toggle="<%= this.data.attr('click_id') %>" data-val="<%= this.data.attr('click_value') %>" data-truecmd="<%= this.data.attr('value_true') %>" <%= (el) -> vis.binds.musiccast.stateToggle(el); vis.binds.jqueryui.classes(el, null, data.click_value) %>>
        <div class="vis-widget-body">
            <img class="imgToggleClose" <%= this.data.attr('false_src') ? 'src="' +  this.data.attr('false_src') + '"' : '' %> style="               <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('false_alt') %>"/ ><span class="imgToggleFalse"><%= this.data.attr('false_text') %></span>
            <img class="imgToggleOpen"  <%= this.data.attr('true_src')  ? 'src="' +  this.data.attr('true_src')  + '"' : '' %> style="display: none; <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('true_alt')  %>" /><span class="imgToggleTrue" style="display:none"><%= this.data.attr('true_text')  %></span>
            <div <%= (el) -> vis.binds.musiccast.itoggle(el) %>></div>
        </div>
    </div>
</script>

<!--
	oid = shuffle stat
	click_id = shuffle (button)
	click_value = true
	vis.binds.musiccast.stateToggle = Aufruf vom Button incl Erkennung von shuffle_stat
-->
<script id="tplMusiccastShuffle"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="musiccast"
        data-vis-prev='<div id="prev_tplIconStateBool" style="position: relative; text-align: initial;padding: 4px ">
            <div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default " style="width: 100px; height: 25px;" > 
                <div class="vis-widget-prev-body"> <img class="tplImgFalse" src="/vis/img/bulb_on.png" style=" vertical-align:middle;height:100%;" alt="">Shuffle </div> </div></div>'
        data-vis-name="ctrl - Shuffle"
        data-vis-attrs="oid;click_id/id;click_value[true];false_text[OFF];true_text[ON];songs_text[songs/FOLDER];album_text[Album/Program];false_src/image;true_src/image;songs_src/image;album_src/image;imageHeight/slider,0,200,1;false_alt;true_alt;songs_alt;album_alt;invert_icon/checkbox">
    <%
    var styles = "";
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>
    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 100px; height: 35px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>" data-oid-toggle="<%= this.data.attr('click_id') %>" data-val="<%= this.data.attr('click_value') %>" <%= (el) -> vis.binds.musiccast.stateToggle(el); vis.binds.jqueryui.classes(el, null, data.click_value)  %>>
        <div class="vis-widget-body" >
            <img class="imgToggleFalse" <%= this.data.attr('false_src') ? 'src="' +  this.data.attr('false_src') + '"' : '' %> style="               <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('false_alt') %>"/ ><span class="imgToggleFalse"><%= this.data.attr('false_text') %></span>
            <img class="imgToggleTrue"  <%= this.data.attr('true_src')  ? 'src="' +  this.data.attr('true_src')  + '"' : '' %> style="display: none; <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('true_alt')  %>" /><span class="imgToggleTrue" style="display:none"><%= this.data.attr('true_text')  %></span>
            <img class="imgToggleSongs" <%= this.data.attr('songs_src') ? 'src="' +  this.data.attr('songs_src') + '"' : '' %> style="display: none; <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('songs_alt') %>"/ ><span class="imgToggleSongs" style="display:none"><%= this.data.attr('songs_text') %></span>
            <img class="imgToggleAlbum" <%= this.data.attr('album_src') ? 'src="' +  this.data.attr('album_src') + '"' : '' %> style="display: none; <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('album_alt')  %>" /><span class="imgToggleAlbum" style="display:none"><%= this.data.attr('album_text')  %></span>
            <div <%= (el) -> vis.binds.musiccast.shuffletoggle(el) %>></div>
        </div>
    </div>
</script>

<script id="tplMusiccastRepeat"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="musiccast"
        data-vis-prev='<div id="prev_tplIconStateBool" style="position: relative; text-align: initial;padding: 4px ">
            <div class="vis-widget_prev ui-widget ui-button ui-corner-all ui-state-default " style="width: 100px; height: 25px;" > 
                <div class="vis-widget-prev-body"> <img class="tplImgFalse" src="/vis/img/bulb_on.png" style=" vertical-align:middle;height:100%;" alt=""> Repeat </div> </div></div>'
        data-vis-name="ctrl - Repeat"
        data-vis-attrs="oid;click_id/id;click_value[true];false_text[off];one_text[one];all_text[all];folder_text[album];ab_text[a-b];false_src/image;one_src/image;all_src/image;folder_src/image;ab_src/image;imageHeight/slider,0,200,1;false_alt;one_alt;all_alt;folder_alt;ab_alt;invert_icon/checkbox">
    <%
    var styles = "";
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>
    <div class="vis-widget ui-widget ui-button ui-corner-all ui-state-default <%== this.data.attr('class') %>" style="width: 100px; height: 35px;" id="<%= this.data.attr('wid') %>" data-oid="<%= this.data.attr('oid') %>"  data-oid-toggle="<%= this.data.attr('click_id') %>" data-val="<%= this.data.attr('click_value') %>" <%= (el) -> vis.binds.musiccast.stateToggle(el); vis.binds.jqueryui.classes(el, null, data.click_value) %>>
        <div class="vis-widget-body">
            <img class="imgToggleFalse" <%= this.data.attr('false_src')     ? 'src="' +  this.data.attr('false_src') + '"' : '' %>      style="               <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('false_alt') %>"/ > <span class="imgToggleFalse"><%= this.data.attr('false_text') %></span>
            <img class="imgToggleOne"  <%= this.data.attr('one_src')        ? 'src="' +  this.data.attr('one_src')  + '"' : '' %>       style="display: none; <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('one_alt')  %>" />  <span class="imgToggleOne" style="display:none"><%= this.data.attr('one_text')  %></span>
            <img class="imgToggleAll" <%= this.data.attr('all_src')         ? 'src="' +  this.data.attr('all_src') + '"' : '' %>        style="display: none; <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('all_alt') %>"/ >   <span class="imgToggleAll" style="display:none"><%= this.data.attr('all_text') %></span>
            <img class="imgToggleFolder" <%= this.data.attr('folder_src')   ? 'src="' +  this.data.attr('folder_src')  + '"' : '' %>    style="display: none; <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('folder_alt') %>" /><span class="imgToggleFolder" style="display:none"><%= this.data.attr('folder_text')  %></span>
            <img class="imgToggleAB"  <%= this.data.attr('ab_src')          ? 'src="' +  this.data.attr('ab_src')  + '"' : '' %>        style="display: none; <%= styles %> vertical-align: middle; height: <%= this.data.attr('imageHeight') || 100 %>%;" alt="<%== this.data.attr('ab_alt')  %>" />   <span class="imgToggleAB" style="display:none"><%= this.data.attr('ab_text')  %></span>
            <div <%= (el) -> vis.binds.musiccast.repeattoggle(el) %>></div>
        </div>
    </div>
</script>


<script id="tplMusiccastInputButton"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplJquiRadioSteps" style="zoom: 0.99; position: relative; text-align: initial;padding: 4px ">
            <div class="vis-widget_prev ui-selectee ui-draggable-handle" data-vis-resizable="{"disabled":true, "handles":"e"}" style="left: 85px; top: 258px; font-size: 5px;"> <div class="vis-widget-prev-body"> 
                <div data-o class="ui-buttonset"> <input type="radio" value="0" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only ui-corner-left" role="button" aria-pressed="false"><span class="ui-button-text">NAPSTER</span></label> <input type="radio" value="SPOTIFY" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only" role="button" aria-pressed="false"><span class="ui-button-text">SPOTIFY</span></label> <input type="radio" value="tv" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only" role="button" aria-pressed="false"><span class="ui-button-text">TV</span></label> <input type="radio" value="0.75" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only ui-state-active" role="button" aria-pressed="true"><span class="ui-button-text">75%</span></label> <input type="radio" value="net_radio" class="ui-helper-hidden-accessible"><label class="ui-button ui-widget ui-state-default ui-button-text-only ui-corner-right" role="button" aria-pressed="false"><span class="ui-button-text">NET_RADIO</span></label> </div> </div> </div>'
        data-vis-set="musiccast"
        data-vis-type="ctrl"
        data-vis-name="crtl - Input Buttons "
        data-vis-attrs="oid/id;oid_list/id">
    <div class="vis-widget <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>" data-vis-resizable='{"disabled": true, "handles": "e"}' >
        <div class="vis-widget-body" >
            <div id="<%= this.data.attr('wid') %>_radio"  data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.jqueryui.radio(el); %> >
				<%
					var getValue = vis.binds.musiccast.getValue;
					var values  = vis.states[this.data.attr('oid_list') + '.val'];	
					if (values){
						for (var val=0; val < values.length; val++) {
							%>						
							<input type="radio" id="<%= this.data.attr('wid') %>_radio<%= val %>" name="<%= this.data.attr('wid') %>_radio" value="<%= values[val] %>" checked='checked'/><label for="<%= this.data.attr('wid') %>_radio<%= val %>"><%= values[val].toUpperCase() %></label>
							<% //evtl. bei erster Taste das checked='checked' weglassen
						}
					}

				%>
            </div>
        </div>
    </div>
</script>

<script id="tplMusiccastAlbumArt"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="musiccast"
        data-vis-prev='<img src="widgets/musiccast/img/default_album.png"></img>'
        data-vis-type="val"
        data-vis-name="Album img src"
        data-vis-attrs="oid;html_prepend;html_append;refreshInterval[0]/slider,0,180000,100">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0px; left:0px; width:80px; height: 80px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <div data-oid="<%= this.data.attr('oid') %>">
                <%== this.data.attr('html_prepend') %>
                <img src="<%= (typeof app !== 'undefined' ? app.replaceFilePathImg(vis.states.attr(this.data.oid + '.val')) : vis.states.attr(this.data.oid + '.val')) || 'widgets/musiccast/img/default_album.png' %>" width="100%" />
                 <!-- alte variante
		 <div <%= (el) -> vis.binds.basic.imgRefresh(el, vis.states.attr(data.oid + '.val' ), data.attr("refreshInterval")) %> />
		 -->
		 <div <%= (el) -> vis.binds.basic.imgRefresh(el, vis.states.attr(data.oid + '.val' ), data, this.view) %> />
                <%== this.data.attr('html_append') %>
            </div>
        </div>
    </div>
</script>


<script id="tplMusiccastNetusb"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMusiccastHelper" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev " style="width: 280px; height: 159px;" > <div class="myset-class vis-widget-prev-body " style="padding:2px"> OID: hm-rpc.0.EEQ0006629.1.STATE<br> OID value: true<br> Color: <span style="color: rgb(128, 0, 0);">#800000</span><br> htmlText: <textarea readonly="" style="width:100%">asda</textarea></div>'
        data-vis-attrs="oid/id;htmlText/text;invert_icon/checkbox;html_prepend/html;html_append/html;"
        data-vis-attrs0="group.buttons;oid-rewind/id;oid-prev/id;oid-stop/id;oid-next/id;oid-forward/id;buttontext_rewind[rew];buttontext_prev[prev];buttontext_stop[stop];buttontext_next[next];buttontext_forward[ffw];cmd_value[true];no_style/checkbox"
        data-vis-attrs1="group.playPause;oid-playback/id;oid-playPause/id;play_value[true];value_false[pause];value_true[play];false_text[pause];true_text[play];false_src[/icons-addictive-flavour-png/button/button_blue_pause.png]/image;true_src[/icons-addictive-flavour-png/button/button_blue_play.png]/image;imageHeight/slider,0,200,1;false_alt;true_alt;invert_icon/checkbox"
        data-vis-attrs2="group.extraStatistics;extraAttr"
        data-vis-set="musiccast"
        data-vis-type="ctrl"
        data-vis-name="Netusb">
    <%
    var styles = "";
    if (this.data.invert_icon === 'true' || this.data.invert_icon === true) {
        styles = "filter: invert(1); -webkit-filter: invert(1); -moz-filter: invert(1); -o-filter: invert(1); -ms-filter: invert(1);";
    }
    %>
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 700px; height: 600px" id="<%= this.data.attr('wid') %>">
        <div class="row grey">Yamaha</div>
		<div class="row">
			<div class="col100 red">shuffle</div>
			<div class="col400 grey">album</div>
			<div class="col200 red">linkcontrol</div>
		</div>
		<div class="clear"></div>
		<div class="row">
			<div class="col100 red">repeat</div>
			<div class="col400 grey">Artist</div>
			<div class="col200 red">link delay</div>
		</div>
		<div class="clear"></div>
		<div class="row">
			<div class="col100 red">audioinfo</div>
			<div class="col400 grey">track</div>
			<div class="col200 red">soundprgr</div>
		</div>
		<div class="clear"></div>
		<div class="row">
			<div class="col100 red">clearvoice</div>
			<div class="col100 grey">pure direct</div>
			<div class="col100 red">direct</div>
			<div class="col100 grey">enhance</div>
			<div class="col100 red">bass ext</div>
			<div class="col100 grey">?</div>
			<div class="col100 red">?</div>
		</div>
		<div class="clear"></div>
		<div class="grid">
			<div class="col100 red">Bild</div>
			<div class="col100 grey">bass/Low</div>
			<div class="col100 red">Treble/Mid</div>
			<div class="col100 grey">Balance/High pixels</div>
			<div class="col100 red">Subw</div>
			<div class="col100 grey">Mute</div>
			<div class="col100 red">Power</div>
		</div>
		<div class="clear"></div>
		<div class="row">
			<div class="col100 red">input</div>
			<div class="col400 grey">Volume</div>
			<div class="col200 red">Preset</div>
		</div>
		<div class="clear"></div>
		<div class="row">
			<div class="col100 red">rewind             
            </div>
			<div class="col100 grey">prev
            </div>
			<div class="col100 red">stop                
            </div>
			<div class="col100 grey"> PlayPause
            </div>
			<div class="col100 red">next
            </div>
			<div class="col100 grey"> forward

            </div>            
			<div class="col100 red">sleep</div>
		</div>
		<div class="clear"></div>
    </div>
</script>



<script id="tplMusiccastCD"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplMusiccastHelper" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev " style="width: 280px; height: 159px;" > <div class="myset-class vis-widget-prev-body " style="padding:2px"> OID: hm-rpc.0.EEQ0006629.1.STATE<br> OID value: true<br> Color: <span style="color: rgb(128, 0, 0);">#800000</span><br> htmlText: <textarea readonly="" style="width:100%">asda</textarea></div>'
        data-vis-attrs="oid/id;myColor/color;htmlText/text;"
        data-vis-attrs0="group.extraStatistics;extraAttr"
        data-vis-set="musiccast"
        data-vis-type="ctrl"
        data-vis-name="CDplayer">
    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow:visible; width: 600px; height: 300px" id="<%= this.data.attr('wid') %>">
		<div class="rowCD grey">Yamaha</div>
		<div class="rowCD">
			<div class="col100 red">picture</div>  
			<div class="col400 grey">album</div>
			<div class="col100 red">shuffle</div>
		</div>
		<div class="clear"></div>
		<div class="rowCD">
			<div class="col100 red">???</div>
			<div class="col400 grey">Artist</div>
			<div class="col100 red">repeat</div>
		</div>
		<div class="clear"></div>
		<div class="rowCD">
			<div class="col100 red">open/close</div>
			<div class="col400 grey">track</div>
			<div class="col100 red">track/tracks</div>
		</div>
		<div class="clear"></div>
		<div class="rowCD">
			<div class="col100 red">Time</div>
			<div class="col400 grey">Volume</div>
			<div class="col100 red">TotalTime</div>
		</div>
		<div class="clear"></div>
		<div class="rowCD">
			<div class="col100 red">rewind</div>
			<div class="col100 grey">prev</div>
			<div class="col100 red">stop</div>
			<div class="col100 grey">Play/Pause</div>
			<div class="col100 red">next</div>
			<div class="col100 grey">forward</div>
		</div>
		<div class="clear"></div>
	</div>

</script>


<!-- --------------musiccast.html--- END -->
<!-- --------------players.html--- START -->
<!--
    ioBroker.vis players Widget-Set
    version: "0.1.0"
    Copyright 10.2016-2017 instalator<vvvalt@mail.ru>
-->
<link rel="stylesheet" href="widgets/players/css/style.css" />
<script type="text/javascript" src="widgets/players/js/players.js"></script>

<script id="tplWinampPlayer"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img style="width:112px; height:52px" src="widgets/players/img/winamp.png"></img>'
        data-vis-attrs="oid_play/id/onPlayWinampChanged;oid_next/id;oid_prev/id;oid_stop/id;oid_pause/id;oid_seek/id;oid_vol/id;oid_mute/id;oid_shuffle/id;oid_repeat/id;oid_artist/id;oid_title/id;oid_album/id;oid_bitrate/id;"
        data-vis-set="players"
        data-vis-type="val"
        data-vis-beta="true"
        data-vis-name="Winamp Player">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:354px; height:161px" id="<%= this.data.attr('wid') %>" data-vis-resizable='{"disabled":true, "handles":"e"}'>
    <map id="consoleMap" name="consoleMap">
        <area class="winamp-btn" data-id="repeat"   shape="circle" coords="323,47,9"   alt="Toggle Repeat">
        <area class="winamp-btn" data-id="shuffle"  shape="circle" coords="324,71,9"   alt="Toggle Shuffle">
        <area class="winamp-btn" data-id="playlist" shape="circle" coords="304,99,11"  alt="Toggle Playlist">
        <area class="winamp-btn" data-id="library"  shape="circle" coords="329,99,11"  alt="Toggle dia Library">
        <area class="winamp-btn" data-id="mute"     shape="circle" coords="171,129,7"  alt="Toggle Mute">
        <area class="winamp-btn" data-id="prev"     shape="circle" coords="19,124,11"  alt="Previous Track">
        <area class="winamp-btn" data-id="next"     shape="circle" coords="138,124,11" alt="Next Track">
        <area class="winamp-btn" data-id="stop"     shape="circle" coords="108,125,11" alt="Stop">
        <area class="winamp-btn" data-id="pause"    shape="circle" coords="78,125,11"  alt="Pause">
        <area class="winamp-btn" data-id="play"     shape="circle" coords="48,125,11"  alt="Play">
    </map>
    <div class="winamp">
        <div class="winamp-head">
            <img class="winamp-head_r" src="widgets/players/img/winamp/waBoxTitleRight.gif">
            <img class="winamp-head_l" src="widgets/players/img/winamp/waBoxTitleLeft.gif">
            <div class="winamp-head_c">
                <img class="winamp-head_c-bg" src="widgets/players/img/winamp/waBoxBg.gif">
                <img class="winamp-head_c-img" src="widgets/players/img/winamp/waConsoleTitle.gif">
            </div>
        </div>
        <div class="winamp-body">
            <img src="widgets/players/img/winamp/console.gif" usemap="#consoleMap" width="354" height="144" border="0">
            <img class="winamp-repeat" src="widgets/players/img/winamp/waLightOn.gif" border="0" >
            <img class="winamp-shuffle" src="widgets/players/img/winamp/waLightOn.gif" border="0" >
            <div class="winamp-vol">
                <div class="winamp-vol-slider"></div>
                <span class="volume"></span>
            </div>
            <div class="winamp-seek">
                <div class="winamp-seek-slider"></div>
                <span class="seek"></span>
            </div>
            <div class="winamp-artist">Artist: </div>
            <div class="winamp-title">Title: </div>
            <div class="winamp-album">Album: </div>
            <div class="winamp-bitrate">kbps: </div>
        </div>
    </div>
       <% vis.binds.players.createWidgetWinampPlayer(this.data.wid, this.view, this.data, this.style); %>
	</div>
</script>

<script id="tplWinampPlaylist"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img style="width:112px; height:52px" src="widgets/players/img/winamp_plst.png"></img>'
        data-vis-attrs="oid_playlist/id/onWinampPlaylistChanged;oid_playid/id;oid_track/id;oid_clear/id;"
        data-vis-set="players"
        data-vis-type="val"
        data-vis-beta="true"
        data-vis-name="Winamp Playlist">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:354px; height:161px" id="<%= this.data.attr('wid') %>" >
            <div class="win-plst-head">
                <img class="winamp-head_r" src="widgets/players/img/winamp/waBoxTitleRight.gif">
                <img class="winamp-head_l" src="widgets/players/img/winamp/waBoxTitleLeft.gif">
                <img class="winamp-plst-close" src="widgets/players/img/winamp/closeBox.gif">
                <div class="winamp-head_c">
                    <img class="winamp-head_c-bg" src="widgets/players/img/winamp/waBoxBg.gif">
                    <img class="winamp-head_c-img" src="widgets/players/img/winamp/waPlaylistTitle.gif">
                </div>
            </div>
            <div class="win-plst-body">
                <div class="winamp-playlist">
                    <ul class="winamp-playlist-container">
                    </ul>
                </div>
            </div>
            <div class="win-plst-footer">
                <img class="win-plst-footer-resize" src="widgets/players/img/winamp/waResize.gif">
                <img class="win-plst-footer-l" src="widgets/players/img/winamp/waFooterLeft.gif">
                <div class="win-plst-footer-b">
                    <img class="win-plst-footer-bg" src="widgets/players/img/winamp/waFooterBg.gif">
                    <img class="win-plst-btn-clear" src="widgets/players/img/winamp/plclear.gif">
                </div>
            </div>

    <% vis.binds.players.createWidgetWinampPlaylist(this.data.wid, this.view, this.data, this.style); %>
	</div>
</script>

<script id="tplWinampBrowser"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img style="width:112px; height:52px" src="widgets/players/img/winamp_plst.png"></img>'
        data-vis-attrs="oid_browser/id/onWinampBrowserChanged;oid_add/id;"
        data-vis-set="players"
        data-vis-type="val"
        data-vis-beta="true"
        data-vis-name="Winamp Browser">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:354px; height:161px" id="<%= this.data.attr('wid') %>" >
            <div class="win-browser-head">
                <img class="winamp-head_r" src="widgets/players/img/winamp/waBoxTitleRight.gif">
                <img class="winamp-head_l" src="widgets/players/img/winamp/waBoxTitleLeft.gif">
                <img class="winamp-brwsr-close" src="widgets/players/img/winamp/closeBox.gif">
                <div class="winamp-head_c">
                    <img class="winamp-head_c-bg" src="widgets/players/img/winamp/waBoxBg.gif">
                    <img class="winamp-head_c-img" src="widgets/players/img/winamp/titleML.gif">
                </div>
            </div>
            <div class="win-plst-body">
                <div class="medialibrary">
                    <table class="mlTable">
                        <tbody>
                        <tr>
                            <td class="mlHead">Name<img border="0" src="widgets/players/img/winamp/asc.gif"></td>
                            <!--<td class="mlHead">Date</td>-->
                            <!--<td class="mlHead">Size</td>-->
                        </tr>
                        <tr class="mlChoice">
                            <td class="mlChoice">
                                <span class="mlItem">..</span>
                                <div class="winamp-browser">
                                    <ul class="browser-container"></ul>
                                </div>
                            </td>
					    </tr>
                        </tbody>
                    </table>
                </div>
                <!--<div class="medialibrary-loading">
                    <img src="widgets/players/img/winamp/loading.gif">
                </div>-->
            </div>
            <div class="win-plst-footer"">
                <img class="winamp-head_r" src="widgets/players/img/winamp/waResize.gif">
                <img class="winamp-head_l" src="widgets/players/img/winamp/waFooterLeft.gif">
                <div class="win-plst-footer-b">
                    <img class="win-plst-footer-bg" src="widgets/players/img/winamp/waFooterBg.gif">
                    <img class="browser-btn-add" src="widgets/players/img/winamp/add.gif">
                </div>
            </div>


    <% vis.binds.players.createWidgetWinampBrowser(this.data.wid, this.view, this.data, this.style); %>
	</div>
</script>

<script id="tplSonosMobilePlayer"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img style="width:112px; height:52px" src="widgets/players/img/sonos.png"></img>'
        data-vis-attrs="oid_play/id/onPlaySonosChanged;oid_state/id;oid_next/id;oid_prev/id;oid_pause/id;oid_vol/id;oid_artist/id;oid_title/id;oid_album/id;oid_cover/id;oid_next_title/id;text_next;"
        data-vis-set="players"
        data-vis-beta="true"
        data-vis-update-style="true"
        data-vis-name="Sonos Player">
    <div class="vis-widget sonos-body sonos-landscape <%== this.data.attr('class') %>" style="width: 354px; height: 161px; background: black" id="<%= this.data.attr('wid') %>">
        <div class="sonos-status-container">
            <img class="sonos-current-track-art" />
            <div class="sonos-current-track-info">
                <div>
                    <p class="sonos-track"></p>
                    <p class="sonos-artist"></p>
                    <p class="sonos-album"></p>
                </div>
                <p class="sonos-next-track"><span class="sonos-next-track-title"></span> <span class="sonos-next-track-text"></span></p>
                <div class="sonos-controls">
                    <img class="sonos-button" data-control="prev"  src="widgets/players/img/sonos/prev.svg">
                    <img class="sonos-button" data-control="play"  src="widgets/players/img/sonos/play.svg">
                    <img class="sonos-button" data-control="pause" src="widgets/players/img/sonos/pause.svg" style="display: none">
                    <img class="sonos-button" data-control="next"  src="widgets/players/img/sonos/next.svg">
                    <div class="sonos-master-volume"></div>
                </div>
            </div>
        </div>
	</div>
    <% vis.binds.players.createWidgetSonosPlayer(this.data.wid, this.view, this.data, this.style); %>
</script>

<!-- --------------players.html--- END -->
<!-- --------------plumb.html--- START -->
<!--
    ioBroker.vis plumb widgets

    version: "1.0.1"

    Copyright 2015-2017 smiling_Jack <smiling_Jack@ioBroker.net>

-->
<link rel="stylesheet" type="text/css" href="widgets/plumb/css/plumb.css"/>

<script type="text/javascript" >
    "use strict";

    if (vis.editMode) {
        $.extend(true, systemDictionary, {
            "color_off": 		{"en": "color_off",             "de": "Farbe aus", "ru": "color_off"},
            "color_on": 		{"en": "color_on",              "de": "Farbe an", "ru": "color_on"},
            "group_conTop": 	{"en": "group_conTop",          "de": "Verbindung oben", "ru": "group_conTop"},
            "conTop_show": 		{"en": "conTop_show",           "de": "Anzeigen", "ru": "conTop_show"},
            "conTop_size": 		{"en": "conTop_size",           "de": "Größe", "ru": "conTop_size"},
            "conTop_pos": 		{"en": "conTop_pos",            "de": "Position", "ru": "conTop_pos"},
            "conTop": 			{"en": "conTop",                "de": "Verbindung oben", "ru": "conTop"},
            "group_conBottom": 	{"en": "group_conBottom",       "de": "Verbindung unten", "ru": "group_conBottom"},
            "conBottom_show": 	{"en": "conBottom_show",        "de": "Anzeigen", "ru": "conBottom_show"},
            "conBottom_size": 	{"en": "conBottom_size",        "de": "Größe", "ru": "conBottom_size"},
            "conBottom_pos": 	{"en": "conBottom_pos",         "de": "Position", "ru": "conBottom_pos"},
            "conBottom": 		{"en": "conBottom",             "de": "Verbindung unten", "ru": "conBottom"},
            "group_conLeft": 	{"en": "group_conLeft",         "de": "Verbindung links", "ru": "group_conLeft"},
            "conLeft_show": 	{"en": "conLeft_show",          "de": "Anzeigen", "ru": "conLeft_show"},
            "conLeft_size": 	{"en": "conLeft_size",          "de": "Größe", "ru": "conLeft_size"},
            "conLeft_pos": 		{"en": "conLeft_pos",           "de": "Position", "ru": "conLeft_pos"},
            "conLeft": 			{"en": "conLeft",               "de": "Verbindung links", "ru": "conLeft"},
            "group_conRight": 	{"en": "group_conRight",        "de": "Verbindung rechts", "ru": "group_conRight"},
            "conRight_show": 	{"en": "conRight_show",         "de": "Anzeigen", "ru": "conRight_show"},
            "conRight_size": 	{"en": "conRight_size",         "de": "Größe", "ru": "conRight_size"},
            "conRight_pos": 	{"en": "conRight_pos",          "de": "Position", "ru": "conRight_pos"},
            "conRight": 		{"en": "conRight",              "de": "Verbindung rechts", "ru": "conRight"},
            "type": 			{"en": "type", 					"de": "Art", "ru": "type"},
            "fix": 				{"en": "fix", 					"de": "Fix", "ru": "fix"},
            "bool_on": 			{"en": "bool_on", 				"de": "An", "ru": "bool_on"},
            "bool_off": 		{"en": "bool_off", 				"de": "Aus", "ru": "bool_off"},
            "level_min": 		{"en": "level_min", 			"de": "Wert min", "ru": "level_min"},
            "level_max": 		{"en": "level_max", 			"de": "Wert max", "ru": "level_max"},
            "water_color": 		{"en": "water_color", 			"de": "Wasserfabe", "ru": "water_color"},
            "is_filter": 		{"en": "is_filter", 			"de": "ist Filter", "ru": "is_filter"},
            "top_water": 		{"en": "top_water", 			"de": "Wasser oben", "ru": "top_water"},
            "bottom_water": 	{"en": "bottom_water", 			"de": "Wasser unten", "ru": "bottom_water"},
            "filter_pattern": 	{"en": "filter_pattern", 		"de": "Filter Bild", "ru": "filter_pattern"},
            "filter_size": 		{"en": "filter_size", 			"de": "Filter gröse ", "ru": "filter_size"},
            "filter_opa": 		{"en": "filter_opa", 			"de": "Filter trans.", "ru": "filter_opa"},
            "conTop_water": 	{"en": "conTop_water", 			"de": "Wasserfarbe", "ru": "conTop_water"},
            "conBottom_water": 	{"en": "conBottom_water", 		"de": "Wasserfarbe", "ru": "conBottom_water"},
            "conLeft_water": 	{"en": "conLeft_water", 		"de": "Wasserfarbe", "ru": "conLeft_water"},
            "conRight_water": 	{"en": "conRight_water", 		"de": "Wasserfarbe", "ru": "conRight_water"},
            "ctrl": 			{"en": "ctrl", 					"de": "ctrl", "ru": "ctrl"},
            "show_pipe": 		{"en": "show_pipe", 			"de": "Zeige Rohr", "ru": "show_pipe"},
            "show_symbol": 		{"en": "show_symbol", 			"de": "Zeige Symbol", "ru": "show_symbol"},
            "turn_direction": 	{"en": "turn_direction", 		"de": "Richtung", "ru": "turn_direction"},
            "position": 		{"en": "position", 				"de": "Position", "ru": "position"},
            "time": 			{"en": "time", 					"de": "Geschwindigkeit", "ru": "time"},
            "start": 			{"en": "start", 				"de": "Anfang", "ru": "start"},
            "ende": 			{"en": "ende", 					"de": "Ende", "ru": "ende"},
            "stroke": 			{"en": "stroke", 				"de": "Strahlbreite", "ru": "stroke"},
            "head_color": 		{"en": "head_color", 			"de": "Kopffarbe", "ru": "head_color"},
            "fog": 				{"en": "fog", 					"de": "Sprühnebel", "ru": "fog"},
            "head_show": 		{"en": "head_show", 			"de": "Kopf anzeigen", "ru": "head_show"},
            "head_round": 		{"en": "head_round", 			"de": "Kopf rund", "ru": "head_round"},
            "pipe_size": 		{"en": "Pipe size", 			"de": "Rohr größe", "ru": "pipe_size"},
            "spray_width": 		{"en": "spray_width", 			"de": "Sprühweite", "ru": "spray_width"},
            "spray_range": 		{"en": "spray_range", 			"de": "Sprühbereich", "ru": "spray_range"},
            "test": 			{"en": "test", 					"de": "Test", "ru": "test"},
            "head_size": 		{"en": "head_size", 			"de": "Kopfgröse", "ru": "head_size"},
            "opacity": 			{"en": "opacity", 				"de": "Transparenz", "ru": "opacity"},

            "group_filter": 	{"en": "group_filter", 			"de": "Filter", "ru": "group_filter"},
            "conTop_level": 	{"en": "conTop_level", 			"de": "Füllstand", "ru": "conTop_level"},
            "conTop_color_off": {"en": "conTop_color_off", 		"de": "Farbe aus", "ru": "conTop_color_off"},
            "conTop_color_on": 	{"en": "conTop_color_on", 		"de": "Farbe an", "ru": "conTop_color_on"},
            "conBottom_level": 	{"en": "conBottom_level", 		"de": "Füllstand", "ru": "conBottom_level"},
            "conBottom_color_off": {"en": "conBottom_color_off", "de": "Farbe aus", "ru": "conBottom_color_off"},
            "conBottom_color_on": {"en": "conBottom_color_on", 	"de": "Farbe an", "ru": "conBottom_color_on"},
            "conLeft_level": 	{"en": "conLeft_level", 		"de": "Füllstand", "ru": "conLeft_level"},
            "conLeft_color_off": {"en": "conLeft_color_off", 	"de": "Farbe aus", "ru": "conLeft_color_off"},
            "conLeft_color_on": {"en": "conLeft_color_on", 		"de": "Farbe an", "ru": "conLeft_color_on"},
            "conRight_level": 	{"en": "conRight_level", 		"de": "Füllstand", "ru": "conRight_level"},
            "conRight_color_off": {"en": "conRight_color_off", 	"de": "Farbe aus", "ru": "conRight_color_off"},
            "conRight_color_on": {"en": "conRight_color_on", 	"de": "Farbe an", "ru": "conRight_color_on"},
        });

        $(document).keydown(function (e) {
            if (vis.binds.plumb.dragging) {
                $("#visview_" + vis.activeView).find(".plumb_dock_bottom, .plumb_dock_left, .plumb_dock_right, .plumb_dock_top").droppable("option", "disabled", true).removeClass("drop-hover");
                e.preventDefault();
            }
            if (e.keyCode === 76) {
                if ($('#' + vis.activeWidgets[0]).hasClass("plumb_pipe")) {
                    vis.binds.plumb.check_lengh(vis.activeWidgets[0])
                }
            }
        });
    }

    vis.binds.plumb = {
		version: "1.0.0",
		showVersion: function () {
            if (vis.binds.plumb.version) {
                console.log('Version vis-plumb: ' + vis.binds.plumb.version);
                vis.binds.plumb.version = null;
            }
        },
        dragging: false,
        data: {},
        plumb_drop: function ($this, no_pos) {
            var drag_id;
            var self_id;
            var left;
            var top;
            if (vis.editMode) {

                $($this).find(".plumb_dock_top").droppable({
                    accept: ".pl_b:not(#" + $($this).attr('id') + ")",
                    hoverClass: "drop-hover",
                    tolerance: "touch",
                    drop: function (event, ui) {

                        drag_id = $(ui.draggable).attr('id');
                        self_id = $this.attr('id');
                        top = Math.round(parseInt($this.css('top')) - ui.draggable.height()) + 'px';
                        left = Math.round(parseInt($this.css('left')) + $(this).position().left - $(ui.draggable).find('.plumb_dock_bottom').position().left + (($(this).width() - $(ui.draggable).find('.plumb_dock_bottom').width()) / 2 )) + 'px';


                        vis.views[vis.activeView].widgets[self_id].data.conTop = drag_id;
                        vis.views[vis.activeView].widgets[drag_id].data.conBottom = self_id;
                        vis.views[vis.activeView].widgets[drag_id].style.top = top;
                        vis.views[vis.activeView].widgets[drag_id].style.left = left;

                        $('#inspect_conBottom').val(self_id);

                        $(ui.draggable).css({
                            top: top,
                            left: left
                        });

                        $('.widget-helper').css({
                            top: parseInt(top) - 1  + 'px',
                            left: parseInt(left) - 1 + 'px'
                        });
                        vis.save();

                    }
                });

                $($this).find('.plumb_dock_bottom').droppable({
                    accept: ".pl_t:not(#" + $($this).attr('id') + ")",
                    hoverClass: "drop-hover",
                    tolerance: "touch",
                    drop: function (event, ui) {
                        drag_id = $(ui.draggable).attr('id');
                        self_id = $this.attr('id');
                        left = Math.round(parseInt($this.css("left")) + $(this).position().left - $(ui.draggable).find(".plumb_dock_top").position().left + (($(this).width() - $(ui.draggable).find(".plumb_dock_top").width()) / 2 )) + 'px';
                        top = Math.round(parseInt($this.css("top")) + $this.height()) + 'px';

                        vis.views[vis.activeView].widgets[self_id].data.conBottom = drag_id;
                        vis.views[vis.activeView].widgets[drag_id].data.conTop = self_id;
                        vis.views[vis.activeView].widgets[drag_id].style.top = top;
                        vis.views[vis.activeView].widgets[drag_id].style.left = left;

                        $("#inspect_conTop").val(self_id);

                        $(ui.draggable).css({
                            "top": top,
                            "left": left
                        });

                        $('.widget-helper').css({
                            top: parseInt(top) - 1  + 'px',
                            "left": parseInt(left) - 1 + 'px'
                        });
                        vis.save();
                    }
                });

                $($this).find(".plumb_dock_left").droppable({
                    accept: ".pl_r:not(#" + $($this).attr('id') + ")",
                    hoverClass: "drop-hover",
                    tolerance: "touch",
                    drop: function (event, ui) {
                        drag_id = $(ui.draggable).attr('id');
                        self_id = $this.attr('id');
                        left = Math.round(parseInt($this.css("left")) - ui.draggable.width()) + 'px';
                        top = Math.round(parseInt($this.css("top")) + $(this).position().top - $(ui.draggable).find(".plumb_dock_right").position().top + (($(this).height() - $(ui.draggable).find(".plumb_dock_right").height()) / 2 )) + 'px';

                        vis.views[vis.activeView].widgets[self_id].data.conLeft = drag_id;
                        vis.views[vis.activeView].widgets[drag_id].data.conRight = self_id;
                        vis.views[vis.activeView].widgets[drag_id].style.top = top;
                        vis.views[vis.activeView].widgets[drag_id].style.left = left;

                        $("#inspect_conRight").val(self_id);

                        $(ui.draggable).css({
                            top: top,
                            "left": left
                        });

                        $('.widget-helper').css({
                            top: parseInt(top) - 1  + 'px',
                            "left": parseInt(left) - 1 + 'px'
                        });
                        vis.save();
                    }
                });

                $($this).find(".plumb_dock_right").droppable({
                    accept: ".pl_l:not(#" + $($this).attr('id') + ")",
                    hoverClass: "drop-hover",
                    tolerance: 'touch',
                    drop: function (event, ui) {
                        drag_id = $(ui.draggable).attr('id');
                        self_id = $this.attr('id');
                        left = Math.round(parseInt($this.css("left")) + $this.width()) + 'px';
                        top = Math.round(parseInt($this.css("top")) + $(this).position().top - $(ui.draggable).find(".plumb_dock_left").position().top + (($(this).height() - $(ui.draggable).find(".plumb_dock_left").height()) / 2 )) + 'px';

                        vis.views[vis.activeView].widgets[self_id].data.conRight = drag_id;
                        vis.views[vis.activeView].widgets[drag_id].data.conLeft = self_id;
                        vis.views[vis.activeView].widgets[drag_id].style.top = top;
                        vis.views[vis.activeView].widgets[drag_id].style.left = left;

                        $("#inspect_conLeft").val(self_id);

                        $(ui.draggable).css({
                            top: top,
                            "left": left
                        });

                        $('.widget-helper').css({
                            top: parseInt(top) - 1 + 'px',
                            "left": parseInt(left) - 1 + 'px'
                        });
                        vis.save();
                    }
                });

                $this.on("dragstart", function (event, ui) {
                    vis.binds.plumb.dragging = true;
                    $("#visview_" + vis.activeView).find(".plumb_dock_bottom, .plumb_dock_left, .plumb_dock_right, .plumb_dock_top").droppable("option", "disabled", false);
                });

                $this.on("dragstop", function (event, ui) {
                    vis.binds.plumb.dragging = false;
                });
            }
        },
        check_lengh: function (id) {
            if ($('#' + id).hasClass("plumb_pipe")) {
                var data = vis.views[vis.activeView].widgets[id].data;

                if (data.conLeft !== "" && data.conRight !== "" && data.conLeft !== undefined && data.conRight !== undefined) {
                    var $left = $('#' + data.conLeft);
                    var $right = $('#' + data.conRight);
                    var length;

                    length = parseInt($right.css("left")) - (parseInt($left.css("left")) + parseInt($left.css("width")));

                    if (length > 0) {
                        vis.views[vis.activeView].widgets[id].style.width = length + 'px';
                        vis.views[vis.activeView].widgets[id].style.left = parseInt($left.css("left")) + parseInt($left.css("width")) + 'px';
                        vis.save();
                        $('#' + id).css({
                            width: length + 'px',
                            "left": parseInt($left.css("left")) + parseInt($left.css("width")) + 'px'
                        });
                        $('.widget-helper').css({
                            width: length + 'px',
                            "left": parseInt($left.css("left")) + parseInt($left.css("width")) + 'px'
                        });
                    }

                } else if (data.conTop !== "" && data.conBottom !== "" && data.conTop !== undefined && data.conBottom !== undefined) {
                    var $top = $('#' + data.conTop);
                    var $bottom = $('#' + data.conBottom);

                    length = parseInt($bottom.css("top")) - (parseInt($top.css("top")) + parseInt($top.css('height')));
                    if (length > 0) {
                        vis.views[vis.activeView].widgets[id].style.height = length + 'px';
                        vis.views[vis.activeView].widgets[id].style.top = parseInt($top.css("top")) + parseInt($top.css('height')) + 'px';
                        vis.save();
                        $('#' + id).css({
                            height: length + 'px',
                            top: parseInt($top.css("top")) + parseInt($top.css('height')) + 'px'
                        });
                        $('.widget-helper').css({
                            height: length + 'px',
                            top: parseInt($top.css("top")) + parseInt($top.css('height')) + 'px'
                        });
                    }
                }
            }
        },
        check: function (id, event, back) {
            var data = {
                type:   'plumb_change',
                from:   event.from,
                color:  event.color,
                status: event.status
            };
            vis.binds.plumb.set_normal(id, data, back, event.list);

//            var $this = $('#' + id);
//            var plumb = vis.binds.plumb.data;
//            var self = vis.binds.plumb.data[id];

//            if (self.coli) {
//                if (!event.status) {
//                    vis.binds.plumb.rest_collision(id, data)
//                }
//            } else {
//                if (event.status) {
//                    if ((self.status == true && event.status == true && self.color.c != event.color.c && self.color.c_from != event.color.c_from && self.type != "tpice" )) {
//                        vis.binds.plumb.set_collision(id)
//                    } else {
//                        if (self.color.c != event.color.c || self.color.c_from != event.color.c_from) {
//                            vis.binds.plumb.set_normal(id, data)
//                        }
//                    }
//                } else {
//
////                    if (self.color.c != event.color.c || self.color.c_from != event.color.c_from) {
//                    vis.binds.plumb.set_normal(id, data)
////                    }
//                }
//            }

        },
        set_normal: function (id, event, back, list) {
            list = list || [];
            var self = vis.binds.plumb.data[id];
            $('#' + id + '_fill').attr('fill', event.color.c);

            self.status = event.status;
            self.color  = event.color;

            if (list.indexOf(id) === -1) {
                list.push(id);
                event.list = list;
                if (back) {
                    vis.binds.plumb.trigger_b(id, event);
                } else {
                    vis.binds.plumb.trigger(id, event);
                }
            } else {
                console.warn('Detected cyclic structure: ' + list.join(', ') + ' => ' + id);
            }
        },
        set_collision: function (id) {
            var plumb = vis.binds.plumb.data;
            var self = vis.binds.plumb.data[id];
            self.status = true;
            self.coli = true;

            if (self.conLeft && self.conRight) {
                $('#' + id + "_coli_l").attr("stop-color", plumb[self.conLeft].color.c);
                $('#' + id + "_coli_r").attr("stop-color", plumb[self.conRight].color.c);
                $('#' + id + "_fill").attr("fill", "url(#" + id + "_coli)");
            } else if (self.conTop && self.conBottom) {
                $('#' + id + "_coli_t").attr("stop-color", plumb[self.conTop].color.c);
                $('#' + id + "_coli_b").attr("stop-color", plumb[self.conBottom].color.c);
                $('#' + id + "_fill").attr("fill", "url(#" + id + "_coli)");
            }
        },
        rest_collision: function (id, event) {
            var plumb = vis.binds.plumb.data;
            var self = vis.binds.plumb.data[id];
            var e = JSON.parse(JSON.stringify(event));

            e.status = true;

            $.each(self.cons, function () {
                if (self[this] && self[this] !== event.from) {
                    e.color = plumb[self[this]].color;
                    self.color = e.color;
                }
            });

            $('#' + id + '_fill').attr('fill', e.color.c);

            vis.binds.plumb.trigger_b(id, e);
            self.coli = false;
        },
        trigger: function (id, event) {
            var self = vis.binds.plumb.data[id];
            var e = JSON.parse(JSON.stringify(event));
            $.each(self.cons, function () {
                if (self[this] && self[this] !== event.from) {
                    e.from = id;
                    var conArr = self[this].split(',');
                    conArr.forEach(function(value) {
                        $('#' + value).trigger(e);
                    });
                }
            });
        },
        trigger_b: function (id, event) {
            var self = vis.binds.plumb.data[id];
            var e = JSON.parse(JSON.stringify(event));
            $.each(self.cons, function () {
                if (self[this] && self[this] === event.from) {
                    e.from = id;
                    var conArr = self[this].split(',');
                    conArr.forEach(function(value) {
                        $('#' + value).trigger(e);
                    });
                }
            });
        },

        svg_tpiece: function (id) {
            $('#' + id + "_svg").append('\
            <svg\
            width="100%"\
            height="100%"\
            preserveAspectRatio="none"\
            viewBox="0 0 600 600"\
            >\
            <defs>\
            <radialGradient id="' + id + '_c" gradientUnits="userSpaceOnUse" cy="400" cx="400" gradientTransform="matrix(0 -1.393 1.4925 0 -197.01 957.21)" r="100">\
            <stop stop-color="#000000" stop-opacity=".5" offset="0"/>\
            <stop stop-color="#000000" stop-opacity="0" offset=".666"/>\
            <stop stop-color="#000000" stop-opacity="0" offset="1"/>\
            </radialGradient>\
            <radialGradient id="' + id + '_b" gradientUnits="userSpaceOnUse" cy="400" cx="600" gradientTransform="matrix(-1.4925 0 0 -1.393 1295.5 757.21)" r="100">\
            <stop stop-color="#000000" stop-opacity=".5" offset="0"/>\
            <stop stop-color="#000000" stop-opacity="0" offset=".666"/>\
            <stop stop-color="#000000" stop-opacity="0" offset="1"/>\
            </radialGradient>\
            <linearGradient id="' + id + '_e" y2="400" gradientUnits="userSpaceOnUse" x2="500" y1="200" x1="500">\
            <stop stop-color="#000000" stop-opacity=".5" offset="0"/>\
            <stop stop-color="#000000" stop-opacity="0" offset=".5"/>\
            <stop stop-color="#000000" stop-opacity=".5" offset="1"/>\
            </linearGradient>\
            <linearGradient id="' + id + '_d" y2="300" gradientUnits="userSpaceOnUse" x2="400" y1="300" x1="200">\
            <stop stop-color="#000000" stop-opacity=".5" offset="0"/>\
            <stop stop-color="#000000" stop-opacity="0" offset=".5"/>\
            <stop stop-color="#000000" stop-opacity="0" offset="1"/>\
            </linearGradient>\
            <linearGradient id="' + id + '_a" y2="500" gradientUnits="userSpaceOnUse" x2="400" y1="500" x1="200">\
            <stop stop-color="#000000" stop-opacity=".5" offset="0"/>\
            <stop stop-color="#000000" stop-opacity="0" offset=".5"/>\
            <stop stop-color="#000000" stop-opacity=".5" offset="1"/>\
            </linearGradient>\
            </defs>\
            <g>\
            <path id="' + id + '_fill"  d="m400 200h200v200h-200zm-200-200h200v600h-200z" fill="#c0c0c0"/>\
            <g>\
            <rect height="200" width="200" y="200" x="200" fill="url(#' + id + '_c)"/>\
            <rect height="200" width="200" y="200" x="200" fill="url(#' + id + '_b)"/>\
            <rect height="200" width="200" y="200" x="200" fill="url(#' + id + '_d)"/>\
            <rect height="200" width="200" y="200" x="400" fill="url(#' + id + '_e)"/>\
            <rect height="200" width="200" y="400" x="200" fill="url(#' + id + '_a)"/>\
            <rect height="200" width="200" y="0" x="200"   fill="url(#' + id + '_a)"/>\
            </g>\
            </g>\
            </svg>\
            ');
        },
        svg_bogen: function (id) {
            $('#' + id + "_svg").append('\
            <svg\
            width="100%"\
            height="100%"\
            preserveAspectRatio="none"\
            viewBox="0 0 600 600"\
            >\
            <defs>\
            <clipPath id="' + id + '_clip">\
            <path d="m600 0a600 600 0 0 1 -600 600v-600z"/>\
            </clipPath>\
            <radialGradient id="' + id + '_a" gradientUnits="userSpaceOnUse" cy="0" cx="0" gradientTransform="matrix(0 2 -2 0 0 0)" r="300">\
            <stop stop-color="#000000" stop-opacity=".5" offset="0"/>\
            <stop stop-color="#000000" stop-opacity="0" offset=".5"/>\
            <stop stop-color="#000000" stop-opacity=".5" offset="1"/>\
            <stop stop-color="#000000" stop-opacity="0" offset="1"/>\
            </radialGradient>\
            </defs>\
            <g clip-path="url(#' + id + '_clip)">\
            <path id="' + id + '_fill" fill="#c0c0c0" d="m600 0a600 600 0 0 1 -600 600v-600z"/>\
            <rect height="600" width="600" y="0" x="0" fill="url(#' + id + '_a)"/>\
            </g>\
            </svg>\
            ');
        },
        svg_pipe_v: function (id) {
            $('#' + id + '_svg').append('\
            <svg \
            width="100%"\
            height="100%"\
            preserveAspectRatio="none"\
            viewBox="0 0 100 100" ">\
            <defs>\
            <linearGradient id="' + id + '_a" gradientUnits="userSpaceOnUse" x2="100" y1="50" y2="50">\
            <stop stop-color="#000000" stop-opacity=".5" offset="0"/>\
            <stop stop-color="#000000" stop-opacity="0" offset=".5"/>\
            <stop stop-color="#000000" stop-opacity=".5" offset="1"/>\
            </linearGradient>\
            <linearGradient id="' + id + '_coli" gradientUnits="userSpaceOnUse" y2="100" x1="50" x2="50">\
            <stop id="' + id + '_coli_t" stop-color="#000000" offset="0"/>\
            <stop id="' + id + '_coli_b" stop-color="#000000" offset="1"/>\
            </linearGradient>\
            </defs>\
            <rect  id="' + id + '_fill"  height="100" width="100" y="0" x="0" fill="#c0c0c0"/>\
            <rect height="100" width="100" y="0" x="0" fill="url(#' + id + '_a)"/>\
            </svg>\
            ');
        },
        svg_pipe_h: function (id) {
            $('#' + id + "_svg").append('\
            <svg \
            width="100%"\
            height="100%"\
            preserveAspectRatio="none"\
            viewBox="0 0 100 100" ">\
            <defs>\
            <linearGradient id="' + id + '_a"  gradientUnits="userSpaceOnUse" y2="100" x1="50" x2="50">\
            <stop stop-color="#000000" stop-opacity=".5" offset="0"/>\
            <stop stop-color="#000000" stop-opacity="0" offset=".5"/>\
            <stop stop-color="#000000" stop-opacity=".5" offset="1"/>\
            </linearGradient>\
            <linearGradient id="' + id + '_coli" gradientUnits="userSpaceOnUse" x2="100" y1="50" y2="50">\
            <stop id="' + id + '_coli_l" stop-color="#000000" offset="0"/>\
            <stop id="' + id + '_coli_r" stop-color="#000000" offset="1"/>\
            </linearGradient>\
            </defs>\
            <rect  id="' + id + '_fill"  height="100" width="100" y="0" x="0" fill="#c0c0c0"/>\
            <rect height="100" width="100" y="0" x="0" fill="url(#' + id + '_a)"/>\
            </svg>\
            ');
        },
        svg_check_valve_h: function (id) {
            $('#' + id + "_svg").append('\
             <svg\
             width="100%"\
            height="100%"\
            preserveAspectRatio="none"\
             viewBox="0 0 500 200">\
            <defs>\
            <radialGradient id="' + id + '_a" gradientUnits="userSpaceOnUse" cy="80" cx="260" r="75">\
            <stop stop-color="#eeeeee" offset="0"/>\
            <stop stop-color="#bbbbbb" offset=".25"/>\
            <stop stop-color="#666666" offset="1"/>\
            </radialGradient>\
            <linearGradient id="' + id + '_b"  gradientUnits="userSpaceOnUse" x2="250" x1="250" y2="200">\
            <stop stop-color="#000000" stop-opacity=".5" offset="0"/>\
            <stop stop-color="#000000" stop-opacity="0" offset=".5"/>\
            <stop stop-color="#000000" stop-opacity=".5" offset="1"/>\
            </linearGradient>\
            </defs>\
            <path id="' + id + '_fill_right"  d="m500 0h-250l-41 40v120l41 40h250v-200z"  fill="#c0c0c0"/>\
            <path id="' + id + '_fill_left" d="m0 0h250l-40 41v119l40 40h-249z"  fill="#c0c0c0"/>\
            <rect height="200" width="500" y="0" x="0" fill="url(#' + id + '_b)"/>\
            <g>\
            <path d="m250 200-100-100m100-100-100 100" stroke-linecap="round" stroke="#000000" stroke-width="20" />\
            <path d="m30 100 120 .26" stroke-linecap="round" stroke="#000000" stroke-width="20" />\
            <circle cy="100" cx="270" r="75" fill="url(#' + id + '_a)"/>\
            </g>\
            </svg>\
            ');
        },
        svg_check_valve_v: function (id) {
            $('#' + id + "_svg").append('\
             <svg\
             width="100%"\
            height="100%"\
            preserveAspectRatio="none"\
            viewBox="0 0 200 500">\
            <defs>\
            <radialGradient id="' + id + '_d" gradientUnits="userSpaceOnUse" cy="210" cx="90" r="75">\
            <stop stop-color="#eeeeee" offset="0"/>\
            <stop stop-color="#bbbbbb" offset=".25"/>\
            <stop stop-color="#666666" offset="1"/>\
            </radialGradient>\
            <linearGradient id="' + id + '_c" y2="250" gradientUnits="userSpaceOnUse" y1="250" gradientTransform="rotate(90)" x2="200" >\
            <stop stop-color="#000000" stop-opacity=".5" offset="0"/>\
            <stop stop-color="#000000" stop-opacity="0" offset=".5"/>\
            <stop stop-color="#000000" stop-opacity=".5" offset="1"/>\
            </linearGradient>\
            </defs>\
            <path id="' + id + '_fill_top" d="m0 0v250l40 41h120l40-41v-250h-200z" fill="#c0c0c0"/>\
            <path id="' + id + '_fill_bottom"  d="m0 500v-250l41 40h119l40-40v250z"  fill="#c0c0c0"/>\
            <rect transform="rotate(-90)" height="200" width="500" y="0" x="-500" fill="url(#' + id + '_c)"/>\
            <g>\
            <path d="m200 252.4-100 100m-100-100 100 100" stroke="#000000" stroke-linecap="round" stroke-width="20" fill="none"/>\
            <circle cy="235" cx="100" r="75" fill="url(#' + id + '_d)"/>\
            <path d="m99.87 470.13.26-120" stroke="#000000" stroke-linecap="round" stroke-width="20" fill="none"/>\
            </g>\
            </svg>\
            ');
        },

        pump: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr('id');
            var plumb = vis.binds.plumb.data;

            vis.binds.plumb.data[id] = {
                type: "pump",
                cons: [],
                coli: false,
                conLeft:   data.conLeft   || null,
                conRight:  data.conRight  || null,
                conTop:    data.conTop    || null,
                conBottom: data.conBottom || null,
                status: false,
                color: {
                    c: null,
                    c_from: null,
                    c_default: null
                }
            };

            var self = plumb[id];

            setTimeout(function () {
                $this.find(".plumb_dock_right, .plumb_dock_left, .plumb_dock_top, .plumb_dock_bottom").remove();
                var l;
                var t;
                var s;

                if (data.conTop && data.conTop != "") {
                    self.cons.push("conTop");
                    if (data.conTop_show) {
                        $this.find(".pump").append('<div id="' + id + '_dock_top_svg" class="plumb_dock_top"></div>');
                        vis.binds.plumb.svg_pipe_v(id + "_dock_top");

                        s = (data.conTop_size || 20);
                        t = '-10';
                        l = (($this.width() - s) / 100 * (data.conTop_pos || 50));

                        $this.find(".plumb_dock_top").css({
                            top: t + 'px',
                            left: l + 'px',
                            height: '20px',
                            width: s + 'px'
                        });

                        $('#' + id + "_dock_top_fill").attr("fill", data.color_off);
                    }
                }

                if (data.conBottom && data.conBottom != "") {
                    self.cons.push("conBottom");
                    if (data.conBottom_show) {
                        $this.find(".pump").append('<div id="' + id + '_dock_bottom_svg" class="plumb_dock_bottom"></div>');
                        vis.binds.plumb.svg_pipe_v(id + "_dock_bottom");
                        s = (data.conBottom_size || 20);
                        t = '-10';
                        l = (($this.width() - s) / 100 * (data.conBottom_pos || 50));

                        $this.find(".plumb_dock_bottom").css({
                            bottom: t + 'px',
                            left: l + 'px',
                            height: '20px',
                            width: s + 'px'
                        });
                        $('#' + id + "_dock_bottom_fill").attr("fill", data.color_off);
                    }
                }

                if (data.conLeft && data.conLeft != "") {
                    self.cons.push("conLeft");
                    if (data.conLeft_show) {
                        $this.find(".pump").append('<div id="' + id + '_dock_left_svg" class="plumb_dock_left"></div>');
                        vis.binds.plumb.svg_pipe_h(id + "_dock_left");
                        s = (data.conLeft_size || 20);
                        l = '-10';
                        t = (($this.height() - s) / 100 * (data.conLeft_pos || 50));

                        $this.find(".plumb_dock_left").css({
                            top: t + 'px',
                            left: l + 'px',
                            height: s + 'px',
                            width: '20px'
                        });
                        $('#' + id + "_dock_left_fill").attr("fill", data.color_off);
                    }
                }

                if (data.conRight && data.conRight != "") {
                    self.cons.push("conRight");
                    if (data.conRight_show) {
                        $this.find(".pump").append('<div id="' + id + '_dock_right_svg" class="plumb_dock_right"></div>');
                        vis.binds.plumb.svg_pipe_h(id + "_dock_right");
                        s = (data.conRight_size || 20);
                        l = '-10';
                        t = (($this.height() - s) / 100 * (data.conRight_pos || 50));

                        $this.find(".plumb_dock_right").css({
                            top: t + 'px',
                            right: l + 'px',
                            height: s + 'px',
                            width: '20px'
                        });
                        $('#' + id + "_dock_right_fill").attr("fill", data.color_off);
                    }
                }
                vis.binds.plumb.plumb_drop($this);
            });

            $this.bind('plumb_change', function (event) {
                if (vis.states[data.oid + '.val'] >= 1 && !event.status && event.color.c_from !== id) {
                    setTimeout(function () {
                        var ev = {
                            type: 'plumb_change',
                            from: id,
                            status: true,
                            list: event.list,
                            color: {
                                c_from: id,
                                c_default: data.color_off,
                                c: data.color_on
                            }
                        };
                        self.color = ev.color;
                        $('#' + event.from).trigger(ev);
                    }, 0);
                }
            });

            vis.states.bind(data.oid + '.val', function (e, newVal, oldVal) {
                vis.binds.plumb.stop = 0;
                var ev = {
                    type: 'plumb_change',
                    from: id,
                    color: {
                        c_from: id,
                        c_default: data.color_off
                    }
                };
                if (newVal >= 1) {
                    ev.color.c = data.color_on;
                    ev.status = true
                } else {
                    ev.color.c = data.color_off;
                    ev.status = false
                }
                self.color = ev.color;
                $.each(self.cons, function () {
                    $('#' + id + "_dock_top_fill").attr("fill", ev.color.c);
                    $('#' + id + "_dock_bottom_fill").attr("fill", ev.color.c);
                    $('#' + id + "_dock_left_fill").attr("fill", ev.color.c);
                    $('#' + id + "_dock_right_fill").attr("fill", ev.color.c);
                    var conArr = self[this].split(',');
                    conArr.forEach(function(value) {
                        $('#' + value).trigger(ev);
                    });
                });
            });

            setTimeout(function () {
                $($this.parent()).on("rendered", function () {
                    var ev = {
                        type: 'plumb_change',
                        from: id,
                        color: {
                            c_from: id,
                            c_default: data.color_off
                        }
                    };
                    if (vis.states[data.oid + '.val'] >= 1) {
                        ev.color.c = data.color_on;
                        ev.status = true;
                        self.status = true;
                    } else {
                        ev.color.c = data.color_off;
                        ev.status = false;
                        self.status = true;
                    }
                    self.color = ev.color;
                    $.each(self.cons, function () {
                        $('#' + id + "_dock_top_fill").attr("fill", ev.color.c);
                        $('#' + id + "_dock_bottom_fill").attr("fill", ev.color.c);
                        $('#' + id + "_dock_left_fill").attr("fill", ev.color.c);
                        $('#' + id + "_dock_right_fill").attr("fill", ev.color.c);
                        var conArr = self[this].split(',');
                        conArr.forEach(function(value) {
                            $('#' + value).trigger(ev);
                        });
                    });
                })
            });
        },
        sprinkler_i: function (el, data) {
            var $this = $(el).parent();
            var $head = $(el);
            var $wp = $this.find(".plumb_sprinkler_i");
            var $water = $this.find(".plumb_sprinkler_i_water");
            var id = $this.attr('id');
            var plumb = vis.binds.plumb.data;

            vis.binds.plumb.data[id] = {
                type: "pump",
                cons: ["conTop", "conBottom", "conLeft", "conRight"],
                coli: false,
                conLeft: data.conLeft || null,
                conRight: data.conRight || null,
                conTop: data.conTop || null,
                conBottom: data.conBottom || null,
                status: false,
                color: {
                    c: null,
                    c_from: null,
                    c_default: null
                }
            };

            var self = plumb[id];

            $this.css('overflow', 'visible');

            vis.binds.plumb.plumb_drop($this);

            $($this).on('resize', function () {
                set();
            });

            $this.bind('plumb_change', function (event) {
                self.status = event.status;
                if (event.status) {
                    $wp.show();
                    $head.css({
                        "background-color": data.head_color
                    });
                } else {
                    $wp.hide();
                    if (!data['head-show']) {
                        $head.css({
                            "background-color": 'transparent'
                        });
                    }
                }
            });

            function set() {
                $('#' + id + '_style').remove();

                $('<style id="' + id + '_style">\
                    @-webkit-keyframes ' + id + '-ANIMATION {\
                        0%   { -webkit-transform: rotate(' + data.start + 'deg);}\
                        80%  { -webkit-transform: rotate(' + data.ende + 'deg);}\
                        100% { -webkit-transform: rotate(' + data.start + 'deg);}\
                    }\
                    @keyframes ' + id + '-ANIMATION {\
                        0%   { transform: rotate(' + data.start + 'deg);}\
                        80%  { transform: rotate(' + data.ende + 'deg); }\
                        100% { transform: rotate(' + data.start + 'deg);}\
                    }\
                <style>').appendTo("head");


                $wp.css({
                    "-webkit-animation": id + "-ANIMATION " + data.time + "s infinite linear",
                    "animation": id + "-ANIMATION " + data.time + "s infinite linear"
                });
                $water.css({
                    height: data.spray_width + 'px',
                    width: data.stroke + 'px',
                    left: parseInt($($wp).width() / 2 - data.stroke / 2) + 'px',
                    top: parseInt($($wp).height() / 2 - data.spray_width) + 'px',
                    position: "relative",
                    "background-color": data.water_color,
                    opacity: data.opacity,
                    "border-radius": "100px"
                });


                if (data.fog) {
                    $water.css({
                        "box-shadow": '0 0 ' + (data.stroke * 2) + 'px ' + data.stroke + 'px ' + data.water_color
                    })
                }

                if (data.head_round === 'true' || data.head_round === true) {
                    $head.css({
                        "border-radius": '100%'
                    });
                }

                if (self.status || (vis.editMode && data.test)) {
                    $wp.show()
                } else {
                    $wp.hide()
                }

                if ((self.status === true || data.head_show === "true" || data.head_show === true ) || (vis.editMode && (data.test === "true" || data.test === true))) {
                    $head.css({
                        "background-color": data.head_color
                    });
                } else {
                    $head.css({
                        "background-color": 'transparent'
                    });
                }
            }

            setTimeout(function () {
                set();
            });
        },
        sprinkler_r: function (el, data) {
            var $this = $(el).parent();
            var $head = $this.find(".plumb_sprinkler_r_head");
            var $water = $this.find(".plumb_sprinkler_r");
            var id = $this.attr('id');
            var plumb = vis.binds.plumb.data;

            vis.binds.plumb.data[id] = {
                type: 'pump',
                cons: ["conTop", "conBottom", "conLeft", "conRight"],
                coli: false,
                conLeft: data.conLeft || null,
                conRight: data.conRight || null,
                conTop: data.conTop || null,
                conBottom: data.conBottom || null,
                status: false,
                color: {
                    c: null,
                    c_from: null,
                    c_default: null
                }
            };

            var self = plumb[id];

            vis.binds.plumb.plumb_drop($this);

            $this.bind('plumb_change', function (event) {
                self.status = event.status;
                if (event.status) {
                    $water.show();
//                    $head.css({
//                        "background-color": data.head_color
//                    });
                } else {
                    $water.hide();
                    if (!data["head-show"]) {
//                        $head.css({
//                            "background-color": "transparent"
//                        });
                    }
                }
            });

            function set() {
                var time   = data.time   || 36;
                var start  = data.start  || 0;
                var end    = data.ende   || 180;
                var stroke = data.stroke || 10;
                var set_w  = parseInt(data.spray_width);
                var svg_w  = set_w;
                var svg_t;
                var svg_l;
                var spray_w;
                var spray_t;
                var spray_h;
                var spray_l;
                var radius;
                var head = parseInt(data.head_size, 10) / 2;

                if (data.spray_range === '270-90') {
                    svg_t = 0;
                    svg_l = 0;
                    spray_w = set_w;
                    spray_h = set_w / 2;
                    spray_t = -set_w / 2 + head;
                    spray_l = -set_w / 2 + head;

                    start = 180 / 100 * parseInt(start, 10) + 270;
                    end = 180 / 100 * parseInt(end, 10) + 270;
                } else if (data.spray_range === '90-270') {
                    svg_t = -set_w / 2;
                    svg_l = 0;
                    spray_w = set_w;
                    spray_h = set_w / 2;
                    spray_t = head;
                    spray_l = -set_w / 2 + head;

                    start = 180 / 100 * parseInt(start, 10) + 90;
                    end = 180 / 100 * parseInt(end, 10) + 90;
                } else if (data.spray_range === '180-360') {
                    svg_t = 0;
                    svg_l = 0;
                    spray_w = set_w / 2;
                    spray_h = set_w;
                    spray_t = -set_w / 2 + head;
                    spray_l = -set_w / 2 + head;

                    start = 180 / 100 * parseInt(start, 10) + 180;
                    end = 180 / 100 * parseInt(end, 10) + 180;
                } else if (data.spray_range === '0-180') {
                    svg_t = 0;
                    svg_l = -set_w / 2;
                    spray_w = set_w / 2;
                    spray_h = set_w;
                    spray_t = -set_w / 2 + head;
                    spray_l = head;

                    start = 180 / 100 * parseInt(start, 10);
                    end = 180 / 100 * parseInt(end, 10);
                } else if (data.spray_range === '270-360') {
                    svg_t = 0;
                    svg_l = 0;
                    spray_w = set_w / 2;
                    spray_h = set_w / 2;
                    spray_t = -set_w / 2 + head;
                    spray_l = -set_w / 2 + head;

                    start = 90 / 100 * parseInt(start, 10) + 270;
                    end = 90 / 100 * parseInt(end, 10) + 270;
                } else if (data.spray_range === '0-90') {
                    svg_t = 0;
                    svg_l = -set_w / 2;
                    spray_w = set_w / 2;
                    spray_h = set_w / 2;
                    spray_t = -set_w / 2 + head;
                    spray_l = head;

                    start = 90 / 100 * parseInt(start, 10);
                    end = 90 / 100 * parseInt(end, 10);
                } else if (data.spray_range === '180-270') {
                    svg_t = -set_w / 2;
                    svg_l = 0;
                    spray_w = set_w / 2;
                    spray_h = set_w / 2;
                    spray_t = head;
                    spray_l = -set_w / 2 + head;

                    start = 90 / 100 * parseInt(start, 10) + 180;
                    end = 90 / 100 * parseInt(end, 10) + 180;
                } else if (data.spray_range === '90-180') {
                    svg_t = -set_w / 2;
                    svg_l = -set_w / 2;
                    spray_w = set_w / 2;
                    spray_h = set_w / 2;
                    spray_t = head;
                    spray_l = head;

                    start = 90 / 100 * parseInt(start, 10) + 90;
                    end = 90 / 100 * parseInt(end, 10) + 90;
                } else if (data.spray_range === '360') {
                    svg_t = 0;
                    svg_l = 0;
                    spray_w = set_w;
                    spray_h = set_w;
                    spray_t = -set_w / 2 + head;
                    spray_l = -set_w / 2 + head;
                    start = 360 / 100 * parseInt(start, 10);
                    if (end === '100') {
                        end = 359.99;
                    } else {
                        end = 360 / 100 * parseInt(end, 10);
                    }
                }
                if (data.head_round) {
                    radius = '100%';
                } else {
                    radius = '0';
                }
                $water.css({
                    top: parseInt(spray_t) + 'px',
                    left: parseInt(spray_l) + 'px',
                    height: spray_h + 'px',
                    width: spray_w + 'px',
                    position: 'absolute',
                    overflow: 'hidden'
                });

                $this.css({
                    "border-radius": radius,
                    width: data.head_size + 'px',
                    height: data.head_size + 'px'
                });

                $('#widget_helper_' + id).css({
                    width: parseInt(data.head_size) + 2 + 'px',
                    height: parseInt(data.head_size) + 2 + 'px'
                });


                var _turn_winkel = start * Math.PI / 180;
                var r = 250;
                var x1 = 250 + r * Math.sin(_turn_winkel);
                var y1 = 250 - r * Math.cos(_turn_winkel);
                var x2 = 250 + r * Math.sin(end * Math.PI / 180);
                var y2 = 250 - r * Math.cos(end * Math.PI / 180);
                var p;
                if ((end - start) < 180) {
                    p = "M" + x1 + "," + y1 + " A" + r + "," + r + " 0 0,1 " + x2 + "," + y2 + "L 250 250 z";
                } else {
                    p = "M" + x1 + "," + y1 + " A" + r + "," + r + " 0 1,1 " + x2 + "," + y2 + " L 250 250 z"
                }

                $('#' + id + "_svg").remove();
                $water.append('\
                    <svg\
                    xmlns:svg="http://www.w3.org/2000/svg"\
                    xmlns="http://www.w3.org/2000/svg"\
                    id = "' + id + '_svg"\
                    width="100%"\
                    height="100%"\
                    viewBox="0 0 500 500"\
                    >\
                <clipPath id="starfoo_' + id + '">\
                    <path d="' + p + '"/>\
                    </clipPath>\
                         <g transform="translate(0,0)" clip-path="url(#starfoo_' + id + ')">\
                            <g style="stroke:' + data.water_color + ';stroke-width:' + stroke + ';stroke-linecap:round;stroke-opacity:' + data.opacity + '" >\
                                <path d="M 250,500 250,0"/>\
                                <path d="M 293,496 207,3.8"/>\
                                <path d="M 335,485 165,14.7"/>\
                                <path d="M 375,467 125,33"/>\
                                <path d="M 411,442 89.2,58"/>\
                                <path d="M 442,411 58.3,88.9"/>\
                                <path d="M 467,375 33.2,125"/>\
                                <path d="M 485,335 14.8,165"/>\
                                <path d="M 496,293 3.61,207"/>\
                                <path d="M 500,250 -0.117,250"/>\
                                <path d="M 496,207 3.68,293"/>\
                                <path d="M 485,165 14.9,335"/>\
                                <path d="M 467,125 33.2,375"/>\
                                <path d="M 442,89.2 58.2,411"/>\
                                <path d="M 411,58.3 89.1,442"/>\
                                <path d="M 375,33.3 125,467"/>\
                                <path d="M 335,14.9 165,485"/>\
                                <path d="M 293,3.71 207,496"/>\
                                <animateTransform id="t_two_' + id + '" attributeName="transform" type="rotate" from="0 250 250" to=" 360 250 250" begin="0s" dur="' + time + '" repeatCount="indefinite"   />\
                            </g>\
                        </g>\
                    </svg>\
                ');
                //                    <circle cx="250" cy="250" r="' + data.head_size + '"  fill="' + data.head_color + '"  />\

                if (self.status || (vis.editMode && data.test)) {
                    $water.show()
                } else {
                    $water.hide()
                }

                var $svg = $this.find("svg");
                $svg.css({
                    width: svg_w + 'px',
                    height: svg_w + 'px',
                    top: parseInt(svg_t) + 'px',
                    left: parseInt(svg_l) + 'px',
                    position: 'absolute'
                });

                if (data.head_round === 'true' || data.head_round === true) {
                    $head.css({
                        "border-radius": '100%'
                    });
                }
            }

            setTimeout(function () {
                set();
            });
        },
        pipe_h: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr('id');

            $($this).on('resize', function () {
                $('#widget_helper_' + id).css({
                    top: parseInt($this.css('top')) - 2 + 'px',
                    left: parseInt($this.css('left')) - 2 + 'px'
                })
            });

            $($this).on('resizestop', function (event, ui) {
                vis.views[vis.activeView].widgets[id].style.left = ui.position.left;
                vis.views[vis.activeView].widgets[id].style.top = ui.position.top;
                vis.save();
            });
            vis.binds.plumb.data[id] = {
                type: 'pipe',
                cons: ["conLeft", "conRight"],
                coli: false,
                conLeft: data.conLeft || null,
                conRight: data.conRight || null,
                conTop: data.conTop || null,
                conBottom: data.conBottom || null,
                status: false,
                color: {
                    c: null,
                    c_from: null,
                    c_default: null
                }
            };

            setTimeout(function () {
                vis.binds.plumb.svg_pipe_h(id);

                $($this).css('height', data.pipe_size + 'px');
                $('#widget_helper_' + id).css({
                    height: parseInt(data.pipe_size) + 2 + 'px'
                });
                if (data.oid) {
                    $('#' + id + '_fill').attr('fill', !vis.binds.basic.isFalse(vis.states[data.oid + '.val']) ? $this.data('color_on') : $this.data('color_off'));
                }
            });

            vis.binds.plumb.plumb_drop($this);
            $this.data('color_on',  data.color_on  || 'green');
            $this.data('color_off', data.color_off || '#c0c0c0');

            if (data.oid) {
                vis.states.bind(data.oid + '.val', function (e, newVal, oldVal) {
                    $('#' + id + '_fill').attr('fill', !vis.binds.basic.isFalse(newVal) ? $this.data('color_on') : $this.data('color_off'));
                });
            } else {
                $this.bind('plumb_change', function (event) {
                    vis.binds.plumb.check(id, event);
                });
            }
        },
        pipe_v: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr('id');

            vis.binds.plumb.data[id] = {
                type:       'pipe',
                cons:       ['conTop', 'conBottom'],
                coli:       false,
                conLeft:    data.conLeft    || null,
                conRight:   data.conRight   || null,
                conTop:     data.conTop     || null,
                conBottom:  data.conBottom  || null,
                status:     false,
                color: {
                    c:          null,
                    c_from:     null,
                    c_default:  null
                }
            };
            $($this).on('resize', function () {
                $('#widget_helper_' + id).css({
                    top:    parseInt($this.css('top'))  - 2 + 'px',
                    left:   parseInt($this.css('left')) - 2 + 'px'
                })
            });

            $($this).on("resizestop", function (event, ui) {
                vis.views[vis.activeView].widgets[id].style.left = ui.position.left;
                vis.views[vis.activeView].widgets[id].style.top = ui.position.top;
                vis.save();
            });

            setTimeout(function () {
                vis.binds.plumb.svg_pipe_v(id);

                $($this).css('width', data.pipe_size + 'px');
                $('#widget_helper_' + id).css({
                    width: parseInt(data.pipe_size) + 2 + 'px'
                });
                if (data.oid) {
                    $('#' + id + '_fill').attr('fill', !vis.binds.basic.isFalse(vis.states[data.oid + '.val']) ? $this.data('color_on') : $this.data('color_off'));
                }
            });

            vis.binds.plumb.plumb_drop($this);

            $this.data('color_on',  data.color_on  || 'green');
            $this.data('color_off', data.color_off || '#c0c0c0');

            if (data.oid) {
                vis.states.bind(data.oid + '.val', function (e, newVal, oldVal) {
                    $('#' + id + '_fill').attr('fill', !vis.binds.basic.isFalse(newVal) ? $this.data('color_on') : $this.data('color_off'));
                });
            } else {
                $this.bind('plumb_change', function (event) {
                    vis.binds.plumb.check(id, event);
                });
            }
        },
        bogen_br: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr('id');

            vis.binds.plumb.data[id] = {
                type: 'pipe',
                cons: ["conRight", "conBottom"],
                coli: false,
                conLeft: data.conLeft || null,
                conRight: data.conRight || null,
                conTop: data.conTop || null,
                conBottom: data.conBottom || null,
                status: false,
                color: {
                    c: null,
                    c_from: null,
                    c_default: null
                }
            };

            setTimeout(function () {
                vis.binds.plumb.svg_bogen(id);
                $($this).css({
                    height: data.pipe_size + 'px',
                    width: data.pipe_size + 'px'
                });
                $('#widget_helper_' + id).css({
                    height: parseInt(data.pipe_size) + 2 + 'px',
                    width: parseInt(data.pipe_size) + 2 + 'px'
                });
                if (data.oid) {
                    $('#' + id + '_fill').attr('fill', !vis.binds.basic.isFalse(vis.states[data.oid + '.val']) ? $this.data('color_on') : $this.data('color_off'));
                }
            });

            vis.binds.plumb.plumb_drop($this);

            $this.data('color_on',  data.color_on  || 'green');
            $this.data('color_off', data.color_off || '#c0c0c0');

            if (data.oid) {
                vis.states.bind(data.oid + '.val', function (e, newVal, oldVal) {
                    $('#' + id + '_fill').attr('fill', !vis.binds.basic.isFalse(newVal) ? $this.data('color_on') : $this.data('color_off'));
                });
            } else {
                $this.bind('plumb_change', function (event) {
                    vis.binds.plumb.check(id, event);
                });
            }
        },
        bogen_bl: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr('id');

            vis.binds.plumb.data[id] = {
                type: 'pipe',
                cons: ["conLeft", "conBottom"],
                coli: false,
                conLeft: data.conLeft || null,
                conRight: data.conRight || null,
                conTop: data.conTop || null,
                conBottom: data.conBottom || null,
                status: false,
                color: {
                    c: null,
                    c_from: null,
                    c_default: null
                }
            };

            setTimeout(function () {
                vis.binds.plumb.svg_bogen(id);
                $($this).css({
                    height: data.pipe_size + 'px',
                    width: data.pipe_size + 'px'
                });
                $('#widget_helper_' + id).css({
                    height: parseInt(data.pipe_size) + 2 + 'px',
                    width: parseInt(data.pipe_size) + 2 + 'px'
                });
                if (data.oid) {
                    $('#' + id + '_fill').attr('fill', !vis.binds.basic.isFalse(vis.states[data.oid + '.val']) ? $this.data('color_on') : $this.data('color_off'));
                }
            });

            vis.binds.plumb.plumb_drop($this);

            $this.data('color_on',  data.color_on  || 'green');
            $this.data('color_off', data.color_off || '#c0c0c0');

            if (data.oid) {
                vis.states.bind(data.oid + '.val', function (e, newVal, oldVal) {
                    $('#' + id + '_fill').attr('fill', !vis.binds.basic.isFalse(newVal) ? $this.data('color_on') : $this.data('color_off'));
                });
            } else {
                $this.bind('plumb_change', function (event) {
                    vis.binds.plumb.check(id, event);
                });
            }
        },
        bogen_tr: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr('id');

            vis.binds.plumb.data[id] = {
                type:       'pipe',
                cons:       ["conRight", "conTop"],
                coli:       false,
                conLeft:    data.conLeft || null,
                conRight:   data.conRight || null,
                conTop:     data.conTop || null,
                conBottom:  data.conBottom || null,
                status:     false,
                color: {
                    c:          null,
                    c_from:     null,
                    c_default:  null
                }
            };

            setTimeout(function () {
                vis.binds.plumb.svg_bogen(id);
                $($this).css({
                    height: data.pipe_size + 'px',
                    width: data.pipe_size + 'px'
                });
                $('#widget_helper_' + id).css({
                    height: parseInt(data.pipe_size) + 2 + 'px',
                    width:  parseInt(data.pipe_size) + 2 + 'px'
                });
                if (data.oid) {
                    $('#' + id + '_fill').attr('fill', !vis.binds.basic.isFalse(vis.states[data.oid + '.val']) ? $this.data('color_on') : $this.data('color_off'));
                }
            });

            vis.binds.plumb.plumb_drop($this);

            $this.data('color_on',  data.color_on  || 'green');
            $this.data('color_off', data.color_off || '#c0c0c0');

            if (data.oid) {
                vis.states.bind(data.oid + '.val', function (e, newVal, oldVal) {
                    $('#' + id + '_fill').attr('fill', !vis.binds.basic.isFalse(newVal) ? $this.data('color_on') : $this.data('color_off'));
                });
            } else {
                $this.bind('plumb_change', function (event) {
                    vis.binds.plumb.check(id, event);
                });
            }
        },
        bogen_tl: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr('id');

            vis.binds.plumb.data[id] = {
                type: 'pipe',
                cons: ["conLeft", "conTop"],
                coli: false,
                conLeft: data.conLeft || null,
                conRight: data.conRight || null,
                conTop: data.conTop || null,
                conBottom: data.conBottom || null,
                status: false,
                color: {
                    c: null,
                    c_from: null,
                    c_default: null
                }
            };

            setTimeout(function () {
                vis.binds.plumb.svg_bogen(id);
                $($this).css({
                    height: data.pipe_size + 'px',
                    width: data.pipe_size + 'px'
                });
                $('#widget_helper_' + id).css({
                    height: parseInt(data.pipe_size) + 2 + 'px',
                    width: parseInt(data.pipe_size) + 2 + 'px'
                });
                if (data.oid) {
                    $('#' + id + '_fill').attr('fill', !vis.binds.basic.isFalse(vis.states[data.oid + '.val']) ? $this.data('color_on') : $this.data('color_off'));
                }
            });

            vis.binds.plumb.plumb_drop($this);

            $this.data('color_on',  data.color_on  || 'green');
            $this.data('color_off', data.color_off || '#c0c0c0');

            if (data.oid) {
                vis.states.bind(data.oid + '.val', function (e, newVal, oldVal) {
                    $('#' + id + '_fill').attr('fill', !vis.binds.basic.isFalse(newVal) ? $this.data('color_on') : $this.data('color_off'));
                });
            } else {
                $this.bind('plumb_change', function (event) {
                    vis.binds.plumb.check(id, event);
                });
            }
        },
        valve_h: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr('id');
            var plumb = vis.binds.plumb.data;
            var last_from;

            plumb[id] = {
                type: 'pipe',
                cons: ["conLeft", "conRight"],
                coli: false,
                conLeft: data.conLeft || null,
                conRight: data.conRight || null,
                conTop: data.conTop || null,
                conBottom: data.conBottom || null,
                status: false,
                color: {
                    c: null,
                    c_from: null,
                    c_default: null
                }
            };

            var self = plumb[id];

            $($this).css({
                height: parseInt(data.pipe_size) + 'px',
                width: parseInt(parseInt(data.pipe_size) * 1.5) + 'px'
            });
            $('#widget_helper_' + id).css({
                height: parseInt(data.pipe_size) + 2 + 'px',
                width: parseInt(parseInt(data.pipe_size) * 1.5) + 2 + 'px'
            });

            vis.binds.plumb.plumb_drop($this);

            if (data.ctrl) {
                $(el).on('click touchstart', function () {
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    if (vis.states[data.oid + '.val'] >= 1) {
                        vis.setValue(data.oid, 0);
                    } else {
                        vis.setValue(data.oid, 1);
                    }
                });
            }

            $this.data('color_on',  data.color_on  || 'green');
            $this.data('color_off', data.color_off || 'red');

            $this.bind('plumb_change', function (event) {
                if (event.status) {
                    last_from = event.from;
                }

                if (vis.states[data.oid + '.val'] >= 1) {
                    vis.binds.plumb.check(id, event);
                }
            });

            function set(newVal) {
                var ev = {
                    type:   'plumb_change',
                    from:   id,
                    status: true
                };

                function check_ev(ev) {
                    var x = ev;
                    x.color = x.color || {};
                    if (!x.color.c) x.color.c = '#c0c0c0';
                    if (!x.color.c_default) x.color.c_default = '#c0c0c0';
                    return x
                }

                if (newVal === true) newVal = 1;
                    else if (newVal === false) newVal = 0;
                var conLeftArr = self.conLeft.split(',');
                var conRightArr = self.conRight.split(',');
                if (newVal >= 1) {
                    $this.find('path').attr('fill', $this.data('color_on'));
                    if (self.conLeft == last_from && last_from !== undefined && plumb[self.conLeft] && plumb[self.conLeft].status) {
                        ev.color        = JSON.parse(JSON.stringify(plumb[self.conLeft].color));
                        ev.status       = JSON.parse(JSON.stringify(plumb[self.conLeft].status));
                        ev              = check_ev(ev);
                        self.color      = ev.color;
                        self.status     = ev.status;
                        conRightArr.forEach(function(value) {
                            $('#' + value).trigger(ev);
                        });
                    } else if (plumb[self.conRight] && plumb[self.conRight].status) {
                        last_from   = self.conRight;
                        ev.color    = JSON.parse(JSON.stringify(plumb[self.conRight].color));
                        ev.status   = JSON.parse(JSON.stringify(plumb[self.conRight].status));
                        ev          = check_ev(ev);
                        self.color  = ev.color;
                        self.status = ev.status;
                        conRightArr.forEach(function(value) {
                            $('#' + value).trigger(ev);
                        });
                    } else {
                        if (conLeftArr.length <= 1) {
                            last_from   = self.conLeft;
                            ev.color    = JSON.parse(JSON.stringify(plumb[self.conLeft] ? plumb[self.conLeft].color : {c_default: $this.data('color_on')}));
                            ev.status   = JSON.parse(JSON.stringify(plumb[self.conLeft] ? plumb[self.conLeft].status : false));
                        }
                        else if (conRightArr.length <= 1) {
                            last_from   = self.conRight;
                            ev.color    = JSON.parse(JSON.stringify(plumb[self.conRight] ? plumb[self.conRight].color : {c_default: $this.data('color_on')}));
                            ev.status   = JSON.parse(JSON.stringify(plumb[self.conRight] ? plumb[self.conRight].status : false));
                        }
                        ev          = check_ev(ev);
                        self.color  = ev.color;
                        self.status = ev.status;
                        conRightArr.forEach(function(value) {
                            $('#' + value).trigger(ev);
                        });
                    }
                } else {
                    $this.find('path').attr('fill', $this.data('color_off'));
                    if (self.conLeft == last_from) {
                        ev.color    = JSON.parse(JSON.stringify(plumb[self.conLeft] ? plumb[self.conLeft].color : {c_default: $this.data('color_off')}));
                        ev.status   = false;
                        ev.color.c  = ev.color.c_default;
                        ev          = check_ev(ev);
                        self.color  = ev.color;
                        self.status = false;
                        conRightArr.forEach(function(value) {
                            $('#' + value).trigger(ev);
                        });
                    }

                    if (self.conRight == last_from) {
                        ev.color    = JSON.parse(JSON.stringify(plumb[self.conRight] ? plumb[self.conRight].color : {c_default: $this.data('color_off')}));
                        ev.status   = false;
                        ev.color.c  = ev.color.c_default;
                        ev          = check_ev(ev);
                        self.color  = ev.color;
                        self.status = false;
                        conLeftArr.forEach(function(value) {
                            $('#' + value).trigger(ev);
                        });
                    }
                }
            }

            vis.states.bind(data.oid + '.val', function (e, newVal, oldVal) {
                set(newVal)
            });

            if (vis.states[data.oid + '.val'] >= 1) {
                $this.find("path").attr("fill", $this.data('color_on'));
            } else {
                $this.find("path").attr("fill", $this.data('color_off'));
            }
        },
        valve_v: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr('id');
            var plumb = vis.binds.plumb.data;
            var last_from;
            vis.binds.plumb.data[id] = {
                type:       'pipe',
                cons:       ["conTop", "conBottom"],
                coli:       false,
                conLeft:    data.conLeft || null,
                conRight:   data.conRight || null,
                conTop:     data.conTop || null,
                conBottom:  data.conBottom || null,
                status:     false,
                color: {
                    c:          null,
                    c_from:     null,
                    c_default:  null
                }
            };

            var self = plumb[id];

            $($this).css({
                height: parseInt(parseInt(data.pipe_size) * 1.5) + 'px',
                width:  parseInt(data.pipe_size) + 'px'
            });
            $('#widget_helper_' + id).css({
                height: parseInt(parseInt(data.pipe_size) * 1.5) + 2 + 'px',
                width: parseInt(data.pipe_size) + 2 + 'px'
            });

            vis.binds.plumb.plumb_drop($this);

            $this.data('color_on',  data.color_on  || 'green');
            $this.data('color_off', data.color_off || 'red');

            if (data.ctrl) {
                $(el).on('click touchstart', function () {
                    // Protect against two events
                    if (vis.detectBounce(this)) return;

                    if (vis.states[data.oid + '.val'] >= 1) {
                        vis.setValue(data.oid, 0);
                    } else {
                        vis.setValue(data.oid, 1);
                    }
                });
            }

            $this.bind('plumb_change', function (event) {
                if (vis.states[data.oid + '.val'] >= 1) {
                    vis.binds.plumb.check(id, event);
                }
            });

            function set(newVal) {
                var ev = {
                    type:   'plumb_change',
                    from:   id,
                    status: true
                };

                function check_ev(ev) {
                    var x = ev;
                    x.color = x.color || {};
                    if (!x.color.c)         x.color.c = '#c0c0c0';
                    if (!x.color.c_default) x.color.c_default = '#c0c0c0';
                    return x
                }

                if (newVal === true) newVal = 1;
                    else if (newVal === false) newVal = 0;
                var conBottomArr = self.conBottom.split(',');
                var conTopArr = self.conTop.split(',');
                if (newVal >= 1) {
                    $this.find('path').attr('fill', $this.data('color_on'));

                    if (self.conTop == last_from && last_from !== undefined && plumb[self.conTop] && plumb[self.conTop].status) {
                        ev.color    = JSON.parse(JSON.stringify(plumb[self.conTop].color));
                        ev.status   = JSON.parse(JSON.stringify(plumb[self.conTop].status));
                        ev          = check_ev(ev);
                        self.color  = ev.color;
                        self.status = ev.status;
                        conBottomArr.forEach(function(value) {
                            $('#' + value).trigger(ev);
                        });
                    } else if (plumb[self.conBottom] && plumb[self.conBottom].status) {
                        last_from   = self.conBottom;
                        ev.color    = JSON.parse(JSON.stringify(plumb[self.conBottom].color));
                        ev.status   = JSON.parse(JSON.stringify(plumb[self.conBottom].status));
                        ev          = check_ev(ev);
                        self.color  = ev.color;
                        self.status = ev.status;
                        conTopArr.forEach(function(value) {
                            $('#' + value).trigger(ev);
                        });
                    } else {
                        if (conTopArr.length <= 1) {
                            last_from   = self.conTop;
                            ev.color    = JSON.parse(JSON.stringify(plumb[self.conTop] ? plumb[self.conTop].color : {c_default: $this.data('color_on')}));
                            ev.status   = JSON.parse(JSON.stringify(plumb[self.conTop] ? plumb[self.conTop].status : false));
                        }
                        else if (conBottomArr.length <= 1) {
                            last_from   = self.conBottom;
                            ev.color    = JSON.parse(JSON.stringify(plumb[self.conBottom] ? plumb[self.conBottom].color : {c_default: $this.data('color_on')}));
                            ev.status   = JSON.parse(JSON.stringify(plumb[self.conBottom] ? plumb[self.conBottom].status : false));
                        }
                        ev          = check_ev(ev);
                        self.color  = ev.color;
                        self.status = ev.status;
                        conBottomArr.forEach(function(value) {
                            $('#' + value).trigger(ev);
                        });
                    }
                } else {
                    $this.find('path').attr('fill', $this.data('color_off'));

                    if (self.conTop == last_from) {
                        ev.color    = JSON.parse(JSON.stringify(plumb[self.conTop] ? plumb[self.conTop].color : {c_default: $this.data('color_off')}));
                        ev.status   = false;
                        ev.color.c  = ev.color.c_default;
                        ev          = check_ev(ev);
                        self.color  = ev.color;
                        self.status = false;
                        conBottomArr.forEach(function(value) {
                            $('#' + value).trigger(ev);
                        });
                    }

                    if (self.conBottom == last_from) {
                        ev.color    = JSON.parse(JSON.stringify(plumb[self.conBottom] ? plumb[self.conBottom].color : {c_default: $this.data('color_off')}));
                        ev.status   = false;
                        ev.color.c  = ev.color.c_default;
                        ev          = check_ev(ev);
                        self.color  = ev.color;
                        self.status = false;
                        conTopArr.forEach(function(value) {
                            $('#' + value).trigger(ev);
                        });
                    }
                }
            }

            vis.states.bind(data.oid + '.val', function (e, newVal, oldVal) {
                set(newVal);
            });

            if (vis.states[data.oid + '.val'] >= 1) {
                $this.find('path').attr('fill', $this.data('color_on'));
            } else {
                $this.find('path').attr('fill', $this.data('color_off'));
            }
        },
        c_valve_h: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr('id');
            var plumb = vis.binds.plumb.data;
            var last_true;

            vis.binds.plumb.data[id] = {
                type: 'pipe',
                cons: ["conLeft", "conRight"],
                coli: false,
                conLeft: data.conLeft || null,
                conRight: data.conRight || null,
                conTop: data.conTop || null,
                conBottom: data.conBottom || null,
                status: false,
                color: {
                    c: null,
                    c_from: null,
                    c_default: null
                }
            };

            var self = plumb[id];

            setTimeout(function () {
                vis.binds.plumb.svg_check_valve_h(id);
                $($this).css({
                    height: parseInt(data.pipe_size) + 'px',
                    width: parseInt(parseInt(data.pipe_size) * 2.5) + 'px'
                });
                $('#widget_helper_' + id).css({
                    height: parseInt(data.pipe_size) + 2 + 'px',
                    width: parseInt(parseInt(data.pipe_size) * 2.5) + 2 + 'px'
                });

                if (data.turn_direction) {
                    $this.find('svg').css({
                        "-webkit-transform": "rotate(180deg)",
                        "transform": "rotate(180deg)"
                    })
                }
            });

            $($this).find(".plumb_c_valve_h_back_r").css({right: "0px"});

            $this.data('color_on',  data.color_on  || 'green');
            $this.data('color_off', data.color_off || 'red');

            vis.binds.plumb.plumb_drop($this);

            $this.bind('plumb_change', function (event) {

                if (self.conLeft == event.from && !data.turn_direction) {
                    $('#' + id + "_fill_left").attr("fill", event.color.c);
                    $('#' + id + "_fill_right").attr("fill", event.color.c);
                    if (event.status) {
                        last_true = event;
                    } else {
                        last_true = undefined;
                    }
                    vis.binds.plumb.check(id, event);
                } else if (self.conLeft == event.from) {
                    if (last_true) {
                        $('#' + id + "_fill_left").attr("fill", last_true.color.c);
                        $('#' + id + "_fill_right").attr("fill", last_true.color.c);
                        vis.binds.plumb.check(id, last_true);
                    } else {
                        $('#' + id + "_fill_right").attr("fill", event.color.c);
                    }
                }

                if (self.conRight == event.from && data.turn_direction) {
                    $('#' + id + "_fill_left").attr("fill", event.color.c);
                    $('#' + id + "_fill_right").attr("fill", event.color.c);
                    if(event.status){
                        last_true = event;
                    }else{
                        last_true = undefined;
                    }
                    vis.binds.plumb.check(id, event)
                } else if (self.conRight == event.from) {
                    if(last_true){
                        $('#' + id + "_fill_left").attr("fill", last_true.color.c);
                        $('#' + id + "_fill_right").attr("fill", last_true.color.c);
                        vis.binds.plumb.check(id, last_true)
                    }else{
                        $('#' + id + "_fill_right").attr("fill", event.color.c);
                    }
                }
            });

            function set(newVal) {
                var ev = {
                    type:   'plumb_change',
                    from:   id,
                    status: true
                };
                var self_color;
                if (newVal >= 1) {
                    self_color = $this.data('color_on');
                    $this.find(".plumb_valve_l").css({"border-color": "rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) " + self_color});
                    $this.find(".plumb_valve_r").css({"border-color": "rgba(0, 0, 0, 0) " + self_color + " rgba(0, 0, 0, 0) rgba(0, 0, 0, 0)"});

                    if (plumb[self.conLeft] && plumb[self.conLeft].status) {
                        ev.color = JSON.parse(JSON.stringify(plumb[self.conLeft].color));
                        self.color = ev.color;

                        $('#' + data.conRight).trigger(ev);
                    }

                    if (plumb[self.conRight] && plumb[self.conRight].status) {
                        ev.color = JSON.parse(JSON.stringify(plumb[self.conRight].color));
                        self.color = ev.color;
                        $('#' + data.conLeft).trigger(ev);
                    }
                } else {
                    self_color = $this.data('color_off');
                    $this.find(".plumb_valve_l").css({"border-color": "rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) " + self_color});
                    $this.find(".plumb_valve_r").css({"border-color": "rgba(0, 0, 0, 0) " + self_color + " rgba(0, 0, 0, 0) rgba(0, 0, 0, 0)"});

                    if (plumb[self.conLeft] && plumb[self.conLeft].status) {
                        ev.color    = JSON.parse(JSON.stringify(plumb[self.conLeft].color));
                        ev.color.c  = ev.color.c_default;
                        ev.status   = false;
                        self.color  = ev.color;
                        $('#' + data.conLeft).trigger(ev);
                    }

                    if (plumb[self.conRight] && plumb[self.conRight].status) {
                        ev.color    = JSON.parse(JSON.stringify(plumb[self.conRight].color));
                        ev.color.c  = ev.color.c_default;
                        ev.status   = false;
                        self.color  = ev.color;
                        $('#' + data.conRight).trigger(ev);
                    }
                }
            }
        },
        c_valve_v: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr('id');
            var plumb = vis.binds.plumb.data;
            var last_true;

            vis.binds.plumb.data[id] = {
                type: 'pipe',
                cons: ["conTop", "conBottom"],
                coli: false,
                conLeft: data.conLeft || null,
                conRight: data.conRight || null,
                conTop: data.conTop || null,
                conBottom: data.conBottom || null,
                status: false,
                color: {
                    c: null,
                    c_from: null,
                    c_default: null
                }
            };

            $this.data('color_on',  data.color_on  || 'green');
            $this.data('color_off', data.color_off || 'red');

            var self = plumb[id];

            setTimeout(function () {
                vis.binds.plumb.svg_check_valve_v(id);
                $($this).css({
                    height: parseInt(parseInt(data.pipe_size) * 2.5) + 'px',
                    width:  parseInt(data.pipe_size) + 'px'
                });
                $('#widget_helper_' + id).css({
                    height: parseInt(parseInt(data.pipe_size) * 2.5) + 2 + 'px',
                    width:  parseInt(data.pipe_size) + 2 + 'px'
                });

                if (data.turn_direction) {
                    $this.find('svg').css({
                        "-webkit-transform": "rotate(180deg)",
                        "transform": "rotate(180deg)"
                    })
                }
            });

            $($this).trigger('resize');

            $($this).find(".plumb_c_valve_h_back_r").css({right: 0});

            vis.binds.plumb.plumb_drop($this);

            $this.bind('plumb_change', function (event) {
                if (self.conTop == event.from && data.turn_direction) {
                    $('#' + id + "_fill_top").attr("fill", event.color.c);
                    $('#' + id + "_fill_bottom").attr("fill", event.color.c);
                    if (event.status){
                        last_true = event;
                    }else{
                        last_true = undefined;
                    }
                    vis.binds.plumb.check(id, event)
                } else if (self.conTop == event.from) {
                    if (last_true) {
                        $('#' + id + "_fill_top").attr("fill",last_true);
                        $('#' + id + "_fill_bottom").attr("fill", last_true);
                        vis.binds.plumb.check(id, last_true)
                    } else {
                        $('#' + id + "_fill_top").attr("fill", event.color.c);
                    }
                }

                if (self.conBottom == event.from && !data.turn_direction) {
                    $('#' + id + "_fill_top").attr("fill", event.color.c);
                    $('#' + id + "_fill_bottom").attr("fill", event.color.c);
                    if (event.status) {
                        last_true = event;
                    } else {
                        last_true = undefined;
                    }

                    vis.binds.plumb.check(id, event);
                } else if (self.conBottom == event.from) {
                    if (last_true) {
                        $('#' + id + "_fill_top").attr("fill",last_true);
                        $('#' + id + "_fill_bottom").attr("fill", last_true);
                        vis.binds.plumb.check(id, last_true)
                    } else {
                        $('#' + id + "_fill_top").attr("fill", event.color.c);
                    }
                }
            });

            function set(newVal) {
                var ev = {
                    type:   'plumb_change',
                    from:   id,
                    status: true
                };
                var self_color;
                if (newVal >= 1) {
                    self_color = $this.data('color_on');
                    $this.find(".plumb_valve_l").css({"border-color": "rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) " + self_color});
                    $this.find(".plumb_valve_r").css({"border-color": "rgba(0, 0, 0, 0) " + self_color + " rgba(0, 0, 0, 0) rgba(0, 0, 0, 0)"});

                    if (plumb[self.conLeft] && plumb[self.conLeft].status) {
                        ev.color = JSON.parse(JSON.stringify(plumb[self.conLeft].color));
                        self.color = ev.color;
                        $('#' + data.conRight).trigger(ev);
                    }

                    if (plumb[self.conRight] && plumb[self.conRight].status) {
                        ev.color = JSON.parse(JSON.stringify(plumb[self.conRight].color));
                        self.color = ev.color;
                        $('#' + data.conLeft).trigger(ev);
                    }
                } else {
                    self_color = $this.data('color_off');
                    $this.find(".plumb_valve_l").css({"border-color": "rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) " + self_color});
                    $this.find(".plumb_valve_r").css({"border-color": "rgba(0, 0, 0, 0) " + self_color + " rgba(0, 0, 0, 0) rgba(0, 0, 0, 0)"});

                    if (plumb[self.conLeft] && plumb[self.conLeft].status) {
                        ev.color    = JSON.parse(JSON.stringify(plumb[self.conLeft].color));
                        ev.color.c  = ev.color.c_default;
                        ev.status   = false;
                        self.color  = ev.color;

                        $('#' + data.conLeft).trigger(ev);
                    }

                    if (plumb[self.conRight] && plumb[self.conRight].status) {
                        ev.color    = JSON.parse(JSON.stringify(plumb[self.conRight].color));
                        ev.color.c  = ev.color.c_default;
                        ev.status   = false;
                        self.color  = ev.color;
                        $('#' + data.conRight).trigger(ev);
                    }
                }
            }
        },
        tpice_hb: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr('id');

            vis.binds.plumb.data[id] = {
                type: "tpice",
                cons: ["conLeft", "conRight", "conBottom"],
                coli: false,
                conLeft: data.conLeft || null,
                conRight: data.conRight || null,
                conTop: data.conTop || null,
                conBottom: data.conBottom || null,
                status: false,
                color: {
                    c: null,
                    c_from: null,
                    c_default: null
                }
            };

            setTimeout(function () {
                vis.binds.plumb.svg_tpiece(id);
                $($this).css({
                    height: parseInt(data.pipe_size) * 3 + 'px',
                    width: parseInt(data.pipe_size) * 3 + 'px'
                });
                $('#widget_helper_' + id).css({
                    height: parseInt(data.pipe_size) * 3 + 2 + 'px',
                    width: parseInt(data.pipe_size) * 3 + 2 + 'px'
                });
                if (data.oid) {
                    $('#' + id + '_fill').attr('fill', !vis.binds.basic.isFalse(vis.states[data.oid + '.val']) ? $this.data('color_on') : $this.data('color_off'));
                }
            });

            vis.binds.plumb.plumb_drop($this);

            $this.data('color_on',  data.color_on  || 'green');
            $this.data('color_off', data.color_off || '#c0c0c0');

            if (data.oid) {
                vis.states.bind(data.oid + '.val', function (e, newVal, oldVal) {
                    $('#' + id + '_fill').attr('fill', !vis.binds.basic.isFalse(newVal) ? $this.data('color_on') : $this.data('color_off'));
                });
            } else {
                $this.bind('plumb_change', function (event) {
                    vis.binds.plumb.check(id, event)
                });
            }
        },
        tpice_ht: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr('id');

            vis.binds.plumb.data[id] = {
                type:       "tpice",
                cons:       ["conLeft", "conRight", "conTop"],
                coli:       false,
                conLeft:    data.conLeft || null,
                conRight:   data.conRight || null,
                conTop:     data.conTop || null,
                conBottom:  data.conBottom || null,
                status:     false,
                color: {
                    c:          null,
                    c_from:     null,
                    c_default:  null
                }
            };

            setTimeout(function () {
                vis.binds.plumb.svg_tpiece(id);
                $($this).css({
                    height: parseInt(data.pipe_size) * 3 + 'px',
                    width: parseInt(data.pipe_size) * 3 + 'px'
                });
                $('#widget_helper_' + id).css({
                    height: parseInt(data.pipe_size) * 3 + 2 + 'px',
                    width: parseInt(data.pipe_size) * 3 + 2 + 'px'
                });
                if (data.oid) {
                    $('#' + id + '_fill').attr('fill', !vis.binds.basic.isFalse(vis.states[data.oid + '.val']) ? $this.data('color_on') : $this.data('color_off'));
                }
            });

            vis.binds.plumb.plumb_drop($this);

            $this.data('color_on',  data.color_on  || 'green');
            $this.data('color_off', data.color_off || '#c0c0c0');

            if (data.oid) {
                vis.states.bind(data.oid + '.val', function (e, newVal, oldVal) {
                    $('#' + id + '_fill').attr('fill', !vis.binds.basic.isFalse(newVal) ? $this.data('color_on') : $this.data('color_off'));
                });
            } else {
                $this.bind('plumb_change', function (event) {
                    vis.binds.plumb.check(id, event)
                });
            }
        },
        tpice_vl: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr('id');

            vis.binds.plumb.data[id] = {
                type: "tpice",
                cons: ["conLeft", "conTop", "conBottom"],
                coli: false,
                conLeft: data.conLeft || null,
                conRight: data.conRight || null,
                conTop: data.conTop || null,
                conBottom: data.conBottom || null,
                status: false,
                color: {
                    c: null,
                    c_from: null,
                    c_default: null
                }
            };

            setTimeout(function () {
                vis.binds.plumb.svg_tpiece(id);
                $($this).css({
                    height: parseInt(data.pipe_size) * 3 + 'px',
                    width: parseInt(data.pipe_size) * 3 + 'px'
                });
                $('#widget_helper_' + id).css({
                    height: parseInt(data.pipe_size) * 3 + 2 + 'px',
                    width: parseInt(data.pipe_size) * 3 + 2 + 'px'
                });
                if (data.oid) {
                    $('#' + id + '_fill').attr('fill', !vis.binds.basic.isFalse(vis.states[data.oid + '.val']) ? $this.data('color_on') : $this.data('color_off'));
                }
            });

            vis.binds.plumb.plumb_drop($this);

            $this.data('color_on',  data.color_on  || 'green');
            $this.data('color_off', data.color_off || '#c0c0c0');

            if (data.oid) {
                vis.states.bind(data.oid + '.val', function (e, newVal, oldVal) {
                    $('#' + id + '_fill').attr('fill', !vis.binds.basic.isFalse(newVal) ? $this.data('color_on') : $this.data('color_off'));
                });
            } else {
                $this.bind('plumb_change', function (event) {
                    vis.binds.plumb.check(id, event)
                });
            }
        },
        tpice_vr: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr('id');

            vis.binds.plumb.data[id] = {
                type: "tpice",
                cons: ["conRight", "conTop", "conBottom"],
                coli: false,
                conLeft: data.conLeft || null,
                conRight: data.conRight || null,
                conTop: data.conTop || null,
                conBottom: data.conBottom || null,
                status: false,
                color: {
                    c: null,
                    c_from: null,
                    c_default: null
                }
            };

            setTimeout(function () {
                vis.binds.plumb.svg_tpiece(id);
                $($this).css({
                    height: parseInt(data.pipe_size) * 3 + 'px',
                    width: parseInt(data.pipe_size) * 3 + 'px'
                });
                $('#widget_helper_' + id).css({
                    height: parseInt(data.pipe_size) * 3 + 2 + 'px',
                    width: parseInt(data.pipe_size) * 3 + 2 + 'px'
                });
                if (data.oid) {
                    $('#' + id + '_fill').attr('fill', !vis.binds.basic.isFalse(vis.states[data.oid + '.val']) ? $this.data('color_on') : $this.data('color_off'));
                }
            });

            vis.binds.plumb.plumb_drop($this);

            $this.data('color_on',  data.color_on  || 'green');
            $this.data('color_off', data.color_off || '#c0c0c0');

            if (data.oid) {
                vis.states.bind(data.oid + '.val', function (e, newVal, oldVal) {
                    $('#' + id + '_fill').attr('fill', !vis.binds.basic.isFalse(newVal) ? $this.data('color_on') : $this.data('color_off'));
                });
            } else {
                $this.bind('plumb_change', function (event) {
                    vis.binds.plumb.check(id, event)
                });
            }
        },
        ent_e_top: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr('id');
            var plumb = vis.binds.plumb.data;

            vis.binds.plumb.data[id] = {
                type: "pump",
                cons: ["conTop", "conBottom", "conLeft", "conRight"],
                coli: false,
                conLeft: data.conLeft || null,
                conRight: data.conRight || null,
                conTop: data.conTop || null,
                conBottom: data.conBottom || null,
                status: false,
                color: {
                    c: null,
                    c_from: null,
                    c_default: null
                }
            };

            var self = plumb[id];

            vis.binds.plumb.plumb_drop($this);

            $this.find(".tank_simple_svg").append('\
            <svg\
            height="100%"\
            viewBox="0 0 300 600"\
            width="100%"\
            preserveAspectRatio="none"\
             >\
            <defs>\
            <clipPath id="e_' + id + '" clipPathUnits="userSpaceOnUse">\
            <path d="m146.46.013672a150 50 0 0 0 -71.46 6.6855 150 50 0 0 0 -75 43.301v499.8.20h.013672a150 50.2 0 0 0 74.986 43.28 150 50.2 0 0 0 150 0 150 50.2 0 0 0 74.97 -43.28h.03v-.20-499.8a150 50 0 0 0 -75 -43.301 150 50 0 0 0 -78.54 -6.6853z" fill="' + data.color + '"/>\
            </clipPath>\
            <linearGradient id="d_' + id + '" gradientUnits="userSpaceOnUse" y1="300" x2="300" y2="300">\
            <stop stop-color="#000000" stop-opacity=".5" offset="0"/>\
            <stop stop-color="#000000" stop-opacity="0" offset=".5"/>\
            <stop stop-color="#000000" stop-opacity=".5" offset="1"/>\
            </linearGradient>\
            <linearGradient id="a_' + id + '">\
            <stop stop-color="#000000" stop-opacity="0" offset="0"/>\
            <stop stop-color="#000000" stop-opacity=".5" offset="1"/>\
            </linearGradient>\
            <radialGradient id="c_' + id + '" xlink:href="#a_' + id + '" gradientUnits="userSpaceOnUse" cy="172.7" cx="153.34" gradientTransform="matrix(.98033 .00033848 -.00012370 .35826 3.079 -12.306)" r="150"/>\
            <radialGradient id="b_' + id + '" xlink:href="#a_' + id + '" gradientUnits="userSpaceOnUse" cy="427.04" cx="150" gradientTransform="matrix(-1 0 0 -.37168 300 709.06)" r="150"/>\
            <linearGradient x1="25" y1="10" x2="25" y2="90" id="spray_grad_' + id + '" gradientUnits="userSpaceOnUse">\
            <stop offset="0.3" style="stop-color:#353575;stop-opacity:1" />\
            <stop offset="1" style="stop-color:#bb5500;stop-opacity:1"  />\
            </linearGradient>\
            <linearGradient x1="150" y1="300" x2="150" y2="550" id="fill_grad_' + id + '" gradientUnits="userSpaceOnUse">\
            <stop id="fill_grad_top' + id + '"    offset="0" style="stop-color:#bb5500;stop-opacity:0" />\
            <stop id="fill_grad_bottom' + id + '" offset="1" style="stop-color:' + data.water_color + ';stop-opacity:1"  />\
            </linearGradient>\
            <pattern id="kies_' + id + '" x="0" y="0" height="' + data.filter_size + '" width="' + data.filter_size + '" patternUnits="userSpaceOnUse">\
                    <image height="' + data.filter_size + '" width="' + data.filter_size + '"  xlink:href="' + data.filter_pattern + '"></image>\
            </pattern>\
            </defs>\
            <path d="m146.46.013672a150 50 0 0 0 -71.46 6.6855 150 50 0 0 0 -75 43.301v499.8.20h.013672a150 50.2 0 0 0 74.986 43.28 150 50.2 0 0 0 150 0 150 50.2 0 0 0 74.97 -43.28h.03v-.20-499.8a150 50 0 0 0 -75 -43.301 150 50 0 0 0 -78.54 -6.6853z" fill="' + data.color + '"/>\
            <rect id="' + id + '_fill" clip-path="url(#e_' + id + ')" height="400" width="300" y="200" x="0" fill="url(#fill_grad_' + id + ')"/>\
            <rect id="' + id + '_kies" clip-path="url(#e_' + id + ')" height="450" width="300" y="250" x="0" style="opacity:' + data.filter_opa / 100 + '" fill="url(#kies_' + id + ')"/>\
            <rect class="' + id + '_spray" style="color:#000000" fill="#bb5500" stroke="#000000" stroke-linecap="round" stroke-width="0" height="60" width="300" y="120" x="0"></rect>\
            <polyline points="0,180 300,180" stroke="black" stroke-width="5"></polyline>\
            <path d="m0 50h300v500h-300z" fill="url(#d_' + id + ')" />\
            <path fill="url(#b_' + id + ')" d="m300 550a150 50 0 0 1 -75 43 150 50 0 0 1 -150 0 150 50 0 0 1 -75 -43h150z"/>\
            <path fill="url(#c_' + id + ')" d="m0  50a150 50 0 0 1 75 -43 150 50 0 0 1 150 -0 150 50 0 0 1 75 43h-0z"/>\
            <path class="' + id + '_spray" style="stroke-dasharray:10,7,3; stroke:url(#spray_grad_' + id + ');stroke-width:3;stroke-linecap:none;stroke-opacity:1" d="M 150,120 100,5 M 140,120 100,5 M 130,120 100,5 M 120,120 100,5 M 110,120 100,5 M 100,120 100,5 M  90,120 100,5 M  80,120 100,5 M  70,120 100,5 M  60,120 100,5 M  50,120 100,10"></path>\
            <path class="' + id + '_spray" style="stroke-dasharray:10,7,3; stroke:url(#spray_grad_' + id + ');stroke-width:3;stroke-linecap:none;stroke-opacity:1" d="M 250,120 200,5 M 240,120 200,5 M 230,120 200,5 M 220,120 200,5 M 210,120 200,5 M 200,120 200,5 M 190,120 200,5 M 180,120 200,5 M 170,120 200,5 M 160,120 200,5 M 150,120 200,10"></path>\
            </svg>\
            ');
            $this.bind('plumb_change', function (event) {
                if (self.conTop == event.from) {
                    if (event.status) {
                        $("." + id + "_spray").show()
                    } else {
                        $("." + id + "_spray").hide()
                    }
                }
                if (self.conRight == event.from) {
                    if (event.status) {
                        $('#fill_grad_top' + id).css("stop-opacity", "1");

                        var ev = {
                            type: 'plumb_change',
                            from: id,
                            status: true,
                            color: {
                                c_from: id,
                                c_default: event.color.c_default,
                                c: data.water_color
                            }
                        };
                        $('#' + self.conBottom).trigger(ev);
                    } else {
                        var ev = {
                            type: 'plumb_change',
                            from: id,
                            status: false,
                            color: {
                                c_from: id,
                                c_default: event.color.c_default,
                                c: event.color.c_default
                            }
                        };
                        $('#' + self.conBottom).trigger(ev);
                        $('#fill_grad_top' + id).css("stop-opacity", '0')
                    }
                }
                if (self.conBottom == event.from) {
                    if (event.status) {
                        $('#fill_grad_top' + id).css("stop-opacity", '1');
                        var ev = {
                            type: 'plumb_change',
                            from: id,
                            status: true,
                            color: {
                                c_from: id,
                                c_default: event.color.c_default,
                                c: "#bb5500"
                            }

                        };
                        $('#' + self.conRight).trigger(ev);
                    } else {
                        var ev = {
                            type: 'plumb_change',
                            from: id,
                            status: false,
                            color: {
                                c_from: id,
                                c_default: event.color.c_default,
                                c: event.color.c_default
                            }

                        };
                        $('#' + self.conRight).trigger(ev);
                        $('#fill_grad_top' + id).css("stop-opacity", "0")
                    }
                }
            });
        },
        tank_simple: function (el, data) {
            if (data.conRight_pos !== undefined) {
                var $this = $(el).parent();
                var id = $this.attr('id');
                var plumb = vis.binds.plumb.data;
                var last_event;
                vis.binds.plumb.data[id] = {
                    type: "pump",
                    cons: [],
                    coli: false,
                    conLeft: data.conLeft || null,
                    conRight: data.conRight || null,
                    conTop: data.conTop || null,
                    conBottom: data.conBottom || null,
                    status: false,
                    color: {
                        c: null,
                        c_from: null,
                        c_default: null
                    }
                };

                var self = plumb[id];

                vis.binds.plumb.plumb_drop($this);

                $this.find(".tank_simple_svg").append('\
                    <svg\
                    height="100%"\
                    viewBox="0 0 300 600"\
                    width="100%"\
                    preserveAspectRatio="none"\
                     >\
                    <defs>\
                    <clipPath id="e_' + id + '" clipPathUnits="userSpaceOnUse">\
                    <path d="m146.46.013672a150 50 0 0 0 -71.46 6.6855 150 50 0 0 0 -75 43.301v499.8.20h.013672a150 50.2 0 0 0 74.986 43.28 150 50.2 0 0 0 150 0 150 50.2 0 0 0 74.97 -43.28h.03v-.20-499.8a150 50 0 0 0 -75 -43.301 150 50 0 0 0 -78.54 -6.6853z" fill="' + data.color + '"/>\
                    </clipPath>\
                    <linearGradient id="d_' + id + '" gradientUnits="userSpaceOnUse" y1="300" x2="300" y2="300">\
                    <stop stop-color="#000000" stop-opacity=".5" offset="0"/>\
                    <stop stop-color="#000000" stop-opacity="0" offset=".5"/>\
                    <stop stop-color="#000000" stop-opacity=".5" offset="1"/>\
                    </linearGradient>\
                    <linearGradient id="a_' + id + '">\
                    <stop stop-color="#000000" stop-opacity="0" offset="0"/>\
                    <stop stop-color="#000000" stop-opacity=".5" offset="1"/>\
                    </linearGradient>\
                    <radialGradient id="c_' + id + '" xlink:href="#a_' + id + '" gradientUnits="userSpaceOnUse" cy="172.7" cx="153.34" gradientTransform="matrix(.98033 .00033848 -.00012370 .35826 3.079 -12.306)" r="150"/>\
                    <radialGradient id="b_' + id + '" xlink:href="#a_' + id + '" gradientUnits="userSpaceOnUse" cy="427.04" cx="150" gradientTransform="matrix(-1 0 0 -.37168 300 709.06)" r="150"/>\
                    <linearGradient x1="150" y1="300" x2="150" y2="600" id="fill_grad_' + id + '" gradientUnits="userSpaceOnUse">\
                    <stop id="fill_grad_top' + id + '"    offset="0" style="stop-color:' + data.top_water + ';stop-opacity:1" />\
                    <stop id="fill_grad_bottom' + id + '" offset="1" style="stop-color:' + data.bottom_water + ';stop-opacity:1"  />\
                    </linearGradient>\
                    <pattern id="kies_' + id + '" x="0" y="0" height="' + data.filter_size + '" width="' + data.filter_size + '" patternUnits="userSpaceOnUse">\
                            <image height="' + data.filter_size + '" width="' + data.filter_size + '"  xlink:href="' + data.filter_pattern + '"></image>\
                    </pattern>\
                    </defs>\
                    <path d="m146.46.013672a150 50 0 0 0 -71.46 6.6855 150 50 0 0 0 -75 43.301v499.8.20h.013672a150 50.2 0 0 0 74.986 43.28 150 50.2 0 0 0 150 0 150 50.2 0 0 0 74.97 -43.28h.03v-.20-499.8a150 50 0 0 0 -75 -43.301 150 50 0 0 0 -78.54 -6.6853z" fill="' + data.color + '"/>\
                    <rect id="' + data.wid + '_fill" style="color:#000000" clip-path="url(#e_' + id + ')" height="300" width="300" y="300" x="0" fill="url(#fill_grad_' + id + ')"/>\
                    <rect id="' + id + '_kies" clip-path="url(#e_' + id + ')" height="450" width="300" y="150" x="0" style="display: none; opacity:' + data.filter_opa / 100 + '" fill="url(#kies_' + id + ')"/>\
                    <path d="m0 50h300v500h-300z" fill="url(#d_' + id + ')"/>\
                    <path fill="url(#b_' + id + ')" d="m300 550a150 50 0 0 1 -75 43 150 50 0 0 1 -150 0 150 50 0 0 1 -75 -43h150z"/>\
                    <path fill="url(#c_' + id + ')" d="m0  50a150 50 0 0 1 75 -43 150 50 0 0 1 150 -0 150 50 0 0 1 75 43h-0z"/>\
                    </svg>\
                ');


                setTimeout(function () {
                    if (data.is_filter) {
                        $('#' + id + "_kies").show();
                    }

                    $this.find(".plumb_dock_right, .plumb_dock_left, .plumb_dock_top, .plumb_dock_bottom").remove();
                    $this.removeClass("pl_l");
                    $this.removeClass("pl_r");
                    $this.removeClass("pl_t");
                    $this.removeClass("pl_b");
                    var l;
                    var t;
                    var s;
                    var shadow;

                    if (data.conTop && data.conTop != "") {
                        self.cons.push("conTop");
                        if (data.conTop_show) {
                            $this.find(".tank_simple").append('<div id="' + id + '_dock_top_svg" class="plumb-dock-svg plumb_dock_top"></div>');
                            vis.binds.plumb.svg_pipe_v(id + "_dock_top");

                            s = (parseInt(data.conTop_size) || 20);
                            t = "-9";
                            l = (($this.width() - s) / 100 * (data.conTop_pos || 50));

                            $this.find(".plumb_dock_top").css({
                                top: t + 'px',
                                left: l + 'px',
                                height: "50px",
                                width: s + 'px',
                                overflow: "hidden"
                            }).find("svg").css({
                                position: 'absolute',
                                width: '100%',
                                height: '100%'
                            });

                            $('#' + id + "_dock_top_fill").attr("fill", data.color_off);
                            $this.addClass("pl_t");
                        }
                    }

                    if (data.conBottom && data.conBottom != "") {
                        self.cons.push("conBottom");
                        if (data.conBottom_show) {
                            $this.find(".tank_simple").append('<div id="' + id + '_dock_bottom_svg" class="plumb-dock-svg plumb_dock_bottom"></div>');
                            vis.binds.plumb.svg_pipe_v(id + "_dock_bottom");
                            s = (parseInt(data.conBottom_size) || 20);
                            t = "-9";
                            l = (($this.width() - s) / 100 * (data.conBottom_pos || 50));

                            $this.find(".plumb_dock_bottom").css({
                                bottom: t + 'px',
                                left: l + 'px',
                                height: "50px",
                                width: s + 'px',
                                overflow: "hidden"
                            }).find("svg").css({
                                position: 'absolute',
                                width: '100%',
                                height: '100%'
                            });
                            $('#' + id + "_dock_bottom_fill").attr("fill", data.color_off);
                            $this.addClass("pl_b")
                        }
                    }
                    if (data.conLeft && data.conLeft != "") {
                        self.cons.push("conLeft");
                        if (data.conLeft_show) {
                            $this.find(".tank_simple").append('<div id="' + id + '_dock_left_svg" class="plumb-dock-svg plumb_dock_left"></div>');
                            vis.binds.plumb.svg_pipe_h(id + "_dock_left");
                            s = (parseInt(data.conLeft_size) || 20);
                            l = "-9";
                            t = (($this.height() - s) / 100 * (data.conLeft_pos || 50));

                            $this.find(".plumb_dock_left").css({
                                top: t + 'px',
                                left: l + 'px',
                                height: s + 'px',
                                width: "20px",
                                overflow: "hidden"
                            }).find("svg").css({
                                position: 'absolute',
                                width: '100%',
                                height: '100%'
                            });
                            $('#' + id + "_dock_left_fill").attr("fill", data.color_off);
                            $this.addClass("pl_l")
                        }
                    }
                    if (data.conRight && data.conRight != "") {
                        self.cons.push("conRight");
                        if (data.conRight_show) {
                            $this.find(".tank_simple").append('<div id="' + id + '_dock_right_svg" class="plumb-dock-svg plumb_dock_right"></div>');
                            vis.binds.plumb.svg_pipe_h(id + "_dock_right");
                            s = (parseInt(data.conRight_size) || 20);
                            l = "-9";
                            t = (($this.height() - s) / 100 * (data.conRight_pos || 50));

                            $this.find(".plumb_dock_right").css({
                                top: t + 'px',
                                right: l + 'px',
                                height: s + 'px',
                                width: "20px",
                                overflow: "hidden"
                            }).find("svg").css({
                                position: 'absolute',
                                width: '100%',
                                height: '100%'
                            });
                            $('#' + id + "_dock_right_fill").attr("fill", data.color_off);
                            $this.addClass('pl_r')
                        }
                    }
                    vis.binds.plumb.plumb_drop($this);

                    if (data.oid) {
                        set(vis.states[data.oid + '.val']);
                    }
                    vis.states.bind(data.oid + '.val', function (e, newVal, oldVal) {
                        set(newVal);
                    });
                }, 0);

                $this.bind('plumb_change', function (event) {
                    if (event.status) {
                        last_event = event.from;
                    }
                });
            }

            function set(_newVal) {
                var newVal = _newVal || 0;
                var step = 600 / 100;
                var val;
                var level;
                if (data.type === 'level') {
                    step = 600 / (data.level_max - data.level_min );
                    val = (newVal - data.level_min) * step;
                    if (val < 0) {
                        val = 0
                    }
                    level = parseInt(100 / 600 * val);
                    $('#' + data.wid + "_fill").attr('height', val).attr('y', 600 - val);
                    $('#fill_grad_' + id).attr('y1', 600 - val);
                } else if (data.type === 'bool') {
                    step = 600 / 100;

                    if (newVal) {
                        val = data.level_max * step;
                    } else {
                        val = data.level_min * step;
                    }

                    level = parseInt(100 / 600 * val);
                    $('#' + data.wid + "_fill").attr('height', val).attr("y", 600 - val);
                    $('#fill_grad_' + id).attr("y1", 600 - val);
                } else if (data.type === 'fix') {
                    level = parseInt(100 / 600 * (data.level_min * step));
                    $('#' + data.wid + "_fill").attr('height', data.level_min * step).attr("y", 600 - data.level_min * step);
                    $('#fill_grad_' + id).attr("y1", 600 - data.level_min * step);
                }


//                --------------------------------------------------------------------------------------------------------------------
                var ev = {
                    type:   'plumb_change',
                    from:   id,
                    status: true,
                    color: {
                        c_from: id
//                        c_default: event.color.c_default || "#C0C0C0",
//                        c: event.color.c || "#C0C0C0"
                    }
                };
                if (self.conRight != last_event) {
                    if (level > parseInt(data.conRight_level)) {
                        ev.color.c = data.conRight_color_on;
                        ev.color.c_default = data.conRight_color_off;
                    } else {
                        ev.status = false;
                        ev.color.c = data.conRight_color_off;
                        ev.color.c_default = data.conRight_color_off;
                    }
                    $('#' + id + "_dock_right_fill").attr("fill", ev.color.c);
                    $('#' + self.conRight).trigger(ev);

                }
                if (self.conLeft != last_event) {
                    if (level >= parseInt(data.conLeft_level)) {
                        ev.color.c = data.conLeft_color_on;
                        ev.color.c_default = data.conLeft_color_off;
                    } else {
                        ev.status = false;
                        ev.color.c = data.conLeft_color_off;
                        ev.color.c_default = data.conLeft_color_off;
                    }
                    $('#' + id + "_dock_left_fill").attr("fill", ev.color.c);
                    $('#' + self.conLeft).trigger(ev);
                }
                if (self.conTop != last_event) {
                    if (level >= parseInt(data.conTop_level)) {
                        ev.color.c = data.conTop_color_on;
                        ev.color.c_default = data.conTop_color_off;
                    } else {
                        ev.status = false;
                        ev.color.c = data.conTop_color_off;
                        ev.color.c_default = data.conTop_color_off;
                    }
                    $('#' + id + "_dock_top_fill").attr("fill", ev.color.c);
                    $('#' + self.conTop).trigger(ev);
                }
                if (self.conBottom != last_event) {
                    if (level >= parseInt(data.conBottom_level)) {
                        ev.color.c = data.conBottom_color_on;
                        ev.color.c_default = data.conBottom_color_off;
                    } else {
                        ev.status = false;
                        ev.color.c = data.conBottom_color_off;
                        ev.color.c_default = data.conBottom_color_off;
                    }
                    $('#' + id + "_dock_bottom_fill").attr("fill", ev.color.c);
                    $('#' + self.conBottom).trigger(ev);
                }
//
//                if (self.conRight == last_event) {
//                    $('#' + id + "_dock_right_fill").attr("fill", event.color.c);
//                } else if (self.conLeft == last_event) {
//                    $('#' + id + "_dock_left_fill").attr("fill", event.color.c);
//                } else if (self.conTop == last_event) {
//                    $('#' + id + "_dock_top_fill").attr("fill", event.color.c);
//                } else if (self.conBottom == last_event) {
//                    $('#' + id + "_dock_bottom_fill").attr("fill", event.color.c);
//                }
            }

            setTimeout(function () {
                $($this.parent()).on('rendered', function () {
                    if (data.oid) {
                        set(vis.states[data.oid + '.val']);
                    }
                });
            }, 0);
        }
    };

    vis.binds.plumb.showVersion();
</script>

<script id="tplPlump_pump"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_pump" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl_b pl_t ui-selectee ui-draggable-handle " data-vis-resizable="{}" style="top: 163px; left: 449px; width: 57px; height: 183px;" > <div class="vis-widget-prev-body">	<div class="pump" ><img style="position: absolute; width: 100%;" src="./widgets/plumb/img/pumpe.png"><div class="plumb_dock_top ui-droppable"></div><div class="plumb_dock_bottom ui-droppable"></div>	<div class="plumb_dock_left ui-droppable"></div>	<div class="plumb_dock_right ui-droppable"></div>	</div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="val"
        data-vis-name="Pump"
        data-vis-attrs="oid;src[widgets/plumb/img/pumpe.png]/image;color_off[#C0C0C0]/color;color_on[#00ff00]/color;group.conTop;conTop_show/checkbox;conTop_size[20]/slider,10,50,5;conTop_pos[50]/slider,0,100,1;conTop;group.conBottom;conBottom_show/checkbox;conBottom_size[20]/slider,10,50,5;conBottom_pos[50]/slider,0,100,1;conBottom;group.conLeft;conLeft_show/checkbox;conLeft_size[20]/slider,10,50,5;conLeft_pos[50]/slider,0,100,1;conLeft;group.conRight;conRight_show/checkbox;conRight_size[20]/slider,10,50,5;conRight_pos[50]/slider,0,100,1;conRight">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_b pl_t pl_l pl_r" data-vis-resizable='{}' style=" width: 65px; height: 205px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.pump(el, data) %>>
	<div class="pump" >
	  <% if (vis.editMode) { %>
                <div class="editmode-helper" style="z-index:0" />
            <% } %>
            <img class="pump_img" <%= this.data.attr('src') ? 'src="' + this.data.attr('src') + '"' : '' %> />
	<div id="<%= this.data.attr('wid') %>_dock_left_svg" class="plumb-dock-svg plumb_dock_left"></div>
	<div id="<%= this.data.attr('wid') %>_dock_left_svg" class="plumb-dock-svg plumb_dock_right"></div>
	<div id="<%= this.data.attr('wid') %>_dock_left_svg" class="plumb-dock-svg plumb_dock_top"></div>
	<div id="<%= this.data.attr('wid') %>_dock_left_svg" class="plumb-dock-svg plumb_dock_bottom"></div>
	</div>
        </div>
    </div>
</script>

<script id="tplPlump_i-sprinkler"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_isprinkler" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl pl_b pl_t pl_l pl_r ui-draggable-handle " data-vis-resizable="{"grid": [ 10, 10 ]}" style="width: 20px; height: 17px; overflow: visible; left: 242px; top: 228px; position: absolute;" > <div class="plumb_sprinkler_i_body vis-widget-prev-body" style="border-top-left-radius: 100%; border-top-right-radius: 100%; border-bottom-right-radius: 100%; border-bottom-left-radius: 100%; background-color: rgb(0, 0, 0);"> <div class="plumb_sprinkler_i" > <div class="plumb_splinkler_i_water" style="height: 60px; width: 5px; left: 7px; top: -51px; position: relative; background-color: rgb(27, 138, 222);"></div> </div> <div class="plumb_dock_top ui-droppable"></div> <div class="plumb_dock_bottom ui-droppable"></div> <div class="plumb_dock_left ui-droppable"></div> <div class="plumb_dock_right ui-droppable"></div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="val"
        data-vis-name="Sprinker I"
        data-vis-attrs="_no_resize[true]/hidden;test/checkbox;spray_width[100]/slider,10,500,1;head_size[20]/slider,10,50,5;time[4];start[0];ende[90];stroke[4];opacity[0.8];fog/checkbox;water_color[blue]/color;head_color[black]/color;head_show[true]/checkbox;head_round[true]/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_b pl_t pl_l pl_r" style=" width: 20px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="plumb_sprinkler_i_body vis-widget-body" <%= (el) -> vis.binds.plumb.sprinkler_i(el, data) %>>
            <% if (vis.editMode) { %><div class="editmode-helper" /><% } %>
            <div class="plumb_sprinkler_i" style="display: 'none'">
                <div class="plumb_sprinkler_i_water"></div>
            </div>
            <div class="plumb_dock_top"></div>
            <div class="plumb_dock_bottom"></div>
            <div class="plumb_dock_left"></div>
            <div class="plumb_dock_right"></div>
        </div>
    </div>
</script>

<script id="tplPlump_r-sprinkler"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_isprinkler" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl pl_b pl_t pl_l pl_r ui-draggable-handle " data-vis-resizable="{"grid": [ 10, 10 ]}" style="width: 20px; height: 17px; overflow: visible; left: 242px; top: 228px; position: absolute;" > <div class="plumb_sprinkler_i_body vis-widget-prev-body" style="border-top-left-radius: 100%; border-top-right-radius: 100%; border-bottom-right-radius: 100%; border-bottom-left-radius: 100%; background-color: rgb(0, 0, 0);"> <div class="plumb_sprinkler_i" > <div class="plumb_splinkler_i_water" style="height: 60px; width: 5px; left: 7px; top: -51px; position: relative; background-color: rgb(27, 138, 222);"></div> </div> <div class="plumb_dock_top ui-droppable"></div> <div class="plumb_dock_bottom ui-droppable"></div> <div class="plumb_dock_left ui-droppable"></div> <div class="plumb_dock_right ui-droppable"></div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="val"
        data-vis-name="Sprinker R"
        data-vis-attrs="_no_resize[true]/hidden;spray_width[100]/slider,10,500,1;"
        data-vis-attrs0="spray_range[360]/nselect,360,0-180,90-270,270-90,0-90,90-180,180-270,270-360;test/checkbox;time[30];head_size[20]/slider,10,50,5;start[0]/slider,0,100,1;ende[100]/slider,0,100,1;stroke[4];opacity[0.8]/slider,0,1,0.01;water_color[blue]/color;head_color[black]/color;head_round[true]/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_b pl_t pl_l pl_r" style=" width: 20px; height: 20px;overflow: visible" id="<%= this.data.attr('wid') %>">
        <div style="overflow: visible" class="plumb_sprinkler_r_body vis-widget-body" <%= (el) -> vis.binds.plumb.sprinkler_r(el, data) %>>
            <div class="plumb_sprinkler_r_head"></div>
            <div class="plumb_dock_top"></div>
            <div class="plumb_dock_bottom"></div>
            <div class="plumb_dock_left"></div>
            <div class="plumb_dock_right"></div>
            <div class="plumb_sprinkler_r" style="display: 'none'">
            </div>
        </div>
    </div>
</script>

<script id="tplPlump_pipe_V"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/plumb/img/prev_pipe_v.png" ></img>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Pipe_V"
        data-vis-attrs="pipe_size[20]/slider,10,50,5;conTop;conBottom;"
        data-vis-attrs0="group.custom_control;oid;color_on/color;color_off/color;">
    <div class="vis-widget <%== this.data.attr('class') %> plumb_pipe pl pl_b pl_t" data-vis-resizable='{"handles": "n,s" }' style="width: 20px; height: 100px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.pipe_v(el, data) %>>
	<div class="pipe_v" >
	   <div id="<%= this.data.attr('wid') %>_svg" class="plumb-svg"></div>
	<div class="plumb_dock_top"></div>
	<div class="plumb_dock_bottom"></div>
	</div>
        </div>
    </div>
</script>

<script id="tplPlump_pipe_H"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/plumb/img/prev_pipe_h.png" class=""></img>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Pipe_H"
        data-vis-attrs="pipe_size[20]/slider,10,50,5;conLeft;conRight;"
        data-vis-attrs0="group.custom_control;oid;color_on/color;color_off/color;">
    <div class="vis-widget <%== this.data.attr('class') %> plumb_pipe pl pl_l pl_r " data-vis-resizable='{"handles": "e, w"}' style=" width: 100px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.pipe_h(el, data) %>>
	<div class="pipe_h" >
	<div id="<%= this.data.attr('wid') %>_svg" class="plumb-svg"></div>
	<div class="plumb_dock_left"></div>
	<div class="plumb_dock_right"></div>
	</div>
        </div>
    </div>
</script>

<script id="tplPlump_bogen_br"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/plumb/img/prev_bogen.png" class=""></img>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Bogen_br"
        data-vis-attrs="_no_resize[true]/hidden;pipe_size[20]/slider,10,50,5;conBottom;conRight;"
        data-vis-attrs0="group.custom_control;oid;color_on/color;color_off/color;">
    <div class="vis-widget <%== this.data.attr('class')%>  pl pl_r pl_b "  style=" width: 20px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.bogen_br(el, data) %>>
	<div class="bogen_br">
	<div id="<%= this.data.attr('wid') %>_svg" class="plumb-svg plumb-rotate180"></div>
	<div class="plumb_dock_right"></div>
	<div class="plumb_dock_bottom"></div>
	</div>
        </div>
    </div>
</script>

<script id="tplPlump_bogen_bl"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/plumb/img/prev_bogen.png" class="plumb-flip-x"></img>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Bogen_bl"
        data-vis-attrs="_no_resize[true]/hidden;pipe_size[20]/slider,10,50,5;conBottom;conLeft;"
        data-vis-attrs0="group.custom_control;oid;color_on/color;color_off/color;">
    <div class="vis-widget <%== this.data.attr('class')%>  pl pl_l pl_b " style=" width: 20px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.bogen_bl(el, data) %>>
	<div class="bogen_bl plumb_body">
	<div id="<%= this.data.attr('wid') %>_svg" class="plumb-svg plumb-flip-y"></div>
	<div class="plumb_dock_left"></div>
	<div class="plumb_dock_bottom"></div>
	</div>
        </div>
    </div>
</script>

<script id="tplPlump_bogen_tr"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/plumb/img/prev_bogen.png" class="plumb-flip-y"></img>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Bogen_tr"
        data-vis-attrs="_no_resize[true]/hidden;pipe_size[20]/slider,10,50,5;conTop;conRight;"
        data-vis-attrs0="group.custom_control;oid;color_on/color;color_off/color;">
    <div class="vis-widget <%== this.data.attr('class')%>  pl pl_t pl_r " style=" width: 20px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.bogen_tr(el, data) %>>
	<div class="bogen_tr plumb_body">
	<div id="<%= this.data.attr('wid') %>_svg" class="plumb-svg plumb-flip-x"></div>
	<div class="plumb_dock_top"></div>
	<div class="plumb_dock_right"></div>
	</div>
        </div>
    </div>
</script>

<script id="tplPlump_bogen_tl"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/plumb/img/prev_bogen.png" class="plumb-rotate180"></img>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Bogen_tl"
        data-vis-attrs="_no_resize[true]/hidden;pipe_size[20]/slider,10,50,5;conTop;conLeft;"
        data-vis-attrs0="group.custom_control;oid;color_on/color;color_off/color;">
    <div class="vis-widget <%== this.data.attr('class')%>  pl pl_t pl_l " style=" width: 20px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.bogen_tl(el, data) %>>
	<div class="bogen_tl plumb_body">
	<div id="<%= this.data.attr('wid') %>_svg" class="plumb-svg"></div>
	<div class="plumb_dock_top"></div>
	<div class="plumb_dock_left"></div>
	</div>
        </div>
    </div>
</script>

<script id="tplPlump_valve_H"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_valve_H" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl_l pl_r ui-selectee ui-draggable-handle " data-vis-resizable="{"grid": [ 20, 10 ],"aspectRatio": true}" style="top: 245px; left: 240px; width: 40px; height: 20px;" > <div class="vis-widget-prev-body">   <div class="valve_h" >    <div class="plumb_valve_l" style="border-color: rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgb(255, 0, 0); border-width: 10px 0px 10px 20px;"></div>    <div class="plumb_valve_r" style="border-color: rgba(0, 0, 0, 0) rgb(255, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0); border-width: 10px 20px 10px 0px;"></div>    <div class="plumb_dock_left ui-droppable"></div>    <div class="plumb_dock_right ui-droppable"></div>   </div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="val"
        data-vis-name="valve_H"
        data-vis-attrs="_no_resize[true]/hidden;oid;pipe_size[20]/slider,10,50,5;conLeft;conRight;ctrl/checkbox;color_on/color;color_off/color;">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_l pl_r " style=" width: 30px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.valve_h(el, data) %>>
	<div class="valve_h " >
	<svg style="display: block"
	   preserveAspectRatio="none"
            	height="100%"
            	width="100%"
            	viewBox="0 0 350 200">
              <path d="m0 0v200l175-87.5 175 87.5v-200l-175 87.5-175-87.5z" fill-rule="evenodd" fill="#ff0000"/>
            </svg>
	<div class="plumb_dock_left"></div>
	<div class="plumb_dock_right"></div>
	</div>
        </div>
    </div>
</script>

<script id="tplPlump_valve_V"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_valve_v" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl_t pl_b ui-selectee ui-draggable-handle " data-vis-resizable="{"grid": [ 10, 20 ],"aspectRatio": true}" style="width: 20px; height: 35px; left: 121px; top: 469px; position: absolute;" > <div class="vis-widget-prev-body"> <div class="valve_v " > <div class="plumb_valve_t" style="border-color: rgb(255, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0); border-width: 20px 10px 0px;"></div> <div class="plumb_valve_b" style="border-color: rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgb(255, 0, 0); border-width: 0px 10px 20px;"></div> <div class="plumb_dock_top ui-droppable"></div> <div class="plumb_dock_bottom ui-droppable"></div> </div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="val"
        data-vis-name="valve_V"
        data-vis-attrs="_no_resize[true]/hidden;oid;pipe_size[20]/slider,10,50,5;conTop;conBottom;ctrl/checkbox;color_on/color;color_off/color;">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_t pl_b " style=" width: 20px; height: 32px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.valve_v(el, data) %>>
	<div class="valve_v " >
	<svg style="display: block"
	   preserveAspectRatio="none"\
                	height="100%"
                	width="100%"
                	viewBox="0 0 200 350">
                 <path d="m0 350h200l-87.5-175 87.5-175h-200l87.5 175-87.5 175z" fill-rule="evenodd" fill="#ff0000"/>
                </svg>
	<div class="plumb_dock_top"></div>
	<div class="plumb_dock_bottom"></div>
	</div>
        </div>
    </div>
</script>

<script id="tplPlump_check_valve_H"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/plumb/img/prev_c_valve_h.png"></img>'
        data-vis-set="plumb"
        data-vis-type="val"
        data-vis-name="Check Valve H"
        data-vis-attrs="_no_resize[true]/hidden;conLeft;conRight;pipe_size[20]/slider,10,50,5;turn_direction[false]/checkbox;color_on/color;color_off/color;">
         <div class="vis-widget <%== this.data.attr('class') %> pl pl_l pl_r " style=" width: 50px; height: 20px;" id="<%= this.data.attr('wid') %>">
             <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.c_valve_h(el, data) %>>
    	<div class="valve_h " >
    	<div id="<%= this.data.attr('wid') %>_svg" class="plumb-svg"></div>
    	<div class="plumb_dock_left"></div>
    	<div class="plumb_dock_right"></div>
    	</div>
             </div>
         </div>
</script>

<script id="tplPlump_check_valve_V"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/plumb/img/prev_c_valve_v.png"></img>'
        data-vis-set="plumb"
        data-vis-type="val"
        data-vis-name="Check Valve V"
        data-vis-attrs="_no_resize[true]/hidden;conTop;conBottom;pipe_size[20]/slider,10,50,5;turn_direction[false]/checkbox;color_on/color;color_off/color;">
         <div class="vis-widget <%== this.data.attr('class') %> pl pl_t pl_b " style=" width: 20px; height: 50px;" id="<%= this.data.attr('wid') %>">
             <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.c_valve_v(el, data) %>>
    	<div class="valve_v " >
    	       <div id="<%= this.data.attr('wid') %>_svg" class="plumb-svg"></div>
    	<div class="plumb_dock_top"></div>
    	<div class="plumb_dock_bottom"></div>
    	</div>
             </div>
         </div>
</script>

<script id="tplPlump_Tpiece_ht"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/plumb/img/prev_tpice.png" ></img>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Pipe_HT"
        data-vis-attrs="_no_resize[true]/hidden;pipe_size[20]/slider,10,50,5;conLeft;conRight;conTop;"
        data-vis-attrs0="group.custom_control;oid;color_on/color;color_off/color;">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_l pl_r pl_t" style="width: 60px; height: 60px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.tpice_ht(el, data) %>>
	<div class="tpice_ht" >
	   <div id="<%= this.data.attr('wid') %>_svg" class="plumb-svg plumb-rotate270"></div>
	   <div class="tpice-hr plumb_body"></div>
	   <div class="tpice-t plumb_body"></div>
	<div class="plumb_dock_top"></div>
	<div class="plumb_dock_left"></div>
	<div class="plumb_dock_right"></div>
	</div>
        </div>
    </div>
</script>

<script id="tplPlump_Tpiece_hb"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/plumb/img/prev_tpice.png" class="plumb-flip-y" ></img>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Pipe_HB"
        data-vis-attrs="_no_resize[true]/hidden;pipe_size[20]/slider,10,50,5;conLeft;conRight;conBottom;"
        data-vis-attrs0="group.custom_control;oid;color_on/color;color_off/color;">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_l pl_r pl_b" style="width: 60px; height: 60px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.tpice_hb(el, data) %>>
	<div class="tpice_ht " >
	           <div id="<%= this.data.attr('wid') %>_svg" class="plumb-svg plumb-rotate90"></div>
	<div class="plumb_dock_bottom"></div>
	<div class="plumb_dock_left"></div>
	<div class="plumb_dock_right"></div>
	</div>
        </div>
    </div>
</script>

<script id="tplPlump_Tpiece_vl"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/plumb/img/prev_tpice.png" class="plumb-rotate270" style="margin:15px"></img>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Pipe_VL"
        data-vis-attrs="_no_resize[true]/hidden;pipe_size[20]/slider,10,50,5;conLeft;conBottom;conTop;"
        data-vis-attrs0="group.custom_control;oid;color_on/color;color_off/color;">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_l pl_b pl_t" style="width: 60px; height: 60px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.tpice_vl(el, data) %>>
	<div class="tpice_vl " >
	   <div id="<%= this.data.attr('wid') %>_svg" class="plumb-svg plumb-rotate180"></div>
	   <div class="tpice-vb plumb_body"></div>
	<div class="plumb_dock_top"></div>
	<div class="plumb_dock_bottom"></div>
	<div class="plumb_dock_left"></div>
	</div>
        </div>
    </div>
</script>

<script id="tplPlump_Tpiece_vr"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/plumb/img/prev_tpice.png" class="plumb-rotate90" style="margin:15px"></img>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Pipe_VR"
        data-vis-attrs="_no_resize[true]/hidden;pipe_size[20]/slider,10,50,5;conBottom;conRight;conTop;"
        data-vis-attrs0="group.custom_control;oid;color_on/color;color_off/color;">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_b pl_r pl_t" style="width: 60px; height: 60px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.tpice_vr(el, data) %>>
	<div class="tpice_vr ">
	   <div id="<%= this.data.attr('wid') %>_svg" class="plumb-svg "></div>
                <div class="plumb_dock_top"></div>
	<div class="plumb_dock_bottom"></div>
	<div class="plumb_dock_right"></div>
	</div>
        </div>
    </div>
</script>

<script id="tplPlump_tank_simple"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/plumb/img/prev_tank_simple.png"></img>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Tank"
        data-vis-attrs="type[level]/nselect,fix,bool,level;level_min[0];level_max[100];oid;color[#C0C0C0]/color;top_water[#0000ff]/color;bottom_water[#00ffff]/color;"
        data-vis-attrs0="group.filter;is_filter/checkbox;filter_pattern[widgets/plumb/img/kies.png]/image;filter_size[100];filter_opa[50]/slider,0,100,1;"
        data-vis-attrs1="group.conTop;conTop_show/checkbox;conTop_level[100]/slider,0,100,1;conTop_color_off[#C0C0C0]/color;conTop_color_on[#00ff00]/color;conTop_size[20]/slider,10,50,5;conTop_pos[50]/slider,0,100,1;conTop;"
        data-vis-attrs2="group.conBottom;conBottom_show/checkbox;conBottom_level[1]/slider,0,100,1;conBottom_color_off[#C0C0C0]/color;conBottom_color_on[#00ff00]/color;conBottom_size[20]/slider,10,50,5;conBottom_pos[50]/slider,0,100,1;conBottom;"
        data-vis-attrs3="group.conLeft;conLeft_show/checkbox;conLeft_level[50]/slider,0,100,1;conLeft_color_off[#C0C0C0]/color;conLeft_color_on[#00ff00]/color;conLeft_size[20]/slider,10,50,5;conLeft_pos[50]/slider,0,100,1;conLeft;"
        data-vis-attrs4="group.conRight;conRight_show/checkbox;conRight_level[50]/slider,0,100,1;conRight_color_off[#C0C0C0]/color;conRight_color_on[#00ff00]/color;conRight_size[20]/slider,10,50,5;conRight_pos[50]/slider,0,100,1;conRight">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_l pl_r pl_t pl_b" data-vis-resizable='{}' style="min-width: 70px; min-height: 135px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.tank_simple(el, data) %>>
	<div class="tank_simple" >
            	<div class="tank_simple_svg">
	<div id="<%= this.data.attr('wid') %>_dock_left_svg" class="plumb-dock-svg plumb_dock_left"></div>
	<div id="<%= this.data.attr('wid') %>_dock_right_svg" class="plumb-dock-svg plumb_dock_right"></div>
	<div id="<%= this.data.attr('wid') %>_dock_top_svg" class="plumb-dock-svg plumb_dock_top"></div>
	<div id="<%= this.data.attr('wid') %>_dock_bottom_svg" class="plumb-dock-svg plumb_dock_bottom"></div>
	</div>
        </div>
    </div>
</script>

<!--<script id="tplPlump_tank_ent_e"-->
<!--type="text/ejs"-->
<!--class="vis-tpl"-->
<!--data-vis-prev='<div id="prev_tplPlump_tank_ent_e" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl pl_l pl_r pl_t ui-draggable-handle " data-vis-resizable="{"grid": [ 30, 30 ],"aspectRatio": true}" style="width: 110px; height: 240px; left: 330px; top: 47px; position: absolute;" > <div class="vis-widget-prev-body"> <div class="tank_ent-e " > <div class="ent-e_top_pipe-l" style="box-shadow: rgb(0, 0, 0) 10px 0px 10px -10px inset, rgb(0, 0, 0) -10px 0px 10px -10px inset;"></div> <div class="ent-e_top_pipe-r" style="box-shadow: rgb(0, 0, 0) 10px 0px 10px -10px inset, rgb(0, 0, 0) -10px 0px 10px -10px inset;"></div> <div class="ent-e_top" style="box-shadow: rgb(0, 0, 0) 90px 0px 90px -90px inset, rgb(0, 0, 0) -90px 0px 90px -90px inset, rgb(0, 0, 0) 0px 45px 45px -45px inset;"></div> <div class="ent-e_center" style="box-shadow: rgb(0, 0, 0) 90px 0px 90px -90px inset, rgb(0, 0, 0) -90px 0px 90px -90px inset;"> <div class="ent-e_schott"></div> <div class="ent-e_kies"></div> </div> <div class="ent-e_bottom" style="box-shadow: rgb(0, 0, 0) 90px 0px 90px -90px inset, rgb(0, 0, 0) -90px 0px 90px -90px inset;"></div> <div class="ent-e_bottom_pipe"></div> <div class="plumb_dock_top ui-droppable"></div> <div class="plumb_dock_left ui-droppable"></div> <div class="plumb_dock_right ui-droppable"></div> </div> </div> </div></div>'-->
<!--data-vis-set="plumb"-->
<!--data-vis-type="static"-->
<!--data-vis-name="Tank Enteisung"-->
<!--data-vis-attrs="color[#C0C0C0]/color;water_color[#0000ff]/color;conTop,cnBottom;conLeft;conRight;filter_pattern[widgets/plumb/img/kies.png]/image;filter_size[15];filter_opa[50]/slider,0,100,1">-->
<!--<div class="vis-widget <%== this.data.attr('class') %> pl pl_l pl_r pl_t" data-vis-resizable='{"grid": [ 5, 5 ],"aspectRatio": false,"handles": "n, e, s, w"}' style="min-width: 140px; min-height: 270px;" id="<%= this.data.attr('wid') %>">-->
<!--<div class="vis-widget-body" <%= (el) -> vis.binds.plumb.ent_e_top(el, data) %>>-->
<!--<div class="tank_ent-e " >-->
<!--<div class="tank_simple_svg">-->
<!--<div id="<%= this.data.attr('wid') %>_dock_left_svg" class="plumb-dock-svg plumb_dock_left"></div>-->
<!--<div id="<%= this.data.attr('wid') %>_dock_right_svg" class="plumb-dock-svg plumb_dock_right"></div>-->
<!--<div id="<%= this.data.attr('wid') %>_dock_top_svg" class="plumb-dock-svg plumb_dock_top"></div>-->
<!--<div id="<%= this.data.attr('wid') %>_dock_bottom_svg" class="plumb-dock-svg plumb_dock_bottom"></div>-->
<!--</div>-->
<!--</div>-->
<!--</div>-->
<!--</script>-->

<!-- --------------plumb.html--- END -->
<!-- --------------rgraph.html--- START -->
<!--
    ioBroker.vis rgraph Widget-Set

    version: "0.0.2"

    Copyright 2013-2015 bluefox<dogafox@gmail.com>
-->
<script type="text/javascript" src="widgets/rgraph/js/RGraph.common.core.js"></script>
<script type="text/javascript" src="widgets/rgraph/js/RGraph.common.effects.js"></script>
<script type="text/javascript" src="widgets/rgraph/js/RGraph.common.dynamic.js"></script>
<script type="text/javascript" src="widgets/rgraph/js/RGraph.common.tooltips.js"></script>
<script type="text/javascript" src="widgets/rgraph/js/RGraph.common.key.js"></script>
<script type="text/javascript" src="widgets/rgraph/js/RGraph.thermometer.js"></script>
<script type="text/javascript" src="widgets/rgraph/js/RGraph.gauge.js"></script>
<script type="text/javascript" src="widgets/rgraph/js/RGraph.bar.js"></script>
<script type="text/javascript" src="widgets/rgraph/js/RGraph.line.js"></script>

<script language="javascript">
    "use strict";
    // Add words for bars
    if (vis.editMode) {
        $.extend(systemDictionary, {
            "min_value"          : {"en": "Min value",      "de": "Min Wert",             "ru": "Мин. значение"},
            "max_value"          : {"en": "Max value",      "de": "Max Wert",             "ru": "Макс. значение"},
            "max_value_oid"       : {"en": "Max value ID",   "de": "Max Wert Objekt",      "ru": "ID макс. значения"},
            "width"              : {"en": "Widget width",   "de": "Widgetbreite",         "ru": "Ширина элемента"},
            "control"            : {"en": "Control",        "de": "Steuerung",            "ru": "Контроль"},
            "factor"             : {"en": "Multiply factor","de": "Wert multiplizieren",  "ru": "Фактор-множитель"},
            "value_offset"       : {"en": "Offset factor",  "de": "Offsetwert",           "ru": "Фактор сдвига"},
            "color"              : {"en": "Color",          "de": "Farbe",                "ru": "Цвет"},
            "show_scale"         : {"en": "Show scale",     "de": "Zeige Skala",          "ru": "Показать шкалу"},
            "labels_color"       : {"en": "Labels color",   "de": "Labelfarbe",           "ru": "Цвет подписей шкалы"},
            "labels_font"        : {"en": "Labels font",    "de": "Labelfont",            "ru": "Шрифт подписей шкалы"},
            "labels_size"        : {"en": "Labels font size","de": "Labelsfontgröße",     "ru": "Размер подписей шкалы"},
            "title"              : {"en": "Title",          "de": "Titel",                "ru": "Подпись"},
            "title_side"         : {"en": "Side title",     "de": "Seitentitel",           "ru": "Вертикальная подпись"},
            "title_side_font"    : {"en": "Side title font","de": "Seitentitelfont",       "ru": "Шрифт вертикальной подписи"},
            "title_side_size"    : {"en": "Side title font size","de": "Seitentitelfontgröße","ru": "Размер вертикальной подписи"},
            "show_shadow"        : {"en": "Show shadow",    "de": "Zeige Schatten",       "ru": "Показать тень"},
            "ticksize"           : {"en": "Tick length",    "de": "Zeichenlänge",         "ru": "Длина штриха"},
            "units_pre"          : {"en": "Units pre",      "de": "Einheitsprefix",       "ru": "Префикс"},
            "units_post"         : {"en": "Units post",     "de": "Einheitspostfix",      "ru": "Суффикс"},
            "scale_decimals"     : {"en": "Scale decimals", "de": "Nachkommazeichen bei Skala","ru": "Чисел после запятой шкалы"},
            "show_value"         : {"en": "Show value",     "de": "Zeige Wert",           "ru": "Показать значение"},
            "value_decimals"     : {"en": "Value decimals", "de": "Nachkommazeichen beim Wert","ru": "Чисел после запятой значения"},
            "labels_count"       : {"en": "Labels count",   "de": "Anzahl von Labels",    "ru": "Кол-во подписей в шкале"},
            "animate"            : {"en": "Show animation", "de": "Zeige Animation",      "ru": "Плавное изменение"},
            // Gauge
            "oid_2"            : {"en": "Second object ID",    "de": "Zweite ObjektID",          "ru": "ID второго объекта"},
            "oid_3"            : {"en": "Third object ID",     "de": "Dritte ObjektID",          "ru": "ID третьего объекта"},
            "a_start"            : {"en": "Scale start",         "de": "Anfang von Skala",         "ru": "Начало шкалы"},
            "a_end"              : {"en": "Scale end",           "de": "Ende von Skala",           "ru": "Конец шкалы"},
            "ticks_big_color"    : {"en": "Big tick color",      "de": "Farbe von langen Ticks",   "ru": "Цвет длинных штрихов"},
            "ticks_small_color"  : {"en": "Small tick color",    "de": "Farbe von kurzen Ticks",   "ru": "Цвет коротких штрихов"},
            "border_outer_color" : {"en": "Outer border color",  "de": "Aussenrand-Farbe",         "ru": "Цвет внешней каймы"},
            "border_inner_color" : {"en": "Inner border color",  "de": "Innenrabd-Farbe",          "ru": "Цвет внутренней каймы"},
            "back_color"         : {"en": "Background color",    "de": "Hintergrund-Farbe",        "ru": "Цвет фона"},
            "background_gradient": {"en": "Gradient background", "de": "Hintergrund mit Gradient", "ru": "Фон с градиентом"},
            "border_outline_color" : {"en": "Outline border color","de": "Abgrenzungrand-Farbe",   "ru": "Цвет границы"},
            "needle_colors"      : {"en": "Needle colors",       "de": "Zeigerfarben",             "ru": "Цвет стрелки"},
            "needle_type"        : {"en": "Needle type",         "de": "Zeigertyp",                "ru": "Тип стрелки"},
            "needle_tail"        : {"en": "Show needle tail",    "de": "Zeige Zeigerschwanz",      "ru": "Показать хвостик стрелки"},
            "needle_size"        : {"en": "Needle size",         "de": "Zeigergröße",              "ru": "Размер стрелки"},
            "centerpin_radius"   : {"en": "Center radius",       "de": "Radius von Mittelpunkt",   "ru": "Радиус центральной точки"},
            "centerpin_color"    : {"en": "Center color",        "de": "Farbe von Mittelpunkt",    "ru": "Цвет центральной точки"},
            "title_color"        : {"en": "Top title color",     "de": "Obere Beschriftungsfarbe", "ru": "Цвет верхней подписи"},
            "title_font"         : {"en": "Top title font",      "de": "Oberer Beschriftungsfont", "ru": "Шрифт верхней подписи"},
            "title_size"         : {"en": "Top title size",      "de": "Obere Beschriftungsgröße", "ru": "Размер верхней подписи"},
            "title_pos"          : {"en": "Top title position",  "de": "Obere Beschriftungs- Position","ru": "Положение верхней подписи"},
            "title_bottom"       : {"en": "Bottom title",        "de": "Untere Beschriftung",      "ru": "Нижняя подпись"},
            "title_bottom_color" : {"en": "Bottom title color",  "de": "Untere Beschriftungsfarbe","ru": "Цвет нижней подписи"},
            "title_bottom_font"  : {"en": "Bottom title font",   "de": "Unterer Beschriftungfont", "ru": "Шрифт нижней подписи"},
            "title_bottom_size"  : {"en": "Bottom title size",   "de": "Untere Beschriftungsgröße","ru": "Размер верхней подписи"},
            "title_bottom_pos"   : {"en": "Bottom title position","de": "Untere Beschriftungs- Position","ru": "Положение нижней подписи"},
            "labels_centered"    : {"en": "Centered labels",     "de": "Labels zentriert",         "ru": "Подписи шкалы ближе к границе"},
            "labels_offset"      : {"en": "Labels offset",       "de": "Offsetlables",             "ru": "Сдвиг подписей шкалы"},
            "red_start"          : {"en": "End of third sector", "de": "Ende von dritten Sektor",  "ru": "Конец третьего сектора"},
            "red_color"          : {"en": "Color of third sector", "de": "Farbe von dritten Sektor","ru": "Цвет третьего сектора"},
            "yellow_color"       : {"en": "Color of second sector","de": "Farbe von zweten Sektor","ru": "Цвет второго сектора"},
            "green_color"        : {"en": "Color of first sector", "de": "Farbe von ersten Sektor","ru": "Цвет первого сектора"},
            "green_end"          : {"en": "End of first sector",   "de": "Ende von ersten Sektor", "ru": "Конец первого сектора"},
            "padding_left"       : {"en": "Padding left",        "de": "Abstand links",            "ru": "Отступ слева"},
            "padding_right"      : {"en": "Padding right",        "de": "Abstand rechts",          "ru": "Отступ справа"},
            "animate_tooltip"    : {"en": "Slow changes of value", "de": "Langsame Wertänderung",  "ru": "Анимированное изменение значения"},
            "Arial"              : {"en": "Arial",               "de": "Arial",                    "ru": "Arial"},
            "Times"              : {"en": "Times",               "de": "Times",                    "ru": "Times"},
            "Andale Mono"        : {"en": "Andale Mono",         "de": "Andale Mono",              "ru": "Andale Mono"},
            "Comic Sans"         : {"en": "Comic Sans",          "de": "Comic Sans",               "ru": "Comic Sans"},
            "Impact"             : {"en": "Impact",              "de": "Impact",                   "ru": "Impact"},
            "group_scale"        : {"en": "Scale",               "de": "Skala",                    "ru": "Шкала"},
            "group_title"        : {"en": "Title",               "de": "Beschriftung",             "ru": "Подпись"},
            "group_advanced"     : {"en": "Advanced",            "de": "Erweitert",                "ru": "Дополнительно"},
            "group_background"   : {"en": "Background",          "de": "Hintergrund",              "ru": "Фон"},
            "group_labels"       : {"en": "Labels",              "de": "Aufschrift",               "ru": "Надписи"},
            "group_sectors"      : {"en": "Sectors",             "de": "Sektoren",                 "ru": "Сектора"},
            "line_color"         : {"en": "Line color",          "de": "Liniefarbe",               "ru": "Цвет линии"},
            "line_thick"         : {"en": "Line thickness",      "de": "Linienbreite",             "ru": "Толщина линии"},
            "update_interval"    : {"en": "Update interval(ms)", "de": "Aktualisierungs- Intervall(ms)", "ru": "Обновление(мс)"},
            "update_interval_tooltip": {"en": "How offten the new point will be painted on graphics.\x0AMake it smaller to see the changes.", "de": "Wie oft wird neuen Punkt gemalt.\x0AMach es kleiner um die Änderungen zu sehen.", "ru": "Как часто рисуется новая точка на графике\x0AНапиши маленькое значение, что бы понять, как работает график."},
            "points_count"       : {"en": "Points number on X",  "de": "Punktenanzahl über X",     "ru": "Количество точек в графике по X"},
            "title_x"            : {"en": "Title for x axis",    "de": "Beschriftung X-Achse",     "ru": "Подпись шкалы X"},
            "title_y"            : {"en": "Title for y axis",    "de": "Beschriftung Y-Achse",     "ru": "Подпись шкалы Y"},
            "num_hlines"         : {"en": "Horizontal lines number", "de": "Anzahl von horizontalen Linien", "ru": "Кол-во горизонтальных линий"},
            "spline"             : {"en": "Spline smoothing",    "de": "Splineglättung",           "ru": "Сглаживание сплайном"},
            "filled"             : {"en": "Filled graphics",     "de": "Gefüllte Grafik",          "ru": "Закрашеный график"},
            "group_oid_show"     : {"en": "Show lines depends on", "de": "Zeige Linien abhängig von", "ru": "Показать линии в зависимости от"},
            "oid_show"           : {"en": "Show line depends on", "de": "Zeige Linie abhängig von", "ru": "Показать линию в зависимости от"},
            "triangle"           : {"en": "Triangle form",       "de": "Dreieckform",              "ru": "Треугольной формы"},
            "line"               : {"en": "Line",                "de": "Linie",                    "ru": "Линия"},
            "group_settings"     : {"en": "Settings",            "de": "Einstellungen",            "ru": "Настройки"},
            "filled_color"       : {"en": "Color of the bar's bottom",  "de": "Barfarbe unten",    "ru": "Цвет графика снизу"},
            "empty_color"        : {"en": "Color of the bar top", "de": "Barfarbe oben",           "ru": "Цвет графика сверху"},
            "label_color"        : {"en": "Labels color",        "de": "Beschriftungs- Farbe",     "ru": "Цвет подписей"},
            "legend"             : {"en": "Show legend",         "de": "Zeige Legende",            "ru": "Показать легенду"},
            "filled_text"        : {"en": "Legend for filled value", "de": "Legende für den Wert", "ru": "Легенда для значения"},
            "empty_text"         : {"en": "Legend for non-filled value",  "de": "Legende für den Gegenwert",               "ru": "Легенда для пустого значения"},
            "labels_above"       : {"en": "Show max value at top",  "de": "Zeige maximales Wert oben", "ru": "Показать максимальное значение"},
            "label_size"         : {"en": "Label's size",        "de": "Beschriftungs- größe",     "ru": "Размер подписей"},
            "labels_above_angle" : {"en": "Max value at top with angle", "de": "Zeige maximales Wert oben diagonal", "ru": "Максимальное значение под углом"},
            "decimals"           : {"en": "Digits after comma",  "de": "Nach Kommazahlen",         "ru": "Чисел после запятой"},
            "gutter_left"        : {"en": "Gutter left",         "de": "Abstand links",            "ru": "Отступ слева"},
            "horz_margin"        : {"en": "Horizontal margin",   "de": "Horizontaler Abstand",     "ru": "Горизонтальный отступ"},
            "bar_labels_color"   : {"en": "Bar value's color",   "de": "Bar-Wert-Farbe",           "ru": "Цвет значения"},
            "bar_labels_bold"    : {"en": "Bar value's bold font", "de": "Bar-Wert-Dick",          "ru": "Жирный шрифт значения"},
            "bar_labels_center"  : {"en": "Show value in middle",  "de": "Zeige Wert in der Mitte", "ru": "Показать значение в центре"},
            "group_colors"       : {"en": "Colors",              "de": "Farben",                   "ru": "Цвета"},
            "group_max_values"   : {"en": "Max values",          "de": "Maximale Werte",           "ru": "Максимальные значения"}
        });
    }    

    //jQuery.extend(true, vis.binds, {
    vis.binds.rgraph = {
	    version: "0.0.2",
		showVersion: function () {
			if (vis.binds.rgraph.version) {
				console.log('Version vis-rgraph:' + vis.binds.rgraph.version);
				vis.binds.rgraph.version = null;
			}
		},
        // Register callback in dashUI
        init: function  () {
			vis.binds.rgraph.showVersion();
            if (!vis.binds.rgraph.regElements) {
                vis.binds.rgraph.regElements = [];
                vis.registerOnChange(vis.binds.rgraph.onchange, null);
            }
        },

        // Callback from DashUI if some object changed
        onchange: function (arg, objId, newState, isFromDevice, lastchange) {
            if (vis.binds.rgraph.regElements[objId]) {
                for (var i = 0, len = vis.binds.rgraph.regElements[objId].length; i < len; i++) {
                    var elem = document.getElementById(vis.binds.rgraph.regElements[objId][i]);
                    if (elem && elem.rgraphValueChange) {
                        elem.rgraphValueChange(objId, newState, isFromDevice);
                    }
                }
            }
        },

        registerIds: function (wid, objId) {
            if (typeof objId == "object" || typeof objId == "array") {
                for (var i = 0, len = objId.length; i < len; i++)
                    if (objId[i] && (!vis.binds.rgraph.regElements[objId[i]] || vis.binds.rgraph.regElements[objId[i]].indexOf (wid) == -1)) {
                        if (!vis.binds.rgraph.regElements[objId[i]]) {
                            vis.binds.rgraph.regElements[objId[i]] = [wid];
                        }
                        else {
                            vis.binds.rgraph.regElements[objId[i]].push (wid);
                        }
                    }
            }
            else
            if (!vis.binds.rgraph.regElements[objId] || vis.binds.rgraph.regElements[objId].indexOf (wid) == -1) {
                if (!vis.binds.rgraph.regElements[objId]) {
                    vis.binds.rgraph.regElements[objId] = [wid];
                }
                else {
                    vis.binds.rgraph.regElements[objId].push (wid);
                }
            }
        },

        // Create or replace div with canvas inside it
        createCanvas: function (view, wid, _class, oid, width, height, canvas_width, canvas_height) {
            vis.binds.rgraph.init();
            vis.binds.rgraph.registerIds(wid, oid);

            var style    = vis.views[view].widgets[wid] ? vis.views[view].widgets[wid].style || {} : {};
            style.width  = parseInt(style.width)  || parseInt(width);
            style.height = parseInt(style.height) || parseInt(height);

            //$('#'+wid).remove ();
            var $wid = $('#' + wid);
            if (!$wid.length) {
                $('#visview_' + view).append('<div class="vis-widget ' + (_class || "") + '" id="' + wid + '" data-oid="' + oid + '" >' +
                        '<canvas class="vis-widget" id="c' + wid + '"></canvas></div>');
                $wid = $('#' + wid);
            } else {
                $wid.addClass(_class || '');
            }
            $wid.css(style);

            // Canvas understand no Style, so set width and height extra
            var can = document.getElementById('c' + wid);
            canvas_width  = parseInt(canvas_width)  || style.width;
            canvas_height = parseInt(canvas_height) || style.height;
            can.width  = canvas_width;
            can.height = canvas_height;
        },

        updateChart: function (wid) {
            var div = document.getElementById(wid);
            var can = document.getElementById('c' + wid);

            if (div && can) {
                if (div._timeout) clearTimeout(div._timeout);

                var updateInterval = div.rgraph.Get('update_interval');
                var values = div.rgraph.Get('my_values');
                var len = div.rgraph.original_data.length;
                if (!values) {
                    len = 0;
                } else if (len > values.length) {
                    len = values.length;
                }
                for (var j = 0; j < len; j++) {
                    var d1 = div.rgraph.original_data[j];

                    d1.push(values[j]);
                    div.rgraph.original_data[j] = RGraph.array_shift(d1);
                }

                RGraph.Clear(can);
                div.rgraph.Draw();
                div._timeout = _setTimeout (vis.binds.rgraph.updateChart, updateInterval, wid);
            }
        },

        updateBar: function (wid) {
            var div = document.getElementById(wid);
            var can = document.getElementById('c' + wid);

            if (div && can) {
                if (div._timeout) clearTimeout(div._timeout);

                var options = div.rgraph.Get("my_options");
                var values  = div.rgraph.Get("my_values");

                div.rgraph.data = values;
                div.rgraph.data_arr = RGraph.array_linearize(values);

                RGraph.Clear (can);
                div.rgraph.Draw();

                if (options.update_interval) {
                    div._timeout = _setTimeout(vis.binds.rgraph.updateBar, options.update_interval, wid);
                }
            }
        },

        tplRGtermometer: function (view, data) {
            vis.binds.rgraph.createCanvas(view, data.attr('wid'), data.attr('class'), data.attr('oid'), 100, 400);

            var str = vis.states.attr(data.attr('oid') + '.val');
            if (str === null || str === undefined) str = data.attr('min_value');
            
            var t = new RGraph.Thermometer('c' + data.attr('wid'), parseFloat(data.attr('min_value')), parseFloat(data.attr('max_value')), parseFloat(str));
            if (data.attr('color')) {
                var color = data.attr('color');
                t.colorsParsed = false;
                var isValid = false;
                try {
                    t.parseSingleColorForGradient(color);
                    isValid = true;
                } catch(e)
                {

                }
                if (isValid) {
                    t.properties['chart.colors'] = ["Gradient(" + color + ")"];
                }
            }

            if (data.attr("show_scale")) {
                t.Set('scale.visible', true);
            }
            if (data.attr("show_shadow") !== "" && data.attr("show_shadow") !== null && data.attr("show_shadow") !== undefined) {
                t.Set('shadow', (data.attr("show_shadow") == "true" || data.attr("show_shadow") == true));
            }
            if (data.attr("control") !== "" && data.attr("control") !== null && data.attr("control") !== undefined) {
                t.Set('adjustable', (data.attr("control") == "true" || data.attr("control") == true));
                t.Set ("oid", data.attr('oid'));
                if (!vis.editMode) {
                    RGraph.AddCustomEventListener (t, "onadjust", function (obj) {
                        if (obj.setTimer) {
                            clearTimeout (obj.setTimer);
                        }
                        obj.setTimer = _setTimeout (function (o) {
                            localData.setValue(o.properties["chart.oid"], o.value);
                        }, 300, obj);
                    });
                }
            }
            if (data.attr("labels_color") !== "") {
                var isValid = false;
                try {
                    t.parseSingleColorForGradient(data.attr("labels_color"));
                    isValid = true;
                } catch(e)
                {

                }
                if (isValid) t.Set('text.color', data.attr("labels_color"));
            }
            if (data.attr("labels_font") !== "") {
                t.Set('text.font', data.attr("labels_font"));
            }
            if (data.attr("labels_size") !== "") {
                var f = parseFloat (data.attr("labels_size"));
                t.Set('text.size', f);
            }
            if (data.attr("title") !== "") {
                t.Set('title', data.attr("title"));
            }
            if (data.attr("title_side") !== "") {
                t.Set('title.side', data.attr("title_side"));
            }
            if (data.attr("title_side_font") !== "") {
                t.Set('title.side.font', data.attr("title_side_font"));
            }
            if (data.attr("title_side_size") !== "") {
                var f = parseFloat (data.attr("title_side_size"));
                t.Set('title.side.size', f);
            }
            if (data.attr("ticksize") !== "") {
                var f = parseFloat (data.attr("ticksize"));
                t.Set('ticksize', f);
            }
            if (data.attr("units_pre") !== "") {
                t.Set('units.pre', data.attr("units_pre"));
            }
            if (data.attr("units_post") !== "") {
                t.Set('units.post', data.attr("units_post"));
            }
            if (data.attr("scale_decimals") !== "") {
                var f = parseFloat (data.attr("scale_decimals"));
                t.Set('scale.decimals', f);
            }

            if (data.attr("show_value") !== "" && data.attr("show_value") !== null && data.attr("show_value") !== undefined) {
                t.Set('value.label', (data.attr("show_value") == "true" || data.attr("show_value") == true));
            }
            if (data.attr("value_decimals") !== "") {
                var f = parseFloat (data.attr("value_decimals"));
                t.Set('value.label.decimals', f);
            }
            if (data.attr("labels_count") !== "" && data.attr("labels_count") !== null && data.attr("labels_count") !== undefined) {
                var f = parseFloat (data.attr("labels_count"));
                t.Set('labels.count', f);
            }
            if (vis.language == 'de' || vis.language == 'ru' ) {
                t.Set('scale.point', ',');
                t.Set('scale.thousand', '.');
                t.Set('value.label.point', ',');
                t.Set('value.label.thousand', '.');
            }
            if (data.attr("padding_left") !== "" && data.attr("padding_left") !== null && data.attr("padding_left") !== undefined) {
                t.Set('gutter.left', parseFloat (data.attr("padding_left")));
            }
            if (data.attr("padding_right") !== "" && data.attr("padding_right") !== null && data.attr("padding_right") !== undefined) {
                t.Set('gutter.right', parseFloat (data.attr("padding_right")));
            }
            if (data.attr("padding_top") !== "" && data.attr("padding_top") !== null && data.attr("padding_top") !== undefined) {
                t.Set('gutter.top', parseFloat (data.attr("padding_top")));
            }
            if (data.attr("padding_bottom") !== "" && data.attr("padding_bottom") !== null && data.attr("padding_bottom") !== undefined) {
                t.Set('gutter.bottom', parseFloat (data.attr("padding_bottom")));
            }

            // Clear the background
            RGraph.Clear (t.canvas);
            //t.canvas.getContext('2d').clearRect (0, 0, t.canvas.width, t.canvas.height);

            try {
                t.Draw();
            } catch (e) {
                servConn.logError("Cannot render tplRGtermometer: " + e);
            }
            var elem = document.getElementById(data.attr('wid'));
            elem.rgraph = t;
            t.Set('animate', data.attr("animate") == "true" || data.attr("animate") == true)
            $('#' + data.attr('wid')).bind("resize", function () {
                var div = $(this);
                var can = document.getElementById('c' + div.attr('id'));

                can.width  = div.width();
                can.height = div.height();

                if (can.width == 0 || can.height == 0) {
                    // My be jQuery bug
                    can.width  = parseInt(div[0].style.width);
                    can.height = parseInt(div[0].style.height);
                }

                RGraph.Clear (can);
                //this.rgraph.canvas.getContext('2d').clearRect (0, 0, this.rgraph.canvas.width, this.rgraph.canvas.height);

                try {
                    this.rgraph.Draw();
                } catch (e) {
                    servConn.logError("Cannot render tplRGtermometer: " + e);
                }
            });

            elem.rgraphValueChange = function (objId, newValue, isFromDevice) {
                this.rgraph.value = parseFloat(newValue);
                // Clear the background
                RGraph.Clear(this.rgraph.canvas);
                //this.rgraph.canvas.getContext('2d').clearRect (0, 0, this.rgraph.canvas.width, this.rgraph.canvas.height);
                if (this.rgraph.Get("animate")) {
                    RGraph.Effects.Thermometer.Grow(this.rgraph);
                } else {
                    try {
                        this.rgraph.Draw();
                    } catch (e) {
                        servConn.logError("Cannot render tplRGtermometer: " + e);
                    }
                }
            }
        },
        tplRLiveChart: function (view, data) {
            var wid = data.attr('wid');
            var elem_ = document.getElementById(wid);
            var oldIDs = null;
            var oldValues = null;
            if (elem_) {
                if (elem_._timeout) {
                    clearTimeout (elem_._timeout);
                    elem_._timeout = null;
                }
                // save data
                if (elem.rgraph) {
                    oldIDs    = elem.rgraph.Get("oids");
                    oldValues = RGraph.array_clone(elem.rgraph.original_data);
                }
            }

            var pointsCount = parseInt(data.attr('points_count')) || 250;
            var len       = 1;
            var IDs       = [];
            var IDs_show  = [];
            var colors    = [];
            var thickness = [];
            var id;
            var validColor = 'black';
            var validThickness = 1;
            // Read IDs, colors and line thickness
            while (id = data.attr('oid' + len)) {
                IDs.push(id);
                // If ID changed
                if (oldIDs && IDs[IDs.length - 1] != oldIDs[IDs.length - 1]){
                    oldValues = null;
                    oldIDs    = null;
                }
                IDs_show[IDs.length - 1] = data.attr('oid_show' + len);
                id = data.attr('line_color' + len);
                if (id) {
                    validColor = id;
                }
                var isValid = false;
                try {
                    //t.parseSingleColorForGradient(id);
                    isValid = true;
                } catch(e)
                {

                }
                if (isValid) {
                    colors.push (validColor);
                } else {
                    colors.push ('black');
                }

                id = data.attr('line_thick' + len);
                if (id) validThickness = id;

                thickness.push(validThickness);

                len++;
            }

            vis.binds.rgraph.createCanvas(view, wid, data.attr('class'), IDs, 200, 200);
            vis.binds.rgraph.registerIds(wid, IDs_show);

            var factor = data.attr('factor') || 1;
            factor = parseFloat(factor);

            var offset = data.attr('value_offset') || 0;
            offset = parseFloat(offset);

            var min_value = data.attr('min_value') || 0;
            min_value = parseFloat(min_value);

            var max_value = data.attr('max_value') || 0;
            max_value = parseFloat(max_value);

            var values = [];
            for (var i = 0, len = IDs.length; i < len; i++) {
                values[i] = vis.states.attr(IDs[i] + '.val');
                if (values[i] === null || values[i] === undefined) {
                    values[i] = min_value;
                }
                values[i] = parseFloat (values[i]);
                values[i] = values[i] * factor + offset;
            }

            var elem = document.getElementById(wid);
            var can  = document.getElementById('c'+wid);

            var arr = [];

            if (!oldValues) {
                // Pre-pad the arrays with "pointsCount" null values
                for (var i = 0, len = IDs.length; i < len; i++) {
                    arr[i] = [];
                    for (var j = 0, jlen = pointsCount - 1; j < jlen; j++) {
                        arr[i].push(null);
                    }
                    arr[i].push(values[i]);
                }
            }
            else {
                for (var i = 0, len = IDs.length; i < len; i++) {
                    arr[i] = RGraph.array_shift(oldValues[i]);
                    arr[i].push(values[i]);
                }
            }

            var update_interval = data.attr('update_interval') || 1000;
            update_interval = parseInt(update_interval);

            var t = new RGraph.Line ("c"+wid, arr);

            t.Set ("oids",      IDs);
            t.Set ("hm_show_ids", IDs_show);
            t.Set ("my_values", values);
            t.Set ("update_interval", update_interval);
            t.Set ("factor", factor);
            t.Set ("value_offset", offset);

            t.Set('background.grid.vlines', false);
            t.Set('background.barcolor1', 'white');
            t.Set('background.barcolor2', 'white');

            var text = data.attr('title');
            if (text) {
                t.Set('title', text);
                t.Set('title.vpos', 0.5);
            }
            text = data.attr('title_x');
            if (text) {
                t.Set('title.xaxis', text);
                t.Set('title.xaxis.pos', 0.5);
            }
            text = data.attr('title_y');
            if (text) {
                t.Set('title.yaxis', text);
                t.Set('title.yaxis.pos', 0.5);
            }

            var my_colors = RGraph.array_clone(colors);
            t.Set('my_colors', my_colors);
            // Set visibility of charts
            for (var i = 0, len = IDs_show.length; i < len; i++){
                if (IDs_show[i]) {
                    var isVisible = vis.states.attr(IDs_show[i] + '.val');
                    if (isVisible == "false" || isVisible === false) {
                        colors[i] = 'rgba(0,0,0,0)';
                    }
                }
            }
            t.Set('colors', colors);
            t.Set('linewidth', thickness);
            //obj.Set('ylabels.inside', true);
            t.Set('xticks', 0);
            t.Set('yaxispos', 'right');
            t.Set('ymin', min_value);
            t.Set('ymax', max_value);

            text = data.attr('filled');
            if (text) {
                t.Set('filled', (text == 'true' || text === true));
            }
            else {
                t.Set('filled', false);
            }

            text = data.attr('spline');
            if (text) {
                t.Set('spline', (text == 'true' || text === true));
            }
            else {
                t.Set('spline', false);
            }

            text = data.attr('num_hlines');
            if (text) {
                t.Set('background.grid.autofit.numhlines', parseInt(text));
            }

            var grad = t.context.createLinearGradient(0,0,0,250);
            grad.addColorStop(0, '#efefef');
            grad.addColorStop(0.9, 'rgba(0,0,0,0)');

            t.Set('fillstyle', [grad]);

            RGraph.Clear(t.canvas);

            try {
                t.Draw();
            } catch (e) {
                servConn.logError("Cannot render tplRLiveChart: " + e);
            }

            elem.rgraph = t;
            $(elem).bind("resize", function () {
                if (this._resizeTimer){
                    clearTimeout (this._resizeTimer);
                }
                this._resizeTimer = _setTimeout (function (_wid) {
                    var _div = document.getElementById(_wid);
                    var div  = $(_div);
                    var can  = document.getElementById('c' + _wid);

                    can.width  = div.width();
                    can.height = div.height ();

                    if (can.width == 0 || can.height == 0) {
                        // My be jQuery bug
                        can.width = parseInt(_div.style.width);
                        can.height = parseInt(_div.style.height);
                    }


                    RGraph.Clear (can);
                    try {
                        _div.rgraph.Draw();
                    } catch (e) {
                        servConn.logError("Cannot render tplRLiveChart: " + e);
                    }
                }, 500, this.id);
            });

            elem.rgraphValueChange = function (objId, newValue, isFromDevice) {
                var IDs      = this.rgraph.Get("oids");
                var IDs_show = this.rgraph.Get("hm_show_ids");

                for (var i = 0, len = IDs.length; i < len; i++){
                    if (IDs[i] == objId) {
                        var values = this.rgraph.Get("my_values");
                        var factor = this.rgraph.Get("factor");
                        var offset = this.rgraph.Get("value_offset");

                        values[i] = vis.states.attr(IDs[i] + '.val');
                        if (values[i] === null || values[i] === undefined) {
                            values[i] = this.rgraph.min;
                        }
                        values[i] = parseFloat(values[i]);
                        values[i] = values[i] * factor + offset

                        return;
                    }
                }
                for (var i = 0, len = IDs_show.length; i < len; i++){
                    if (IDs_show[i] && IDs_show[i] == objId) {
                        var colors    = this.rgraph.Get("colors");
                        var my_colors = this.rgraph.Get("my_colors");
                        var isVisible = vis.states.attr(IDs_show[i] + '.val');
                        if (isVisible == "false" || isVisible === false) {
                            colors[i] = 'rgba(0,0,0,0)';
                        }
                        else {
                            colors[i] = my_colors[i];
                        }
                        this.rgraph.Set("colors", colors);
                        var updateInterval = this.rgraph.Get("update_interval");
                        this._timeout = _setTimeout (vis.binds.rgraph.updateChart, 100, this.id);
                        return;
                    }
                }
            }

            if (update_interval) {
                elem._timeout = _setTimeout (vis.binds.rgraph.updateChart, update_interval, wid);
            }
        },
        tplRGgauge: function (view, data) {
            vis.binds.rgraph.createCanvas (view, data.attr('wid'), data.attr('class'), [data.attr('oid'), data.attr('oid_2'), data.attr('oid_3')], 200, 200);

            var str = vis.states.attr(data.attr('oid') + '.val');
            if (str === null || str === undefined) {
                str = data.attr("min_value");
            }

            var str2 = data.attr('oid_2') ? vis.states.attr(data.attr('oid_2') + '.val') : null;
            
            if (str2 === undefined) str2 = data.attr("min_value");

            var str3 = data.attr('oid_3') ? vis.states.attr(data.attr('oid_3') + '.val') : null;
            
            if (str3 === undefined) str3 = data.attr("min_value");

            var values = [parseFloat(str) || 0];
            if (str2 !== null) {
                values[1] = str2 || 0;
                if (str3 !== null) values[2] = str3 || 0;
            }
            var factor = data.attr("factor") || 1;
            factor = parseFloat(factor);

            var offset = data.attr("value_offset") || 0;
            offset = parseFloat(offset);

            values[0] = values[0] * factor + offset;

            var max_value = data.attr("max_value_oid") ? vis.states.attr(data.attr('max_value_oid') + '.val') : data.attr('max_value');

            var t = new RGraph.Gauge("c" + data.attr('wid'), parseFloat(data.attr("min_value")), parseFloat(max_value), values);
            t.Set("oid",   data.attr('oid'));
            t.Set("oid_2", data.attr('oid_2'));
            t.Set("oid_3", data.attr('oid_3'));
            t.Set("factor", factor);
            t.Set("value_offset", offset);

            if (data.attr("control") !== "" && data.attr("control") !== null && data.attr("control") !== undefined) {
                if ((data.attr("control") == "true" || data.attr("control") == true)) {
                    t.Set('adjustable', true);

                    RGraph.AddCustomEventListener (t, "onadjust", function (obj) {
                        var oid_2 = obj.Get("oid_2");
                        var oid_3 = obj.Get("oid_3");

                        var values = [obj.value];
                        var str2 = oid_2 ? vis.states.attr(oid_2 + '.val') : null;
                        if (str2 === undefined) str2 = obj.min;

                        var str3 = oid_3 ? vis.states.attr(oid_3 + '.val') : null;
                        if (str3 === undefined) str3 = obj.min;

                        if (str2 !== null) {
                            values[1] = str2 || 0;
                            if (values[1] > obj.max) values[1] = obj.max;

                            if (str3 !== null) {
                                values[2] = str3 || 0;
                                if (values[2] > obj.max) values[2] = obj.max;
                            }
                        }
                        values[0] = values[0] * factor + offset;
                        obj.value = values;
                        obj.Draw ();

                        if (!vis.editMode) {
                            if (obj.setTimer) {
                                clearTimeout (obj.setTimer);
                            }
                            obj.setTimer = _setTimeout (function (o) {
                                var factor  = o.Get("factor");
                                var offset  = o.Get("value_offset");
                                localData.setValue(o.Get("oid"), (o.value[0] - offset) / factor);
                            }, 300, obj);
                        }
                    });
                }
            }

            if (data.attr("a_start") !== "" && data.attr("a_start") !== null && data.attr("a_start") !== undefined) {
                var f = parseFloat(data.attr("a_start"));
                f = f * Math.PI / 180;
                t.Set('angles.start', f);
            }
            if (data.attr("a_end") !== "" && data.attr("a_end") !== null && data.attr("a_end") !== undefined) {
                var f = parseFloat(data.attr("a_end"));
                f = f * Math.PI / 180;
                t.Set('angles.end', f);
            }
            if (data.attr("show_shadow")) {
                t.Set('shadow', true);
            }
            if (data.attr("value_text")) {
                t.Set('value.text', true);
            }
            if (data.attr("value_text_pos") !== null && data.attr("value_text_pos") !== undefined && data.attr("value_text_pos") !== "") {
                var f = parseFloat (data.attr("value_text_pos"));
                t.Set('value.text.y.pos', f);
            }
            if (data.attr("value_units_pre")) {
                t.Set('value.text.units.pre', data.attr("value_units_pre"));
            }
            if (data.attr("value_units_post")) {
                t.Set('value.text.units.post', data.attr("value_units_post"));
            }
            if (data.attr("ticks_big_color")) {
                t.Set('tickmarks.big.color', data.attr("ticks_big_color"));
            }
            if (data.attr("ticks_mid_color")) {
                t.Set('tickmarks.medium.color', data.attr("ticks_mid_color"));
            }
            if (data.attr("ticks_small_color")) {
                t.Set('tickmarks.small.color', data.attr("ticks_small_color"));
            }
            if (data.attr("border_outer_color")) {
                t.Set('border.outer', data.attr("border_outer_color"));
            }
            if (data.attr("border_inner_color")) {
                t.Set('border.inner', data.attr("border_inner_color"));
            }
            if (data.attr("color_ranges")) {
                var colors = data.attr("color_ranges").split(":");
                t.Set('colors.ranges', colors);
            }
            if (data.attr("back_color")) {
                t.Set('background.color', data.attr("back_color"));
            }
            if (data.attr("needle_colors")) {
                var colors = data.attr("needle_colors").split(":");
                t.Set('needle.colors', colors);
            }
            if (data.attr("border_outline_color")) {
                t.Set('border.outline', data.attr("border_outline_color"));
            }
            if (data.attr("needle_type")) {
                t.Set('needle.type', data.attr("needle_type"));
            }
            if (data.attr("needle_tail")) {
                t.Set('needle.tail', data.attr("needle_tail"));
            }
            if (data.attr("needle_size")) {
                var f = parseFloat (data.attr("needle_size"));
                t.Set('needle.size', f);
            }
            if (data.attr("centerpin_radius")) {
                var f = parseFloat (data.attr("centerpin_radius"));
                t.Set('centerpin.radius', f);
            }
            if (data.attr("centerpin_color")) {
                t.Set('centerpin.color', data.attr("centerpin_color"));
            }
            if (data.attr("title")) {
                t.Set('title.top', data.attr("title"));
            }
            if (data.attr("title_color")) {
                t.Set('title.top.color', data.attr("title_color"));
            }
            if (data.attr("title_size")) {
                var f = parseFloat (data.attr("title_size"));
                t.Set('title.top.size', f);
            }
            if (data.attr("title_font")) {
                t.Set('title.top.font', data.attr("title_font"));
            }
            if (data.attr("title_pos") !== null && data.attr("title_pos") !== undefined && data.attr("title_pos") !== "") {
                var f = parseFloat (data.attr("title_pos"));
                t.Set('title.top.pos', f);
            }
            if (data.attr("title_bottom")) {
                t.Set('title.bottom', data.attr("title_bottom"));
            }
            if (data.attr("title_bottom_color")) {
                t.Set('title.bottom.color', data.attr("title_bottom_color"));
            }
            if (data.attr("title_bottom_size")) {
                var f = parseFloat (data.attr("title_bottom_size"));
                t.Set('title.bottom.size', f);
            }
            if (data.attr("title_bottom_font")) {
                t.Set('title.bottom.font', data.attr("title_bottom_font"));
            }
            if (data.attr("title_bottom_pos") !== null && data.attr("title_bottom_pos") !== undefined && data.attr("title_bottom_pos") !== "") {
                var f = parseFloat (data.attr("title_bottom_pos"));
                t.Set('title.bottom.pos', f);
            }
            if (data.attr("labels_centered")) {
                t.Set('labels.centered', data.attr("labels_centered"));
            }
            if (data.attr("labels_offset") !== "" && data.attr("labels_offset") !== null && data.attr("labels_offset") !== undefined) {
                var f = parseFloat (data.attr("labels_offset"));
                t.Set('labels.offset', f);
            }
            if (data.attr("labels_color") !== "") {
                t.Set('text.color', data.attr("labels_color"));
            }
            if (data.attr("labels_font") !== "") {
                t.Set('text.font', data.attr("labels_font"));
            }
            if (data.attr("labels_size") !== "") {
                var f = parseFloat (data.attr("labels_size"));
                t.Set('text.size', f);
            }
            if (data.attr("background_gradient")) {
                t.Set('background.gradient', true);
            }
            if (data.attr("red_color") !== "") {
                t.Set('red.color', data.attr("red_color"));
            }
            if (data.attr("red_start") !== "") {
                var f = parseFloat (data.attr("red_start"));
                f = f * parseFloat(data.attr("max_value"));
                t.Set('red.start', f);
            }
            if (data.attr("yellow_color") !== "") {
                t.Set('yellow.color', data.attr("yellow_color"));
            }
            if (data.attr("green_color") !== "") {
                t.Set('green.color', data.attr("green_color"));
            }
            if (data.attr("green_end") !== "") {
                var f = parseFloat (data.attr("green_end"));
                f = f * parseFloat(data.attr("max_value"));
                t.Set('green.end', f);
            }

            // Clear the background
            RGraph.Clear(t.canvas);
            //t.canvas.getContext('2d').clearRect (0, 0, t.canvas.width, t.canvas.height);

            try {
                t.Draw();
            } catch (e) {
                servConn.logError("Cannot render tplRGgauge: " + e);
            }
            t.Set('animate', data.attr("animate") == "true" || data.attr("animate") == true)
            var elem = document.getElementById(data.attr('wid'));
            elem.rgraph = t;
            $('#' + data.attr('wid')).bind("resize", function () {
                var div = $(this);
                var can = document.getElementById('c' + div.attr('id'));

                can.width  = div.width();
                can.height = div.height ();

                if (can.width == 0 || can.height == 0) {
                    // My be jQuery bug
                    can.width = parseInt(div[0].style.width);
                    can.height = parseInt(div[0].style.height);
                }

                RGraph.Clear (can);
                //this.rgraph.canvas.getContext('2d').clearRect (0, 0, this.rgraph.canvas.width, this.rgraph.canvas.height);

                try {
                    this.rgraph.Draw();
                } catch (e) {
                    servConn.logError("Cannot render tplRGgauge: " + e);
                }
            });

            elem.rgraphValueChange = function (objId, newValue, isFromDevice) {
                var oid_2 = this.rgraph.Get("oid_2");
                var oid_3 = this.rgraph.Get("oid_3");
                var factor  = this.rgraph.Get("factor");
                var offset  = this.rgraph.Get("value_offset");

                var str = vis.states.attr(this.rgraph.Get('oid') + '.val');
                if (str === null || str === undefined) str = this.rgraph.min;

                var str2 = oid_2 ? vis.states.attr(oid_2 + '.val') : null;
                if (str2 === undefined) str2 = this.rgraph.min;

                var str3 = oid_3 ? vis.states.attr(oid_3 + '.val') : null;
                if (str3 === undefined) str3 = this.rgraph.min;

                var values = [parseFloat(str) || 0];
                if (str2 !== null) {
                    values[1] = str2 || 0;

                    if (str3 !== null) {
                        values[2] = str3 || 0;
                    }
                }
                values[0] = values[0] * factor + offset;

                this.rgraph.value = values;
                // Clear the background
                RGraph.Clear(this.rgraph.canvas);
                //this.rgraph.canvas.getContext('2d').clearRect (0, 0, this.rgraph.canvas.width, this.rgraph.canvas.height);

                if (this.rgraph.Get("animate")) {
                    RGraph.Effects.Gauge.Grow(this.rgraph);
                }
                else {
                    try {
                        this.rgraph.Draw();
                    } catch (e) {
                        servConn.logError("Cannot render tplRGgauge: " + e);
                    }
                }
            }
        },
        tplRBarChart: function (view, data) {
            var wid = data.attr('wid');

            var factor = data.attr('factor') || 1;
            factor = parseFloat(factor);

            var offset = data.attr('value_offset') || 0;
            offset = parseFloat(offset);

            var len = 1;
            var IDs = [];
            var id;
            var values = [];
            var names  = [];
            var max_values = [];
            var valid_max = null;

            // Read IDs and max values
            while (id = data.attr('oid' + len)) {
                IDs.push(id);

                id = data.attr('name' + len);
                names.push (id || "");

                id = data.attr('max_value' + len);
                if (id || valid_max) {
                    max_values.push(parseInt(id, 10));
                    valid_max = id;
                }

                len++;
            }

            if (!valid_max) {
                max_values = null;
            } else {
                for (var i = max_values.length, len = IDs.length; i < len; i++) {
                    max_values.push(valid_max);
                }
            }

            var values = [];
            for (var i = 0, len = IDs.length; i < len; i++) {
                values[i] = [];
                var val = vis.states.attr(IDs[i] + '.val');
                if (val === null || val === undefined) {
                    val = data.attr("min_value");
                }
                val = parseFloat (val);
                val = val * factor + offset;
                
                if (val < 0) val = 0;

                if (max_values) {
                    values[i][0] = max_values[i] - val;
                    if (values[i][0] < 0) {
                        values[i][0] = 0;
                    }
                    values[i][1] = val;
                } else {
                    values[i][0] = val;
                }
            }

            var options = {
                IDs:          IDs,
                names:        names,
                labels_above_angle:  data.attr('labels_above_angle'),
                filled_color: data.attr('filled_color'),
                empty_color:  data.attr('empty_color'),
                factor:       factor,
                offset:       offset,
                title:        data.attr('title')   || "",
                update_interval: parseInt (data.attr('update_interval')) || 0,
                max_values:   max_values,
                filled_text:  data.attr('filled_text') || false,
                empty_text:   data.attr('empty_text') || false,
                legend:       data.attr('legend')  || false,
                label_size:   parseInt(data.attr('label_size')),
                label_color:  data.attr('label_color'),
                labels_above: data.attr('labels_above'),
                labels_color: data.attr('labels_color'),
                decimals:     parseInt(data.attr('decimals')),
                shadow:       data.attr('show_shadow'),
                bar_labels_color:   data.attr('bar_labels_color'),
                bar_labels_bold:    data.attr('bar_labels_bold'),
                bar_labels_center:  data.attr('bar_labels_center'),
                gutter_left:  parseInt(data.attr('gutter_left')) || 45,
                horz_margin:  parseInt(data.attr('horz_margin')) || 15,
                defaultWidth: 200,
                defaultHeight:400
            };
            options.bar_labels_bold = !(options.bar_labels_bold != "true" && options.bar_labels_bold !== true);


            vis.binds.rgraph.createCanvas(view, wid, data.attr('class'), IDs, 200, 200);

            var elem = document.getElementById(wid);
            var can  = document.getElementById('c' + wid);

            var t = new RGraph.Bar ('c' + wid, values);

            t.Set('my_options', options);
            t.Set('my_values',  values);

            t.set('grouping', 'stacked');
            t.set('labels', options.names);
            t.set('labels.above.angle', options.labels_above_angle ? 45 : 0);
            t.set('labels.above', options.labels_above);
            t.set('labels.above.size', parseInt(options.label_size) || 12);
            t.set('labels.above.decimals', options.decimals);
            t.set('linewidth', 1);
            t.set('strokestyle', 'black');
            t.set('colors', max_values ? [options.empty_color, options.filled_color] : [options.filled_color]);
            t.set('shadow', options.show_shadow);
            t.set('shadow.offsetx', 4);
            t.set('shadow.offsety', 4);
            t.set('shadow.blur', 15);
            t.set('hmargin', parseInt(options.horz_margin));
            t.set('gutter.left', parseInt(options.gutter_left));
            t.set('background.grid.vlines', false);
            t.set('background.grid.border', false);
            t.set('axis.color', '#ccc');
            t.set('noyaxis', true);
            t.set('labels.above.color', options.label_color);
            t.set('chart.text.color', options.labels_color);
            t.set('title', options.title);

            if (options.legend) {
                t.set('key', max_values ? [options.empty_text || ' ', options.filled_text || ' '] : options.filled_text || ' ');
                t.set('key.position.gutter.boxed', true);
                t.set('key.position', 'graph');
                t.set('key.position.x', 10)
                t.set('key.position.y', 10)
                t.set('key.colors', max_values ? [options.empty_color, options.filled_color] : [options.filled_color]);
            }

            var text = data.attr('num_hlines');
            if (text) {
                t.Set('background.grid.autofit.numhlines', parseInt(text));
            }

            RGraph.Clear(t.canvas);
            try {
                t.on('draw', function (obj) {
                    var values  = obj.Get("my_values");
                    var options = obj.Get("my_options");
                    if (values.length > 0 && values[0].length > 1)  {
                        obj.context.fillStyle = options.bar_labels_color;
                        for (var i = 0, len = obj.coords.length; i < len; ++i) {
                            if (i%2 == 0) continue;
                            RGraph.Text2(obj.context, {
                                font:   'Verdana',
                                'bold':  options.bar_labels_bold,
                                'size':  options.label_size,
                                'x':     obj.coords[i][0] + (obj.coords[i][2] / 2),
                                'y':     options.bar_labels_center ? (obj.coords[i][1] + (obj.coords[i][3] / 2)) : (obj.coords[i][1] + obj.coords[i][3] - options.label_size),
                                'text':  obj.data_arr[i].toFixed(options.decimals),
                                'valign':'center',
                                'halign':'center'
                            });
                        }
                    }
                })
                .draw();
            } catch (e) {
                servConn.logError("Cannot render tplRBarChart: " + e);
            }

            elem.rgraph = t;
            $(elem).bind("resize", function () {
                if (this._resizeTimer) clearTimeout(this._resizeTimer);
                
                this._resizeTimer = _setTimeout(function (_wid) {
                    var _div = document.getElementById(_wid);
                    var div  = $(_div);
                    var can  = document.getElementById('c' + _wid);

                    can.width  = div.width();
                    can.height = div.height ();

                    if (can.width == 0 || can.height == 0) {
                        // My be jQuery bug
                        can.width  = parseInt(_div.style.width);
                        can.height = parseInt(_div.style.height);
                    }

                    RGraph.Clear(can);
                    
                    try {
                        _div.rgraph.Draw();
                    } catch (e) {
                        servConn.logError("Cannot render tplRBarChart: " + e);
                    }
                }, 500, this.id);
            });

            elem.rgraphValueChange = function (objId, newValue, isFromDevice) {
                var options = this.rgraph.Get("my_options");
                var isFound = false;

                for (var i = 0, len = options.IDs.length; i < len; i++){
                    if (options.IDs[i] == objId) {
                        var values  = this.rgraph.Get("my_values");
                        var val = vis.states.attr(options.IDs[i] + '.val');
                        if (val === null || val === undefined) {
                            val = this.rgraph.min;
                        }
                        val = parseFloat(val);
                        val = val * factor + offset;
                        if (val < 0) {
                            val = 0;
                        }
                        if (values[i].length > 1) {
                            values[i][0] = options.max_values[i] - val;
                            if (values[i][0] < 0) {
                                values[i][0] = 0;
                            }
                            values[i][1] = val;
                        }
                        else {
                            values[i][0] = val;
                        }
                        isFound = true;
                        //return;
                    }
                }
                if (isFound && !options.update_interval) {
                    vis.binds.rgraph.updateBar (this.id);
                }
            }
            if (options.update_interval) {
                elem._timeout = _setTimeout(vis.binds.rgraph.updateBar, options.update_interval, wid);
            }
        }
    };

</script>

<script id="tplRGtermometer" 
        type="text/ejs"
        class="vis-tpl"
        data-vis-type="temperature,number"
        data-vis-set="rgraph" 
        data-vis-name="Thermometer"
        data-vis-prev='<img src="widgets/rgraph/img/Prev_thermometr.png"></img>'
        data-vis-attrs="oid;min_value[0];max_value[100];control/checkbox;padding_left/slider,0,100,1;padding_right/slider,0,100,1;factor[1];value_offset[0];color;animate/checkbox;"
        data-vis-attrs0="group.scale;show_scale/checkbox;labels_color/color;labels_font/fontname;labels_size/slider,1,100;"
        data-vis-attrs1="group.title;title;title_side;title_side_font/fontname;title_side_size/slider,1,100;"
        data-vis-attrs2="group.advanced;show_shadow[true]/checkbox;ticksize/slider,0,100;units_pre;units_post;scale_decimals/slider,0,10,1;show_value/checkbox;value_decimals/slider,0,10,1;labels_count/slider,0,100,1">
    <%
        vis.binds.rgraph.tplRGtermometer(this.view, this.data);
    %>
</script>

<script id="tplRGgauge"
        type="text/ejs"
        class="vis-tpl"
        data-vis-type="gauge,number"
        data-vis-prev='<img src="widgets/rgraph/img/Prev_gauge.png"></img>'
        data-vis-set="rgraph"
        data-vis-name="Gauge-Basic"
        data-vis-attrs="oid/id;oid_2/id;oid_3/id;min_value[0];max_value[100];max_value_oid/id;factor[1];value_offset[0];control/checkbox;animate/checkbox;"
        data-vis-attrs0="group.scale;a_start/slider,0,360;a_end/slider,0,720;ticks_big_color/color;ticks_small_color/color;border_outer_color/color;border_inner_color/color;"
        data-vis-attrs1="group.background;back_color/color;background_gradient/checkbox;border_outline_color/color;"
        data-vis-attrs2="group.needle;needle_colors/color;needle_type/select,triangle,line;needle_tail/checkbox;needle_size/slider,5,500,1;centerpin_radius/slider,0,500,1;centerpin_color/color;"
        data-vis-attrs3="group.title;title;title_color/color;title_font/fontname;title_size/slider,1,100;title_pos/slider,0,1;title_bottom;title_bottom_color/color;title_bottom_font/fontname;title_bottom_size/slider,1,100;title_bottom_pos/slider,0,1;"
        data-vis-attrs4="group.labels;labels_color[#000000]/color;labels_font/fontname;labels_size/slider,1,100;labels_centered/checkbox;labels_offset/slider,-500,500,1;"
        data-vis-attrs5="group.sectors;green_end/slider,0,1;green_color/color;yellow_color/color;red_color/color;red_start/slider,0,1">
    <%
        vis.binds.rgraph.tplRGgauge(this.view, this.data);
    %>
</script>

<script id="tplRLiveChart" 
        type="text/ejs"
        class="vis-tpl"
        data-vis-type="chart,number"
        data-vis-prev='<img src="widgets/rgraph/img/Prev_liveChart.png"></img>'
        data-vis-set="rgraph"
        data-vis-name="LiveChart"
        data-vis-attrs="oid(1-8)/id;line_color(1-8)[black]/color;line_thick(1-8)[1]/slider,0.5,5,0.5;"
        data-vis-attrs0="group.settings;min_value[0];max_value[0];factor[1];value_offset[0];update_interval[5000]/slider,100,20000,100;points_count[250]/slider,10,2000,10;title;title_x;title_y;num_hlines[3]/slider,0,20,1;spline/checkbox;filled/checkbox;"
        data-vis-attrs1="group.oid_show;oid_show(1-8)/id;">
    <%
        vis.binds.rgraph.tplRLiveChart(this.view, this.data);
    %>
</script>

<script id="tplRBarChart"
        type="text/ejs"
        class="vis-tpl"
        data-vis-type="chart,number,barchart"
        data-vis-prev='<img src="widgets/rgraph/img/Prev_barChart.png"></img>'
        data-vis-set="rgraph"
        data-vis-name="BarChart"
        data-vis-attrs="oid(1-8)/id;name(1-8);"
        data-vis-attrs0="group.colors;filled_color[black]/color;empty_color[white]/color;"
        data-vis-attrs1="group.max_values;max_value(1-8);"
        data-vis-attrs2="group.settings;factor[1];value_offset[0];update_interval[0]/slider,0,20000,100;legend/checkbox;filled_text[Level];empty_text[Empty];"
        data-vis-attrs3="decimals[2]/slider,0,10,1;show_shadow/checkbox;gutter_left[45]/slider,0,200,1;horz_margin[15]/slider,0,200,1;num_hlines/slider,0,20,1;"
        data-vis-attrs4="group.labels;title;label_color[black]/color;labels_above[true]/checkbox;label_size[12]/slider,1,40,1;labels_above_angle/checkbox;labels_color[#000000]/color;bar_labels_color[black]/color;bar_labels_bold/checkbox;bar_labels_center/checkbox;"
        >
    <%
        vis.binds.rgraph.tplRBarChart(this.view, this.data);
    %>
</script>

<!-- --------------rgraph.html--- END -->
<!-- --------------sbfspot.html--- START -->
﻿<!--
    ioBroker.vis sbfspot Widget-Set


    Copyright 10.2015-2017 René G. <info@rg-engineering.eu>
-->
<!--
<script language="javascript" type="text/javascript" src="widgets/weather/lib/js/flot/jquery.js"></script>
-->
<script language="javascript" type="text/javascript" src="widgets/sbfspot/lib/js/flot/jquery.canvaswrapper.js"></script>
<script language="javascript" type="text/javascript" src="widgets/sbfspot/lib/js/flot/jquery.colorhelpers.js"></script>
<script language="javascript" type="text/javascript" src="widgets/sbfspot/lib/js/flot/jquery.flot.js"></script>
<script language="javascript" type="text/javascript" src="widgets/sbfspot/lib/js/flot/jquery.flot.saturated.js"></script>
<script language="javascript" type="text/javascript" src="widgets/sbfspot/lib/js/flot/jquery.flot.browser.js"></script>
<script language="javascript" type="text/javascript" src="widgets/sbfspot/lib/js/flot/jquery.flot.drawSeries.js"></script>
<script language="javascript" type="text/javascript" src="widgets/sbfspot/lib/js/flot/jquery.flot.uiConstants.js"></script>
<script language="javascript" type="text/javascript" src="widgets/sbfspot/lib/js/flot/jquery.flot.time.js"></script>
<script language="javascript" type="text/javascript" src="widgets/sbfspot/lib/js/flot/jquery.flot.legend.js"></script>

<script language="javascript" type="text/javascript" src="widgets/sbfspot/lib/js/flot/jquery.flot.axislabels_V2.js"></script>

<!-- doku for flot : -->
<!--  https://github.com/flot/flot/blob/master/API.md -->

<style>
    .chart-placeholder {
        width: 100%;
        height: 100%;
        font-size: 14px;
        line-height: 1.2em;
    }

    .legendLayer .background {
        fill: rgba(255, 255, 255, 0.85);
        stroke: rgba(0, 0, 0, 0.85);
        stroke-width: 1;
    }
</style>


<script type="text/javascript">
    'use strict';

    var MarkingColor = "eaebe5";

    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {

            "sbfspot": {
                "en": "sbfspot",
                "de": "sbfspot",
                "ru": "sbfspot",
                "pt": "sbfspot",
                "nl": "sbfspot",
                "fr": "sbfspot",
                "it": "sbfspot",
                "es": "sbfspot",
                "pl": "sbfspot",
                "zh-cn": "sbfspot"
            },

            "1 second": {
                "en": "1 second",
                "de": "1 Sekunde",
                "ru": "1 секунда",
                "pt": "1 segundo",
                "nl": "1 seconde",
                "fr": "1 seconde",
                "it": "1 secondo",
                "es": "1 segundo",
                "pl": "1 sekunda",
                "zh-cn": "1秒"
            },
            "10 seconds": {
                "en": "10 seconds",
                "de": "10 Sekunden",
                "ru": "10 секунд",
                "pt": "10 segundos",
                "nl": "10 seconden",
                "fr": "10 secondes",
                "it": "10 secondi",
                "es": "10 segundos",
                "pl": "10 sekund",
                "zh-cn": "10秒"
            },
            "30 seconds": {
                "en": "30 seconds",
                "de": "30 Sekunden",
                "ru": "30 секунд",
                "pt": "30 segundos",
                "nl": "30 seconden",
                "fr": "30 secondes",
                "it": "30 secondi",
                "es": "30 segundos",
                "pl": "30 sekund",
                "zh-cn": "30秒"
            },
            "1 minute": {
                "en": "1 minute",
                "de": "1 Minute",
                "ru": "1 минута",
                "pt": "1 minuto",
                "nl": "1 minuut",
                "fr": "1 minute",
                "it": "1 minuto",
                "es": "1 minuto",
                "pl": "1 minuta",
                "zh-cn": "1分钟"
            },
            "2 minutes": {
                "en": "2 minutes",
                "de": "2 Minuten",
                "ru": "2 минуты",
                "pt": "2 minutos",
                "nl": "2 minuten",
                "fr": "2 minutes",
                "it": "2 minuti",
                "es": "2 minutos",
                "pl": "2 minuty",
                "zh-cn": "2分钟"
            },
            "5 minutes": {
                "en": "5 minutes",
                "de": "5 Minuten",
                "ru": "5 минут",
                "pt": "5 minutos",
                "nl": "5 minuten",
                "fr": "5 minutes",
                "it": "5 minuti",
                "es": "5 minutos",
                "pl": "5 minut",
                "zh-cn": "5分钟"
            },
            "10 minutes": {
                "en": "10 minutes",
                "de": "10 Minuten",
                "ru": "10 минут",
                "pt": "10 minutos",
                "nl": "10 minuten",
                "fr": "10 minutes",
                "it": "10 minuti",
                "es": "10 minutos",
                "pl": "10 minut",
                "zh-cn": "10分钟"
            },
            "30 minutes": {
                "en": "30 minutes",
                "de": "30 Minuten",
                "ru": "30 минут",
                "pt": "30 minutos",
                "nl": "30 minuten",
                "fr": "30 minutes",
                "it": "30 minuti",
                "es": "30 minutos",
                "pl": "30 minut",
                "zh-cn": "30分钟"
            },
            "1 hour": {
                "en": "1 hour",
                "de": "1 Stunde",
                "ru": "1 час",
                "pt": "1 hora",
                "nl": "1 uur",
                "fr": "1 heure",
                "it": "1 ora",
                "es": "1 hora",
                "pl": "1 godzina",
                "zh-cn": "1小时"
            },
            "2 hours": {
                "en": "2 hours",
                "de": "2 Stunden",
                "ru": "два часа",
                "pt": "2 horas",
                "nl": "twee uur",
                "fr": "2 heures",
                "it": "2 ore",
                "es": "2 horas",
                "pl": "2 godziny",
                "zh-cn": "2小时"
            },
            "4 hours": {
                "en": "4 hours",
                "de": "4 Stunden",
                "ru": "4 часа",
                "pt": "4 horas",
                "nl": "4 uur",
                "fr": "4 heures",
                "it": "4 ore",
                "es": "4 horas",
                "pl": "4 godziny",
                "zh-cn": "4个小时"
            },
            "8 hours": {
                "en": "8 hours",
                "de": "8 Stunden",
                "ru": "8 часов",
                "pt": "8 horas",
                "nl": "8 uur",
                "fr": "8 heures",
                "it": "8 ore",
                "es": "8 horas",
                "pl": "8 godzin",
                "zh-cn": "8小时"
            },
            "12 hours": {
                "en": "12 hours",
                "de": "12 Stunden",
                "ru": "12 часов",
                "pt": "12 horas",
                "nl": "12 uren",
                "fr": "12 heures",
                "it": "12 ore",
                "es": "12 horas",
                "pl": "12 godzin",
                "zh-cn": "12小时"
            },
            "24 hours": {
                "en": "24 hours",
                "de": "24 Stunden",
                "ru": "24 часа",
                "pt": "24 horas",
                "nl": "24 uur",
                "fr": "24 heures",
                "it": "24 ore",
                "es": "24 horas",
                "pl": "24 godziny",
                "zh-cn": "24小时"
            },
            "sbfspotinstance": {
                "en": "sbfspot instance",
                "de": "sbfspot-Instanz",
                "ru": "экземпляр sbfspot",
                "pt": "instância sbfspot",
                "nl": "sbfspot-instantie",
                "fr": "instance de sbfspot",
                "it": "istanza sbfspot",
                "es": "instancia de sbfspot",
                "pl": "instancja sbfspot",
                "zh-cn": "sbfspot实例"
            },
            "time_interval": {
                "en": "Time interval",
                "de": "Zeitintervall",
                "ru": "Интервал времени",
                "pt": "Intervalo de tempo",
                "nl": "Tijdsinterval",
                "fr": "Intervalle de temps",
                "it": "Intervallo di tempo",
                "es": "Intervalo de tiempo",
                "pl": "Przedział czasowy",
                "zh-cn": "时间间隔"
            },
            "withxaxix": {
                "en": "show X axis",
                "de": "X-Achse anzeigen",
                "ru": "показать ось X",
                "pt": "mostre o eixo X",
                "nl": "X-as weergeven",
                "fr": "afficher l'axe X",
                "it": "mostra l'asse X.",
                "es": "mostrar eje X",
                "pl": "pokaż oś X.",
            },

            "sel_today": {
                "en": "today",
                "de": "heute",
                "ru": "Cегодня",
                "pt": "hoje",
                "nl": "vandaag",
                "fr": "aujourd'hui",
                "it": "oggi",
                "es": "hoy",
                "pl": "dzisiaj",
                "zh-cn": "今天"
            },
            "sel_last30days": {
                "en": "last 30 days",
                "de": "letzte 30 Tage",
                "ru": "последние 30 дней",
                "pt": "últimos 30 dias",
                "nl": "laatste 30 dagen",
                "fr": "les 30 derniers jours",
                "it": "ultimi 30 giorni",
                "es": "últimos 30 días",
                "pl": "ostatnie 30 dni",
                "zh-cn": "最近30天"
            },
            "sel_last12months": {
                "en": "last 12 months",
                "de": "letzten 12 Monate",
                "ru": "последние 12 месяцев",
                "pt": "últimos 12 meses",
                "nl": "laatste 12 maanden",
                "fr": "12 derniers mois",
                "it": "ultimi 12 mesi",
                "es": "últimos 12 meses",
                "pl": "ostatnie 12 miesięcy",
                "zh-cn": "最近12个月"
            },
            "sel_years": {
                "en": "years",
                "de": "Jahre",
                "ru": "лет",
                "pt": "anos",
                "nl": "jaar",
                "fr": "ans",
                "it": "anni",
                "es": "años",
                "pl": "lat",
                "zh-cn": "年份"
            },
            "serial": {
                "en": "inverter serial No.",
                "de": "Seriennummer des Wechselrichters",
                "ru": "серийный номер инвертора",
                "pt": "número de série do inversor",
                "nl": "serienummer van de omvormer",
                "fr": "n ° de série de l'onduleur",
                "it": "numero di serie dell'inverter",
                "es": "número de serie del inversor",
                "pl": "numer seryjny falownika",
                "zh-cn": "变频器序列号"
            },
            "valueselect": {
                "en": "select",
                "de": "wählen",
                "ru": "Выбрать",
                "pt": "selecionar",
                "nl": "kiezen",
                "fr": "sélectionner",
                "it": "selezionare",
                "es": "seleccionar",
                "pl": "Wybierz",
                "zh-cn": "选择"
            },


            "axislabelcolor": {
                "en": "color of axis label",
                "de": "Farbe der Achsenbeschriftung",
                "ru": "цвет метки оси",
                "pt": "cor do rótulo do eixo",
                "nl": "kleur van aslabel",
                "fr": "couleur de l'étiquette de l'axe",
                "it": "colore dell'etichetta dell'asse",
                "es": "color de la etiqueta del eje",
                "pl": "kolor etykiety osi",
                "zh-cn": "轴标颜色"
            },
            "tickscolor": {
                "en": "color of axis ticks",
                "de": "Farbe der Achsenstriche",
                "ru": "цвет отметок оси",
                "pt": "cor dos tiques do eixo",
                "nl": "kleur van as tikken",
                "fr": "couleur des tiques des axes",
                "it": "colore delle zecche degli assi",
                "es": "color de las garrapatas del eje",
                "pl": "kolor znaczników osi",
                "zh-cn": "轴刻度的颜色"
            },
            "graphcolor": {
                "en": "color",
                "de": "Farbe",
                "ru": "цвет",
                "pt": "cor",
                "nl": "kleur",
                "fr": "Couleur",
                "it": "colore",
                "es": "color",
                "pl": "kolor",
                "zh-cn": "颜色"
            },
            "nobgcolor": {
                "en": "no background color on grid",
                "de": "Keine Hintergrundfarbe im Raster",
                "ru": "нет цвета фона на сетке",
                "pt": "sem cor de fundo na grade",
                "nl": "geen achtergrondkleur op het raster",
                "fr": "pas de couleur d'arrière-plan sur la grille",
                "it": "nessun colore di sfondo sulla griglia",
                "es": "sin color de fondo en la cuadrícula",
                "pl": "brak koloru tła na siatce",
                "zh-cn": "网格上没有背景色"
            },

            "bgcolor": {
                "en": "background color on grid",
                "de": "Hintergrundfarbe auf Raster",
                "ru": "цвет фона на сетке",
                "pt": "cor de fundo na grade",
                "nl": "achtergrondkleur op het raster",
                "fr": "couleur de fond sur la grille",
                "it": "colore di sfondo sulla griglia",
                "es": "color de fondo en la cuadrícula",
                "pl": "kolor tła na siatce",
                "zh-cn": "网格上的背景色"
            },

            "bordercolor": {
                "en": "color of grid border",
                "de": "Farbe des Gitterrandes",
                "ru": "цвет границы сетки",
                "pt": "cor da borda da grade",
                "nl": "kleur van de rasterrand",
                "fr": "couleur de la bordure de la grille",
                "it": "colore del bordo della griglia",
                "es": "color del borde de la cuadrícula",
                "pl": "kolor obramowania siatki",
                "zh-cn": "网格边框的颜色"
            },
            "borderWidth": {
                "en": "width of grid border",
                "de": "Breite des Gitterrandes",
                "ru": "ширина границы сетки",
                "pt": "largura da borda da grade",
                "nl": "breedte van de rasterrand",
                "fr": "largeur de la bordure de la grille",
                "it": "larghezza del bordo della griglia",
                "es": "ancho del borde de la cuadrícula",
                "pl": "szerokość granicy siatki",
                "zh-cn": "网格边框的宽度"
            },

            "withyaxix": {
                "en": "show y axis",
                "de": "y-Achse anzeigen",
                "ru": "показать ось у",
                "pt": "mostre o eixo y",
                "nl": "y-as weergeven",
                "fr": "afficher l'axe y",
                "it": "mostra l'asse y",
                "es": "mostrar eje y",
                "pl": "pokaż oś y",
                "zh-cn": "显示y轴"
            },
            "graphDateFormat": {
                "en": "Date Format for X axis",
                "de": "Datumsformat für die X-Achse",
                "ru": "Формат даты для оси X",
                "pt": "Formato de data para o eixo X",
                "nl": "Datumnotatie voor X-as",
                "fr": "Format de date pour l'axe X",
                "it": "Formato data per asse X.",
                "es": "Formato de fecha para el eje X",
                "pl": "Format daty dla osi X.",
                "zh-cn": "X轴的日期格式"
            },
            "group_graph": {
                "en": "graph",
                "de": "Graph",
                "ru": "график",
                "pt": "gráfico",
                "nl": "diagram",
                "fr": "graphique",
                "it": "grafico",
                "es": "grafico",
                "pl": "wykres",
                "zh-cn": "图形"
            },
            "group_oids": {
                "en": "OID's",
                "de": "OID's",
                "ru": "OID-х",
                "pt": "OID's",
                "nl": "OID's",
                "fr": "OID",
                "it": "di OID",
                "es": "OID",
                "pl": "OID",
                "zh-cn": "OID的"
            },
            "oid_value": {
                "en": "OID values",
                "de": "OID-Werte",
                "ru": "Значения OID",
                "pt": "Valores OID",
                "nl": "OID-waarden",
                "fr": "Valeurs OID",
                "it": "Valori OID",
                "es": "Valores OID",
                "pl": "Wartości OID",
                "zh-cn": "OID值"
            },


            "markingcolor": {
                "en": "color of marking",
                "de": "Farbe der Markierung",
                "ru": "цвет маркировки",
                "pt": "cor da marcação",
                "nl": "kleur van markering",
                "fr": "couleur de marquage",
                "it": "colore della marcatura",
                "es": "color de marcado",
                "pl": "kolor oznakowania",
                "zh-cn": "标记颜色"
            },
            "withmarking": {
                "en": "with marking",
                "de": "mit Markierung",
                "ru": "с маркировкой",
                "pt": "com marcação",
                "nl": "met markering",
                "fr": "avec marquage",
                "it": "con marcatura",
                "es": "con marcado",
                "pl": "z oznaczeniem",
                "zh-cn": "带标记"
            },

            "graphName": {
                "en": "name on legend",
                "de": "Name auf Legende",
                "ru": "имя по легенде",
                "pt": "nome na legenda",
                "nl": "naam op legende",
                "fr": "nom sur la légende",
                "it": "nome sulla leggenda",
                "es": "nombre en la leyenda",
                "pl": "imię na legendzie",
                "zh-cn": "传说中的名字"
            },


            "LabelFontSize": {
                "en": "size of Label Font",
                "de": "Größe der Beschriftungsschrift",
                "ru": "размер шрифта метки",
                "pt": "tamanho da fonte da etiqueta",
                "nl": "grootte van het lettertype",
                "fr": "taille de la police d'étiquette",
                "it": "dimensione del carattere dell'etichetta",
                "es": "tamaño de la fuente de la etiqueta",
                "pl": "rozmiar czcionki etykiety",
                "zh-cn": "标签字体的大小"
            },
            "LabelFontFamily": {
                "en": "family of label font",
                "de": "Schriftfamilie",
                "ru": "семейство меток шрифта",
                "pt": "família de fontes de rótulo",
                "nl": "familie van lettertype",
                "fr": "famille de polices d'étiquettes",
                "it": "famiglia di caratteri etichetta",
                "es": "familia de fuente de etiquetas",
                "pl": "rodzina czcionek etykiet",
                "zh-cn": "标签字体家族"
            },
            "tickLength": {
                "en": "length of tick",
                "de": "Länge des Ticks",
                "ru": "длина тика",
                "pt": "comprimento do carrapato",
                "nl": "lengte van de teek",
                "fr": "longueur de tique",
                "it": "lunghezza del segno di spunta",
                "es": "longitud de la garrapata",
                "pl": "długość kleszcza",
                "zh-cn": "tick的长度"
            },
            "showMinorTicks": {
                "en": "show minor tick",
                "de": "zeige kleine Ticks",
                "ru": "показать небольшую галочку",
                "pt": "mostre carrapato menor",
                "nl": "toon kleine vinkjes",
                "fr": "montrer une tique mineure",
                "it": "mostra segno di spunta minore",
                "es": "mostrar marca menor",
                "pl": "pokaż drobne kleszcze",
                "zh-cn": "显示小勾"
            },
            "showTicks": {
                "en": "show tick",
                "de": "zeige ticks",
                "ru": "показать галочку",
                "pt": "show tick",
                "nl": "vinkje tonen",
                "fr": "montrer tique",
                "it": "mostra tick",
                "es": "mostrar marca",
                "pl": "pokaż tik",
                "zh-cn": "显示刻度"
            },
            "tickDecimals": {
                "en": "decimals",
                "de": "Dezimalstellen",
                "ru": "десятичные",
                "pt": "decimais",
                "nl": "decimalen",
                "fr": "décimales",
                "it": "decimali",
                "es": "decimales",
                "pl": "miejsca po przecinku",
                "zh-cn": "小数点"
            },
            "tickSize": {
                "en": "tick size",
                "de": "Tick-Größe",
                "ru": "размер галочки",
                "pt": "tamanho do carrapato",
                "nl": "teken grootte",
                "fr": "taille de la tique",
                "it": "dimensione tick",
                "es": "tamaño de la garrapata",
                "pl": "rozmiar kleszcza",
                "zh-cn": "刻度大小"
            },
            "minTickSize": {
                "en": "min. tick size",
                "de": "Mindest. Tick-Größe",
                "ru": "минимум размер галочки",
                "pt": "min. tamanho do carrapato",
                "nl": "min. teken grootte",
                "fr": "min. taille de la tique",
                "it": "min. dimensione tick",
                "es": "min. tamaño de la garrapata",
                "pl": "min. rozmiar kleszcza",
                "zh-cn": "分钟刻度大小"
            },
             "labelwidth": {
                "en": "label width",
                "de": "Labelbreite",
                "ru": "ширина этикетки",
                "pt": "largura da etiqueta",
                "nl": "labelbreedte",
                "fr": "largeur d'étiquette",
                "it": "larghezza dell'etichetta",
                "es": "ancho de etiqueta",
                "pl": "szerokość etykiety",
                "zh-cn": "标签宽度"
            },
             
            "coloraxis": {
                "en": "color of axis",
                "de": "Farbe der Achse",
                "ru": "цвет оси",
                "pt": "cor do eixo",
                "nl": "kleur van de as",
                "fr": "couleur de l'axe",
                "it": "colore dell'asse",
                "es": "color del eje",
                "pl": "kolor osi",
                "zh-cn": "轴的颜色"
            },
            "colorticklabel": {
                "en": "color tick label",
                "de": "Farbe Tick Label",
                "ru": "цветная метка",
                "pt": "etiqueta de escala de cores",
                "nl": "kleur maatlabel",
                "fr": "étiquette de couleur tique",
                "it": "etichetta con segno di spunta di colore",
                "es": "etiqueta de marca de color",
                "pl": "kolorowa etykieta kleszczowa",
                "zh-cn": "彩色刻度标签"
            },
            "withlegend": {
                "en": "show legend",
                "de": "Legende anzeigen",
                "ru": "показать легенду",
                "pt": "mostrar legenda",
                "nl": "toon legende",
                "fr": "montrer la légende",
                "it": "mostra legenda",
                "es": "Mostrar leyenda",
                "pl": "pokaż legendę",
                "zh-cn": "显示传奇"
            },
            "legendposition": {
                "en": "legend position",
                "de": "Legendenposition",
                "ru": "положение легенды",
                "pt": "posição da legenda",
                "nl": "legende positie",
                "fr": "position de la légende",
                "it": "posizione della legenda",
                "es": "posición de leyenda",
                "pl": "pozycja legendy",
                "zh-cn": "图例位置"
            }
        });
    }

 


    vis.binds.sbfspot = {
        version: "2.4.3",
        showVersion: function () {
            if (vis.binds.sbfspot.version) {
                console.log('Version vis-sbfspot: ' + vis.binds.sbfspot.version);
                vis.binds.sbfspot.version = null;
            }
        },

        setup: {
            intervals: {
                '1 second': 1000,
                '10 seconds': 10000,
                '30 seconds': 30000,
                '1 minute': 60000,
                '2 minutes': 120000,
                '5 minutes': 300000,
                '10 minutes': 600000,
                '30 minutes': 1800000,
                '1 hour': 3600000,
                '2 hours': 7200000,
                '4 hours': 14400000,
                '8 hours': 28800000,
                '12 hours': 43200000,
                '24 hours': 86400000
            },
            datasel: {
                'sel_today': 1,
                'sel_last30days': 2,
                'sel_last12months': 3,
                'sel_years': 4
            }

        },
        history: {

            init: function (widgetID, view, data1, style) {
                var $div = $('#' + widgetID);
                console.log("sbfspot history (" + widgetID + ")");
                var data = {};
                for (var s in data1) {
                    if (s[0] !== '_' && data1.hasOwnProperty(s) && typeof data1[s] !== 'object' && typeof data1[s] !== 'function') {
                        data[s] = data1[s];
                    }

                }

                   function SetMarkingColor(color) {
        MarkingColor = color;
    }

    function xwhFormatter(val, axis) {

        console.log('xwhFormatter for ' + val);

        if (val > 1000000)
            return (val / 1000000).toFixed(axis.tickDecimals) + " MWh";
        else if (val > 1000)
            return (val / 1000).toFixed(axis.tickDecimals) + " kWh";
        else
            return val.toFixed(axis.tickDecimals) + " Wh";
    }

    function legendformater(label, series) {

        //wenn keine Daten, dann ausblenden ->  (return null)
        if (series.data == null || typeof series.data == "undefined" || typeof series.data[0] == "undefined") {

            console.log('legendformater no label because no data ');
            return null;
        }
        else {
            console.log('legendformater label ' + label);
            return label;
        }
    }



    //===============================================================
    //Attention: this is different to sbfspot and vis-weather!!! we have much longer time periods here
    function GridMarkings(axes) {

        var markings = [];
        var minDate = new Date(axes.xaxis.min);

        const dayDiff = (axes.xaxis.max - axes.xaxis.min) / 1000 / 60 / 60 / 24;
        console.log('GridMarkings: DayDiff ' + dayDiff + ' (' + axes.xaxis.max + ' ' + axes.xaxis.min + ')');

        var i = minDate.getTime();

        if (dayDiff > 400) { //in years

            console.log('for year');

            minDate.setHours(0);
            minDate.setMinutes(0);
            minDate.setDate(1);
            minDate.setMonth(0);
            var i = minDate.getTime();
            var curDate;
            do {
                markings.push({ xaxis: { from: i, to: i + 12 * 30 * 24 * 60 * 60 * 1000 }, color: MarkingColor });

                i += 2 * 12 * 31 * 24 * 60 * 60 * 1000; //plus two year

                curDate = new Date(i);
                minDate = curDate;
                minDate.setHours(0);
                minDate.setMinutes(0);
                minDate.setDate(1);
                minDate.setMonth(0);

                console.log('GridMarkings (1): ' + minDate.toLocaleString());

                i = minDate.getTime();

            } while (i < axes.xaxis.max);
        }

        else if (dayDiff > 30) { // in months

            console.log('for months');

            minDate.setHours(0);
            minDate.setMinutes(0);
            minDate.setDate(1);
            var i = minDate.getTime();
            var curDate;
            do {
                markings.push({ xaxis: { from: i, to: i + 30 * 24 * 60 * 60 * 1000 }, color: MarkingColor });

                i += 2 * 31 * 24 * 60 * 60 * 1000; //plus one month

                curDate = new Date(i);
                minDate = curDate;
                minDate.setHours(0);
                minDate.setMinutes(0);
                minDate.setDate(1);

                console.log('GridMarkings  (2): ' + minDate.toLocaleString());

                i = minDate.getTime();
            } while (i < axes.xaxis.max);
        }
        else if (dayDiff > 10) {

            console.log('for more than days');

            //if (dayDiff > 2) {
            minDate.setHours(12);
            minDate.setMinutes(0);
            var i = minDate.getTime();
            do {
                markings.push({ xaxis: { from: i, to: i + 5 * 24 * 60 * 60 * 1000 }, color: MarkingColor });
                i += 2 * 5 * 24 * 60 * 60 * 1000; //plus 5 days
            } while (i < axes.xaxis.max);
        }

        //if we only few hours then we need markings per hour otherwise per day
        else if (dayDiff > 2) {
            console.log('for more than 2 days');

            do {
                markings.push({ xaxis: { from: i, to: i + 24 * 60 * 60 * 1000 }, color: MarkingColor });
                i += 2 * 24 * 60 * 60 * 1000;
            } while (i < axes.xaxis.max);

        }
        else {

            console.log('for hours');
            do {
                markings.push({ xaxis: { from: i, to: i + 60 * 60 * 1000 }, color: MarkingColor });
                i += 2 * 60 * 60 * 1000;
            } while (i < axes.xaxis.max);
        }
        return markings;

    }



    //===============================================================
    //Attention: this is different to sbfspot and vis-weather!!! we have much longer time periods here
    function CalcTicks4X(axis) {

        var ticks = [];

        var minDate = new Date(axis.min);

        const dayDiff = (axis.max - axis.min) / 1000 / 60 / 60 / 24;

        console.log('CalcTicks4X: DayDiff ' + dayDiff + ' (' + axis.max + ' ' + axis.min + ')');
        
        if (dayDiff > 400) { //in years
            minDate.setHours(12);
            minDate.setMinutes(0);
            minDate.setDate(15);
            minDate.setMonth(5);
            var i = minDate.getTime();
            var curDate;
            do {
                ticks.push([i]);

                i += 12 * 30 * 24 * 60 * 60 * 1000; //plus one year

                curDate = new Date(i);
                minDate = curDate;
                minDate.setHours(12);
                minDate.setMinutes(0);
                minDate.setDate(15);
                minDate.setMonth(5);

                console.log('CalcTicks4X (1): ' + minDate.toLocaleString()); 

                i = minDate.getTime();

            } while (i < axis.max);
        }

        else if (dayDiff > 30) { // in months
            minDate.setHours(12);
            minDate.setMinutes(0);
            minDate.setDate(15);
            var i = minDate.getTime();
            var curDate;
            do {
                ticks.push([i]);
                i += 30 * 24 * 60 * 60 * 1000; //plus one month

                curDate = new Date(i);
                minDate = curDate;
                minDate.setHours(12);
                minDate.setMinutes(0);
                minDate.setDate(15);

                console.log('CalcTicks4X  (2): ' + minDate.toLocaleString());

                i = minDate.getTime();
            } while (i < axis.max);
        }
        else if (dayDiff > 10) {
            //if (dayDiff > 2) {
            minDate.setHours(12);
            minDate.setMinutes(0);
            var i = minDate.getTime();
            do {
                ticks.push([i]);
                i += 5 * 24 * 60 * 60 * 1000; //plus 5 days
            } while (i < axis.max);
        }

        else if (dayDiff > 2) {
        //if (dayDiff > 2) {
            minDate.setHours(12);
            minDate.setMinutes(0);
            var i = minDate.getTime();
            do {
                ticks.push([i]);
                i += 24 * 60 * 60 * 1000; //plus a day
            } while (i < axis.max);
        }
        else {
            minDate.setHours(0);
            minDate.setMinutes(0);
            var i = minDate.getTime();
            do {
                ticks.push([i]);
                i += 6 * 60 * 60 * 1000; //plus 6 hours
            } while (i < axis.max);
        }
        return ticks;
    }



                function update() {

                    console.log("ShowChart sbfspot  (" + widgetID + ")");

                    var $div = $('#' + widgetID);
                    // if nothing found => wait
                    if (!$div.length) {
                        return setTimeout(function () {
                            console.log("need to wait... (" + widgetID + ")");
                            update();
                        }, 1000);
                    }

                    console.log("ShowChart sbfspot begin (" + widgetID + ")");

                    if (!data || !data.sbfspotinstance) {
                        console.log("keine instanz  (" + widgetID + ")");
                        $div.html("<br> <center> <font color='red'> no instance for sbfspot specified </font> </center></br>");
                    }
                    
                    else if (!data.serial) {
                        console.log("keine seriennummer  (" + widgetID + ")");
                        $div.html("<br> <center> <font color='red'> no inverter serial number for sbfspot specified </font> </center></br>");
                    }

                    else {

                        SetMarkingColor(data.markingcolor);

                        var dateMin = -1;
                        var dateMax = -1;

                        var values = [];
                        var maxY = -9999;
                        var minY = 9999;

                        try {
                            var oid_value = data.oid_value;
                            var oData = JSON.parse(vis.states[oid_value + '.val']);

                            if (oData === null || typeof oData == "undefined" || oData.length < 1) {
                                $div.html("<br> <center> <font color='red'>no data available yet for sbfspot</font> </center></br>");
                                return;
                            }


                            //console.log("oData " + oData.length);
                            //console.log(JSON.stringify(oData));

                            var $sel = vis.binds.sbfspot.setup.datasel[data.valueselect];

                            console.log("sel " + $sel);

                            var oldValue = 0;
                            for (var i = 0; i < oData.length; i++) {
                                //[{"time":"06:08","value":0},{"time":"07:08","value":60},{"time":"08:08","value":181},{"time":"09:08","value":401},{"time":"10:08","value":1917},{"time":"11:08","value":3839},{"time":"12:08","value":5905},{"time":"13:08","value":8025},{"time":"14:08","value":10052},{"time":"15:08","value":11844},{"time":"16:08","value":13159},{"time":"17:08","value":13773},{"time":"18:08","value":13875},{"time":"19:08","value":13911},{"time":"20:08","value":13911}] kW
                                //[{ "date": "2017-07-27", "value": 4045 }, { "date": "2017-07-28", "value": 10050 }, { "date": "2017-07-29", "value": 10442 }, { "date": "2017-07-30", "value": 13448 }, { "date": "2017-07-31", "value": 13476 }, { "date": "2017-08-01", "value": 12294 }, { "date": "2017-08-02", "value": 9084 }, { "date": "2017-08-03", "value": 3626 }, { "date": "2017-08-04", "value": 8504 }, { "date": "2017-08-05", "value": 12037 }, { "date": "2017-08-06", "value": 9725 }, { "date": "2017-08-07", "value": 13577 }, { "date": "2017-08-08", "value": 13310 }, { "date": "2017-08-09", "value": 12120 }, { "date": "2017-08-10", "value": 1391 }, { "date": "2017-08-11", "value": 2447 }, { "date": "2017-08-12", "value": 5659 }, { "date": "2017-08-13", "value": 5388 }, { "date": "2017-08-14", "value": 11364 }, { "date": "2017-08-15", "value": 12985 }, { "date": "2017-08-16", "value": 7504 }, { "date": "2017-08-17", "value": 9294 }, { "date": "2017-08-18", "value": 8594 }, { "date": "2017-08-19", "value": 10459 }, { "date": "2017-08-20", "value": 7991 }, { "date": "2017-08-21", "value": 10881 }, { "date": "2017-08-22", "value": 9715 }, { "date": "2017-08-23", "value": 13911 }, { "date": "2017-08-24", "value": 9016 }, { "date": "2017-08-25", "value": 11051 }, { "date": "2017-08-26", "value": 155 }]
                                //[{"month":"2016-09","value":17886174},{"month":"2016-10","value":17973503},{"month":"2016-11","value":18020416},{"month":"2016-12","value":18052202},{"month":"2017-01","value":18077080},{"month":"2017-02","value":18171050},{"month":"2017-03","value":18384397},{"month":"2017-04","value":18602474},{"month":"2017-05","value":18909431},{"month":"2017-06","value":19236280},{"month":"2017-07","value":19522862},{"month":"2017-08","value":19754944}]
                                //[{"year":"2016","value":18052202},{"year":"2017","value":19754944}]

                                if ($sel == 1) {
                                    var oVals = oData[i];
                                    var sDate = oVals["time"];
                                    var value = parseInt(oVals["value"], 10);

                                    var diff = value - oldValue;
                                    oldValue = value;

                                    var DateArray = sDate.split(":");
                                    var minute = parseInt(DateArray[1], 10);
                                    var hour = parseInt(DateArray[0], 10);

                                    var oDate = new Date();
                                    oDate.setHours(hour);
                                    oDate.setMinutes(minute);

                                    if (diff < minY) minY = diff;
                                    if (diff > maxY) maxY = diff;

                                    //console.log(oDate.toString() + " : " + diff);

                                    var date = oDate.getTime();

                                    if (dateMin === -1) {
                                        dateMin = date;
                                    }
                                    dateMax = date;

                                    values.push([oDate, diff]);
                                }
                                else if ($sel == 2) {
                                    var oVals = oData[i];
                                    var sDate = oVals["date"];
                                    var value = parseInt(oVals["value"]);
                                    var value = value;
                                    //2017-08-12

                                    var DateArray = sDate.split("-");
                                    var day = parseInt(DateArray[2], 10);
                                    var month = parseInt(DateArray[1], 10);
                                    var year = parseInt(DateArray[0], 10);

                                    month--;

                                    var oDate = new Date(year, month, day, 12, 0, 0, 0);

                                    if (value < minY) minY = value;
                                    if (value > maxY) maxY = value;

                                    //console.log(oDate.toDateString() + " : " + value);
                                    var date = oDate.getTime();

                                    if (dateMin === -1) {
                                        dateMin = date;
                                    }
                                    dateMax = date;
                                    values.push([oDate, value]);
                                }
                                else if ($sel == 3) {
                                    var oVals = oData[i];
                                    var sDate = oVals["month"];
                                    var value = parseInt(oVals["value"], 10);
                                    var value = value;
                                    //2016-09

                                    //console.log(sDate);
                                    //on new android app this goas fail; don't know why...
                                    //var month = parseInt(sDate.substring(5, 7));
                                    //var year = parseInt(sDate.substring(0, 4));

                                    var DateArray = sDate.split("-");
                                    var month = parseInt(DateArray[1], 10);
                                    var year = parseInt(DateArray[0], 10);

                                    console.log("array " + DateArray[0] + " / " + DateArray[1]);

                                    month--;

                                    //mid of month
                                    var oDate = new Date(year, month, 15, 12, 0, 0, 0);

                                    var diff = value - oldValue;

                                    if (oldValue > 0) {
                                        if (diff < minY) minY = diff;
                                        if (diff > maxY) maxY = diff;

                                        console.log(oDate.toDateString() + " : " + diff + " (" + year + "," + month + ")");

                                        var date = oDate.getTime();

                                        if (dateMin === -1) {
                                            dateMin = date;
                                        }
                                        dateMax = date;

                                        values.push([oDate, diff]);
                                    }
                                    oldValue = value;

                                }
                                else if ($sel == 4) {
                                    var oVals = oData[i];
                                    var year = parseInt(oVals["year"], 10);
                                    var value = parseInt(oVals["value"], 10);
                                    var value = value;
                                    //2016

                                    // mid of year
                                    var oDate = new Date(year, 5, 30, 12, 0, 0, 0);

                                    var diff = value - oldValue;

                                    if (oldValue > 0) {
                                        if (diff < minY) minY = diff;
                                        if (diff > maxY) maxY = diff;

                                        console.log(oDate.toDateString() + " : " + diff);
                                        var date = oDate.getTime();

                                        if (dateMin === -1) {
                                            dateMin = date;
                                        }
                                        dateMax = date;

                                        values.push([oDate, diff]);
                                    }
                                    else {
                                        console.log(oDate.toDateString() + " : " + value);
                                        var date = oDate.getTime();
                                        if (dateMin === -1) {
                                            dateMin = date;
                                        }
                                        dateMax = date;

                                        values.push([oDate, value]);
                                    }
                                    oldValue = value;

                                }
                            }
                        } catch (e) {
                            console.log('exception catch in parse data [' + e + ']');
                        }
                        var barwidth = 0;
                        if ($sel == 1) {
                            barwidth = 1000 * 60 * 60 * 0.25; //0,25 h
                        }
                        else if ($sel == 2) {
                            barwidth = 1000 * 60 * 60 * 12; //12 h
                        }
                        else if ($sel == 3) {
                            barwidth = 1000 * 60 * 60 * 24 * 15; //15 days
                        }
                        else if ($sel == 4) {
                            barwidth = 1000 * 60 * 60 * 24 * 182; //365/2=182 days
                        }
                        console.log("barwidth = " + barwidth); // in ms
                        //sbfspot.0.2000562095.history.last30Days

                        /*
                        var ticksX = data.ticksonxaxix > 0 ? parseInt(data.ticksonxaxix, 10) : 5;

                        if (ticksX > values.length) {
                            ticksX = values.length;
                            console.log('reduce ticks on X to ' + ticksX);
                        }
                        */
                        $.plot($div,
                            [{
                                data: values,
                                color: data.graphcolor,
                                label: data.graphName,
                                xaxis: 1,
                                yaxis: 1,
                                lines: { show: false },
                                bars:
                                {
                                    show: true,
                                    barWidth: [barwidth, true],
                                    align: "center",
                                    horizontal: false
                                }
                            },


                            ],
                            {

                                xaxes:
                                    [{
                                        axisLabelUseCanvas: true,
                                        axisLabelColour: 'orange',

                                        show: data.withxaxix,
                                        mode: "time",
                                        timeBase: "milliseconds",
                                        tickLength: 5,

                                        min: dateMin,
                                        max: dateMax,
                                        //ticks: data.ticksonxaxix > 0 ? parseInt(data.ticksonxaxix, 10) : 5,
                                        ticks: CalcTicks4X,

                                        autoScale: "none",
                                        timeformat: data.graphDateFormat,
                                        monthNames: ["Jan", "Feb", "Mar", "Apr", "Mai", "Jun", "Jul", "Aug", "Sep", "Okt", "Nov", "Dez"],
                                        color: data.tickscolor,
                                        tickColor: data.tickscolor,
                                        font: {

                                            size: data.LabelFontSize,
                                            lineHeight: 13,
                                            style: "normal", //"italic",
                                            weight: "bold",
                                            family: data.LabelFontFamily,
                                            variant: "small-caps",
                                            color: data.axislabelcolor,
                                        },
                                        timezone: "browser"
                                    },

                                    ],
                                yaxes:
                                    [{
                                        axisLabelUseCanvas: true,
                                        axisLabelColour: 'orange',

                                        show: data.withyaxix,
                                        max: maxY,
                                        min: minY,
                                        autoScale: "none", // Available modes: "none", "loose", "exact"
                                        showTickLabels: "major",
                                        alignTicksWithAxis: 1,
                                        position: 'left',
                                        //ticks: 3,

                                        tickLength: parseFloat(data.tickLength),            //20, // size in pixels of major tick marks
                                        showMinorTicks: data.showMinorTicks,    //false, // true = show minor tick marks, false = hide minor tick marks
                                        showTicks: data.showTicks,              //true, // true = show tick marks, false = hide all tick marks
                                        tickDecimals: data.tickDecimals,        //1, // no. of decimals, null means auto
                                        tickSize: data.tickSize,                //3, // number or [number, "unit"]
                                        minTickSize: data.minTickSize,          //1, // number or [number, "unit"]

                                        color: data.coloraxis,
                                        tickColor: data.coloraxis,

                                        labelWidth: parseFloat(data.labelwidth),
                                        font: {
                                            size: data.LabelFontSize,
                                            lineHeight: 13,
                                            style: "normal", //"italic",
                                            weight: "bold",
                                            family: data.LabelFontFamily,
                                            variant: "small-caps",
                                            color: data.colorticklabel,

                                        },
                                        tickFormatter: xwhFormatter
                                    },

                                    ],
                                grid:
                                {
                                    markings: data.withmarking ? GridMarkings : null,

                                    // backgroundColor: data.nobgcolor ? null : { colors: ["#fff", "#eee"] },
                                    backgroundColor: data.nobgcolor ? null : data.bgcolor,
                                    borderWidth:  parseFloat(data.borderWidth), //data.withborder,
                                    borderColor: data.bordercolor,
                                    margin: 1,
                                    /*
                                    borderWidth: {
                                        top: data.withborder ? 1 : 0,
                                        right: data.withborder ? 1 : 0,
                                        bottom: data.withborder ? 2 : 0,
                                        left: data.withborder ? 2 : 0
                                    },*/

                                },
                                legend: {
                                    show: data.withlegend,
                                    labelFormatter: legendformater,
                                    //labelBoxBorderColor: color,
                                    //noColumns: number,
                                    position: data.legendposition,
                                    //margin: number of pixels or [x margin, y margin]
                                    backgroundColor: null,
                                    backgroundOpacity: 0,
                                    container: null,
                                    sorted: false
                                }
                            }
                        );


                    }
                };

                if (data.sbfspotinstance) {

                    var oid_value = data.oid_value;
                    console.log("bind " + oid_value);
                    vis.states.bind(oid_value + '.val', function () {
                        vis.binds.sbfspot.history.update($div);
                    });



                    // update every x seconds
                    if (!vis.editMode) {
                        $div.data('timer', setInterval(function () {
                            vis.binds.sbfspot.history.update($div);
                        }, parseInt(vis.binds.sbfspot.setup.intervals[data.time_interval] / (parseInt(data.points, 10) || 10), 10)));
                    }
                }
                else {
                    console.log("instance not set ");
                }
                update();

                if (vis.editMode) {
                    console.log("flot version " + $.plot.version + " for sbfspot");
                }
            }
        },
    };

    if (vis.editMode) {
        vis.binds.sbfspot.onInstanceChanged = function (widgetID, view, newId, fields) {
            console.log('---------: ' + widgetID + ' - ' + view + ' - ' + newId + ' - ' + fields);

            var changed = [];
            //delete all oid's
            vis.views[view].widgets[widgetID].data.oid_value = "";
            vis.widgets[widgetID].data.oid_value = "";

            //sbfspot.0.2000562095.history.last30Days


            //then copy new values into oid
            if ((fields.indexOf("serial") > -1) || (fields.indexOf("sbfspotinstance") > -1) || fields.indexOf("valueselect") > -1) {

                var sSerial = vis.widgets[widgetID].data.serial;
                var sInstance = vis.widgets[widgetID].data.sbfspotinstance;
                var sValueSet = "today";



                var $sel = vis.widgets[widgetID].data.valueselect;

                console.log("+++++++ " + $sel + " " + vis.binds.sbfspot.setup.datasel[$sel]);

                switch (vis.binds.sbfspot.setup.datasel[$sel]) {
                    case 1:
                        vis.views[view].widgets[widgetID].data.graphDateFormat = "%H:%M";
                        vis.widgets[widgetID].data.graphDateFormat = "%H:%M";
                        sValueSet = "today";
                        break;
                    case 2:
                        vis.views[view].widgets[widgetID].data.graphDateFormat = "%d.%b";
                        vis.widgets[widgetID].data.graphDateFormat = "%d.%b";
                        sValueSet = "last30Days";
                        break;
                    case 3:
                        vis.views[view].widgets[widgetID].data.graphDateFormat = "%b %Y";
                        vis.widgets[widgetID].data.graphDateFormat = "%b %Y";
                        sValueSet = "last12Months";
                        break;
                    case 4:
                        vis.views[view].widgets[widgetID].data.graphDateFormat = "%Y";
                        vis.widgets[widgetID].data.graphDateFormat = "%Y";
                        sValueSet = "years";
                        break;
                    default: break;
                }

                console.log('calc new oids with serial ' + sSerial + " Instance " + sInstance + " " + sValueSet);

                vis.views[view].widgets[widgetID].data.oid_value = sInstance + "." + sSerial + ".history." + sValueSet;
                vis.widgets[widgetID].data.oid_value = sInstance + "." + sSerial + ".history." + sValueSet;







            }

            return changed;
        }

    }

    vis.binds.sbfspot.showVersion();

</script>



<script id="tplSbfspotShowInstance"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="sbfspot"
        data-vis-name="sbfspot"
        data-vis-type="sbfspot"
        data-vis-update-style="true"
        data-vis-prev='<img src="widgets/sbfspot/img/Prev_tplSbfspot.png"></img>'
        data-vis-attrs="sbfspotinstance/sbfspot/onInstanceChanged;time_interval[30 minutes]/select,1 second,10 seconds,30 seconds,1 minute,2 minutes,5 minutes,10 minutes,30 minutes,1 hour,2 hours,4 hours,8 hours,12 hours,24 hours;serial//onInstanceChanged;valueselect[sel_today]/select,sel_today,sel_last30days,sel_last12months,sel_years/onInstanceChanged;"
       
        data-vis-attrs0="withxaxix[true]/checkbox;axislabelcolor[#ffffff]/color;tickscolor[#ffffff]/color;LabelFontSize[8];LabelFontFamily[Arial]/fontname;withmarking[true]/checkbox;markingcolor[#eaebe5]/color;"
        data-vis-attrs1="borderWidth[1];bordercolor[#000000]/color;nobgcolor[true]/checkbox;bgcolor[#FFFFFF]/color;withlegend[false]/checkbox;legendposition[ne]/select,ne,nw,se,sw;"
        data-vis-attrs2="group.graph;graphName;graphcolor[#f1f113]/color;coloraxis[#f1f113]/color;colorticklabel[#f1f113]/color;withyaxix[true]/checkbox;graphDateFormat[%H:%M];tickLength[5];showMinorTicks[true]/checkbox;showTicks[true]/checkbox;tickDecimals[1];tickSize[3];minTickSize[2];labelwidth[30];"
        data-vis-attrs3="group.oids;oid_value/id;">

    <div class="vis-widget <%== this.data.attr('class') %>" style="overflow: hidden;" id="<%= this.data.attr('wid') %>">
        <div class="vis-sbfspot-widget-body"
             <%= vis.binds.sbfspot.history.init(this.data.wid, this.view, this.data, this.style) %>>
        </div>
    </div>



</script>


<!-- --------------sbfspot.html--- END -->
<!-- --------------sip-asterisk.html--- START -->
<link rel="stylesheet" href="widgets/sip-asterisk/css/style.css"/>

<script type="text/javascript" src="widgets/sip-asterisk/js/SIPml-api.js"></script>
<script type="text/javascript" src="widgets/sip-asterisk/js/sip-asterisk.js"></script>

<script id="tplSipAdapterWidget"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/sip-asterisk/img/Prev_tplSipAdapterWidget.png"></img>'
        data-vis-attrs="privateIdentity[1060];publicIdentity[sip:1060@IP-Address];password/password;displayName[arbitrary];realm[IP-Address];websocketProxyURL[wss://IP-Address:8089/ws];phoneNumber;noOutgoingCalls[true]/checkbox;defaultVolume[0.5]/slider,0,1,0.1;sipShowStatus[true]/checkbox;"
        data-vis-attrs0="group.sipoids;calling-oid/id;incall-oid/id;callduration-oid/id;lastcall-oid/id;lastduration-oid/id;"
        data-vis-set="sip-asterisk"
        data-vis-type="widget"
        data-vis-name="SIP-Asterisk"
>
    <div class="vis-widget <%== this.data.attr('class') %> sip-asterisk" style="width:200px; height:200px; overflow: visible;" id="<%= this.data.attr('wid') %>">
        <%
            vis.binds['sip-asterisk'].createWidget(this.data.wid, this.view, this.data, this.style);
        %>
    </div>
</script>
<!-- --------------sip-asterisk.html--- END -->
<!-- --------------starline.html--- START -->
<!--
    ioBroker.Starline Widget-Set 
    version: "0.1.0"
    Copyright 10.2015-2016 instalator <vvvalt@mail.ru>
-->
<link rel="stylesheet" href="widgets/starline/css/style.css" />
<script type="text/javascript" src="widgets/starline/js/starline.js"></script>

<script id="tplStarlineShowInstance"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/starline/img/state.png"></img>'
		data-vis-attrs="oid_alias/id/changeOid;oid_ctemp/id;oid_etemp/id;oid_balance/id;oid_battery/id;oid_gsm_lvl/id;oid_gps_lvl/id;oid_status/id;oid_position_sat_qty/id;"
        data-vis-attrs0="group.car_alr_state;oid_alr_state_door/id;oid_alr_state_add_h/id;oid_alr_state_add_l/id;oid_alr_state_hbrake/id;oid_alr_state_hood/id;oid_alr_state_ign/id;oid_alr_state_pbrake/id;oid_alr_state_shock_h/id;oid_alr_state_shock_l/id;oid_alr_state_tilt/id;oid_alr_state_trunk/id;"
		data-vis-attrs1="group.car_state;oid_car_state_arm/id;oid_car_state_door/id;oid_car_state_hijack/id;oid_car_state_valet/id;oid_car_state_hood/id;oid_car_state_ign/id;oid_car_state_trunk/id;oid_car_state_hbrake/id;oid_car_state_pbrake/id;oid_car_state_run/id;"
		data-vis-attrs2="group.car_control_check;oid_checkballance/id;oid_checktemp/id;"
		data-vis-set="starline"
        data-vis-type="val"
		data-vis-beta="true"
        data-vis-name="Show car status"> 
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:317px; height:237px" id="<%= this.data.attr('wid') %>" >
		<div class="starline_header">
			<div class="gpsgsm-cont">
				<div class="gpsgsm-status">
					<div class="clearfix">
						<div style="float:left"><div class="gsm-status" data-level=""></div>
							<div align="center" class="greyColor" style="color:#59626E;font-size:90%">gsm</div>
						</div>
						<div style="float:left;margin-left:10px;">
							<div title="" class="gps-status" data-level=""></div>
							<div class="greyColor" align="center" style="color:#59626E;font-size:90%">gps</div>
						</div>
						<div style="float:right"></div>
					</div>
				</div>
            </div>
            <div class="menu-item-title-container">
                <div class="menu-status onoff off"></div>
                    <div class="alias_value"></div>
                    <span class="datedata"></span>
            </div>
        </div>

			<div class="starline_body">
				<div data-id="info" style="padding-top: 1px; position: relative; overflow: hidden;">
					<div class="valet-border"><div class="valet-content" style="display: none;">Сервисный<br>режим</div></div>
					<div class="hijack-border"><div class="hijack-content" style="display: none;">Режим<br>антиограбления</div></div>
					<div class="car-status" style="height: 133px;">
						<div class="car-tiltsensor-red"></div>
						<div class="car-hammer1-red"></div>
						<div class="car-hammer2-red"></div>
						<div class="car-trunk-red"></div>
						<div class="car-trunk"></div>
						<div class="car-doors-red"></div>
						<div class="car-doors"></div>
						<div class="car-ign">
							<div class="light"></div>
							<div class="s1"></div>
							<div class="s2"></div>
							<div class="s3"></div>
						</div>
						<div class="car-arm">
							<div class="s1"></div>
							<div class="s2"></div>
							<div class="s3"></div>
							<div class="s4"></div>
							<div class="s5"></div>
						</div>
						<div class="car-run"></div>
						<div class="car-run-red"></div>
						<div class="car-hood-red"></div>
						<div class="car-parking"></div>
						<div class="car-parking-red"></div>
						<div class="car-hood"></div>
						<div class="car-key"></div>
						<div class="car-key-red"></div>
						<div class="car-neutral" title="Режим «Программная нейтраль» включен"></div>
						<div class="car-hfree" title="Режим «Свободные руки» включен"></div>
						<div class="car"></div>
					</div>
					<div class="menu-item-tab-car-controls">
						<ul class="under-buttons-panel">
							<li class="balance" title="Баланс SIM-карты"><div class="balance_icon"></div><span class="balance_value"></span></li>
							<li class="battery" title="Напряжение аккумулятора"><div class="battery_icon"></div><span class="battery_value"></span> В</li>
							<li class="t1 ctemp" title="Температура в салоне"><div class="ctemp_icon"></div><span class="ctemp_value"></span> °C</li>
							<li class="t2 etemp" title="Температура двигателя"><div class="etemp_icon"></div><span class="etemp_value"></span> °C</li>
						</ul>
					</div>
				</div>
			</div>
       <% vis.binds.starline.createWidgetStatus(this.data.wid, this.view, this.data, this.style);%>
	</div>
</script>

<script id="tplStarlineButtonInstance"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/starline/img/btn.png"></img>'
        data-vis-attrs="oid_alias/id/changeOid2;oid_car_state_hijack/id;oid_car_state_arm/id;oid_car_state_run/id;oid_car_state_ign/id;oid_car_state_valet/id;oid_car_state_shock_bpass/id;oid_car_state_tilt_bpass/id;oid_car_state_webasto/id;"
        data-vis-attrs0="group.car_control;oid_control_hijack/id;oid_control_arm/id;oid_control_ign/id;oid_control_poke/id;oid_control_webasto/id;oid_control_shock_bpass/id;oid_control_tilt_bpass/id;oid_control_valet/id;oid_control_update_position/id;oid_control_out/id;"
        data-vis-set="starline"
        data-vis-type="val"
		data-vis-beta="true"
        data-vis-name="Control car alarm">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width:317px; height:73px" id="<%= this.data.attr('wid') %>" >
    <div class="control-container" style="padding: 0px; top: 0px; width: 317px; height:73px; overflow: hidden; padding: 0px; outline: none;">
		<div class="control-button-toleft off"></div>
		<div class="control-button-toright"></div>
		<div class="control-scroll" style="width:267px;height:73px;overflow:hidden;position:relative;margin: 0 auto">
			<div class="control-items">
				<div class="control-item" style="width:267px;float:left;position:relative;">
					<div title="Включение режима антиограбления" data-id="hijack" data-number="0" data-command="31" class="hijack control-button control-left2">
						<div class="control-push"></div>
						<div class="control-icon">
							<div class="control-icon-hijack" style="background:url(./widgets/starline/img/buttons-icon-set_white.png) no-repeat 0px 0px;"></div>
						</div>
					</div>
					<div title="Снятие/постановка на охрану" data-id="arm" data-number="1" data-command="5" class="arm control-button control-left1">
						<div class="control-push"></div>
						<div class="control-icon">
							<div class="control-icon-arm" style="background:url(./widgets/starline/img/buttons-icon-set_white.png) no-repeat -72px 0px;"></div>
						</div>
					</div>
					<div title="Включение/выключение двигателя" data-id="ign" data-number="2" data-command="7" class="ign control-button control-circle">
						<div class="control-push"></div>	
						<div class="control-icon">
							<div class="control-icon-ign" style="background:url(./widgets/starline/img/buttons-icon-set_white.png) no-repeat -36px 0px;"></div>
						</div>
					</div>
					<div title="Сигнал" data-id="poke" data-number="3" data-command="36" class="poke control-button control-right1">
						<div class="control-push"></div>
						<div class="control-icon">
							<div class="control-icon-poke" style="background:url(./widgets/starline/img/buttons-icon-set_white.png) no-repeat -144px 0px;"></div>
						</div>
					</div>
					<div title="Управление предпусковым подогревом двигателя" data-id="webasto" data-number="4" data-command="81" class="webasto control-button control-right2">
						<div class="control-push"></div>	
						<div class="control-icon">
							<div class="control-icon-webasto" style="background:url(./widgets/starline/img/buttons-icon-set_white.png) -108px 0px no-repeat;">	</div>
						</div>
					</div>
				</div>
				<div class="control-item" style="width:267px;float:left;position:relative;">	
					<div title="Выключение датчика удара" data-id="shock_bpass" data-number="5" data-command="12" class="shock_bpass control-button control-left2">	
						<div class="control-push"></div>
						<div class="control-icon">
							<div class="control-icon-shock_bpass" style="background:url(./widgets/starline/img/buttons-icon-set_white.png) -252px 0px no-repeat;">	</div>	
						</div>	
					</div>
					<div title="Отключение датчика наклона" data-id="tilt_bpass" data-number="6" data-command="15" class="tilt_bpass control-button control-left1">
						<div class="control-push"></div>
						<div class="control-icon">
							<div class="control-icon-tilt_bpass" style="background:url(./widgets/starline/img/buttons-icon-set_white.png) -324px 0px no-repeat;"></div>
							</div>
					</div>
					<div title="Включить/выключить сервисный режим" data-id="valet" data-number="7" data-command="50" class="valet control-button control-circle">
						<div class="control-push"></div>
						<div class="control-icon">
					<div class="control-icon-valet" style="background:url(./widgets/starline/img/buttons-icon-set_white.png) -288px 0px no-repeat;"></div>
						</div>
					</div>
					<div title="Запрос координат" data-id="update_position" data-number="8" data-command="43" class="update_position control-button control-right1">
						<div class="control-push"></div>
						<div class="control-icon">
							<div class="control-icon-update_position" style="background:url(./widgets/starline/img/buttons-icon-set_white.png) no-repeat -360px 0px;"></div>
						</div>
					</div>	
					<div title="Активировать доп канал" data-id="add-command" data-number="9" data-command="0" class="add-command control-button control-right2">	
					<div class="control-push"></div>
						<div class="control-icon">
						<div class="control-icon-out" style="background:url(./widgets/starline/img/buttons-icon-set_white.png) no-repeat -180px 0px;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
    </div>
       <% vis.binds.starline.createWidgetControl(this.data.wid, this.view, this.data, this.style);%>
	</div>
</script>



<!-- --------------starline.html--- END -->
<!-- --------------swipe.html--- START -->
<style>
    .roundabout-holder {
        list-style: none;
        position: absolute;
        left:100px;
        top:10px;
        right: 0;
        margin: 0;
        overflow: visible;
        height: calc(100% - 20px);
        width: calc(100% - 200px);
    }

    .roundabout-moveable-item {
        text-align: center;
    }

    .li_carousel {
        background-color: rgba(0, 0, 0, 0);
        text-align: center;
        position: relative;
    }

    .carousel_blocking {
        position: relative;
        z-index: 149;
        width: 100%;
        height: 100%;
    }

    .roundabout-in-focus{
        z-index: 1000;
    }
</style>

<script type="text/javascript">
    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {
            "group_left":           {"en": "Swipe to left",     "de": "Swipe nach links",   "ru": "Сдвиг влево"},
            "left_nav_view":        {"en": "View name",         "de": "Viewname",           "ru": "Имя страницы"},
            "left_in_effect":       {"en": "In effect",         "de": "In-Effekt",          "ru": "In эффект"},
            "left_in_eff_opt":      {"en": "In options",        "de": "In-Optionen",        "ru": "In опции"},
            "left_out_effect":      {"en": "Out effect",        "de": "Out-Effekt",         "ru": "Out эффект"},
            "left_out_eff_opt":     {"en": "Out options",       "de": "Out-Optionen",       "ru": "Out опции"},
            "group_right":          {"en": "Swipe to right",    "de": "Swipe nach rechts",  "ru": "Сдвиг вправо"},
            "right_nav_view":       {"en": "View name",         "de": "Viewname",           "ru": "Имя страницы"},
            "right_in_effect":      {"en": "In effect",         "de": "In-Effekt",          "ru": "In эффект"},
            "right_in_eff_opt":     {"en": "In options",        "de": "In-Optionen",        "ru": "In опции"},
            "right_out_effect":     {"en": "Out effect",        "de": "Out-Effekt",         "ru": "Out эффект"},
            "right_out_eff_opt":    {"en": "Out options",       "de": "Out-Optionen",       "ru": "Out опции"},
            "Swipe Navigation":     {"en": "Swipe Navigation",  "de": "Swipe Navigation",   "ru": "Swipe навигация"}
        });
    }
    
    vis.binds.swipe = {
        loadedSwipe: false,
        loadedRound: false,
        loadSwipeScripts: function (cb) {
            if (vis.binds.swipe.loadedSwipe) {
                cb && cb();
            } else {
                vis.binds.swipe.loadedSwipe = true;
                $.ajax({
                    url: 'widgets/swipe/js/jquery.touchSwipe.min.js',
                    dataType: 'script',
                    success: function () {
                        cb && cb();
                    },
                    async: false
                });
            }
        },
        loadRoundScripts: function (cb) {
            if (vis.binds.swipe.loadedRound) {
                cb && cb();
            } else {
                vis.binds.swipe.loadedRound = true;
                $.ajax({
                    url: 'widgets/swipe/js/jquery.roundabout.min.js',
                    dataType: 'script',
                    success: function () {
                        jQuery.ajax({
                            url: 'widgets/swipe/js/jquery.roundabout-shapes.js',
                            dataType: 'script',
                            success: function () {
                                cb && cb();
                            },
                            async: false
                        });
                    },
                    async: false
                });
            }
        },
        swipeNav: function (wid, view, data, style) {
            var $div = $('#' + wid);
            // if nothing found => wait
            if (!$div.length) {
                setTimeout(function () {
                    vis.binds.swipe.swipeNav(wid, view, data, style);
                }, 100);
                return;
            }
            
            if (vis.editMode) {
                $div.show()
                    .find('.translate-it')
                        .each(function () {
                            $(this).html(_($(this).text()));
                        });
            }

            var $view = $('#visview_' + view);

            if (!vis.editMode) {
                vis.binds.swipe.loadSwipeScripts(function () {
                    $view.swipe({
                        swipeLeft: function () {
                            vis.changeView(data['left_nav_view'], data['left_nav_view'], {
                                effect: data['left_out_effect'],
                                options: {
                                    direction: data['left_out_eff_opt'],
                                    queue: false
                                }, duration: $div.attr('duration')
                            }, {
                                effect: data['left_in_effect'],
                                options: {direction: data['left_in_eff_opt'], queue: false},
                                duration: $div.attr('duration')
                            }, true)
                        },
                        swipeRight: function () {
                            vis.changeView(data['right_nav_view'], data['right_nav_view'], {
                                effect: data['right_out_effect'],
                                options: {direction: data['right_out_eff_opt'], queue: false},
                                duration: $div.attr('duration')
                            }, {
                                effect: data['right_in_effect'],
                                options: {direction: data['right_in_eff_opt'], queue: false},
                                duration: $div.attr('duration')
                            }, true)
                        }
                    });
                });
            }
        },
        applyCarousel: function ($div, childView) {
            var $childView = $div.find('#visview_' + childView);
            var count = $div.data('count');
            count = count || 0;

            if (!$childView.length) {
                count++;
                if (count > 20) {
                    return;
                }
                $div.data('count', count);
                setTimeout(function () {
                    vis.binds.swipe.applyCarousel($div, childView);
                }, 100);
                return;
            }
            var $all = $div.find('.vis-widget');
            $all.each(function () {
                var $id = $(this);
                var id = $id.attr('id');
                var idOldPos = $id.position();

                var $idAndChilds = $childView.children('[id^=' + id + ']');

                if ($idAndChilds.length === 1) {
                    $id.css({top: 0, left: 0});

                    $idAndChilds.wrapAll('<li id="li_' + id + '" class="li_carousel" ></li>');
                    $('#li_' + id).css({height: $id.css('height'), width: $id.css('width')});
                } else {
                    $idAndChilds.wrapAll('<div id="wrap_' + id + '" style="position: absolute; height: 50px; width: 50px; left: ' + (idOldPos.left * -1) + 'px; top:' + (idOldPos.top * -1) + 'px"></div>');
                    $('#wrap_' + id).wrap('<li id="li_' + id + '" class="li_carousel"></li>');
                    $('#li_' + id).css({height: $id.css('height'), width: $id.css('width')});
                }
            });

            $childView.children('.li_carousel').append('<div class="carousel_blocking"></div>');
            $childView.children('.li_carousel').wrapAll('<ul class="parent_carousel"></ul>');

            $childView.find('.parent_carousel')
                .bind('ready', function () {
                    var child = $('.roundabout-in-focus').children();
                    $(child[1]).removeClass('carousel_blocking');
                })
                .roundabout({
                    clickToFocus: true,
                    enableDrag: true,
                    dragFactor: 2,
                    minZ: 1,
                    maxZ: 100,
                    tilt: -4,
                    minOpacity: 0.2,
                    minScale: 1,
                    childSelector: '.li_carousel',
                    triggerFocusEvents: true,
                    triggerBlurEvents: true
                });

            $childView.find('.li_carousel')
                .bind('focus', function () {
                    var child = $(this).children();
                    $(child[1]).removeClass('carousel_blocking');
                    $(this).removeClass('roundabout-moveable-item')
                })
                .bind('blur', function () {
                    var child = $(this).children();
                    $(child[1]).addClass('carousel_blocking');
                    $(this).addClass('roundabout-moveable-item')
                });
        },
        carousel: function (wid, view, data, style) {
            var $div = $('#' + wid);
            var childView = data.contains_view;
            
            // if nothing found => wait
            if (!$div.length) {
                setTimeout(function () {
                    vis.binds.swipe.carousel(wid, view, data, style);
                }, 100);
                return;
            }

            if (view === data.contains_view) {
                $div.find('.vis-widget-body').attr('data-vis-contains', '');
                $div.html('<div style="color: red">' + _('Cannot show itself') + '</div>');
                return;
            }

            if (vis.editMode) return;

            vis.binds.swipe.loadRoundScripts(function () {
                vis.binds.swipe.applyCarousel($div, childView);
            });
        }
    };
</script>

<script id="tplSwipe"
        type="text/ejs"
        class="vis-tpl" 
        data-vis-set="swipe"
        data-vis-prev='<img src="widgets/swipe/img/Prev_Swipe.png"></img>'
        data-vis-name="swipe Navigation"
        data-vis-attrs="duration;"
        data-vis-attrs0="group.left;left_nav_view;left_in_effect[slide];left_in_eff_opt[right];left_out_effect[slide];left_out_eff_opt[left];"
        data-vis-attrs1="group.right;right_nav_view;right_in_effect[slide];right_in_eff_opt[left];right_out_effect[slide];right_out_eff_opt[right];">
    <div class="vis-widget <%== this.data.attr('class') %>" style="display: none; width: 160px; height: 64px; background-color: #333; color: #eee; border: 2px dashed red; opacity:0.8;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.swipe.swipeNav(this.data.wid, this.view, this.data, this.style) %>>
        <div class="vis-widget-body">
            <div style="font-weight: bold" class="translate-it">Swipe Navigation</div>
            <table>
                <tr><td style="width: 40px" class="translate-it">left</td><td style="width: 20px">&gt;</td><td><%= this.data.attr('left_nav_view') %></td></tr>
                <tr><td style="width: 40px" class="translate-it">right</td><td style="width: 20px">&lt;</td><td><%= this.data.attr('right_nav_view') %></td></tr>
            </table>
        </div>
    </div>
</script>


<script id="tplCarousel" 
        type="text/ejs"
        class="vis-tpl" 
        data-vis-set="swipe"
        data-vis-prev='<img src="widgets/swipe/img/Prev_Carousel.png"></img>'
        data-vis-name="Carousel"
        data-vis-attrs="contains_view/views">
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 300px; height: 100px;" id="<%= this.data.attr('wid') %>" <%= (el) -> vis.binds.swipe.carousel(this.data.wid, this.view, this.data, this.style) %>>
        <% if (vis.editMode) { %>
            <div class="editmode-helper" />
        <% } %>
        <div data-vis-contains="<%= this.data.attr('contains_view') %>" class="vis-widget-body vis-view-container"></div>
    </div>
</script>
<!-- --------------swipe.html--- END -->
<!-- --------------tabs.html--- START -->
<link rel="stylesheet" href="widgets/tabs/styles/jquery.sliderTabs.css">
<script src="widgets/tabs/jquery.sliderTabs.js"></script>
<script type="text/javascript">
    if (vis.editMode) {
        // Add words for widgets
        $.extend(true, systemDictionary, {
            "show_tabs":        {"en": "Tabs count",    "de": "Tabs-Anzahl",    "ru": "Количество закладок"},
            "title_tab_":       {"en": "Tab title",     "de": "Tab-Titel",      "ru": "Заголовок закладки"},
            "contains_view_":   {"en": "Contains view", "de": "View für Tab",   "ru": "Имя страницы"}
        });
    }

    vis.binds.tabs = {
        stabs: function (view, wid, data) {
            var $wid = $('#' + wid);
            var id = $wid.attr('id');
            if (id && id.match(/_removed$/)) {
                return;
            }

            if (!$wid.length) {
                return setTimeout(function () {
                    vis.binds.tabs.stabs(view, wid, data);
                }, 100);
            }
            // wait till widget will be visible
            if (!$wid.is(':visible')) {
                return setTimeout(function () {
                    vis.binds.tabs.stabs(view, wid, data);
                }, 1000);
            }

            $wid.find('.tabs-container').remove();
            var i;
            var text = '<span style="width: 100%; height: 100%" class="tabs-container">\n';
            text += '<ul>\n';

            data.show_tabs = parseInt(data.show_tabs, 10) || 1;

            for (i = 1; i <= data.show_tabs; i++) {
                text += '<li><a href="#' + wid + '_st' + i + '">' + (data['title_tab_' + i] || '') + '</a></li>';
            }
            text += '</ul>';

            for (i = 1; i <= data.show_tabs; i++) {
                text += '<div id="' + wid + '_st' + i + '" style="padding-left:0; height:100%">\n';
                if (vis.editMode) text += '    <div class="editmode-helper" />\n';
                text += '    <div data-vis-contains="' + (data['contains_view_' + i] || '') + '" class="vis-widget-body vis-view-container"></div>\n';
                text += '</div>\n';
            }
            text += '</span>';
            $wid.html(text);
            $wid.find('.tabs-container').sliderTabs({
                height: $wid.height() - 5
            });

            vis.updateContainers(view, view);

            if (vis.editMode && vis.activeWidgets.indexOf(wid) !== -1) {
                $wid.resizable('destroy');
                vis.resizable(vis.activeViewDiv, vis.activeView, $wid);
            }

            $wid.data('destroy', function (id, $widget) {
                try {
                    $widget.resizable('destroy');
                } catch (e) {

                }
            });
        }
    };
</script>

<script type="text/ejs" 
        id="tplSTab" 
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplSTab" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-selectee" style="top: 76px; left: 23px; width: 138px; height: 121px; position: absolute;" > <div class="vis-widget-prev-body"> <span style="width:100%;height:100%" class="ui-slider-tabs"> <!-- Unordered list representing the tabs --> <div class="ui-slider-tabs-list-wrapper"><div class="ui-slider-tabs-list-container" style="margin: 0px 35px;"><ul class="ui-slider-tabs-list" style="margin-left: 0px; width: 166px;"> <li class="selected" style="height: 32px;"><a href="#w00016_st1" style="height: 32px;">Tab</a></li><li style="height: 32px;"><a href="#w00016_st2" style="height: 32px;">Tab</a></li><li style="height: 32px;"><a href="#w00016_st3" style="height: 32px;">Tab</a></li></ul><a href="#" class="ui-slider-left-arrow edge" style="width: 35px; height: 32px;"><div></div></a><a href="#" class="ui-slider-right-arrow" style="width: 35px; height: 32px;"><div></div></a></div></div><div class="ui-slider-tabs-content-container" style="height: 86px;"><div style="padding-left: 0px; height: 100%; display: block; left: 0px; width: 126px;" class="ui-slider-tab-content selected"> <div class="editmode-helper"></div> <div data-vis-contains="hallo" class="vis-widget-body vis-view-container"></div> </div><div style="padding-left: 0px; height: 100%; left: 138px; width: 126px;" class="ui-slider-tab-content"> <div class="editmode-helper"></div> <div data-vis-contains="" class="vis-widget-body vis-view-container"></div> </div><div style="padding-left: 0px; height: 100%; left: 138px; width: 126px;" class="ui-slider-tab-content"> <div class="editmode-helper"></div> <div data-vis-contains="" class="vis-widget-body vis-view-container"></div> </div></div></span> </div> </div>'
        data-vis-set="tabs"
        data-vis-update-style="true"
        data-vis-name="SliderTabs" 
        data-vis-attrs="height[100]/slider,20,1000,1;show_tabs[1]/slider,1,8,1;title_tab_(1-show_tabs)[Tab];contains_view_(1-show_tabs)/views">
    <div class="vis-widget <%== this.data.attr('class') %>" style="top:0px; left: 0px; width: 250px; height: 250px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <% vis.binds.tabs.stabs(this.view, this.data.attr('wid'), data) %>
        </div>
    </div>
</script>

<!-- --------------tabs.html--- END -->
<!-- --------------timeandweather.html--- START -->
<!--
    ioBroker.vis time and weather Widget-Set

    version: "1.1.7"

    Copyright 2013-2017 bluefox<dogafox@gmail.com>
-->
<link rel="stylesheet" type="text/css" href="widgets/timeandweather/css/flipclock.css" />
<link rel="stylesheet" type="text/css" href="widgets/timeandweather/css/jquery.jdigiclock.css" />
<link rel="stylesheet" type="text/css" href="widgets/timeandweather/css/yahoo.css" />
<link rel="stylesheet" type="text/css" href="widgets/timeandweather/css/simpleclock.css" />
<script type="text/javascript" src="widgets/timeandweather/js/flipclock/flipclock.min.js"></script>
<script type="text/javascript" src="widgets/timeandweather/js/jquery.jdigiclock.js"></script>
<script type="text/javascript" src="widgets/timeandweather/js/jquery.zweatherfeed.js"></script>
<script type="text/javascript" src="widgets/timeandweather/js/coolclock.js"></script>
<script type="text/javascript" src="widgets/timeandweather/js/moreskins.js"></script>
<script type="text/javascript" src="widgets/timeandweather/js/segment-display.js"></script>

<script language="javascript">
    "use strict";

	// Add words for bars
    if (vis.editMode) {
        $.extend(systemDictionary, {
            "hideSeconds"      : {"en": "Hide seconds",         "de": "Zeige keine Sekunden",   "ru": "Скрыть секунды"},
            "blink"            : {"en": "Blink",                "de": "Blinken",                "ru": "Мигать"},
            "blink_tooltip"    : {
                "en" : "Used only if no seconds shown",
                "de":  "Wird nur aktiv, falls keine Sekunden angezeigt sind",
                "ru":  "Активно только если секунды не показываются"},
            "showWeekDay"      : {"en": "Show day of week",     "de": "Wochentag",              "ru": "День недели"},
            "noClass"          : {"en": "No style",             "de": "Kein Stil",              "ru": "Без стиля"},
            "noClass_tooltip"  : {
                "en" : "Activate it if you want to set own class or own style for clock with css settings",
                "de":  "Aktiviere es, falls eigenen Stil oder Klasse wird angeandt",
                "ru":  "Если установлены пользовательский класс или CSS свойства,\x0Aто нужно активировать, что бы они стали активными"
            },
            "woeid"            : {"en": "City",                 "de": "Stadt",                  "ru": "Город"},
            "shortWeekDay"     : {"en": "Short week day",       "de": "Kurzer Wochentag",       "ru": "Короткий день недели"},
            "shortYear"        : {"en": "Short year",           "de": "Kurzes Jahr",            "ru": "Короткий год"},
            "prependZero"      : {"en": "Prepend zero",         "de": "Null vorne",             "ru": "Ноль в начале"},
            "monthWord"        : {"en": "Month as word",        "de": "Monat als text",         "ru": "Месяц словом"},
            "shortMonth"       : {"en": "Short month",          "de": "Kurzer Monat",           "ru": "Короткий месяц"},
            "americanOrder"    : {"en": "American format",      "de": "USA-Format",             "ru": "Формат USA"},
            "City:"            : {"en": "City:",                "de": "Stadt:",                 "ru": "Город:"},
            "noSeconds"        : {"en": "Hide seconds",         "de": "Zeige keine Sekunden",   "ru": "Скрыть секунды"},
            "showDigital"      : {"en": "Digital clock",        "de": "Digitaluhr",             "ru": "Цифровые часы"},
            "Select city"      : {"en": "Select city",          "de": "Stadt wählen",           "ru": "Выбрать город"},
            "showAmPm"         : {"en": "Show am/pm",           "de": "Zeige am/pm",            "ru": "Показать am/pm"},
            "quadSize"         : {"en": "Quarter text size",    "de": "Viertel-Text-Größe",     "ru": "Размер чисел часа"},
            "quadColor"        : {"en": "Quarter text color",   "de": "Viertel-Text-Farbe",     "ru": "Цвет чисел часа"},
            "quadTickColor"    : {"en": "Quarter tick color",   "de": "Viertel-Tickfarbe",      "ru": "Цвет часовых штрихов"},
            "textSize"         : {"en": "Minutes text size",    "de": "Minutentextgroße",       "ru": "Размер минутных чисел"},
            "textColor"        : {"en": "Minutes text color",   "de": "Minutentextfarbe",       "ru": "Цвет минутных чисел"},
            "tickColor"        : {"en": "Small tick color",     "de": "Klein-Tickfarbe",        "ru": "Цвет минутных штрихов"},
            "isSeconds"        : {"en": "Show second hand",     "de": "Zeige Sekunden",         "ru": "Показать секунды"},
            "handsColor"       : {"en": "Hands color",          "de": "Zeigerfarbe",            "ru": "Цвет стрелок"},
            "handsColorLine"   : {"en": "Hands color bulge",    "de": "Zeigerbeulefarbe",       "ru": "Цвет выемок на стрелках"},
            "handsSecColor"    : {"en": "Seconds hand color",   "de": "Skeundenzeigerfarbe",    "ru": "Цвет секундной стрелки"},
            "textFont"         : {"en": "Text font",            "de": "Textschrift",            "ru": "Шрифт"},
            "cityName"         : {"en": "City name",            "de": "Stadtsname",             "ru": "Показывать имя города"},
            "language"         : {"en": "Language",             "de": "Sprache",                "ru": "Язык"},
            "SymmetricCorner"   : {"en": "symmetric",           "de": "symmetrisch",            "ru": "симметричные"},
            "FlattenedCorner"   : {"en": "flattened",           "de": "abgeflacht",             "ru": "плоские"},
            "PointedCorner"     : {"en": "pointed",             "de": "spitzig",                "ru": "заострённые"},
            "RoundedCorner"     : {"en": "rounded",             "de": "gerundet",               "ru": "закруглённые"},
            "group_clock"       : {"en": "Clock",               "de": "Uhr",                    "ru": "Часы"},
            "clock"             : {"en": "Enable clock",        "de": "Aktiviere Uhr",          "ru": "Активировть часы "},
            "clock_tooltip"     : {
                "en": "Clock is enabled only if no ObjectID and not text used.",
                "de": "Uhr sind nur dann aktiv, falls kein Objekt ID und kein Text definiert sind.",
                "ru": "Активно только,\x0Aесли не используется объект и текст"
            },
            "seconds"           : {"en": "Show seconds",        "de": "Sekunden",               "ru": "Показать секунды"},
            "pattern"           : {"en": "Pattern",             "de": "Vorlage",                "ru": "Шаблон"},
            "pattern_tooltip"   : {
                "en": "Use # as placeholder.\x0AAdditionally dot and semicolon canbe used.",
                "de": "Benutze # als Platzhalter.\x0APunkt und Semikolon können als Trennzeichen benutz werden.",
                "ru": "Используйте # там, где должен быть символ.\x0AЕщё можно использовать точку и двоеточие."
            },
            "colorOn"           : {"en": "Segment color ON",    "de": "Segmentfarbe AN",        "ru": "Цвет вкл. секции"},
            "colorOff"          : {"en": "Segment color OFF",   "de": "Segmentfarbe AUS",       "ru": "Цвет выкл. секции"},
            "runStepInterval"   : {"en": "Running text intervall(ms)", "de": "Interval für laufendem Text(ms)", "ru": "Интервал бегущего текста(мс)"},
            "segmentCount"      : {"en": "Segment count",       "de": "Anzahl Segmenten",       "ru": "Число секций"},
            "displayAngle"      : {"en": "Display angle",       "de": "Zeichenwinkel",          "ru": "Наклон °"},
            "digitHeight"       : {"en": "Digit height",        "de": "Zeichenhöhe",            "ru": "Высота числа"},
            "digitWidth"        : {"en": "Digit width",         "de": "Zeichebreite",           "ru": "Ширина числа"},
            "digitDistance"     : {"en": "Digit distance",      "de": "Zeichenabstand",         "ru": "Расстояние между числами"},
            "segmentWidth"      : {"en": "Segment width",       "de": "Segmentbreite",          "ru": "Ширина секции"},
            "segmentDistance"   : {"en": "Segment distance",    "de": "Segmentdistanz",         "ru": "Расстояние между секциями"},
            "cornerType"        : {"en": "Corners type",        "de": "Ecktyp",                 "ru": "Тип закруглений"},
            "en"                : {"en": "english",             "de": "englisch",               "ru": "английский"},
            "de"                : {"en": "german",              "de": "deutsch",                "ru": "немецкий"},
            "ru"                : {"en": "russian",             "de": "russisch",               "ru": "русский"},
            "city":               {"en": "City",                "de": "Stadt",                  "ru": "Город"},
            "group_now":             {"en": "Now",                "de": "Jetzt",                "ru": "Сейчас"},
            "updateInterval":        {"en": "Update interval[min]", "de": "Updateintervalle[min]", "ru": "Обновление в минутах"},
            "temperature-0-oid":     {"en": "Temperature ID",     "de": "Temperature ID",       "ru": "Температура ID"},
            "condition-0-oid":       {"en": "Condition ID",       "de": "Text ID",              "ru": "Текст ID"},
            "humidity-0-oid":        {"en": "Humidity ID",        "de": "Luftfeutigkeit ID",    "ru": "Влажность ID"},
            "temperature-min-0-oid": {"en": "Min temperature ID", "de": "Min Temperature ID",   "ru": "Мин. температура ID"},
            "temperature-max-0-oid": {"en": "Max temperature ID", "de": "Max Temperature ID",   "ru": "Макс. температура ID"},
            "wind-speed-0-oid":      {"en": "Wind speed ID",      "de": "Windgeschwindigkeit",  "ru": "Скорсть ветра ID"},
            "wind-dir-0-oid":        {"en": "Wind direction ID",  "de": "Windrichting",         "ru": "Направление ветра ID"},
            "icon-0-oid":            {"en": "Icon URL ID",        "de": "Bild-URL ID",          "ru": "URL картинки"},
            "group_tomorrow":        {"en": "Tomorrow",           "de": "Morgen",               "ru": "Завтра"},
            "condition-1-oid":       {"en": "Condition ID",       "de": "Text ID",              "ru": "Текст ID"},
            "temperature-max-1-oid": {"en": "Max temperature ID", "de": "Max Temperature ID",   "ru": "Макс. температура ID"},
            "temperature-min-1-oid": {"en": "Min temperature ID", "de": "Min Temperature ID",   "ru": "Мин. температура ID"},
            "icon-1-oid":            {"en": "Icon URL ID",        "de": "Bild-URL ID",          "ru": "URL картинки ID"},
            "group_aftertomorrow":   {"en": "group_aftertomorrow", "de": "Übermorgen",          "ru": "Послезавтра"},
            "condition-2-oid":       {"en": "Condition ID",       "de": "Text ID",              "ru": "Текст ID"},
            "temperature-max-2-oid": {"en": "Max temperature ID", "de": "Max Temperature ID",   "ru": "Макс. температура ID"},
            "temperature-min-2-oid": {"en": "Min temperature ID", "de": "Min Temperature ID",   "ru": "Мин. температура ID"},
            "icon-2-oid":            {"en": "Icon URL ID",        "de": "Bild-URL ID",          "ru": "URL картинки ID"},
            "group_in2days":         {"en": "In 2 days",          "de": "In 2 Tagen",           "ru": "Через 2 дня"},
            "condition-3-oid":       {"en": "Condition ID",       "de": "Text ID",              "ru": "Текст ID"},
            "temperature-max-3-oid": {"en": "Max temperature ID", "de": "Max Temperature ID",   "ru": "Макс. температура"},
            "temperature-min-3-oid": {"en": "Min temperature ID", "de": "Min Temperature ID",   "ru": "Мин. температура"},
            "icon-3-oid":            {"en": "Icon URL ID",        "de": "Bild-URL ID",          "ru": "URL картинки"},
            "group_in3days":         {"en": "In 3 days",          "de": "In 3 Tagen",           "ru": "Через 3 дня"},
            "condition-4-oid":       {"en": "Condition ID",       "de": "Text ID",              "ru": "Текст ID"},
            "temperature-max-4-oid": {"en": "Max temperature ID", "de": "Max Temperature ID",   "ru": "Макс. температура ID"},
            "temperature-min-4-oid": {"en": "Min temperature ID", "de": "Min Temperature ID",   "ru": "Мин. температура ID"},
            "icon-4-oid":            {"en": "Icon URL ID",        "de": "Bild-URL ID",          "ru": "URL картинки ID"},
            "group_in4days":         {"en": "In 4 days",          "de": "In 4 Tagen",           "ru": "Через 4 дня"},
            "condition-5-oid":       {"en": "Condition ID",       "de": "Text ID",              "ru": "Текст ID"},
            "temperature-max-5-oid": {"en": "Max temperature ID", "de": "Max Temperature ID",   "ru": "Макс. температура ID"},
            "temperature-min-5-oid": {"en": "Min temperature ID", "de": "Min Temperature ID",   "ru": "Мин. температура ID"},
            "icon-5-oid":            {"en": "Icon URL ID",        "de": "Bild-URL ID",          "ru": "URL картинки ID"},
            "group_in5days":         {"en": "In 5 days",          "de": "In 5 Tagen",           "ru": "Через 5 дней"},
            "condition-6-oid":       {"en": "Condition ID",       "de": "Text ID",              "ru": "Текст ID"},
            "temperature-max-6-oid": {"en": "Max temperature ID", "de": "Max Temperature ID",   "ru": "Макс. температура ID"},
            "temperature-min-6-oid": {"en": "Min temperature ID", "de": "Min Temperature ID",   "ru": "Мин. температура ID"},
            "icon-6-oid":            {"en": "Icon URL ID",        "de": "Bild-URL ID",          "ru": "URL картинки ID"},
            "units_speed":           {"en": "Speed units",        "de": "Geschw.Einheit",       "ru": "Единицы изм. скорости"},
            "maxDays":               {"en": "Show max. days",     "de": "Max. Tagesanzahl",     "ru": "Макс. кол-во дней"}
        });
    }

    vis.binds.timeandweather = {
 	    version: "1.1.7",
		showVersion: function () {
			if (vis.binds.timeandweather.version) {
				console.log('Version vis-timeandweather: ' + vis.binds.timeandweather.version);
				vis.binds.timeandweather.version = null;
			}
		},
		startTime: function (view, elem, hideSeconds, blink, noClass, timerId) {
            var today = new Date();
            var h = today.getHours();
            var m = today.getMinutes();
            var s = today.getSeconds();

            // add a zero in front of numbers<10
            m = (m < 10) ? ('0' + m) : m;
            if (!hideSeconds) s = (s < 10) ? ('0' + s) : s;
            h = (h < 10) ? ('0' + h) : h;
            var hl = document.getElementById(elem);

            if (hideSeconds === 'false') hideSeconds = false;

            if (!hl) {
                $('#visview_' + view).append('<div class="vis-widget' + (noClass ? '' : ' clock') + '" id="' + elem + '" ></div>');
                hl = document.getElementById(elem);
                // View deleted
                if (!hl) return;
                hl.dashId = today.getTime();
            }
            if (hl && (timerId === undefined || hl.dashId == timerId)) {
                if (hideSeconds) {
                    hl.innerHTML = h + '<span style="display: inline-block" id="' + elem + '_space">:</span>' + m;
                    if (blink && (s % 2)) {
                        var r = $('#' + elem + '_space');
                        var w = r.width();
                        r.css({width: w});
                        r.html("");
                    }
                } else {
                    hl.innerHTML = h + ":" + m + ":" + s;
                }
                hl.dashTimer = _setTimeout(vis.binds.timeandweather.startTime, 1000, view, elem, hideSeconds, blink, noClass, hl.dashId);
            }
        },
        weekdays: {
            0: {"en": "Sunday",   "de": "Sonntag",    "ru": "Воскресенье"},
            1: {"en": "Monday",   "de": "Montag",     "ru": "Понедельник"},
            2: {"en": "Tuesday",  "de": "Dienstag",   "ru": "Вторник"},
            3: {"en": "Wednesday","de": "Mittwoch",   "ru": "Среда"},
            4: {"en": "Thursday", "de": "Donnerstag", "ru": "Четверг"},
            5: {"en": "Friday",   "de": "Freitag",    "ru": "Пятница"},
            6: {"en": "Saturday", "de": "Samstag",    "ru": "Суббота"}
        },
        weekdaysShort: {
            0: {"en": "Sun", "de": "So", "ru": "Вс"},
            1: {"en": "Mon", "de": "Mo", "ru": "Пн"},
            2: {"en": "Tue", "de": "Di", "ru": "Вт"},
            3: {"en": "Wed", "de": "Mi", "ru": "Ср"},
            4: {"en": "Thu", "de": "Do", "ru": "Чт"},
            5: {"en": "Fri", "de": "Fr", "ru": "Пт"},
            6: {"en": "Sat", "de": "Sa", "ru": "Сб"}
        },
        months: {
            1: {"en": "January",    "de": "Januar",     "ru": "Январь"},
            2: {"en": "February",   "de": "Februar",    "ru": "Февраль"},
            3: {"en": "March",      "de": "März",       "ru": "Март"},
            4: {"en": "April",      "de": "April",      "ru": "Апрель"},
            5: {"en": "May",        "de": "Mai",        "ru": "Май"},
            6: {"en": "June",       "de": "Juni",       "ru": "Июнь"},
            7: {"en": "July",       "de": "Juli",       "ru": "Июль"},
            8: {"en": "August",     "de": "August",     "ru": "Август"},
            9: {"en": "September",  "de": "September",  "ru": "Сентябрь"},
            10: {"en": "October",   "de": "Oktober",    "ru": "Октябрь"},
            11: {"en": "November",  "de": "November",   "ru": "Ноябрь"},
            12: {"en": "December",  "de": "Dezember",   "ru": "Декабрь"}
        },
        startDate: function (view, elem, showWeekDay, noClass, timerId, shortWeekDay, shortYear, prependZero, monthWord, shortMonth, american) {
            var today = new Date();
            var d = today.getDate();
            var dow = today.getDay();
            var m = today.getMonth() + 1;
            var y = today.getFullYear();

            var monthString = vis.binds.timeandweather.months[m][vis.language];
            if (shortMonth) monthString = monthString.slice(0, 3);

            if (shortYear) y = y.toString().slice(2);

            // add a zero in front of numbers<10
            if (prependZero) d = (d < 10) ? ('0' + d) : d;
            if (prependZero) m = (m < 10) ? ('0' + m) : m;

            if (showWeekDay === 'false') showWeekDay = false;

            var $hl = $('#' + elem);
            if (!$hl.length) {
                $('#visview_' + view).append('<div class="vis-widget' + (noClass ? '' : ' date') + '" id="' + elem + '" ></div>');
                $hl = $('#' + elem);
                $hl.data('dashId', (new Date()).getTime());
            }

            if ($hl.length && (timerId === undefined || $hl.data('dashId') == timerId)) {
                var dateString = '';
                if (showWeekDay && !shortWeekDay) {
                    dateString += vis.binds.timeandweather.weekdays[dow][vis.language] + ', ';
                } else if (showWeekDay && shortWeekDay) {
                    dateString += vis.binds.timeandweather.weekdaysShort[dow][vis.language] + ', ';
                }

                if (monthWord) {
                    switch (vis.language) {
                        case 'en':
                            switch (d) {
                                case 1:
                                    d += 'st';
                                    break;
                                case 2:
                                    d += 'nd';
                                    break;
                                case 3:
                                    d += 'rd';
                                    break;
                                default:
                                    d += 'th';
                            }

                            if (american) {
                                dateString += monthString + " " + d + ", " + y;
                            } else {
                                dateString += d + " " + monthString + ", " + y;
                            }

                            break;
                        default:
                            dateString += d + ". " + monthString + " " + y;
                    }
                } else {
                    switch (vis.language) {
                        case 'en':
                            if (american) {
                                dateString += m + "/" + d + "/" + y;
                            } else {
                                dateString += d + "/" + m + "/" + y;
                            }

                            break;
                        default:
                            dateString += d + "." + m + "." + y;
                    }
                }

                $hl.html(dateString);
                $hl.data('dashTimer', _setTimeout(vis.binds.timeandweather.startDate, (24 * 3600 - (today.getHours() * 60 * 60 + today.getMinutes() * 60 + today.getSeconds())) * 1000, view, elem, showWeekDay, noClass, $hl.data('dashId'), shortWeekDay, shortYear, prependZero, monthWord, shortMonth, american));
            }
        },
        tplTwCoolClock: function (view, data) {
 			vis.binds.timeandweather.showVersion();
            var style;
            var wid = data.attr('wid');
            if (vis.views[view] &&
                    vis.views[view].widgets[wid] &&
                    vis.views[view].widgets[wid].style) {
                style = vis.views[view].widgets[wid].style;
            }
            style = style || {};
            style.width = parseInt(style.width) || 85;
            style.height = parseInt(style.height) || 85;
            var radius = parseInt(style.width) || 85;
            if (vis.views[view].widgets[wid]) {
                vis.views[view].widgets[wid].style = style;
            }

            // Take the smallest value
            if (style.height < radius) radius = style.height;
            radius = Math.round(radius / 2);
            var myClass = 'CoolClock:' + (data.attr('theme') || 'classic') + ':' + radius + ':' + (data.attr('noSeconds') ? 'noSeconds' : '') + '::' + (data.attr('showDigital') ? 'showDigital' : '') + '::' + (data.attr('showAmPm') ? 'showAmPm' : '');

            var text = '<div id="' + data.attr('wid') + '" data-myclass="' + myClass + '" style="width: ' + style.width + '; height: ' + style.height + 'px" class="vis-widget"><canvas width="' + style.width + '" height="' + style.height + '"class="' + myClass + '"></canvas></div>';
            $('#visview_' + view).append(text);

            if (vis.editMode) {
                $('#' + data.attr('wid')).bind('resize', function () {
                    var t = $(this);
                    var myClass = t.attr('data-myclass');
                    var myClasses = myClass.split(':');
                    myClasses[2] = t.width();

                    if (t.height() < myClasses[2]) myClasses[2] = t.height();

                    myClasses[2] = Math.round(myClasses[2] / 2);
                    myClass = myClasses.join(':');
                    t.html('<canvas class="' + myClass + '"></canvas>');
                    CoolClock.findAndCreateClocks();
                });
            }
            CoolClock.findAndCreateClocks();
        },
        tplTwFlipClock: function (view, data) {
 			vis.binds.timeandweather.showVersion();
            var text = '<div class="vis-widget" style="width: 500px; height: 110px" id="' + data.attr('wid') + '" data-vis-resizable=';
            text += "'" + '{"disabled":true}' + "'></div>";
            $('#visview_' + view).append(text);
            var clock = $('#' + data.attr('wid')).FlipClock({clockFace: 'TwentyFourHourClock'});
        },
        tplTwHtcWeather: function (view, data) {
 			vis.binds.timeandweather.showVersion();
            var text = '<div class="vis-widget" style="width: 500px; height: 420px" id="' + data.attr('wid') + '" data-vis-resizable=';
            text += "'" + '{"disabled":true}' + "'></div>";
            $('#visview_' + view).append(text);
            var woeid = data.attr('woeid') || data.attr('weoid');
            if (woeid !== undefined && woeid !== null) {
                var i = woeid.indexOf('[');
                if (i != -1) {
                    woeid = woeid.substring(i + 1);
                    i     = woeid.indexOf(']');
                    woeid = woeid.substring(0, i);
                }
            } else {
                woeid = '664942';
            }
            var updateInterval = data.attr('updateInterval');
            if (updateInterval === '' || updateInterval === null || updateInterval === undefined) {
                updateInterval = 180;
            } else {
                updateInterval = parseInt(data.attr('updateInterval'), 10);
            }

            var clock = $('#' + data.attr('wid')).jdigiclock({
                weatherLocationCode: woeid,
                city:                data.attr('cityName'),
                weatherUpdate:       updateInterval,
                lang:                data.attr('language') || vis.language,
                clockImagesPath:     'widgets/timeandweather/img/clock/'
            });
        },
        tplTwYahooWeather: function (view, data) {
 			vis.binds.timeandweather.showVersion();
            var text = '<div class="vis-widget ui-widget-content" id="' + data.attr('wid') + '" style="width:250px; height: 500px; color: #ddd"></div>';
            $('#visview_' + view).append(text);
            var woeid = data.attr('woeid') || data.attr('weoid');
            if (woeid !== undefined && woeid !== null) {
                var i = woeid.indexOf('[');
                if (i != -1) {
                    woeid = woeid.substring(i + 1);
                    i     = woeid.indexOf(']');
                    woeid = woeid.substring(0, i);
                }
            }
            else {
                woeid = '664942';
            }
            var updateInterval = data.attr('updateInterval');
            if (updateInterval === '' || updateInterval === null || updateInterval === undefined) {
                updateInterval = 180;
            } else {
                updateInterval = parseInt(data.attr('updateInterval'), 10);
            }
            $('#' + data.attr('wid')).weatherfeed([woeid], {
                lang:       data.attr('language') || vis.language,
                woeid:      true,
                city:       data.attr('cityName'),
                humidity:   true,
                forecast:   true,
                link:       false,
                maxDays:    data.attr('maxDays'),
                update:     updateInterval,
                resizable:  false,
                rendered:   function () {
                    if (vis.editMode && vis.activeWidgets.indexOf(data.attr('wid')) != -1) {
                        vis.resizable($('#' + data.attr('wid')).resizable('destroy'));
                    }
                }
            });
        },
        getValue: function (oidOrBinding) {
            if (!oidOrBinding) return '';

            if (oidOrBinding[0] === '{') {
                return vis.formatBinding(oidOrBinding);
            } else {
                var val = vis.states.attr(oidOrBinding + '.val');
                if (val === undefined || val === null) return '';
                if (val === 'null') return '';
                return val;
            }
        },
        updateCustomWeather: function (data) {
            var getValue = vis.binds.timeandweather.getValue;
            var weather = {
                units: {
                    pressure:     data.units_pressure   || 'mb',
                    speed:        data.units_speed      || 'km/h',
                    temperature:  data.units_temp       || 'C'
                },
                location: {
                    city: data.city || ''
                },
                wind: {
                    direction:  getValue(data['wind-dir-0-oid']),
                    speed:      getValue(data['wind-speed-0-oid'])
                },
                atmosphere: {
                    humidity: getValue(data['humidity-0-oid'])
                },
                image: {
                    url: 'http://l.yimg.com/a/i/brand/purplelogo//uh/us/news-wea.gif'
                },
                item: {
                    condition: {
                        temp: getValue(data['temperature-0-oid']),
                        text: getValue(data['condition-0-oid']),
                        icon: getValue(data['icon-0-oid'])
                    },
                    forecast: [
                        {
                            high: getValue(data['temperature-max-0-oid']),
                            low:  getValue(data['temperature-min-0-oid']),
                            text: getValue(data['condition-0-oid'])
                        },
                        {
                            high: getValue(data['temperature-max-1-oid']),
                            low:  getValue(data['temperature-min-1-oid']),
                            text: getValue(data['condition-1-oid'])
                        },
                        {
                            high: getValue(data['temperature-max-2-oid']),
                            low:  getValue(data['temperature-min-2-oid']),
                            text: getValue(data['condition-2-oid'])
                        },
                        {
                            high: getValue(data['temperature-max-3-oid']),
                            low:  getValue(data['temperature-min-3-oid']),
                            text: getValue(data['condition-3-oid'])
                        },
                        {
                            high: getValue(data['temperature-max-4-oid']),
                            low:  getValue(data['temperature-min-4-oid']),
                            text: getValue(data['condition-4-oid'])
                        },
                        {
                            high: getValue(data['temperature-max-5-oid']),
                            low:  getValue(data['temperature-min-5-oid']),
                            text: getValue(data['condition-5-oid'])
                        },
                        {
                            high: getValue(data['temperature-max-6-oid']),
                            low:  getValue(data['temperature-min-6-oid']),
                            text: getValue(data['condition-6-oid'])
                        }
                    ]
                }
            };

            if (weather.atmosphere.humidity === '' || weather.atmosphere.humidity === 'null') weather.atmosphere.humidity = null;
            if (weather.wind.direction      === '' || weather.wind.direction      === 'null') weather.wind.direction      = null;
            if (weather.wind.speed          === '' || weather.wind.speed          === 'null') weather.wind.speed          = null;

            for (var i = 0; i < weather.item.forecast.length; i++) {
                if (weather.item.forecast[i].high === null &&
                    weather.item.forecast[i].low  === null &&
                    weather.item.forecast[i].text === null) {
                    weather.item.forecast.splice(i, weather.item.forecast.length - i);
                    break;
                }
                if (weather.item.forecast[i].high === '' &&
                    weather.item.forecast[i].low  === '' &&
                    weather.item.forecast[i].text === '') {
                    weather.item.forecast.splice(i, weather.item.forecast.length - i);
                    break;
                }
            }

            $('#' + data.wid).weatherfeed('', 'update', weather);
            /*$('#' + data.wid).weatherfeed('', 'update', {
                "units": {
                    "distance": "km",
                            "pressure": "mb",
                            "speed": "km/h",
                            "temperature": "C"
                },
                "location": {
                    "city": "Karlsruhe"
                },
                "wind": {
                    "chill": "66",
                    "direction": "255",
                    "speed": "11.27"
                },
                "atmosphere": {
                    "humidity": "71"
                },
                "image": {
                    "url": "http://l.yimg.com/a/i/brand/purplelogo//uh/us/news-wea.gif"
                },
                "item": {
                    "condition": {
                        "code": "26",
                                "temp": "19",
                                "text": "Cloudy"
                    },
                    "forecast": [
                        {
                            "code": "12",
                            "high": "20",
                            "low": "14",
                            "text": "Rain"
                        },
                        {
                            "code": "39",
                            "high": "21",
                            "low": "13",
                            "text": "Scattered Showers"
                        },
                        {
                            "code": "4",
                            "high": "22",
                            "low": "15",
                            "text": "Thunderstorms"
                        },
                        {
                            "code": "28",
                            "high": "23",
                            "low": "13",
                            "text": "Mostly Cloudy"
                        },
                        {
                            "code": "4",
                            "high": "24",
                            "low": "15",
                            "text": "Thunderstorms"
                        },
                        {
                            "code": "47",
                            "high": "23",
                            "low": "16",
                            "text": "Scattered Thunderstorms"
                        },
                        {
                            "code": "30",
                            "high": "23",
                            "low": "16",
                            "text": "Partly Cloudy"
                        }
                    ]
                }
            });*/
        },
        tplTwCustomWeather: function (view, data) {
            vis.binds.timeandweather.showVersion();
            var text = '<div class="vis-widget ui-widget-content" id="' + data.attr('wid') + '" style="width: 250px; height: 500px; color: #ddd"></div>';
            $('#visview_' + view).append(text);

            $('#' + data.attr('wid')).weatherfeed('', {
                lang:       data.attr('language') || vis.language,
                custom:     true,
                city:       data.attr('city'),
                humidity:   true,
                forecast:   true,
                link:       false,
                resizable:  false
            });

            for (var attr in data) {
                if (data.hasOwnProperty(attr)) {
                    if (attr.match(/-oid$/) && data[attr]) {
                        if (data[attr][0] === '{') {
                            var oids = vis.extractBinding(data[attr]);
                            for (var oid = 0; oid < oids.length; oid++) {
                                vis.states.bind(oids[oid].visOid + '.val', function () {
                                    vis.binds.timeandweather.updateCustomWeather(data);
                                });
                            }
                        } else {
                            vis.states.bind(data[attr] + '.val', function () {
                                vis.binds.timeandweather.updateCustomWeather(data);
                            });
                        }
                    }
                }
            }

            vis.binds.timeandweather.updateCustomWeather(data);
        },
        createSvgClock: function (options, el) {
            var quadSize       = options.quadSize || 60;
            var quadColor      = options.quadColor || '#333';
            var quadTickColor  = options.quadTickColor || '#333';
            var textSize       = options.textSize || 30;
            var textColor      = options.textColor || '#555';
            var tickColor      = options.tickColor || '#555';
            var isSeconds      = options.isSeconds || false;
            var handsColor     = options.handsColor || '#111';
            var handsColorLine = options.handsColorLine || '#666';
            var handsSecColor  = options.handsSecColor || '#be5639';
            var textFont       = options.textFont || 'verdana, sans-serif';
            var $el            = $(el);

            var html = '<svg viewbox="-450 -450 900 900" class="svg--clock" style="display: block;min-width: 5em;min-height: 5em;width: 100%;height: 100%;">';
            html += '  <defs>';
            html += '    <line  vector-effect="non-scaling-stroke" id="mark--major" y1="28.8" style="stroke-width: 7;stroke: ' + quadTickColor + '"></line>';
            html += '    <line  vector-effect="non-scaling-stroke" id="mark--minor" y1="14.4" style="stroke-width: 2;stroke: ' + tickColor + '"></line>';
            html += '    <circle  vector-effect="non-scaling-stroke" class="svg--cc" r="360"></circle>';
            html += '  </defs>';
            html += '  <g class="svg--ticks"  vector-effect="non-scaling-stroke"></g>';
            html += '  <g id="hands">';
            html += '    <g class="hand--h" style="stroke-linecap: round;stroke-width: 7;stroke: ' + handsColor + '">';
            html += '      <line vector-effect="non-scaling-stroke" y2="-234"></line>';
            html += '      <line vector-effect="non-scaling-stroke" y1="-136.8" y2="-205.2" style="stroke-width: 3;stroke: ' + handsColorLine + '"></line>';
            html += '    </g>';
            html += '    <g transform="rotate(25)" class="hand--m" style="stroke-linecap: round;stroke-width: 5;stroke: ' + handsColor + '">';
            html += '      <line vector-effect="non-scaling-stroke" y2="-298.8"></line>';
            html += '      <line vector-effect="non-scaling-stroke" y1="-201.60000000000002" y2="-270" style="stroke-width: 3;stroke: ' + handsColorLine + '"></line>';
            html += '    </g>';
            html += '    <g transform="rotate(60)" class="hand--s" style="stroke-width: 2;stroke: ' + handsSecColor + '">';
            html += '      <line vector-effect="non-scaling-stroke" y1="36" y2="-342"></line>';
            html += '    </g>';
            html += '    <g>';
            html += '      <circle vector-effect="non-scaling-stroke" r="14.4" style="fill: #e18728;"></circle>';
            html += '      <circle vector-effect="non-scaling-stroke" r="7.2"  style="fill: #e0a197;"></circle>';
            html += '    </g>';
            html += '  </g>';
            html += '</svg>';

            $el.find('svg').remove();

            if (!$el.find('svg').length) $el.append(html);

            /* because IE */
            Math.sign = Math.sign || function (x) {
                x = +x; // convert to a number
                if (x === 0 || isNaN(x)) {
                    return x;
                }
                return x > 0 ? 1 : -1;
            };

            /* because me lazy */
            Object.getOwnPropertyNames(Math).map(function (p) {
                window[p] = Math[p];
            });

            Node.prototype.setAttrs = function (attr_obj) {
                for (var prop in attr_obj) {
                    this.setAttribute(prop, attr_obj[prop]);
                }
            };

            var NS_URI = 'http://www.w3.org/2000/svg',
                    XLink_NS = 'http://www.w3.org/1999/xlink',

                    ns = 60,
                    mi = 5,
                    qi = .25 * ns,
                    r = ~~$el.find('.svg--cc')[0].getAttribute('r'),
                    svg = $el.find('svg')[0],
                    wrap = $el.find('.svg--ticks')[0],
                    h_el = $el.find('.hand--h')[0],
                    m_el = $el.find('.hand--m')[0],
                    s_el = $el.find('.hand--s')[0],
                    h_max = 12, h_deg = 360 / h_max,
                    m_max = 60, m_deg = 360 / m_max,
                    s_max = 60, s_deg = 360 / s_max,
                    prev_s;

            var init = function () {
                var frag = document.createDocumentFragment(),
                        curr_tick_group, curr_tick, text1, text2,
                        is_major, is_quad, ref,
                        curr_angle, base_angle = 360 / ns;

                if (!isSeconds) s_el.setAttribute('style', 'display: none');
                for (var i = 0; i < ns; i++) {
                    is_major = (i % mi === 0);
                    is_quad = (i % qi === 0);

                    ref = '#mark--' + (is_major ? 'major' : 'minor');
                    curr_angle = i * base_angle;

                    curr_tick_group = document.createElementNS(NS_URI, 'g');
                    curr_tick = document.createElementNS(NS_URI, 'use');
                    curr_tick.setAttributeNS(XLink_NS, 'xlink:href', ref);

                    curr_tick.setAttribute(
                            'transform',
                                    'rotate(' + curr_angle + ')' +
                                    'translate(0 -' + r + ')'
                    );

                    if (is_major) {
                        curr_tick.setAttribute('class', 'major');

                        text1 = document.createElementNS(NS_URI, 'text');
                        text1.textContent = i;

                        text1.setAttribute(
                                'transform',
                                        'rotate(' + curr_angle + ')' +
                                        'translate(0 -' + 1.05 * r + ')' +
                                        'rotate(' + -curr_angle + ')'
                        );
                        curr_tick_group.appendChild(text1);
                        text1.setAttribute('style', 'dominant-baseline: middle;text-anchor: middle;fill: ' + textColor + '; font: ' + textSize + 'px ' + textFont);

                        if (is_quad) {
                            curr_tick.setAttribute('class', 'major quad');

                            text2 = document.createElementNS(NS_URI, 'text');
                            text2.textContent = (i / mi) || 12;

                            text2.setAttrs({
                                'class': 'quad',
                                'transform': 'rotate(' + curr_angle + ')' +
                                        'translate(0 -' + .8 * r + ')' +
                                        'rotate(' + -curr_angle + ')'
                            });
                            text2.setAttribute('style', 'dominant-baseline: middle;text-anchor: middle;fill: ' + quadColor + '; font: 700 ' + quadSize + 'px ' + textFont);
                            curr_tick_group.appendChild(text2);
                        }
                    }

                    curr_tick_group.appendChild(curr_tick);
                    frag.appendChild(curr_tick_group);
                }

                wrap.appendChild(frag);

                run();
                setInterval(function () {
                    requestAnimationFrame(run);
                }, 500);

            };

            var run = function () {
                var t = new Date(),
                        h = t.getHours(), curr_s_deg,
                        m = t.getMinutes(), curr_m_deg,
                        s = t.getSeconds(), curr_h_deg;

                curr_s_deg = (s % s_max) * s_deg;

                if (s != prev_s) {
                    curr_s_deg = (s % s_max) * s_deg;
                    if (isSeconds) {
                        s_el.setAttribute(
                                'transform',
                                        'rotate(' + curr_s_deg + ')'
                        );
                    }

                    curr_m_deg = ((m % m_max) + s / s_max) * m_deg;
                    m_el.setAttribute(
                            'transform',
                                    'rotate(' + curr_m_deg + ')'
                    );

                    curr_h_deg = ((h % h_max) + m / m_max) * h_deg;
                    h_el.setAttribute(
                            'transform',
                                    'rotate(' + curr_h_deg + ')'
                    );
                }

                prev_s = s;

            };

            init();
        },
        tplSvgClock: function (el, data) {
 			vis.binds.timeandweather.showVersion();

            setTimeout(function () {
                vis.binds.timeandweather.createSvgClock(data, el[0]);
            }, 100);
        },
        tplSegmentClock: function (el, data) {
 			vis.binds.timeandweather.showVersion();

            function writeTime(_el, display) {
                var d = new Date();
                var h = d.getHours();
                if (h < 10) h = '0' + h;
                var m = d.getMinutes();
                if (m < 10) m = '0' + m;
                var s = d.getSeconds();
                if (s < 10) s = '0' + s;
                var time = h + ':' + m;
                if (data.seconds && data.seconds !== 'false') time += ':' + s;
                if (vis.editMode || _el.data('val') != time) {
                    _el.data('val', time);
                    display.setValue(time);
                }
            }
            function runText(_el, _display, interval) {
                var $display = $('#' + _display.displayId);

                var val = _el.data('value');
                var len = val.length;
                if (!val) return;
                var step = _el.data('step') || 0;

                if (step < 0) {
                    val = new Array(-step + 1).join(' ') + val.substring(0, _display.pattern.length + step);
                } else {
                    val = val.substring(step);
                }
                if (step >= len) {
                    step = -(_display.pattern.length - 1);
                } else {
                    step++;
                }
                _el.data('step', step);
                _display.setValue(val);

                if (!_el.data('timerId')) {
                    var timerId = Math.round(Math.random() * 100000) + 1;
                    var timer = setInterval(function () {
                        if (_el.data('timerId') != timerId) {
                            clearInterval(timer);
                            return;
                        }
                        runText(_el, _display, interval);
                    }, interval)
                    _el.data('timerId', timerId);
                }
            }
            setTimeout(function () {
                el.append('<canvas id="' + data.attr('wid') + '_clock" width="'  + el.width() + '" height="'  + el.height() + '"></canvas>');
                var display = new SegmentDisplay(data.attr('wid') + '_clock');
                display.pattern         = data.pattern || "##:##:##";
                if (display.pattern == "##:##:##" && (!data.seconds || data.seconds === 'false')) display.pattern = "##:##";
                display.segmentCount    = parseInt(data.segmentCount, 10) || 7;
                display.displayAngle    = (data.displayAngle    === '' || data.displayAngle    === null || data.displayAngle === undefined) ? 9 : (parseInt(data.displayAngle, 10) || 0);
                display.digitHeight     = parseInt(data.digitHeight, 10) || 20;
                display.digitWidth      = parseInt(data.digitWidth, 10)  || 12;
                display.digitDistance   = (data.digitDistance   === '' || data.digitDistance   === null || data.digitDistance === undefined) ? 2 : (parseInt(data.digitDistance, 10) || 0);
                display.segmentWidth    = parseInt(data.segmentWidth, 10) || 3;
                display.segmentDistance = (data.segmentDistance === '' || data.segmentDistance === null || data.segmentDistance === undefined) ? 0.5 : (parseFloat(data.segmentDistance) || 0);
                switch (data.cornerType) {
                    case 'SymmetricCorner':
                        display.cornerType = 0;
                        break;
                    case 'FlattenedCorner':
                        display.cornerType = 1;
                        break;
                    case 'PointedCorner':
                        display.cornerType = 2;
                        break;
                    case 'RoundedCorner':
                        display.cornerType = 0;
                        break;
                    default:
                        display.cornerType = 0;
                    break;
                }
                display.colorOn         = data.colorOn  || 'rgba(0, 0, 0, 0.9)';
                display.colorOff        = data.colorOff || 'rgba(0, 0, 0, 0.1)';
                data.runStepInterval    = parseInt(data.runStepInterval, 10) || 0;
                if (data.oid && data.oid != 'nothing_selected') {
                    var value = vis.states.attr(data.oid + '.val');
                    if (value === null || value === undefined) value = '';
                    value = value.toString();
                    display.setValue(value);
                    el.data('value', value).data('step', 0);
                    vis.states.bind(data.oid + '.val', function (e, newVal) {
                        el.data('value', newVal).data('step', 0);
                        display.setValue(newVal.toString());
                    });
                    if (data.runStepInterval) {
                        runText(el, display, data.runStepInterval);
                    }
                } else if (data.text) {
                    el.data('value', data.text.toString()).data('step', 0);
                    display.setValue(data.text.toString());
                    if (data.runStepInterval) {
                        runText(el, display, data.runStepInterval);
                    }
                } else if (data.clock) {
                    var timerId = Math.round(Math.random() * 1000000);
                    el.data('timer', timerId);
                    writeTime(el, display);
                    var interval = setInterval(function () {
                        if (el.data('timer') != timerId) {
                            clearInterval(interval);
                        }
                        writeTime(el, display);
                    }, 1000);
                } else {
                    display.setValue('no oid, no text, no clock');
                }
            });
        }
    };
    if (vis.editMode) {
        vis.binds.timeandweather.editWeather = function (wid_attr, options) {
            var line = {
                input: '<input type="text" id="inspect_' + wid_attr + '"/>',
                init: function (_wid_attr, data) {
                    $('#inspect_' + _wid_attr).autocomplete({
                        source: function (req, callback) {
                            console.log(req.term);

                            var query = 'select * from geo.places where text="' + req.term + '"';
                            var api = 'http://query.yahooapis.com/v1/public/yql?q=' + encodeURIComponent(query) + '&format=json&callback=?';

                            // Send request
                            $.ajax({
                                type: 'GET',
                                url: api,
                                dataType: 'json',
                                success: function (data) {
                                    if (data.query.count > 0) {
                                        var arr = [];
                                        for (var i = 0; i < data.query.count; i++) {
                                            arr.push({
                                                label: $.fn._getWeatherAddress(data.query.results.place[i]),
                                                value: data.query.results.place.woeid
                                            });
                                        }
                                        callback(arr);
                                    } else {
                                        callback([]);
                                    }
                                },
                                error: function (data) {
                                    callback([]);
                                }
                            });
                        },
                        select: function (event, ui) {
                            $(this).val(ui.item.value);
                            $(this).trigger('change', ui.item.value);
                        }
                    });
                }
            };
            return line;
        };

    }
</script>
<!-- startDate: function (view, elem, showWeekDay, noClass, timerId, shortWeekDay, shortYear, prependZero, monthWord, shortMonth, american) {
            -->
<script id="tplTwSimpleDate"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplTwSimpleDate" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev date vis-widget-lock ui-selectee" style="left: 139px; top: 76px;">30.01.2015</div>'
        data-vis-set="timeandweather"
        data-vis-name="SimpleDate"
        data-vis-attrs="showWeekDay/checkbox;shortWeekDay/checkbox;shortYear/checkbox;prependZero[true]/checkbox;monthWord/checkbox;shortMonth/checkbox;americanOrder/checkbox;noClass/checkbox">
    <%
		vis.binds.timeandweather.startDate(this.view, this.data.attr('wid'), this.data.attr('showWeekDay'), this.data.attr('noClass'), undefined, this.data.attr('shortWeekDay'), this.data.attr('shortYear'), this.data.attr('prependZero'), this.data.attr('monthWord'), this.data.attr('shortMonth'), this.data.attr('americanOrder'));
    %>
</script>

<script id="tplTwSimpleClock"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplTwSimpleClock" style=" position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev clock vis-widget-lock ui-selectee" style="left: 132px; top: 179px; font-size: 28px;">11:01:57</div>'
        data-vis-set="timeandweather"
        data-vis-name="SimpleClock"
        data-vis-attrs="hideSeconds/checkbox;blink/checkbox;noClass/checkbox">
    <%
        vis.binds.timeandweather.startTime(this.view, this.data.attr('wid'), this.data.attr('hideSeconds'), this.data.attr('blink'), this.data.attr('noClass'));
    %>
</script>

<script id="tplTwCoolClock"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/timeandweather/img/Prev_CoolClock.png"></img>'
        data-vis-set="timeandweather"
        data-vis-name="CoolClock"
        data-vis-attrs="theme/select,fancy,swissRail,chunkySwiss,machine,simonbaird_com,classic,classicWhite,modern,simple,securephp,Tes2,Lev,Sand,Sun,Tor,Cold,Babosa,Tumb,Stone,Disc,watermelon;noSeconds/checkbox;showDigital/checkbox;showAmPm/checkbox" >
    <%
        vis.binds.timeandweather.tplTwCoolClock(this.view, this.data);
    %>
</script>

<script id="tplTwFlipClock"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/timeandweather/img/Prev_FlipClock.png"></img>'
        data-vis-set="timeandweather"
        data-vis-name="FlipClock"
        data-vis-attrs="">
    <%
        vis.binds.timeandweather.tplTwFlipClock(this.view, this.data);
    %>
</script>

<script id="tplTwHtcWeather"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/timeandweather/img/Prev_HTCWeather.png"></img>'
        data-vis-set="timeandweather"
        data-vis-name="HtcWeather"
        data-vis-attrs="woeid/custom,timeandweather.editWeather;cityName;language/select,,en,de,ru;updateInterval[180]/slider,0,1440,10;">
    <% 
        vis.binds.timeandweather.tplTwHtcWeather(this.view, this.data);
    %>
</script>

<script id="tplTwYahooWeather"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/timeandweather/img/Prev_YahooWeather.png"></img>'
        data-vis-set="timeandweather"
        data-vis-name="YahooWeather"
        data-vis-attrs="woeid/custom,timeandweather.editWeather;cityName;language/select,,en,de,ru;maxDays[7]/slider,0,8,1;updateInterval[180]/slider,0,1440,10;">
    <% 
        vis.binds.timeandweather.tplTwYahooWeather(this.view, this.data);
    %>
</script>

<script id="tplTwWeather"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/timeandweather/img/Prev_YahooWeather.png"></img>'
        data-vis-set="timeandweather"
        data-vis-name="WeatherCustom"
        data-vis-attrs="city;language/select,,en,de,ru;units_speed;"
        data-vis-attrs0="group.now;temperature-0-oid/id;condition-0-oid/id;humidity-0-oid/id;temperature-min-0-oid/id;temperature-max-0-oid/id;wind-speed-0-oid/id;wind-dir-0-oid/id;icon-0-oid/id;"
        data-vis-attrs1="group.tomorrow;condition-1-oid/id;temperature-min-1-oid/id;temperature-max-1-oid/id;icon-1-oid/id;"
        data-vis-attrs2="group.aftertomorrow;condition-2-oid/id;temperature-min-2-oid/id;temperature-max-2-oid/id;icon-2-oid/id;"
        data-vis-attrs3="group.in2days;condition-3-oid/id;temperature-min-3-oid/id;temperature-max-3-oid/id;icon-3-oid/id;"
        data-vis-attrs4="group.in3days;condition-4-oid/id;temperature-min-4-oid/id;temperature-max-4-oid/id;icon-4-oid/id;"
        data-vis-attrs5="group.in4days;condition-5-oid/id;temperature-min-5-oid/id;temperature-max-5-oid/id;icon-5-oid/id;"
        data-vis-attrs6="group.in5days;condition-6-oid/id;temperature-min-6-oid/id;temperature-max-6-oid/id;icon-6-oid/id;"
    >
    <%
        vis.binds.timeandweather.tplTwCustomWeather(this.view, this.data);
    %>
</script>

<script id="tplSvgClock"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/timeandweather/img/Prev_tplSvgClock.png"></img>'
        data-vis-set="timeandweather"
        data-vis-name="Svg Clock"
        data-vis-update-style="true"
        data-vis-attrs="quadSize/slider,10,200,1;quadColor/color;quadTickColor/color;textSize/slider,10,200,1;textColor/color;tickColor/color;isSeconds/checkbox;handsColor/color;handsColorLine/color;handsSecColor/color;textFont/fontname"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 100px; height: 100px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.timeandweather.tplSvgClock(el, this.data) %> />
    </div>
</script>

<script id="tplSegmentClock"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<img src="widgets/timeandweather/img/Prev_tplSegmentClock.png"></img>'
        data-vis-set="timeandweather"
        data-vis-name="Segment Clock"
        data-vis-update-style="true"
        data-vis-attrs="oid;text;"
        data-vis-attrs0="group.clock;clock[true]/checkbox;seconds[true]/checkbox;"
        data-vis-attrs1="group.style;pattern[##:##:##];colorOn[rgba(0, 0, 0, 1)]/color;colorOff[rgba(0, 0, 0, 0.1)]/color;runStepInterval[0]/slider,0,5000,100;segmentCount[7]/nselect,7,14,16;displayAngle[9]/slider,0,30,1;digitHeight[20]/slider,0,60,1;digitWidth[12]/slider,0,60,1;digitDistance[2]/slider,0,60,1;segmentWidth[3]/slider,0,60,1;segmentDistance[0.5]/slider,0,5,0.1;cornerType[PointedCorner]/select,SymmetricCorner,FlattenedCorner,PointedCorner,RoundedCorner"
        >
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 100px; height: 30px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.timeandweather.tplSegmentClock(el, this.data) %> />
    </div>
</script>


<!-- --------------timeandweather.html--- END -->
<!-- --------------weather.html--- START -->
﻿<!--
    ioBroker.vis weather Widget-Set


    Copyright 10.2015-2019 René G. <info@rg-engineering.eu>
-->
<!--
<script language="javascript" type="text/javascript" src="widgets/weather/lib/js/flot/jquery.js"></script>
-->
<script language="javascript" type="text/javascript" src="widgets/weather/lib/js/flot/jquery.canvaswrapper.js"></script>
<script language="javascript" type="text/javascript" src="widgets/weather/lib/js/flot/jquery.colorhelpers.js"></script>
<script language="javascript" type="text/javascript" src="widgets/weather/lib/js/flot/jquery.flot.js"></script>
<script language="javascript" type="text/javascript" src="widgets/weather/lib/js/flot/jquery.flot.saturated.js"></script>
<script language="javascript" type="text/javascript" src="widgets/weather/lib/js/flot/jquery.flot.browser.js"></script>
<script language="javascript" type="text/javascript" src="widgets/weather/lib/js/flot/jquery.flot.drawSeries.js"></script>
<script language="javascript" type="text/javascript" src="widgets/weather/lib/js/flot/jquery.flot.uiConstants.js"></script>
<script language="javascript" type="text/javascript" src="widgets/weather/lib/js/flot/jquery.flot.time.js"></script>
<script language="javascript" type="text/javascript" src="widgets/weather/lib/js/flot/jquery.flot.legend.js"></script>

<script language="javascript" type="text/javascript" src="widgets/weather/lib/js/flot/jquery.flot.axislabels_V2.js"></script>


<!-- doku for flot : -->
<!--  https://github.com/flot/flot/blob/master/API.md -->

<style>
    .chart-placeholder {
        width: 100%;
        height: 100%;
        font-size: 14px;
        line-height: 1.2em;
    }

    .legendLayer .background {
        fill: rgba(255, 255, 255, 0.85);
        stroke: rgba(0, 0, 0, 0.85);
        stroke-width: 1;
    }
</style>

<script type="text/javascript">
    'use strict';

    //require('flot');

    var MarkingColor = "eaebe5";

    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {
            //            "format_date": { "en": "Dateformat", "de": "Datumformat", "ru": "?????? ????" },
            //            "format_date_tooltip": {"en": "Dateformat","de": "Datumformat","ru": "?????? ????"},

            "weather": {
                "en": "weather",
                "de": "Wetter",
                "ru": "Погода",
                "pt": "clima",
                "nl": "weer",
                "fr": "la météo",
                "it": "tempo metereologico",
                "es": "clima",
                "pl": "pogoda",
                "zh-cn": "天气"
            },
            "1 second": {
                "en": "1 second",
                "de": "1 Sekunde",
                "ru": "1 секунда",
                "pt": "1 segundo",
                "nl": "1 seconde",
                "fr": "1 seconde",
                "it": "1 secondo",
                "es": "1 segundo",
                "pl": "1 sekunda",
                "zh-cn": "1秒"
            },
            "10 seconds": {
                "en": "10 seconds",
                "de": "10 Sekunden",
                "ru": "10 секунд",
                "pt": "10 segundos",
                "nl": "10 seconden",
                "fr": "10 secondes",
                "it": "10 secondi",
                "es": "10 segundos",
                "pl": "10 sekund",
                "zh-cn": "10秒"
            },
            "30 seconds": {
                "en": "30 seconds",
                "de": "30 Sekunden",
                "ru": "30 секунд",
                "pt": "30 segundos",
                "nl": "30 seconden",
                "fr": "30 secondes",
                "it": "30 secondi",
                "es": "30 segundos",
                "pl": "30 sekund",
                "zh-cn": "30秒"
            },
            "1 minute": {
                "en": "1 minute",
                "de": "1 Minute",
                "ru": "1 минута",
                "pt": "1 minuto",
                "nl": "1 minuut",
                "fr": "1 minute",
                "it": "1 minuto",
                "es": "1 minuto",
                "pl": "1 minuta",
                "zh-cn": "1分钟"
            },
            "2 minutes": {
                "en": "2 minutes",
                "de": "2 Minuten",
                "ru": "2 минуты",
                "pt": "2 minutos",
                "nl": "2 minuten",
                "fr": "2 minutes",
                "it": "2 minuti",
                "es": "2 minutos",
                "pl": "2 minuty",
                "zh-cn": "2分钟"
            },
            "5 minutes": {
                "en": "5 minutes",
                "de": "5 Minuten",
                "ru": "5 минут",
                "pt": "5 minutos",
                "nl": "5 minuten",
                "fr": "5 minutes",
                "it": "5 minuti",
                "es": "5 minutos",
                "pl": "5 minut",
                "zh-cn": "5分钟"
            },
            "10 minutes": {
                "en": "10 minutes",
                "de": "10 Minuten",
                "ru": "10 минут",
                "pt": "10 minutos",
                "nl": "10 minuten",
                "fr": "10 minutes",
                "it": "10 minuti",
                "es": "10 minutos",
                "pl": "10 minut",
                "zh-cn": "10分钟"
            },
            "30 minutes": {
                "en": "30 minutes",
                "de": "30 Minuten",
                "ru": "30 минут",
                "pt": "30 minutos",
                "nl": "30 minuten",
                "fr": "30 minutes",
                "it": "30 minuti",
                "es": "30 minutos",
                "pl": "30 minut",
                "zh-cn": "30分钟"
            },
            "1 hour": {
                "en": "1 hour",
                "de": "1 Stunde",
                "ru": "1 час",
                "pt": "1 hora",
                "nl": "1 uur",
                "fr": "1 heure",
                "it": "1 ora",
                "es": "1 hora",
                "pl": "1 godzina",
                "zh-cn": "1小时"
            },
            "2 hours": {
                "en": "2 hours",
                "de": "2 Stunden",
                "ru": "два часа",
                "pt": "2 horas",
                "nl": "twee uur",
                "fr": "2 heures",
                "it": "2 ore",
                "es": "2 horas",
                "pl": "2 godziny",
                "zh-cn": "2小时"
            },
            "4 hours": {
                "en": "4 hours",
                "de": "4 Stunden",
                "ru": "4 часа",
                "pt": "4 horas",
                "nl": "4 uur",
                "fr": "4 heures",
                "it": "4 ore",
                "es": "4 horas",
                "pl": "4 godziny",
                "zh-cn": "4个小时"
            },
            "8 hours": {
                "en": "8 hours",
                "de": "8 Stunden",
                "ru": "8 часов",
                "pt": "8 horas",
                "nl": "8 uur",
                "fr": "8 heures",
                "it": "8 ore",
                "es": "8 horas",
                "pl": "8 godzin",
                "zh-cn": "8小时"
            },
            "12 hours": {
                "en": "12 hours",
                "de": "12 Stunden",
                "ru": "12 часов",
                "pt": "12 horas",
                "nl": "12 uren",
                "fr": "12 heures",
                "it": "12 ore",
                "es": "12 horas",
                "pl": "12 godzin",
                "zh-cn": "12小时"
            },
            "24 hours": {
                "en": "24 hours",
                "de": "24 Stunden",
                "ru": "24 часа",
                "pt": "24 horas",
                "nl": "24 uur",
                "fr": "24 heures",
                "it": "24 ore",
                "es": "24 horas",
                "pl": "24 godziny",
                "zh-cn": "24小时"
            },
            "instance": {
                "en": "weather instance",
                "de": "Wetterinstanz",
                "ru": "случай погоды",
                "pt": "instância climática",
                "nl": "weer exemplaar",
                "fr": "instance météo",
                "it": "istanza meteorologica",
                "es": "instancia meteorológica",
                "pl": "instancja pogodowa",
                "zh-cn": "天气实例"
            },
            "time_interval": {
                "en": "Time interval",
                "de": "Zeitintervall",
                "ru": "Интервал времени",
                "pt": "Intervalo de tempo",
                "nl": "Tijdsinterval",
                "fr": "Intervalle de temps",
                "it": "Intervallo di tempo",
                "es": "Intervalo de tiempo",
                "pl": "Przedział czasowy",
                "zh-cn": "时间间隔"
            },
            "group_oids": {
                "en": "OID's",
                "de": "OID's",
                "ru": "OID-х",
                "pt": "OID's",
                "nl": "OID's",
                "fr": "OID",
                "it": "di OID",
                "es": "OID",
                "pl": "OID",
                "zh-cn": "OID的"
            },
            "group_rain": {
                "en": "rain",
                "de": "Regen",
                "ru": "дождь",
                "pt": "chuva",
                "nl": "regen",
                "fr": "pluie",
                "it": "pioggia",
                "es": "lluvia",
                "pl": "deszcz",
                "zh-cn": "雨"
            },
            "group_chancerain": {
                "en": "chance of rain",
                "de": "Niederschlagswahrscheinlichkeit",
                "ru": "вероятность дождя",
                "pt": "chance de chover",
                "nl": "kans op regen",
                "fr": "risque de pluie",
                "it": "probabilità di pioggia",
                "es": "probabilidad de lluvia",
                "pl": "szansa na deszcz",
                "zh-cn": "下雨的机会"
            },
            "group_temperature": {
                "en": "temperature",
                "de": "Temperatur",
                "ru": "температура",
                "pt": "temperatura",
                "nl": "temperatuur",
                "fr": "Température",
                "it": "temperatura",
                "es": "temperatura",
                "pl": "temperatura",
                "zh-cn": "温度"
            },
            "group_clouds": {
                "en": "clouds",
                "de": "Wolken",
                "ru": "облака",
                "pt": "nuvens",
                "nl": "wolken",
                "fr": "des nuages",
                "it": "nuvole",
                "es": "nubes",
                "pl": "chmury",
                "zh-cn": "乌云"
            },
            "oid_value": {
                "en": "OID values",
                "de": "OID-Werte",
                "ru": "Значения OID",
                "pt": "Valores OID",
                "nl": "OID-waarden",
                "fr": "Valeurs OID",
                "it": "Valori OID",
                "es": "Valores OID",
                "pl": "Wartości OID",
                "zh-cn": "OID值"
            },
            "withxaxix": {
                "en": "show X axis",
                "de": "X-Achse anzeigen",
                "ru": "показать ось X",
                "pt": "mostre o eixo X",
                "nl": "X-as weergeven",
                "fr": "afficher l'axe X",
                "it": "mostra l'asse X.",
                "es": "mostrar eje X",
                "pl": "pokaż oś X.",
            },
            "rainvisible": {
                "en": "visible",
                "de": "sichtbar",
                "ru": "видимый",
                "pt": "visível",
                "nl": "zichtbaar",
                "fr": "visible",
                "it": "visibile",
                "es": "visible",
                "pl": "widoczny",
                "zh-cn": "可见"
            },
            "rainchartType": {
                "en": "chart type",
                "de": "Diagramm Typ",
                "ru": "тип диаграммы",
                "pt": "tipo de gráfico",
                "nl": "grafiektype",
                "fr": "type de graphique",
                "it": "tipo di grafico",
                "es": "tipo de gráfico",
                "pl": "typ wykresu",
                "zh-cn": "图表类型"
            },
            "raincolor": {
                "en": "color",
                "de": "Farbe",
                "ru": "цвет",
                "pt": "cor",
                "nl": "kleur",
                "fr": "Couleur",
                "it": "colore",
                "es": "color",
                "pl": "kolor",
                "zh-cn": "颜色"
            },
            "chancerainvisible": {
                "en": "visible",
                "de": "sichtbar",
                "ru": "видимый",
                "pt": "visível",
                "nl": "zichtbaar",
                "fr": "visible",
                "it": "visibile",
                "es": "visible",
                "pl": "widoczny",
                "zh-cn": "可见"
            },
            "tempvisible": {
                "en": "visible",
                "de": "sichtbar",
                "ru": "видимый",
                "pt": "visível",
                "nl": "zichtbaar",
                "fr": "visible",
                "it": "visibile",
                "es": "visible",
                "pl": "widoczny",
                "zh-cn": "可见"
            },
            "tempchartType": {
                "en": "chart type",
                "de": "Diagramm Typ",
                "ru": "тип диаграммы",
                "pt": "tipo de gráfico",
                "nl": "grafiektype",
                "fr": "type de graphique",
                "it": "tipo di grafico",
                "es": "tipo de gráfico",
                "pl": "typ wykresu",
                "zh-cn": "图表类型"
            },
            "tempcolor": {
                "en": "color",
                "de": "Farbe",
                "ru": "цвет",
                "pt": "cor",
                "nl": "kleur",
                "fr": "Couleur",
                "it": "colore",
                "es": "color",
                "pl": "kolor",
                "zh-cn": "颜色"
            },
            "chanceraincolor": {
                "en": "color",
                "de": "Farbe",
                "ru": "цвет",
                "pt": "cor",
                "nl": "kleur",
                "fr": "Couleur",
                "it": "colore",
                "es": "color",
                "pl": "kolor",
                "zh-cn": "颜色"
            },
            "cloudsvisible": {
                "en": "visible",
                "de": "sichtbar",
                "ru": "видимый",
                "pt": "visível",
                "nl": "zichtbaar",
                "fr": "visible",
                "it": "visibile",
                "es": "visible",
                "pl": "widoczny",
                "zh-cn": "可见"
            },
            "cloudschartType": {
                "en": "chart type",
                "de": "Diagramm Typ",
                "ru": "тип диаграммы",
                "pt": "tipo de gráfico",
                "nl": "grafiektype",
                "fr": "type de graphique",
                "it": "tipo di grafico",
                "es": "tipo de gráfico",
                "pl": "typ wykresu",
                "zh-cn": "图表类型"
            },
            "sunorcloud": {
                "en": "show sun or clouds",
                "de": "Sonne oder Wolken zeigen",
                "ru": "показать солнце или облака",
                "pt": "mostre sol ou nuvens",
                "nl": "toon zon of wolken",
                "fr": "montrer du soleil ou des nuages",
                "it": "mostra sole o nuvole",
                "es": "mostrar sol o nubes",
                "pl": "pokaż słońce lub chmury",
                "zh-cn": "显示太阳或云"
            },
            "cloudcolor": {
                "en": "color",
                "de": "Farbe",
                "ru": "цвет",
                "pt": "cor",
                "nl": "kleur",
                "fr": "Couleur",
                "it": "colore",
                "es": "color",
                "pl": "kolor",
                "zh-cn": "颜色"
            },
            "line": {
                "en": "line",
                "de": "Linie",
                "ru": "линия",
                "pt": "linha",
                "nl": "lijn",
                "fr": "ligne",
                "it": "linea",
                "es": "línea",
                "pl": "linia",
                "zh-cn": "线"
            },
            "bar": {
                "en": "bar",
                "de": "Balken",
                "ru": "бар",
                "pt": "Barra",
                "nl": "bar",
                "fr": "bar",
                "it": "bar",
                "es": "bar",
                "pl": "bar",
                "zh-cn": "酒吧"
            },
            "sun": {
                "en": "sun",
                "de": "Sonne",
                "ru": "солнце",
                "pt": "Dom",
                "nl": "zon",
                "fr": "Soleil",
                "it": "sole",
                "es": "Dom",
                "pl": "słońce",
                "zh-cn": "太阳"
            },
            "clouds": {
                "en": "clouds",
                "de": "Wolken",
                "ru": "облака",
                "pt": "nuvens",
                "nl": "wolken",
                "fr": "des nuages",
                "it": "nuvole",
                "es": "nubes",
                "pl": "chmury",
                "zh-cn": "乌云"
            },
            "axislabelcolor": {
                "en": "color of axis label",
                "de": "Farbe der Achsenbeschriftung",
                "ru": "цвет метки оси",
                "pt": "cor do rótulo do eixo",
                "nl": "kleur van aslabel",
                "fr": "couleur de l'étiquette de l'axe",
                "it": "colore dell'etichetta dell'asse",
                "es": "color de la etiqueta del eje",
                "pl": "kolor etykiety osi",
                "zh-cn": "轴标颜色"
            },
            "tickscolor": {
                "en": "color of axis ticks",
                "de": "Farbe der Achsenstriche",
                "ru": "цвет отметок оси",
                "pt": "cor dos tiques do eixo",
                "nl": "kleur van as tikken",
                "fr": "couleur des tiques des axes",
                "it": "colore delle zecche degli assi",
                "es": "color de las garrapatas del eje",
                "pl": "kolor znaczników osi",
                "zh-cn": "轴刻度的颜色"
            },
            "markingcolor": {
                "en": "color of marking",
                "de": "Farbe der Markierung",
                "ru": "цвет маркировки",
                "pt": "cor da marcação",
                "nl": "kleur van markering",
                "fr": "couleur de marquage",
                "it": "colore della marcatura",
                "es": "color de marcado",
                "pl": "kolor oznakowania",
                "zh-cn": "标记颜色"
            },
            "withmarking": {
                "en": "with marking",
                "de": "mit Markierung",
                "ru": "с маркировкой",
                "pt": "com marcação",
                "nl": "met markering",
                "fr": "avec marquage",
                "it": "con marcatura",
                "es": "con marcado",
                "pl": "z oznaczeniem",
                "zh-cn": "带标记"
            },
            "maxY_temp": {
                "en": "max. value y-axix (0 for auto)",
                "de": "max. Wert y-Achse (0 für Auto)",
                "ru": "Максимум. значение оси Y (0 для авто)",
                "pt": "máx. valor y-axix (0 para automático)",
                "nl": "max. waarde y-axix (0 voor auto)",
                "fr": "max. valeur y-axix (0 pour auto)",
                "it": "max. valore y-axix (0 per auto)",
                "es": "max. valor y-axix (0 para auto)",
                "pl": "max. wartość y-axix (0 dla auto)",
                "zh-cn": "最高值y轴（自动为0）"
            },
            "minY_temp": {
                "en": "min. value y-axix (0 for auto)",
                "de": "min. Wert y-Achse (0 für Auto)",
                "ru": "минимум значение оси Y (0 для авто)",
                "pt": "min. valor y-axix (0 para automático)",
                "nl": "min. waarde y-axix (0 voor auto)",
                "fr": "min. valeur y-axix (0 pour auto)",
                "it": "min. valore y-axix (0 per auto)",
                "es": "min. valor y-axix (0 para auto)",
                "pl": "min. wartość y-axix (0 dla auto)",
                "zh-cn": "分钟值y轴（自动为0）"
            },
            "yTempVisible": {
                "en": "show y axis",
                "de": "y-Achse anzeigen",
                "ru": "показать ось у",
                "pt": "mostre o eixo y",
                "nl": "y-as weergeven",
                "fr": "afficher l'axe y",
                "it": "mostra l'asse y",
                "es": "mostrar eje y",
                "pl": "pokaż oś y",
                "zh-cn": "显示y轴"
            },
            "yRainVisible": {
                "en": "show y axis",
                "de": "y-Achse anzeigen",
                "ru": "показать ось у",
                "pt": "mostre o eixo y",
                "nl": "y-as weergeven",
                "fr": "afficher l'axe y",
                "it": "mostra l'asse y",
                "es": "mostrar eje y",
                "pl": "pokaż oś y",
                "zh-cn": "显示y轴"
            },
            "yCloudVisible": {
                "en": "show y axis",
                "de": "y-Achse anzeigen",
                "ru": "показать ось у",
                "pt": "mostre o eixo y",
                "nl": "y-as weergeven",
                "fr": "afficher l'axe y",
                "it": "mostra l'asse y",
                "es": "mostrar eje y",
                "pl": "pokaż oś y",
                "zh-cn": "显示y轴"
            },
            "yChanceRainVisible": {
                "en": "show y axis",
                "de": "y-Achse anzeigen",
                "ru": "показать ось у",
                "pt": "mostre o eixo y",
                "nl": "y-as weergeven",
                "fr": "afficher l'axe y",
                "it": "mostra l'asse y",
                "es": "mostrar eje y",
                "pl": "pokaż oś y",
                "zh-cn": "显示y轴"
            },
            "xDateFormat": {
                "en": "format for date/time on x-axis",
                "de": "Format für Datum / Uhrzeit auf der x-Achse",
                "ru": "формат даты / времени по оси X",
                "pt": "formato para data / hora no eixo x",
                "nl": "formaat voor datum / tijd op x-as",
                "fr": "format de date / heure sur l'axe des x",
                "it": "formato per data / ora sull'asse x",
                "es": "formato para fecha / hora en eje x",
                "pl": "format daty / godziny na osi x",
                "zh-cn": "x轴上日期/时间的格式"
            },
            "nobgcolor": {
                "en": "no background color on grid",
                "de": "Keine Hintergrundfarbe im Raster",
                "ru": "нет цвета фона на сетке",
                "pt": "sem cor de fundo na grade",
                "nl": "geen achtergrondkleur op het raster",
                "fr": "pas de couleur d'arrière-plan sur la grille",
                "it": "nessun colore di sfondo sulla griglia",
                "es": "sin color de fondo en la cuadrícula",
                "pl": "brak koloru tła na siatce",
                "zh-cn": "网格上没有背景色"
            },

            "bgcolor": {
                "en": "background color on grid",
                "de": "Hintergrundfarbe auf Raster",
                "ru": "цвет фона на сетке",
                "pt": "cor de fundo na grade",
                "nl": "achtergrondkleur op het raster",
                "fr": "couleur de fond sur la grille",
                "it": "colore di sfondo sulla griglia",
                "es": "color de fondo en la cuadrícula",
                "pl": "kolor tła na siatce",
                "zh-cn": "网格上的背景色"
            },
            /*
            "withborder": {
                "en": "show border of grid",
                "de": "Rahmen des Gitters anzeigen",
                "ru": "показать границу сетки",
                "pt": "mostrar borda da grade",
                "nl": "rand van raster weergeven",
                "fr": "montrer la bordure de la grille",
                "it": "mostra il bordo della griglia",
                "es": "mostrar borde de cuadrícula",
                "pl": "pokaż granicę siatki",
                "zh-cn": "显示网格边框"
            },*/
            "bordercolor": {
                "en": "color of grid border",
                "de": "Farbe des Gitterrandes",
                "ru": "цвет границы сетки",
                "pt": "cor da borda da grade",
                "nl": "kleur van de rasterrand",
                "fr": "couleur de la bordure de la grille",
                "it": "colore del bordo della griglia",
                "es": "color del borde de la cuadrícula",
                "pl": "kolor obramowania siatki",
                "zh-cn": "网格边框的颜色"
            },
            "borderWidth": {
                "en": "width of grid border",
                "de": "Breite des Gitterrandes",
                "ru": "ширина границы сетки",
                "pt": "largura da borda da grade",
                "nl": "breedte van de rasterrand",
                "fr": "largeur de la bordure de la grille",
                "it": "larghezza del bordo della griglia",
                "es": "ancho del borde de la cuadrícula",
                "pl": "szerokość granicy siatki",
                "zh-cn": "网格边框的宽度"
            },
            "datastructure": {
                "en": "data structure",
                "de": "Datenstruktur",
                "ru": "структура данных",
                "pt": "estrutura de dados",
                "nl": "data structuur",
                "fr": "Structure de données",
                "it": "struttura dati",
                "es": "estructura de datos",
                "pl": "struktura danych",
                "zh-cn": "数据结构"
            },
            "raincolorticklabel": {
                "en": "color tick label",
                "de": "Farbe Tick Label",
                "ru": "цветная метка",
                "pt": "etiqueta de escala de cores",
                "nl": "kleur maatlabel",
                "fr": "étiquette de couleur tique",
                "it": "etichetta con segno di spunta di colore",
                "es": "etiqueta de marca de color",
                "pl": "kolorowa etykieta kleszczowa",
                "zh-cn": "彩色刻度标签"
            },
            "chanceraincolorticklabel": {
                "en": "color tick label",
                "de": "Farbe Tick Label",
                "ru": "цветная метка",
                "pt": "etiqueta de escala de cores",
                "nl": "kleur maatlabel",
                "fr": "étiquette de couleur tique",
                "it": "etichetta con segno di spunta di colore",
                "es": "etiqueta de marca de color",
                "pl": "kolorowa etykieta kleszczowa",
                "zh-cn": "彩色刻度标签"
            },
            "tempcolorticklabel": {
                "en": "color tick label",
                "de": "Farbe Tick Label",
                "ru": "цветная метка",
                "pt": "etiqueta de escala de cores",
                "nl": "kleur maatlabel",
                "fr": "étiquette de couleur tique",
                "it": "etichetta con segno di spunta di colore",
                "es": "etiqueta de marca de color",
                "pl": "kolorowa etykieta kleszczowa",
                "zh-cn": "彩色刻度标签"
            },
            "cloudcolorticklabel": {
                "en": "color tick label",
                "de": "Farbe Tick Label",
                "ru": "цветная метка",
                "pt": "etiqueta de escala de cores",
                "nl": "kleur maatlabel",
                "fr": "étiquette de couleur tique",
                "it": "etichetta con segno di spunta di colore",
                "es": "etiqueta de marca de color",
                "pl": "kolorowa etykieta kleszczowa",
                "zh-cn": "彩色刻度标签"
            },

            "raincoloraxis": {
                "en": "color of axis",
                "de": "Farbe der Achse",
                "ru": "цвет оси",
                "pt": "cor do eixo",
                "nl": "kleur van de as",
                "fr": "couleur de l'axe",
                "it": "colore dell'asse",
                "es": "color del eje",
                "pl": "kolor osi",
                "zh-cn": "轴的颜色"
            },
            "chanceraincoloraxis": {
                "en": "color of axis",
                "de": "Farbe der Achse",
                "ru": "цвет оси",
                "pt": "cor do eixo",
                "nl": "kleur van de as",
                "fr": "couleur de l'axe",
                "it": "colore dell'asse",
                "es": "color del eje",
                "pl": "kolor osi",
                "zh-cn": "轴的颜色"
            },
            "tempcoloraxis": {
                "en": "color of axis",
                "de": "Farbe der Achse",
                "ru": "цвет оси",
                "pt": "cor do eixo",
                "nl": "kleur van de as",
                "fr": "couleur de l'axe",
                "it": "colore dell'asse",
                "es": "color del eje",
                "pl": "kolor osi",
                "zh-cn": "轴的颜色"
            },
            "cloudcoloraxis": {
                "en": "color of axis",
                "de": "Farbe der Achse",
                "ru": "цвет оси",
                "pt": "cor do eixo",
                "nl": "kleur van de as",
                "fr": "couleur de l'axe",
                "it": "colore dell'asse",
                "es": "color del eje",
                "pl": "kolor osi",
                "zh-cn": "轴的颜色"
            },
            "LabelFontSize": {
                "en": "size of Label Font",
                "de": "Größe der Beschriftungsschrift",
                "ru": "размер шрифта метки",
                "pt": "tamanho da fonte da etiqueta",
                "nl": "grootte van het lettertype",
                "fr": "taille de la police d'étiquette",
                "it": "dimensione del carattere dell'etichetta",
                "es": "tamaño de la fuente de la etiqueta",
                "pl": "rozmiar czcionki etykiety",
                "zh-cn": "标签字体的大小"
            },
            "LabelFontFamily": {
                "en": "family of label font",
                "de": "Schriftfamilie",
                "ru": "семейство меток шрифта",
                "pt": "família de fontes de rótulo",
                "nl": "familie van lettertype",
                "fr": "famille de polices d'étiquettes",
                "it": "famiglia di caratteri etichetta",
                "es": "familia de fuente de etiquetas",
                "pl": "rodzina czcionek etykiet",
                "zh-cn": "标签字体家族"
            },


            "rainname": {
                "en": "name on legend",
                "de": "Name auf Legende",
                "ru": "имя по легенде",
                "pt": "nome na legenda",
                "nl": "naam op legende",
                "fr": "nom sur la légende",
                "it": "nome sulla leggenda",
                "es": "nombre en la leyenda",
                "pl": "imię na legendzie",
                "zh-cn": "传说中的名字"
            },
            "tempname": {
                "en": "name on legend",
                "de": "Name auf Legende",
                "ru": "имя по легенде",
                "pt": "nome na legenda",
                "nl": "naam op legende",
                "fr": "nom sur la légende",
                "it": "nome sulla leggenda",
                "es": "nombre en la leyenda",
                "pl": "imię na legendzie",
                "zh-cn": "传说中的名字"
            },
            "cloudsname": {
                "en": "name on legend",
                "de": "Name auf Legende",
                "ru": "имя по легенде",
                "pt": "nome na legenda",
                "nl": "naam op legende",
                "fr": "nom sur la légende",
                "it": "nome sulla leggenda",
                "es": "nombre en la leyenda",
                "pl": "imię na legendzie",
                "zh-cn": "传说中的名字"
            },
            "chancerainname": {
                "en": "name on legend",
                "de": "Name auf Legende",
                "ru": "имя по легенде",
                "pt": "nome na legenda",
                "nl": "naam op legende",
                "fr": "nom sur la légende",
                "it": "nome sulla leggenda",
                "es": "nombre en la leyenda",
                "pl": "imię na legendzie",
                "zh-cn": "传说中的名字"
            },

            "raintickLength": {
                "en": "length of tick",
                "de": "Länge des Ticks",
                "ru": "длина тика",
                "pt": "comprimento do carrapato",
                "nl": "lengte van de teek",
                "fr": "longueur de tique",
                "it": "lunghezza del segno di spunta",
                "es": "longitud de la garrapata",
                "pl": "długość kleszcza",
                "zh-cn": "tick的长度"
            },
            "rainshowMinorTicks": {
                "en": "show minor tick",
                "de": "zeige kleine Ticks",
                "ru": "показать небольшую галочку",
                "pt": "mostre carrapato menor",
                "nl": "toon kleine vinkjes",
                "fr": "montrer une tique mineure",
                "it": "mostra segno di spunta minore",
                "es": "mostrar marca menor",
                "pl": "pokaż drobne kleszcze",
                "zh-cn": "显示小勾"
            },
            "rainshowTicks": {
                "en": "show tick",
                "de": "zeige ticks",
                "ru": "показать галочку",
                "pt": "show tick",
                "nl": "vinkje tonen",
                "fr": "montrer tique",
                "it": "mostra tick",
                "es": "mostrar marca",
                "pl": "pokaż tik",
                "zh-cn": "显示刻度"
            },
            "raintickDecimals": {
                "en": "decimals",
                "de": "Dezimalstellen",
                "ru": "десятичные",
                "pt": "decimais",
                "nl": "decimalen",
                "fr": "décimales",
                "it": "decimali",
                "es": "decimales",
                "pl": "miejsca po przecinku",
                "zh-cn": "小数点"
            },
            "raintickSize": {
                "en": "tick size",
                "de": "Tick-Größe",
                "ru": "размер галочки",
                "pt": "tamanho do carrapato",
                "nl": "teken grootte",
                "fr": "taille de la tique",
                "it": "dimensione tick",
                "es": "tamaño de la garrapata",
                "pl": "rozmiar kleszcza",
                "zh-cn": "刻度大小"
            },
            "rainminTickSize": {
                "en": "min. tick size",
                "de": "Mindest. Tick-Größe",
                "ru": "минимум размер галочки",
                "pt": "min. tamanho do carrapato",
                "nl": "min. teken grootte",
                "fr": "min. taille de la tique",
                "it": "min. dimensione tick",
                "es": "min. tamaño de la garrapata",
                "pl": "min. rozmiar kleszcza",
                "zh-cn": "分钟刻度大小"
            },

            "chanceraintickLength": {
                "en": "length of tick",
                "de": "Länge des Ticks",
                "ru": "длина тика",
                "pt": "comprimento do carrapato",
                "nl": "lengte van de teek",
                "fr": "longueur de tique",
                "it": "lunghezza del segno di spunta",
                "es": "longitud de la garrapata",
                "pl": "długość kleszcza",
                "zh-cn": "tick的长度"
            },
            "chancerainshowMinorTicks": {
                "en": "show minor tick",
                "de": "zeige kleine Ticks",
                "ru": "показать небольшую галочку",
                "pt": "mostre carrapato menor",
                "nl": "toon kleine vinkjes",
                "fr": "montrer une tique mineure",
                "it": "mostra segno di spunta minore",
                "es": "mostrar marca menor",
                "pl": "pokaż drobne kleszcze",
                "zh-cn": "显示小勾"
            },
            "chancerainshowTicks": {
                "en": "show tick",
                "de": "zeige ticks",
                "ru": "показать галочку",
                "pt": "show tick",
                "nl": "vinkje tonen",
                "fr": "montrer tique",
                "it": "mostra tick",
                "es": "mostrar marca",
                "pl": "pokaż tik",
                "zh-cn": "显示刻度"
            },
            "chanceraintickDecimals": {
                "en": "decimals",
                "de": "Dezimalstellen",
                "ru": "десятичные",
                "pt": "decimais",
                "nl": "decimalen",
                "fr": "décimales",
                "it": "decimali",
                "es": "decimales",
                "pl": "miejsca po przecinku",
                "zh-cn": "小数点"
            },
            "chanceraintickSize": {
                "en": "tick size",
                "de": "Tick-Größe",
                "ru": "размер галочки",
                "pt": "tamanho do carrapato",
                "nl": "teken grootte",
                "fr": "taille de la tique",
                "it": "dimensione tick",
                "es": "tamaño de la garrapata",
                "pl": "rozmiar kleszcza",
                "zh-cn": "刻度大小"
            },
            "chancerainminTickSize": {
                "en": "min. tick size",
                "de": "Mindest. Tick-Größe",
                "ru": "минимум размер галочки",
                "pt": "min. tamanho do carrapato",
                "nl": "min. teken grootte",
                "fr": "min. taille de la tique",
                "it": "min. dimensione tick",
                "es": "min. tamaño de la garrapata",
                "pl": "min. rozmiar kleszcza",
                "zh-cn": "分钟刻度大小"
            },

            "temptickLength": {
                "en": "length of tick",
                "de": "Länge des Ticks",
                "ru": "длина тика",
                "pt": "comprimento do carrapato",
                "nl": "lengte van de teek",
                "fr": "longueur de tique",
                "it": "lunghezza del segno di spunta",
                "es": "longitud de la garrapata",
                "pl": "długość kleszcza",
                "zh-cn": "tick的长度"
            },
            "tempshowMinorTicks": {
                "en": "show minor tick",
                "de": "zeige kleine Ticks",
                "ru": "показать небольшую галочку",
                "pt": "mostre carrapato menor",
                "nl": "toon kleine vinkjes",
                "fr": "montrer une tique mineure",
                "it": "mostra segno di spunta minore",
                "es": "mostrar marca menor",
                "pl": "pokaż drobne kleszcze",
                "zh-cn": "显示小勾"
            },
            "tempshowTicks": {
                "en": "show tick",
                "de": "zeige ticks",
                "ru": "показать галочку",
                "pt": "show tick",
                "nl": "vinkje tonen",
                "fr": "montrer tique",
                "it": "mostra tick",
                "es": "mostrar marca",
                "pl": "pokaż tik",
                "zh-cn": "显示刻度"
            },
            "temptickDecimals": {
                "en": "decimals",
                "de": "Dezimalstellen",
                "ru": "десятичные",
                "pt": "decimais",
                "nl": "decimalen",
                "fr": "décimales",
                "it": "decimali",
                "es": "decimales",
                "pl": "miejsca po przecinku",
                "zh-cn": "小数点"
            },
            "temptickSize": {
                "en": "tick size",
                "de": "Tick-Größe",
                "ru": "размер галочки",
                "pt": "tamanho do carrapato",
                "nl": "teken grootte",
                "fr": "taille de la tique",
                "it": "dimensione tick",
                "es": "tamaño de la garrapata",
                "pl": "rozmiar kleszcza",
                "zh-cn": "刻度大小"
            },
            "tempminTickSize": {
                "en": "min. tick size",
                "de": "Mindest. Tick-Größe",
                "ru": "минимум размер галочки",
                "pt": "min. tamanho do carrapato",
                "nl": "min. teken grootte",
                "fr": "min. taille de la tique",
                "it": "min. dimensione tick",
                "es": "min. tamaño de la garrapata",
                "pl": "min. rozmiar kleszcza",
                "zh-cn": "分钟刻度大小"
            },

            "cloudtickLength": {
                "en": "length of tick",
                "de": "Länge des Ticks",
                "ru": "длина тика",
                "pt": "comprimento do carrapato",
                "nl": "lengte van de teek",
                "fr": "longueur de tique",
                "it": "lunghezza del segno di spunta",
                "es": "longitud de la garrapata",
                "pl": "długość kleszcza",
                "zh-cn": "tick的长度"
            },
            "cloudshowMinorTicks": {
                "en": "show minor tick",
                "de": "zeige kleine Ticks",
                "ru": "показать небольшую галочку",
                "pt": "mostre carrapato menor",
                "nl": "toon kleine vinkjes",
                "fr": "montrer une tique mineure",
                "it": "mostra segno di spunta minore",
                "es": "mostrar marca menor",
                "pl": "pokaż drobne kleszcze",
                "zh-cn": "显示小勾"
            },
            "cloudshowTicks": {
                "en": "show tick",
                "de": "zeige ticks",
                "ru": "показать галочку",
                "pt": "show tick",
                "nl": "vinkje tonen",
                "fr": "montrer tique",
                "it": "mostra tick",
                "es": "mostrar marca",
                "pl": "pokaż tik",
                "zh-cn": "显示刻度"
            },
            "cloudtickDecimals": {
                "en": "decimals",
                "de": "Dezimalstellen",
                "ru": "десятичные",
                "pt": "decimais",
                "nl": "decimalen",
                "fr": "décimales",
                "it": "decimali",
                "es": "decimales",
                "pl": "miejsca po przecinku",
                "zh-cn": "小数点"
            },
            "cloudtickSize": {
                "en": "tick size",
                "de": "Tick-Größe",
                "ru": "размер галочки",
                "pt": "tamanho do carrapato",
                "nl": "teken grootte",
                "fr": "taille de la tique",
                "it": "dimensione tick",
                "es": "tamaño de la garrapata",
                "pl": "rozmiar kleszcza",
                "zh-cn": "刻度大小"
            },
            "cloudminTickSize": {
                "en": "min. tick size",
                "de": "Mindest. Tick-Größe",
                "ru": "минимум размер галочки",
                "pt": "min. tamanho do carrapato",
                "nl": "min. teken grootte",
                "fr": "min. taille de la tique",
                "it": "min. dimensione tick",
                "es": "min. tamaño de la garrapata",
                "pl": "min. rozmiar kleszcza",
                "zh-cn": "分钟刻度大小"
            },

            "templabelwidth": {
                "en": "label width",
                "de": "Labelbreite",
                "ru": "ширина этикетки",
                "pt": "largura da etiqueta",
                "nl": "labelbreedte",
                "fr": "largeur d'étiquette",
                "it": "larghezza dell'etichetta",
                "es": "ancho de etiqueta",
                "pl": "szerokość etykiety",
                "zh-cn": "标签宽度"
            },
            "rainlabelwidth": {
                "en": "label width",
                "de": "Labelbreite",
                "ru": "ширина этикетки",
                "pt": "largura da etiqueta",
                "nl": "labelbreedte",
                "fr": "largeur d'étiquette",
                "it": "larghezza dell'etichetta",
                "es": "ancho de etiqueta",
                "pl": "szerokość etykiety",
                "zh-cn": "标签宽度"
            },
            "chancerainlabelwidth": {
                "en": "label width",
                "de": "Labelbreite",
                "ru": "ширина этикетки",
                "pt": "largura da etiqueta",
                "nl": "labelbreedte",
                "fr": "largeur d'étiquette",
                "it": "larghezza dell'etichetta",
                "es": "ancho de etiqueta",
                "pl": "szerokość etykiety",
                "zh-cn": "标签宽度"
            },
            "cloudslabelwidth": {
                "en": "label width",
                "de": "Labelbreite",
                "ru": "ширина этикетки",
                "pt": "largura da etiqueta",
                "nl": "labelbreedte",
                "fr": "largeur d'étiquette",
                "it": "larghezza dell'etichetta",
                "es": "ancho de etiqueta",
                "pl": "szerokość etykiety",
                "zh-cn": "标签宽度"
            },
            "withlegend": {
                "en": "show legend",
                "de": "Legende anzeigen",
                "ru": "показать легенду",
                "pt": "mostrar legenda",
                "nl": "toon legende",
                "fr": "montrer la légende",
                "it": "mostra legenda",
                "es": "Mostrar leyenda",
                "pl": "pokaż legendę",
                "zh-cn": "显示传奇"
            },
            "legendposition": {
                "en": "legend position",
                "de": "Legendenposition",
                "ru": "положение легенды",
                "pt": "posição da legenda",
                "nl": "legende positie",
                "fr": "position de la légende",
                "it": "posizione della legenda",
                "es": "posición de leyenda",
                "pl": "pozycja legendy",
                "zh-cn": "图例位置"
            }

        });
    }

 

    vis.binds.weather = {
        version: "2.4.1",
        showVersion: function () {
            if (vis.binds.weather.version) {
                console.log('Version vis-weather: ' + vis.binds.weather.version);
                vis.binds.weather.version = null;
            }
        },
        setup: {
            intervals:
            {
                '1 second': 1000,
                '10 seconds': 10000,
                '30 seconds': 30000,
                '1 minute': 60000,
                '2 minutes': 120000,
                '5 minutes': 300000,
                '10 minutes': 600000,
                '30 minutes': 1800000,
                '1 hour': 3600000,
                '2 hours': 7200000,
                '4 hours': 14400000,
                '8 hours': 28800000,
                '12 hours': 43200000,
                '24 hours': 86400000
            },
        },
        tempandrain: {


            //==================================================================================
            //
            // just for test
            // will be commented out later
            test: function (widgetID, view, data, style) {
                console.log("test begins here ");

                var $div = $('#' + widgetID);
                // if nothing found => wait
                if (!$div.length) {
                    return setTimeout(function () {
                        console.log("need to wait...");
                        vis.binds.weather.tempandrain.test(widgetID, view, data, style);
                    }, 1000);
                }

                var text = '';
                text += 'OID: ' + data.oid + '</div><br>';
                text += 'OID value: <span class="myset-value">' + vis.states[data.oid + '.val'] + '</span><br>';
                text += 'Color: <span style="color: ' + data.myColor + '">' + data.myColor + '</span><br>';
                text += 'extraAttr: ' + data.extraAttr + '<br>';
                text += 'Browser instance: ' + vis.instance + '<br>';
                text += 'htmlText: <textarea readonly style="width:100%">' + (data.htmlText || '') + '</textarea><br>';

                $('#' + widgetID).html(text);

                // subscribe on updates of value
                if (data.oid) {
                    vis.states.bind(data.oid + '.val', function (e, newVal, oldVal) {
                        $div.find('.template-value').html(newVal);
                    });
                }

            },





            init: function (widgetID, view, data1, style) {
                var $div = $('#' + widgetID);
                console.log("temp and rain init (" + widgetID + ")");
                var data = {};
                for (var s in data1) {
                    if (s[0] !== '_' && data1.hasOwnProperty(s) && typeof data1[s] !== 'object' && typeof data1[s] !== 'function') {
                        data[s] = data1[s];
                    }

                }


                   function SetMarkingColor(color) {
        MarkingColor = color;
    }

    function degreeFormatter(v, axis) {
        return v.toFixed(axis.tickDecimals) + "°C";
    }

    function percentageFormatter(v, axis) {
        return v.toFixed(axis.tickDecimals) + "%";
    }

    function mmFormatter(v, axis) {
        return v.toFixed(axis.tickDecimals) + "mm";
    }

    function legendformater(label, series) {

        //wenn keine Daten, dann ausblenden ->  (return null)
        if (series.data == null || typeof series.data == "undefined" || typeof series.data[0] == "undefined") {

            console.log('legendformater no label because no data ');
            return null;
        }
        else {
            console.log('legendformater label ' + label);
            return label;
        }
    }

    function GridMarkings(axes) {

        var markings = [];
        var minDate = new Date(axes.xaxis.min);

        //start from midnight
        minDate.setHours(0);

        const dayDiff = (axes.xaxis.max - axes.xaxis.min) / 1000 / 60 / 60 / 24;
        console.log('GridMarkings: DayDiff ' + dayDiff + ' (' + axes.xaxis.max + ' ' + axes.xaxis.min + ') start at ' + minDate.toString());

        var i = minDate.getTime();

        //if we only few hours then we need markings per hour otherwise per day
        if (dayDiff > 2) {
            do {
                console.log("new day marking from " + i);
                markings.push({ xaxis: { from: i, to: i + 24 * 60 * 60 * 1000 }, color: MarkingColor });
                i += 2 * 24 * 60 * 60 * 1000;
            } while (i < axes.xaxis.max);

        }
        else {

            do {
                console.log("new hour marking from " + i);
                markings.push({ xaxis: { from: i, to: i + 60 * 60 * 1000 }, color: MarkingColor });
                i += 2 * 60 * 60 * 1000;
            } while (i < axes.xaxis.max);
        }
        return markings;

    }

    function CalcTicks4X(axis) {

        var ticks = [];

        var minDate = new Date(axis.min);

        const dayDiff = (axis.max - axis.min) / 1000 / 60 / 60 / 24;

        console.log('CalcTicks4X: DayDiff ' + dayDiff + ' (' + axis.max + ' ' + axis.min + ')');

        //if we only few hours then we need ticks per hour otherwise per day
        if (dayDiff > 2) {
            minDate.setHours(12);
            minDate.setMinutes(0);
            var i = minDate.getTime();
            do {
                console.log("new day tick at " + i);
                ticks.push([i]);
                i += 24 * 60 * 60 * 1000;
            } while (i < axis.max);
        }
        else {
            minDate.setHours(0);
            minDate.setMinutes(0);
            var i = minDate.getTime();
            do {
                console.log("new hour tick at " + i);
                ticks.push([i]);
                i += 6 * 60 * 60 * 1000;
            } while (i < axis.max);
        }
        return ticks;
    }



                function update() {

                    console.log("ShowChart temp/rain/cloud  (" + widgetID + ")");

                    var $div = $('#' + widgetID);
                    // if nothing found => wait
                    if (!$div.length) {
                        return setTimeout(function () {
                            console.log("need to wait... (" + widgetID + ")");
                            update();
                        }, 1000);
                    }

                    console.log("ShowChart temp/rain/cloud begin (" + widgetID + ")");

                    if (!data || !data.instance) {
                        console.log("keine instanz  (" + widgetID + ")");
                        $div.html("<br> <center> <font color='red'> no instance for DasWetter specified </font> </center></br>");
                    }
                    else if (data.instance.indexOf("daswetter") > -1 && data.oid_date == "") {
                        console.log("no OID's for DasWetter  (" + widgetID + ")");
                        $div.html("<br> <center> <font color='red'> no OID's for DasWetter specified </font> </center></br>");
                    }
                    else {



                        SetMarkingColor(data.markingcolor);

                        var values_rain = [];
                        var values_chancerain = [];
                        var maxY_rain = -99;
                        var minY_rain = 100;
                        var values_temp = [];
                        var maxY_temp = -99;
                        var minY_temp = 100;
                        var values_cloud = [];
                        var maxY_cloud = 100;
                        var minY_cloud = 0;
                        var cnt = 0;


                        var max_cnt = 0;
                        var day = 0;
                        var month = 0;
                        var year = 0;
                        var hour = 0;
                        var minute = 0;

                        var dateMin = -1;
                        var dateMax = -1;

                        var nTimeDiff = -1;
                        var oldHour = -1;

                        if (data.instance.indexOf("daswetter") > -1) {

                            //get first date only for DasWetter.com
                            //20180825
                            var oid_first_date = data.oid_date;
                            var sDate = vis.states[oid_first_date + '.val'];
                            var day = parseInt(sDate.substring(6, 8), 10);
                            var month = parseInt(sDate.substring(4, 6), 10);
                            var year = parseInt(sDate.substring(0, 4), 10);
                            //console.log("got " + sDate + " from " + oid_first_date);
                            console.log("got first date " + sDate + " = " + day + "." + month + "." + year);
                            month--;

                            max_cnt = 40;
                            data.chancerainvisible = false; // value not available!!

                        }
                        else if (data.instance.indexOf("weatherunderground") > -1) {
                            max_cnt = 36;
                        }

                        //console.log("date is " + day +"."+month+"."+year);
                        var lastHour = -1;
                        for (var d = 0; d < max_cnt; d++) {

                            //get rain values
                            var oid_rain = data['oid_rain' + d];
                            var val_rain = parseFloat(vis.states[oid_rain + '.val']);
                            //console.log("got " + val_rain + " from " + oid_rain);
                            if (val_rain > maxY_rain) maxY_rain = val_rain;
                            if (val_rain < minY_rain) minY_rain = val_rain;
                            var oid_chancerain = data['oid_chancerain' + d];
                            var val_chancerain = parseInt(vis.states[oid_chancerain + '.val'], 10);
                            //console.log("got " + val_chancerain + " from " + oid_chancerain);


                            //get temperature values
                            var oid_temp = data['oid_temp' + d];
                            var val_temp = parseInt(vis.states[oid_temp + '.val'], 10);
                            //console.log("got " + val_temp + " from " + oid_temp);
                            if (val_temp > maxY_temp) maxY_temp = val_temp;
                            if (val_temp < minY_temp) minY_temp = val_temp;

                            //get cloud values
                            var oid_cloud = data['oid_cloud' + d];
                            var val = parseInt(vis.states[oid_cloud + '.val'], 10);
                            //console.log("got " + val + " from " + oid_cloud);
                            var val_cloud = 0;
                            if (data.sunorcloud == "sun") { //invert value
                                val_cloud = 100 - val;
                            }
                            else {
                                val_cloud = val;
                            }

                            // get time
                            var oid = data['oid_hour' + d];
                            //console.log("check " + oid);
                            if (oid.length < 3) {
                                //stop loop here
                                console.log("less then " + max_cnt + " oid (" + d + ") found");
                                d = max_cnt;
                                break;
                            }
                            var sTime = vis.states[oid + '.val'];
                            //console.log("got " + sTime + " from " + oid);
                            //console.log("got " + sTime );

                            var bDateNotValid = false;
                            var month1 = month + 1;
                            //console.log("### date " + day + "." + month1 + "." + year);

                            var oDate;
                            if (data.instance.indexOf("daswetter") > -1) {

                                hour = parseInt(sTime.substring(0, 2), 10);
                                minute = parseInt(sTime.substring(3, 5), 10);

                                oDate = new Date(year, month, day, hour, minute, 0, 0);

                                //console.log("### check next day " + hour + " ? " + lastHour + " at " + oDate.toLocaleString());

                                //check next day
                                if (hour < lastHour) {
                                    oDate.setDate(oDate.getDate() + 1);
                                    day = oDate.getDate();
                                    month = oDate.getMonth();
                                    year = oDate.getFullYear();

                                    //console.log("### next day found " + oDate.toLocaleString());
                                }
                                lastHour = hour;
                            }
                            else if (data.instance.indexOf("weatherunderground") > -1) {





                                if (typeof sTime == 'undefined') {
                                    bDateNotValid = true;
                                }
                                else {



                                    //check which version??
                                    //V1.x: 05:00 PM CEST am 18. August 2018
                                    //V2.x: 8/18/2018, 5:00:00 PM
                                    //      oder 2018 - 8 - 19 12: 00: 00
                                    var oTemp = sTime.split(' ');
                                    var wuversion = 0;
                                    if (oTemp[1] == "PM" || oTemp[1] == "AM") {
                                        wuversion = 1;
                                        //console.log("+++ old version +++");
                                    }
                                    else {
                                        wuversion = 2;
                                        //console.log("+++ new version +++");
                                    }

                                    if (wuversion == 2) {

                                        //acc. https://stackoverflow.com/questions/4310953/invalid-date-in-safari#
                                        //safari doesnt support 2018-8-26
                                        //it supports:
                                        //MM - dd - yyyy
                                        //yyyy / MM / dd
                                        //MM / dd / yyyy
                                        //MMMM dd, yyyy
                                        //MMM dd, yyyy
                                        //so we just replace '-' by '/'

                                        //test only:
                                        //sTime = "2018-8-26";

                                        //in WU wird ToLocalstring verwendet
                                        var oDateWU = new Date(sTime.replace(/-/g, "/"));
                                        hour = oDateWU.getHours();
                                        minute = oDateWU.getMinutes();
                                        year = oDateWU.getFullYear();
                                        month = oDateWU.getMonth();
                                        day = oDateWU.getDate();
                                        //console.log("--------" + sTime + " = " + oDateWU.toLocaleString());
                                    }
                                    else {
                                        // WU V1.0

                                        //04:00 PM CEST am 14. Mai 2017

                                        var oTemp1 = oTemp[0].split(':');

                                        hour = parseInt(oTemp1[0], 10);
                                        if (oTemp[1] == "PM" && hour != 12) {
                                            hour += 12; //PM
                                        }
                                        if (oTemp[1] == "AM" && hour == 12) {
                                            hour = 0; //AM
                                        }
                                        //12 PM ist 12 Mittags
                                        //12 AM ist 0 Nachts

                                        minute = parseInt(oTemp1[1], 10);
                                        year = parseInt(oTemp[6], 10);

                                        switch (oTemp[5]) {
                                            case "Januar": month = 0; break;
                                            case "Februar": month = 1; break;
                                            case "März": month = 2; break;
                                            case "April": month = 3; break;
                                            case "Mai": month = 4; break;
                                            case "Juni": month = 5; break;
                                            case "Juli": month = 6; break;
                                            case "August": month = 7; break;
                                            case "September": month = 8; break;
                                            case "Oktober": month = 9; break;
                                            case "November": month = 10; break;
                                            case "Dezember": month = 11; break;
                                        }


                                        day = parseInt(oTemp[4], 10);
                                    }
                                    //console.log("--------" + day + "." + month + 1 + "." + year + " " + hour + ":" + minute);
                                    oDate = new Date(year, month, day, hour, minute, 0, 0);
                                }
                            }
                            //console.log("-#--#---" + day + "." + month + "." + year + " " + hour + ":" + minute);

                            if (oldHour > 0) {
                                nTimeDiff = hour - oldHour;
                            }
                            //console.log("++++ timediff " + nTimeDiff);
                            oldHour = hour;

                            console.log("### " + oDate.toLocaleString() + " = " + oDate.getTime() + " rain: " + val_rain + " temp: " + val_temp + " cloud: " + val_cloud);

                            if (!bDateNotValid) {
                                //need time in UTC
                                var date = oDate.getTime();

                                if (dateMin === -1) {
                                    dateMin = date;
                                }
                                dateMax = date;
                                //console.log(date);
                                values_rain.push([date, val_rain]);
                                values_temp.push([date, val_temp]);
                                values_cloud.push([date, val_cloud]);
                                values_chancerain.push([date, val_chancerain]);
                            }
                        }



                        //maxY += 0.1 * maxY;
                        //minY -= 0.1 * minY;

                        maxY_temp = Math.ceil((maxY_temp + 1) / 10) * 10;
                        if (minY_temp > 0) {
                            minY_temp = 0;
                        }
                        else {
                            var temp1 = Math.abs(minY_temp);

                            minY_temp = Math.ceil((temp1 + 1) / 10) * 10;
                            minY_temp = -1.0 * minY_temp;
                        }

                        console.log("maxY_temp " + data.maxY_temp);
                        if (parseInt(data.maxY_temp, 10) != 0) {
                            maxY_temp = parseInt(data.maxY_temp, 10);
                        }

                        console.log("minY_temp " + data.minY_temp);
                        if (parseInt(data.minY_temp, 10) != 0) {
                            minY_temp = parseInt(data.minY_temp, 10);
                        }


                        maxY_rain = Math.ceil((maxY_rain + 1) / 10) * 10;
                        if (maxY_rain < 10) maxY_rain = 10;

                        console.log("start with maxRain " + maxY_rain + " minRain " + minY_rain + " maxTemp " + maxY_temp + " minTemp " + minY_temp + " " + dateMin + " " + dateMax);


                        var barwidth = 0;
                        if (data.instance.indexOf("daswetter") > -1) {

                            if (nTimeDiff > 0) {
                                barwidth = 1000 * 60 * 60 * nTimeDiff;
                            }
                            else {
                                barwidth = 1000 * 60 * 60 * 1; //1h
                            }
                        }
                        else if (data.instance.indexOf("weatherunderground") > -1) {
                            barwidth = 1000 * 60 * 60 * 0.5; //0.5h
                        }
                        console.log("barwidth = " + barwidth + " with TimeDiff " + nTimeDiff + "ms"); // in ms



                        console.log("start plot (" + widgetID + ") ");

                        

                        $.plot($div,
                            [{
                                data: data.chancerainvisible ? values_chancerain : {},
                                color: data.chanceraincolor,
                                xaxis: 1,
                                yaxis: 4,
                                label: data.chancerainname,
                                lines: { show: false },
                                bars:
                                {
                                    show: true,
                                    barWidth: [barwidth, true],
                                    align: "left", //"center",
                                    horizontal: false
                                }
                            },

                            {
                                data: data.tempvisible ? values_temp : {},
                                color: data.tempcolor,
                                xaxis: 1,
                                yaxis: 1,
                                label: data.tempname,
                                lines: { show: data.tempchartType == "line" ? true : false, fill: false },
                                bars:
                                {
                                    show: data.tempchartType == "bar" ? true : false,
                                    barWidth: [barwidth, true],
                                    align: "left", //"center",
                                    horizontal: false
                                }
                            },
                            {
                                data: data.rainvisible ? values_rain : {},
                                color: data.raincolor,
                                xaxis: 1,
                                yaxis: 2,
                                label: data.rainname,
                                lines: { show: data.rainchartType == "line" ? true : false, fill: false },
                                bars:
                                {
                                    show: data.rainchartType == "bar" ? true : false,
                                    barWidth: [barwidth, true],
                                    align: "left", //"center",
                                    horizontal: false
                                }
                            },
                            {
                                data: data.cloudsvisible ? values_cloud : {},
                                color: data.cloudcolor,
                                xaxis: 1,
                                yaxis: 3,
                                label: data.cloudsname,
                                lines: { show: data.cloudschartType == "line" ? true : false, fill: false },
                                bars:
                                {
                                    show: data.cloudschartType == "bar" ? true : false,
                                    barWidth: [barwidth, true],
                                    align: "left", //"center",
                                    horizontal: false
                                }
                            }

                            ],
                            {

                                xaxes:
                                    [{
                                        axisLabelUseCanvas: true,
                                        axisLabelColour: 'orange',

                                        show: data.withxaxix,
                                        mode: "time",
                                        timeBase: "milliseconds",
                                        tickLength: 5,

                                        min: dateMin,
                                        max: dateMax,
                                        //ticks: data.ticksonxaxix > 0 ? parseInt(data.ticksonxaxix, 10) : 5,
                                        ticks: CalcTicks4X,
                                        autoScale: "none",
                                        timeformat: data.xDateFormat,
                                        monthNames: ["Jan", "Feb", "Mar", "Apr", "Mai", "Jun", "Jul", "Aug", "Sep", "Okt", "Nov", "Dez"],
                                        color: data.tickscolor,
                                        tickColor: data.tickscolor,
                                        font: {
                                            size: data.LabelFontSize,
                                            lineHeight: 13,
                                            style: "normal", //"italic",
                                            weight: "bold",
                                            family: data.LabelFontFamily,
                                            variant: "small-caps",
                                            color: data.axislabelcolor,


                                        },
                                        timezone: "browser"
                                    }],

                                yaxes:

                                    //temp y-axis #1
                                    [{
                                        axisLabelUseCanvas: true,
                                        axisLabelColour: 'orange',


                                        show: (data.tempvisible && data.yTempVisible),
                                        //max: parseInt(data.maxY_temp,10) != 0 ? parseInt(data.maxY_temp, 10) : maxY_temp, //0 = default = auto determine max/min value
                                        //min: parseInt(data.minY_temp,10) != 0 ? parseInt(data.minY_temp, 10) : minY_temp,
                                        max: maxY_temp,
                                        min: minY_temp,
                                        autoScale: "none", // Available modes: "none", "loose", "exact"
                                        showTickLabels: "major",
                                        alignTicksWithAxis: 1,
                                        position: 'left',
                                        //ticks: 3,

                                        tickLength: parseFloat(data.temptickLength),            //20, // size in pixels of major tick marks
                                        showMinorTicks: data.tempshowMinorTicks,    //false, // true = show minor tick marks, false = hide minor tick marks
                                        showTicks: data.tempshowTicks,              //true, // true = show tick marks, false = hide all tick marks
                                        tickDecimals: data.temptickDecimals,        //1, // no. of decimals, null means auto
                                        tickSize: data.temptickSize,                //3, // number or [number, "unit"]
                                        minTickSize: data.tempminTickSize,          //1, // number or [number, "unit"]


                                        color: data.tempcoloraxis,
                                        tickColor: data.tempcoloraxis,

                                        labelWidth: parseFloat(data.templabelwidth),
                                        //offset: {
                                        //    below: 0,
                                        //    above: 0
                                        //},

                                        //boxPosition: {                          ////position of the axis on the corresponding axis box
                                        //    centerX: 0,
                                        //    centerY: 0
                                        //},

                                        font: {
                                            size: data.LabelFontSize,
                                            lineHeight: 13,
                                            style: "normal", //"italic",
                                            weight: "bold",
                                            family: data.LabelFontFamily,
                                            variant: "small-caps",
                                            color: data.tempcolorticklabel,
                                        },
                                        tickFormatter: degreeFormatter
                                    },

                                    //rain visible y-axis #2
                                    {
                                        axisLabelUseCanvas: true,
                                        axisLabelColour: 'orange',

                                        show: (data.rainvisible && data.yRainVisible),
                                        max: maxY_rain,
                                        min: 0,
                                        autoScale: "none", // Available modes: "none", "loose", "exact"
                                        showTickLabels: "major",
                                        alignTicksWithAxis: 2,
                                        position: 'right',
                                        //ticks: 3,

                                        tickLength: parseFloat(data.raintickLength),            //20, // size in pixels of major tick marks
                                        showMinorTicks: data.rainshowMinorTicks,    //false, // true = show minor tick marks, false = hide minor tick marks
                                        showTicks: data.rainshowTicks,              //true, // true = show tick marks, false = hide all tick marks
                                        tickDecimals: data.raintickDecimals,        //1, // no. of decimals, null means auto
                                        tickSize: data.raintickSize,                //3, // number or [number, "unit"]
                                        minTickSize: data.rainminTickSize,          //1, // number or [number, "unit"]


                                        color: data.raincoloraxis,
                                        tickColor: data.raincoloraxis,

                                        labelWidth: parseFloat(data.rainlabelwidth),
                                        //offset: {
                                        //    below: 0,
                                        //    above: 0
                                        //},

                                        //boxPosition: {                          ////position of the axis on the corresponding axis box
                                        //    centerX: 0,
                                        //    centerY: 0
                                        //},

                                        font: {
                                            size: data.LabelFontSize,
                                            lineHeight: 13,
                                            style: "normal", //"italic",
                                            weight: "bold",
                                            family: data.LabelFontFamily,
                                            variant: "small-caps",
                                            color: data.raincolorticklabel,
                                        },
                                        tickFormatter: mmFormatter
                                    },

                                    //sun-cloud y-axis
                                    {
                                        axisLabelUseCanvas: true,
                                        axisLabelColour: 'orange',

                                        show: (data.cloudsvisible && data.yCloudVisible),
                                        max: maxY_cloud,
                                        min: minY_cloud,
                                        autoScale: "none", // Available modes: "none", "loose", "exact"
                                        showTickLabels: "major",
                                        alignTicksWithAxis: 3,
                                        position: 'left',
                                        //ticks: 3,

                                        tickLength: parseFloat(data.cloudtickLength),            //20, // size in pixels of major tick marks
                                        showMinorTicks: data.cloudshowMinorTicks,    //false, // true = show minor tick marks, false = hide minor tick marks
                                        showTicks: data.cloudshowTicks,              //true, // true = show tick marks, false = hide all tick marks
                                        tickDecimals: data.cloudtickDecimals,        //1, // no. of decimals, null means auto
                                        tickSize: data.cloudtickSize,                //3, // number or [number, "unit"]
                                        minTickSize: data.cloudminTickSize,          //1, // number or [number, "unit"]

                                        color: data.cloudcoloraxis,
                                        tickColor: data.cloudcoloraxis,

                                        labelWidth: parseFloat(data.cloudslabelwidth),
                                        //offset: {
                                        //    below: 0,
                                        //    above: 0
                                        //},

                                        //boxPosition: {                          ////position of the axis on the corresponding axis box
                                        //    centerX: 0,
                                        //    centerY: 0
                                        //},

                                        font: {
                                            size: data.LabelFontSize,
                                            lineHeight: 13,
                                            style: "normal", //"italic",
                                            weight: "bold",
                                            family: data.LabelFontFamily,
                                            variant: "small-caps",
                                            color: data.cloudcolorticklabel
                                        },
                                        tickFormatter: percentageFormatter
                                    },

                                    //chance rain y-axis  #4
                                    {
                                        axisLabelUseCanvas: true,
                                        axisLabelColour: 'orange',

                                        show: (data.chancerainvisible && data.yChanceRainVisible),  //much better visible without
                                        max: 100,
                                        min: 0,
                                        autoScale: "none", // Available modes: "none", "loose", "exact"
                                        showTickLabels: "major",
                                        alignTicksWithAxis: 4,
                                        position: 'right',
                                        //ticks: 3,

                                        tickLength: parseFloat(data.chanceraintickLength),            //20, // size in pixels of major tick marks
                                        showMinorTicks: data.chancerainshowMinorTicks,    //false, // true = show minor tick marks, false = hide minor tick marks
                                        showTicks: data.chancerainshowTicks,              //true, // true = show tick marks, false = hide all tick marks
                                        tickDecimals: data.chanceraintickDecimals,        //1, // no. of decimals, null means auto
                                        tickSize: data.chanceraintickSize,                //3, // number or [number, "unit"]
                                        minTickSize: data.chancerainminTickSize,          //1, // number or [number, "unit"]


                                        color: data.chanceraincoloraxis,
                                        tickColor: data.chanceraincoloraxis,

                                        labelWidth: parseFloat(data.chancerainlabelwidth),
                                        //offset: {
                                        //    below: 0,
                                        //    above: 0
                                        //},

                                        //boxPosition: {                          ////position of the axis on the corresponding axis box
                                        //    centerX: 0,
                                        //    centerY: 0
                                        //},

                                        font: {
                                            size: data.LabelFontSize,
                                            lineHeight: 13,
                                            style: "normal", //"italic",
                                            weight: "bold",
                                            family: data.LabelFontFamily,
                                            variant: "small-caps",

                                            color: data.chanceraincolorticklabel
                                        },
                                        tickFormatter: percentageFormatter
                                    }],
                                grid:
                                {
                                    markings: data.withmarking ? GridMarkings : null,

                                    // backgroundColor: data.nobgcolor ? null : { colors: ["#fff", "#eee"] },
                                    backgroundColor: data.nobgcolor ? null : data.bgcolor,
                                    borderWidth:  parseFloat(data.borderWidth), //data.withborder,
                                    borderColor: data.bordercolor,
                                    margin: 1,
                                    /*
                                    borderWidth: {
                                        top: data.withborder ? 1 : 0,
                                        right: data.withborder ? 1 : 0,
                                        bottom: data.withborder ? 2 : 0,
                                        left: data.withborder ? 2 : 0
                                    },*/

                                },
                                legend: {
                                    show: data.withlegend,
                                    labelFormatter: legendformater,
                                    //labelBoxBorderColor: color,
                                    //noColumns: number,
                                    position: data.legendposition,
                                    //margin: number of pixels or [x margin, y margin]
                                    backgroundColor: null,
                                    backgroundOpacity: 0,
                                    container: null,
                                    sorted: false
                                },
                            }
                        );
                    }
                };



                if (data.instance) {
                    //Umschalten wu / daswetter und auf oid zugreifen
                    var max_cnt = 0;
                    if (data.instance.indexOf("daswetter") > -1) {
                        var oid_first_date = data.oid_date;
                        //console.log("bind " + oid_first_date);
                        vis.states.bind(oid_first_date + '.val', function () {
                            update();
                        });
                        max_cnt = 40;
                    }

                    else if (data.instance.indexOf("weatherunderground") > -1) {
                        max_cnt = 36;
                    }

                    else {
                        console.log("no wether instance set in init " + data.instance);
                    }

                    if (data.instance.indexOf("weatherunderground") > -1) {
                        for (var i = 0; i < max_cnt; i++) {
                            //get chance rain oid
                            var oid_chancerain = data['oid_chancerain' + i];
                            //console.log("bind " + oid_chancerain);
                            vis.states.bind(oid_chancerain + '.val', function () {
                                update();
                            });
                        }

                    }

                    //gilt für beide nur mit unterschiedlichen grenzen
                    for (var i = 0; i < max_cnt; i++) {
                        //get rain oid
                        var oid_rain = data['oid_rain' + i];
                        //console.log("bind " + oid_rain);
                        vis.states.bind(oid_rain + '.val', function () {
                            update();
                        });
                        //get temperature oid
                        var oid_temp = data['oid_temp' + i];
                        //console.log("bind " + oid_temp);
                        vis.states.bind(oid_temp + '.val', function () {
                            update();
                        });
                        //get cloud oid
                        var oid_cloud = data['oid_cloud' + i];
                        //console.log("bind " + oid_cloud);
                        vis.states.bind(oid_cloud + '.val', function () {
                            update();
                        });
                        // get time oid
                        var oid_hour = data['oid_hour' + i];
                        //console.log("bind " + oid_hour);
                        vis.states.bind(oid_hour + '.val', function () {
                            update();
                        });
                    }

                    // update every x seconds
                    if (!vis.editMode) {
                        $div.data('timer', setInterval(function () {
                            update();
                        }, parseInt(vis.binds.weather.setup.intervals[data.time_interval] / (parseInt(data.points, 10) || 10), 10)));
                    }
                }
                else {
                    console.log("instance not set ");
                }
                update();
                if (vis.editMode) {
                    console.log("flot version " + $.plot.version + " for weather");
                }
            }
        },
    };

    if (vis.editMode) {
        vis.binds.weather.onInstanceChanged = function (widgetID, view, newId, fields) {
            //we use the same callback for different changes;
            //so we need to check what have been changed...
            console.log('--------- : ' + widgetID + ' - ' + view + ' - ' + newId + ' - ' + fields);
            var instanceID = "";
            var datastructurename = "";
            if (fields == "instance") {
                instanceID = newId;
                datastructurename = vis.widgets[widgetID].data.datastructure;
                console.log('instance changed to ' + newId + ' old structure = ' + datastructurename);
            }

            else if (fields == "datastructure") {
                datastructurename = newId;
                instanceID = vis.widgets[widgetID].data.instance;
                console.log('datastructure changed to ' + newId + ' old instance = ' + instanceID);
            }



            //delete all
            vis.views[view].widgets[widgetID].data.oid_date = "";
            vis.widgets[widgetID].data.oid_date = "";

            for (var h = 0; h < 40; h++) {
                vis.views[view].widgets[widgetID].data['oid_rain' + h] = "";
                vis.widgets[widgetID].data['oid_rain' + h] = "";
                vis.views[view].widgets[widgetID].data['oid_chancerain' + h] = "";
                vis.widgets[widgetID].data['oid_chancerain' + h] = "";
                vis.views[view].widgets[widgetID].data['oid_temp' + h] = "";
                vis.widgets[widgetID].data['oid_temp' + h] = "";
                vis.views[view].widgets[widgetID].data['oid_cloud' + h] = "";
                vis.widgets[widgetID].data['oid_cloud' + h] = "";
                vis.views[view].widgets[widgetID].data['oid_hour' + h] = "";
                vis.widgets[widgetID].data['oid_hour' + h] = "";
            }

            //wu oder DasWetter (umschaltbar)

            var changed = [];
            var oid_rain = "";
            var oid_chancerain = "";
            var oid_temp = "";
            var oid_cloud = "";
            var oid_hour = "";

            if (instanceID.indexOf("daswetter") > -1) {
                var daswetterversion = 0;
                //with 1.x: daswetter.0.NextDaysDetailed.0d.date 20180524
                //with 2.x: daswetter.0.NextDaysDetailed.Location_1.Day_1.day_value 20180524
                var oid_first_date = "";
                if (vis.views[view].widgets[widgetID].data.datastructure == "NextDaysDetailed") {
                    oid_first_date = instanceID + ".NextDaysDetailed.Location_1.Day_1.day_value";
                }

                else if (vis.views[view].widgets[widgetID].data.datastructure == "NextHours") {
                    oid_first_date = instanceID + ".NextHours.Location_1.Day_1.day_value";
                }

                else if (vis.views[view].widgets[widgetID].data.datastructure == "NextHours2") {
                    oid_first_date = instanceID + ".NextHours2.Location_1.Day_1.date";
                }


                if (vis.objects[oid_first_date]) {
                    daswetterversion = 2;
                    console.log("using new data structure with DasWetter");
                }

                else {
                    oid_first_date = instanceID + ".NextDaysDetailed.0d.date";
                    if (vis.objects[oid_first_date]) {
                        daswetterversion = 1;
                        console.log("using old data structure with DasWetter");
                    }

                }

                //which datastructure
                console.log("datastructure is " + vis.views[view].widgets[widgetID].data.datastructure);


                if (vis.objects[oid_first_date]) {
                    //console.log(oid_first_date + " updated ");
                    vis.views[view].widgets[widgetID].data.oid_date = oid_first_date;
                    vis.widgets[widgetID].data.oid_date = oid_first_date;
                }

                var cnt = 0;
                var max_days = 5;
                var max_periods = 8;


                //we only have 40 OID'S!!!
                if (daswetterversion == 2) {
                    if (vis.views[view].widgets[widgetID].data.datastructure == "NextDaysDetailed") {
                        max_days = 5;
                        max_periods = 8;
                    }

                    else if (vis.views[view].widgets[widgetID].data.datastructure == "NextHours") {
                        max_days = 5;
                        max_periods = 24;
                    }

                    else if (vis.views[view].widgets[widgetID].data.datastructure == "NextHours2") {
                        max_days = 5;
                        max_periods = 8;
                    }

                }


                for (var d = 0; d < max_days; d++) {
                    for (var p = 0; p < max_periods; p++) {
                        //get rain oid

                        if (daswetterversion == 1) {
                            oid_rain = instanceID + ".NextDaysDetailed." + d + "d." + p + "h.Rain";
                            //get temperature oid
                            oid_temp = instanceID + ".NextDaysDetailed." + d + "d." + p + "h.Temperature";
                            //get cloud oid
                            oid_cloud = instanceID + ".NextDaysDetailed." + d + "d." + p + "h.Clouds";
                            // get time oid
                            oid_hour = instanceID + ".NextDaysDetailed." + d + "d." + p + "h.hour";
                        }
                        else if (daswetterversion == 2) {
                            //daswetter.0.NextDaysDetailed.Location_1.Day_1.Hour_1.rain.value
                            var dd = d + 1;
                            var pp = p + 1;
                            //NextDaysDetailed,NextHours,NextHours2
                            if (datastructurename == "NextDaysDetailed") {
                                //daswetter.0.NextDaysDetailed.Location_1.Day_1.Hour_1.rain_value
                                oid_rain = instanceID + ".NextDaysDetailed.Location_1.Day_" + dd + ".Hour_" + pp + ".rain_value";
                                //get temperature oid
                                oid_temp = instanceID + ".NextDaysDetailed.Location_1.Day_" + dd + ".Hour_" + pp + ".temp_value";
                                //get cloud oid
                                oid_cloud = instanceID + ".NextDaysDetailed.Location_1.Day_" + dd + ".Hour_" + pp + ".clouds_value";
                                // get time oid
                                oid_hour = instanceID + ".NextDaysDetailed.Location_1.Day_" + dd + ".Hour_" + pp + ".hour_value";
                            }

                            else if (datastructurename == "NextHours") {
                                //daswetter.0.NextHours.Location_1.Day_1.Hour_1.rain_value
                                oid_rain = instanceID + ".NextHours.Location_1.Day_" + dd + ".Hour_" + pp + ".rain_value";
                                //get temperature oid //daswetter.0.NextHours.Location_1.Day_1.Hour_1.temp_value
                                oid_temp = instanceID + ".NextHours.Location_1.Day_" + dd + ".Hour_" + pp + ".temp_value";
                                //get cloud oid //daswetter.0.NextHours.Location_1.Day_1.Hour_1.clouds_value
                                oid_cloud = instanceID + ".NextHours.Location_1.Day_" + dd + ".Hour_" + pp + ".clouds_value";
                                // get time oid //daswetter.0.NextHours.Location_1.Day_1.Hour_1.hour_value
                                oid_hour = instanceID + ".NextHours.Location_1.Day_" + dd + ".Hour_" + pp + ".hour_value";
                            }

                            else if (datastructurename == "NextHours2") {
                                //daswetter.0.NextHours2.Location_1.Day_1.Hour_1.rain
                                oid_rain = instanceID + ".NextHours2.Location_1.Day_" + dd + ".Hour_" + pp + ".rain";
                                //get temperature oid //daswetter.0.NextHours2.Location_1.Day_1.Hour_1.temp
                                oid_temp = instanceID + ".NextHours2.Location_1.Day_" + dd + ".Hour_" + pp + ".temp";
                                //get cloud oid //daswetter.0.NextHours2.Location_1.Day_1.Hour_1.clouds
                                oid_cloud = instanceID + ".NextHours2.Location_1.Day_" + dd + ".Hour_" + pp + ".clouds";
                                // get time oid //daswetter.0.NextHours2.Location_1.Day_1.Hour_1.hour
                                oid_hour = instanceID + ".NextHours2.Location_1.Day_" + dd + ".Hour_" + pp + ".hour";
                            }

                        }

                        else {
                            console.log("could not define which version to use with DasWetter");
                        }

                        if (vis.objects[oid_rain]) {
                            //console.log(oid_rain + " updated ");
                            vis.views[view].widgets[widgetID].data['oid_rain' + cnt] = oid_rain;
                            vis.widgets[widgetID].data['oid_rain' + cnt] = oid_rain;
                        }

                        if (vis.objects[oid_temp]) {
                            //console.log(oid_temp + " updated ");
                            vis.views[view].widgets[widgetID].data['oid_temp' + cnt] = oid_temp;
                            vis.widgets[widgetID].data['oid_temp' + cnt] = oid_temp;
                        }

                        if (vis.objects[oid_cloud]) {
                            //console.log(oid_cloud + " updated ");
                            vis.views[view].widgets[widgetID].data['oid_cloud' + cnt] = oid_cloud;
                            vis.widgets[widgetID].data['oid_cloud' + cnt] = oid_cloud;
                        }

                        if (vis.objects[oid_hour]) {
                            //console.log(oid_hour + " updated ");
                            vis.views[view].widgets[widgetID].data['oid_hour' + cnt] = oid_hour;
                            vis.widgets[widgetID].data['oid_hour' + cnt] = oid_hour;
                        }

                        cnt++;
                        if (cnt >= 40) {
                            console.log("OID limit reached");
                            break;
                        }

                    }
                }
            }

            else if (instanceID.indexOf("weatherunderground") > -1) {
                vis.views[view].widgets[widgetID].data.datastructure = "";
                vis.widgets[widgetID].data.datastructure = "";
                var wuversion = 0;
                //weatherunderground.0.forecastHourly.0h.time
                var oid_version_check = instanceID + ".forecastHourly.0h.time";
                if (vis.objects[oid_version_check]) {
                    wuversion = 2;
                    console.log("using new data structure with WU");
                }

                else {
                    //weatherunderground.0.forecast.0h.time
                    oid_version_check = instanceID + ".forecast.0h.time";
                    if (vis.objects[oid_version_check]) {
                        wuversion = 1;
                        console.log("using old data structure with WU");
                    }

                }



                for (var h = 0; h < 36; h++) {
                    if (wuversion == 1) {
                        //get rain oid weatherunderground.0.forecast.0h.qpf
                        oid_rain = instanceID + ".forecast." + h + "h.qpf";
                        //get rain oid weatherunderground.0.forecast.0h.qpf
                        oid_chancerain = instanceID + ".forecast." + h + "h.pop";
                        //get temperature oid weatherunderground.0.forecast.0h.temp
                        oid_temp = instanceID + ".forecast." + h + "h.temp";
                        //get cloud oid weatherunderground.0.forecast.0h.sky
                        oid_cloud = instanceID + ".forecast." + h + "h.sky";
                        // get time oid
                        oid_hour = instanceID + ".forecast." + h + "h.time";
                    }

                    else if (wuversion == 2) {
                        //get rain oid weatherunderground.0.forecastHourly.0h.precipitation
                        oid_rain = instanceID + ".forecastHourly." + h + "h.precipitation";
                        //get rain oid weatherunderground.0.forecastHourly.0h.precipitationChance
                        oid_chancerain = instanceID + ".forecastHourly." + h + "h.precipitationChance";
                        //get temperature oid weatherunderground.0.forecastHourly.0h.temp
                        oid_temp = instanceID + ".forecastHourly." + h + "h.temp";
                        //get cloud oid weatherunderground.0.forecastHourly.0h.sky
                        oid_cloud = instanceID + ".forecastHourly." + h + "h.sky";
                        // get time oid weatherunderground.0.forecastHourly.0h.time
                        oid_hour = instanceID + ".forecastHourly." + h + "h.time";
                    }

                    else {
                        console.log("could not define which version to use with WU");
                    }

                    if (vis.objects[oid_rain]) {
                        //console.log(oid_rain + " updated ");
                        vis.views[view].widgets[widgetID].data['oid_rain' + h] = oid_rain;
                        vis.widgets[widgetID].data['oid_rain' + h] = oid_rain;
                    }

                    else {
                        //console.log("wrong version of weatherunderground? >1.0.5?");
                    }

                    if (vis.objects[oid_chancerain]) {
                        //console.log(oid_chancerain + " updated ");
                        vis.views[view].widgets[widgetID].data['oid_chancerain' + h] = oid_chancerain;
                        vis.widgets[widgetID].data['oid_chancerain' + h] = oid_rain;
                    }

                    if (vis.objects[oid_temp]) {
                        //console.log(oid_temp + " updated ");
                        vis.views[view].widgets[widgetID].data['oid_temp' + h] = oid_temp;
                        vis.widgets[widgetID].data['oid_temp' + h] = oid_temp;
                    }

                    if (vis.objects[oid_cloud]) {
                        //console.log(oid_cloud + " updated ");
                        vis.views[view].widgets[widgetID].data['oid_cloud' + h] = oid_cloud;
                        vis.widgets[widgetID].data['oid_cloud' + h] = oid_cloud;
                    }

                    if (vis.objects[oid_hour]) {
                        //console.log(oid_hour + " updated ");
                        vis.views[view].widgets[widgetID].data['oid_hour' + h] = oid_hour;
                        vis.widgets[widgetID].data['oid_hour' + h] = oid_hour;
                    }

                }
            }

            else {
                //ja was nun? do nothing
                console.log(" no weather instance set ");
            }

            return changed;
        }
    }

    vis.binds.weather.showVersion();

</script>



<script id="tplWeatherShowInstance"
        type="text/ejs"
        class="vis-tpl"
        data-vis-set="weather"
        data-vis-name="Weather"
        data-vis-beta="false"
        data-vis-type="weather"
        data-vis-update-style="true"
        data-vis-prev='<img src="widgets/weather/img/Prev_tplWeather.png"></img>'
        data-vis-attrs="instance/weather/onInstanceChanged;"
        data-vis-attrs0="time_interval[30 minutes]/select,1 second,10 seconds,30 seconds,1 minute,2 minutes,5 minutes,10 minutes,30 minutes,1 hour,2 hours,4 hours,8 hours,12 hours,24 hours;"
        data-vis-attrs1="datastructure[NextDaysDetailed]/select,NextDaysDetailed,NextHours,NextHours2/onInstanceChanged;"
        data-vis-attrs2="withxaxix[true]/checkbox;axislabelcolor[#39e00b]/color;tickscolor[#ffffff]/color;LabelFontSize[8];LabelFontFamily[Arial]/fontname;withmarking[true]/checkbox;markingcolor[#eaebe5]/color;xDateFormat[%d.%b %H:%M];borderWidth[1];bordercolor[#000000]/color;nobgcolor[true]/checkbox;bgcolor[#FFFFFF]/color;withlegend[false]/checkbox;legendposition[ne]/select,ne,nw,se,sw;"
        data-vis-attrs3="group.rain;rainvisible[true]/checkbox;rainchartType[bar]/select,line,bar;rainname[rain];raincolor[#1d0ed8]/color;raincoloraxis[#1d0ed8]/color;raincolorticklabel[#1d0ed8]/color;yRainVisible[true]/checkbox;raintickLength[5];rainshowMinorTicks[true]/checkbox;rainshowTicks[true]/checkbox;raintickDecimals[1];raintickSize[3];rainminTickSize[2];rainlabelwidth[30];"
        data-vis-attrs4="group.chancerain;chancerainvisible[true]/checkbox;chancerainname[chance rain];chanceraincolor[#877efc]/color;chanceraincoloraxis[#1d0ed8]/color;chanceraincolorticklabel[#1d0ed8]/color;yChanceRainVisible[true]/checkbox;chanceraintickLength[5];chancerainshowMinorTicks[true]/checkbox;chancerainshowTicks[true]/checkbox;chanceraintickDecimals[1];chanceraintickSize[3];chancerainminTickSize[2];chancerainlabelwidth[30];"
        data-vis-attrs5="group.temperature;tempvisible[true]/checkbox;tempchartType[line]/select,line,bar;tempname[temperature];tempcolor[#00b3ac]/color;tempcoloraxis[#1d0ed8]/color;tempcolorticklabel[#1d0ed8]/color;maxY_temp[0];minY_temp[0];yTempVisible[true]/checkbox;temptickLength[5];tempshowMinorTicks[true]/checkbox;tempshowTicks[true]/checkbox;temptickDecimals[1];temptickSize[3];tempminTickSize[2];templabelwidth[30];"
        data-vis-attrs6="group.clouds;cloudsvisible/checkbox;cloudschartType[bar]/select,line,bar;cloudsname[clouds]; sunorcloud[sun]/select,sun,clouds;cloudcolor[#f6ef3c]/color;cloudcoloraxis[#1d0ed8]/color;cloudcolorticklabel[#1d0ed8]/color;yCloudVisible[true]/checkbox;cloudtickLength[5];cloudshowMinorTicks[true]/checkbox;cloudshowTicks[true]/checkbox;cloudtickDecimals[1];cloudtickSize[3];cloudminTickSize[2];cloudslabelwidth[30];"
        data-vis-attrs7="group.oids;oid_rain(0-39)/id;oid_chancerain(0-39)/id;oid_temp(0-39)/id;oid_cloud(0-39)/id;oid_hour(0-39)/id;"
        data-vis-attrs8="oid_date/id;">


<div class="vis-widget <%== this.data.attr('class') %>" style="overflow: hidden; width: 210px; height: 170px; " id="<%= this.data.attr('wid') %>">
    <div class="vis-weather-widget-body">
        <% vis.binds.weather.tempandrain.init(this.data.wid, this.view, this.data, this.style); %>
    </div>

</div>

</script>



<!-- --------------weather.html--- END -->
<!-- --------------yr.html--- START -->
<!--
    ioBroker.vis dwd Widget-Set

    version: "2.0.0"

    Copyright 2013-2018 bluefox<dogafox@gmail.com>
-->
<script type="text/javascript">
    vis.binds.yr = {
        version: "1.0.5",
        showVersion: function () {
            if (vis.binds.yr.version) {
                console.log('Version vis-canvas-gauges: ' + vis.binds.yr.version);
                vis.binds.yr.version = null;
            }
        }
    };
    vis.binds.yr.showVersion();
</script>

<script id="tplYrAdapter"
    type="text/ejs"
    class="vis-tpl"
    data-vis-set="yr"
    data-vis-name="yr.no Weather"
    data-vis-prev='<img src="widgets/yr/img/Prev_YrAdapter.png"></img>'
    data-vis-attrs="oid[yr.0.forecast.html]">
    <div class="vis-widget <%== this.data.attr('class') %>" style="padding: 3px; background-color:#ccc; font-family: Arial; width: 310px; height: 80px" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body">
            <%== vis.states.attr(this.data.oid + '.val') %>
        </div>
    </div>
</script>
<!-- --------------yr.html--- END -->

<!-- ---------------------------------------  DO NOT EDIT INSIDE THIS LINE - END   ------------------------------------------- -->

<div id='waitScreen' class='vis-wait-screen'><div id='waitDialog' class='waitDialog'><div class='vis-progressbar '></div><div class='vis-wait-text' id='waitText'></div></div></div>
<div id="vis_container" style="position: absolute; top: 0; left: 0; height: 100%; width: 100%"></div>
<div id="vis_license" style="position: absolute; top: 0; left: 0; height: 100%; width: 100%; font-size: 72px; color: #f4706c; display: none; text-align: center; background: rgba(0,0,0,0.5); z-index: 1">
    <div style="position: absolute; top: calc(50% - 36px); left: 0; width: 100%" class="vis-license-text">No valid license found!</div>
</div>
<div id="server-disconnect" class="disconnect-light">
    <div class="splash-screen-text">...</div>
    <div class="splash-screen-circle-outer"></div>
    <div class="splash-screen-circle-inner"></div>
</div>
<div id="dialog-message" title="Message" style="display: none">
    <p>
        <span id="dialog-message-icon" class="ui-icon ui-icon-circle-check" style="float:left; margin:0 7px 50px 0;"></span>
        <span id="dialog-message-text"></span>
    </p>
</div>
</body>
</html>
